<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>[日常训练] Crypto Training - BUUCTF（一） - DSTBP Blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="DSTBP Blog"><meta name="msapplication-TileImage" content="/images/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="DSTBP Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="序言本系列为博主在日常训练中对网上各大平台密码学题目的个人题解，题解不介绍具体知识点，不保证最优解法，仅供参考。这一期内容涵盖 BUUCTF 平台训练场中的 Crypto 类别题目，按解题数量从高到低排序，收录了前 1 至 100 道题的解题思路与过程，并根据涉及的密码学知识点进行分类整理。结合个人理解，将密码学类题目按考查重点划分为以下八类："><meta property="og:type" content="article"><meta property="og:title" content="[日常训练] Crypto Training - BUUCTF（一）"><meta property="og:url" content="http://dstbp.com/2024/02/01/buuctf1/"><meta property="og:site_name" content="DSTBP Blog"><meta property="og:description" content="序言本系列为博主在日常训练中对网上各大平台密码学题目的个人题解，题解不介绍具体知识点，不保证最优解法，仅供参考。这一期内容涵盖 BUUCTF 平台训练场中的 Crypto 类别题目，按解题数量从高到低排序，收录了前 1 至 100 道题的解题思路与过程，并根据涉及的密码学知识点进行分类整理。结合个人理解，将密码学类题目按考查重点划分为以下八类："><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://dstbp.com/data/imgs/posts/buuctf/Thumbnail.png"><meta property="article:published_time" content="2024-02-01T00:10:43.000Z"><meta property="article:modified_time" content="2025-07-12T07:35:03.793Z"><meta property="article:author" content="DSTBP"><meta property="article:tag" content="密码学"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://dstbp.com/data/imgs/posts/buuctf/Thumbnail.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://dstbp.com/2024/02/01/buuctf1/"},"headline":"[日常训练] Crypto Training - BUUCTF（一）","image":["https://dstbp.com/data/imgs/posts/buuctf/Thumbnail.png"],"datePublished":"2024-02-01T00:10:43.000Z","dateModified":"2025-07-12T07:35:03.793Z","author":{"@type":"Person","name":"DSTBP"},"publisher":{"@type":"Organization","name":"DSTBP Blog","logo":{"@type":"ImageObject","url":{"light":"/images/logo.jpg","dark":"/images/logo-dark.jpg"}}},"description":"序言本系列为博主在日常训练中对网上各大平台密码学题目的个人题解，题解不介绍具体知识点，不保证最优解法，仅供参考。这一期内容涵盖 BUUCTF 平台训练场中的 Crypto 类别题目，按解题数量从高到低排序，收录了前 1 至 100 道题的解题思路与过程，并根据涉及的密码学知识点进行分类整理。结合个人理解，将密码学类题目按考查重点划分为以下八类："}</script><link rel="canonical" href="http://dstbp.com/2024/02/01/buuctf1/"><link rel="alternate" href="/atom.xml" title="DSTBP Blog" type="application/atom+xml"><link rel="icon" href="/images/favicon.svg"><link rel="stylesheet" href="/css/font/fontawesome/css/all.min.css"><link data-pjax rel="stylesheet" href="/js/imaegoo/highlight.js/11.7.0/styles/atom-one-light.css"><link data-pjax rel="stylesheet" href="/css/default.css"><!--!--><!--!--><script src="https://vercount.one/js" defer></script><link rel="stylesheet" href="/js/imaegoo/lightgallery/1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="/js/imaegoo/justifiedGallery/3.8.1/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=G-K9WLQN9BFY" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'G-K9WLQN9BFY');</script><!--!--><!--!--><link rel="stylesheet" href="/js/imaegoo/cookieconsent/3.1.1/build/cookieconsent.min.css"><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body class="is-3-column"><script type="text/javascript" src="/js/imaegoo/night.js"></script><canvas id="universe"></canvas><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img class="logo-img" src="/images/logo.jpg" alt="DSTBP Blog" height="28"><img class="logo-img-dark" src="/images/logo-dark.jpg" alt="DSTBP Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">首页</a><a class="navbar-item" href="/archives/">时间轴</a><a class="navbar-item" href="/categories/">分类</a><a class="navbar-item" href="/tags/">标签</a><a class="navbar-item" href="/messages/">留言板</a><a class="navbar-item" href="/friends/">友链</a><a class="navbar-item" href="/about/">关于</a></div><div class="navbar-end"><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i><span>  目录</span></a><a class="navbar-item night" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><i class="fas fa-thumbtack level-item" title="Pinned"></i><span class="level-item"><time dateTime="2024-02-01T00:10:43.000Z" title="2024/2/1 08:10:43">2024-02-01</time>发表</span><span class="level-item"><time dateTime="2025-07-12T07:35:03.793Z" title="2025/7/12 15:35:03">2025-07-12</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/">密码学</a><span> / </span><a class="link-muted" href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/%E6%97%A5%E5%B8%B8%E8%AE%AD%E7%BB%83/">日常训练</a></span><span class="level-item">5 小时读完 (大约44729个字)</span><span class="level-item leancloud_visitors" id="/2024/02/01/buuctf1/" data-flag-title="[日常训练] Crypto Training - BUUCTF（一）"><i class="far fa-eye"></i>&nbsp;&nbsp;<span id="twikoo_visitors"><i class="fa fa-spinner fa-spin"></i></span>次访问</span></div></div><h1 class="title is-3 is-size-4-mobile">[日常训练] Crypto Training - BUUCTF（一）</h1><div class="content"><h1 id="序言"><a href="#序言" class="headerlink" title="序言"></a>序言</h1><p>本系列为博主在日常训练中对网上各大平台密码学题目的个人题解，题解不介绍具体知识点，不保证最优解法，仅供参考。这一期内容涵盖 BUUCTF 平台训练场中的 Crypto 类别题目，按解题数量从高到低排序，收录了前 1 至 100 道题的解题思路与过程，并根据涉及的密码学知识点进行分类整理。结合个人理解，将密码学类题目按考查重点划分为以下八类：</p>
<span id="more"></span>

<ul>
<li><p><strong>编码与混淆（Encoding &amp; Obfuscation）</strong></p>
<p>虽不属于严格意义上的“加密”，但在密码题中常作为基础步骤出现。典型形式包括：</p>
<ul>
<li>各类标准编码（Base64、URL 编码）</li>
<li>进制转换（二进制、八进制、十六进制等）</li>
<li>字符串混淆（兽音译者、JSFuck）</li>
<li>简单扰动（XOR 操作、位反转）</li>
</ul>
</li>
<li><p><strong>传统古典密码（Classical Cryptography）</strong></p>
<p>早期古典密码技术，核心考点为替换与移位机制，常考察手工破解能力。典型形式包括：</p>
<ul>
<li>单表替换（凯撒密码）</li>
<li>多表替换（维吉尼亚密码）</li>
<li>图形替换（猪圈密码、摩斯电码）</li>
<li>换位加密（栅栏密码）</li>
<li>混合密码（恩尼格玛机）</li>
</ul>
</li>
<li><p><strong>现代对称密码（Symmetric Cryptography）</strong></p>
<p>考察现代加密算法实现或使用方式，常涉及密钥管理和模式漏洞。典型形式包括：</p>
<ul>
<li>分组加密（AES、DES）</li>
<li>流加密（RC4、Rabbit）</li>
<li>模式漏洞（ECB 信息泄露）</li>
<li>填充攻击（Padding Oracle）</li>
</ul>
</li>
<li><p><strong>现代非对称密码（Asymmetric Cryptography）</strong></p>
<p>以 RSA 为代表的公钥密码系统为核心，考察其数学原理与实际应用中的安全隐患。典型形式包括：</p>
<ul>
<li>数学构造型密码（RSA、ECC）</li>
<li>参数不安全型（共模攻击、低加密指数攻击）</li>
<li>结构缺陷型（Håstad 攻击、CRT 重组）</li>
<li>签名验证漏洞（Bleichenbacher 攻击）</li>
</ul>
</li>
<li><p><strong>哈希与消息认证（Hash &#x2F; MAC）</strong></p>
<p>涉及哈希函数特性或相关攻击技术。典型形式包括：</p>
<ul>
<li>哈希计算（MD5、SHA1）</li>
<li>碰撞攻击（生日攻击）</li>
<li>长度扩展攻击（Merkle-Damgård 构造漏洞）</li>
<li>爆破攻击（彩虹表）</li>
</ul>
</li>
<li><p><strong>应用密码学（Applied Cryptography）</strong></p>
<p>更贴近真实场景，重点在于加密协议、密钥管理以及实现漏洞。典型形式包括：</p>
<ul>
<li>参数设计漏洞（Nonce 重用）</li>
<li>协议缺陷（TLS&#x2F;SSL 中间人攻击）</li>
<li>物理攻击（侧信道分析、电磁泄露）</li>
</ul>
</li>
<li><p><strong>自定义构造题（Custom Crypto）</strong></p>
<p>该类题目不依赖标准加密算法，通常由出题者自定义加密逻辑，或将多种密码学知识点巧妙（并非巧妙）融合。需对题目进行逆向与逻辑分析。典型形式包括：</p>
<ul>
<li>算法构造型（结合数据结构与算法、原创加密流程、状态机等）</li>
<li>数学建模型（运用数论等基础数学知识构造陷阱）</li>
<li>混合型（多种加密知识点融合）</li>
</ul>
</li>
<li><p><strong>信息隐藏与隐写术（Steganography）</strong></p>
<p>常与 Forensics 交叉， 虽不属于密码学的主流分类，但经常涉及。主要包括图片隐写、音频隐写、文件格式伪装、Zlib&#x2F;Gzip 压缩混淆。</p>
</li>
</ul>
<h1 id="1-编码与混淆"><a href="#1-编码与混淆" class="headerlink" title="1. 编码与混淆"></a>1. 编码与混淆</h1><h2 id="1-1-一眼就解密"><a href="#1-1-一眼就解密" class="headerlink" title="1.1 一眼就解密"></a>1.1 一眼就解密</h2><h3 id="1-1-1-题目"><a href="#1-1-1-题目" class="headerlink" title="1.1.1 题目"></a>1.1.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">下面的字符串解密后便能获得flag：ZmxhZ3tUSEVfRkxBR19PRl9USElTX1NUUklOR30=</span><br></pre></td></tr></table></figure>

<h3 id="1-1-2-解题思路"><a href="#1-1-2-解题思路" class="headerlink" title="1.1.2 解题思路"></a>1.1.2 解题思路</h3><p><strong>Base64 编码</strong></p>
<h3 id="1-1-3-解题脚本"><a href="#1-1-3-解题脚本" class="headerlink" title="1.1.3 解题脚本"></a>1.1.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(base64.b64decode(<span class="string">&#x27;ZmxhZ3tUSEVfRkxBR19PRl9USElTX1NUUklOR30=&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;flag&#123;THE_FLAG_OF_THIS_STRING&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="1-2-Url编码"><a href="#1-2-Url编码" class="headerlink" title="1.2 Url编码"></a>1.2 Url编码</h2><h3 id="1-2-1-题目"><a href="#1-2-1-题目" class="headerlink" title="1.2.1 题目"></a>1.2.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%<span class="number">66</span>%6c%<span class="number">61</span>%<span class="number">67</span>%7b%<span class="number">61</span>%6e%<span class="number">64</span>%<span class="number">20</span>%<span class="number">31</span>%3d%<span class="number">31</span>%7d</span><br></pre></td></tr></table></figure>

<h3 id="1-2-2-解题思路"><a href="#1-2-2-解题思路" class="headerlink" title="1.2.2 解题思路"></a>1.2.2 解题思路</h3><p><strong>Url 编码</strong></p>
<h3 id="1-2-3-解题脚本"><a href="#1-2-3-解题脚本" class="headerlink" title="1.2.3 解题脚本"></a>1.2.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> parse</span><br><span class="line"></span><br><span class="line">encoded_text = <span class="string">&#x27;%66%6c%61%67%7b%61%6e%64%20%31%3d%31%7d&#x27;</span></span><br><span class="line">decoded_text = parse.unquote(encoded_text)</span><br><span class="line"><span class="built_in">print</span>(decoded_text)</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag&#123;and 1=1&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="1-3-Quoted-printable"><a href="#1-3-Quoted-printable" class="headerlink" title="1.3 Quoted-printable"></a>1.3 Quoted-printable</h2><h3 id="1-3-1-题目"><a href="#1-3-1-题目" class="headerlink" title="1.3.1 题目"></a>1.3.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">=E9=<span class="number">82</span>=A3=E4=BD=A0=E4=B9=9F=E5=BE=<span class="number">88</span>=E6=A3=<span class="number">92</span>=E5=<span class="number">93</span>=A6</span><br></pre></td></tr></table></figure>

<h3 id="1-3-2-解题思路"><a href="#1-3-2-解题思路" class="headerlink" title="1.3.2 解题思路"></a>1.3.2 解题思路</h3><p><strong>Quoted-printable 编码</strong>：使用可打印的 ASCII 字符表示各种编码格式下的字符。它属于 MIME 标准的一部分，常用于电子邮件、HTTP 头信息等场景。</p>
<h3 id="1-3-3-解题脚本"><a href="#1-3-3-解题脚本" class="headerlink" title="1.3.3 解题脚本"></a>1.3.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> quopri</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    ct = <span class="string">&quot;=E9=82=A3=E4=BD=A0=E4=B9=9F=E5=BE=88=E6=A3=92=E5=93=A6&quot;</span></span><br><span class="line">    decoded = quopri.decodestring(ct)</span><br><span class="line">    <span class="built_in">print</span>(decoded.decode(<span class="string">&quot;utf8&quot;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># flag&#123;那你也很棒哦&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="1-4-信息化时代的步伐"><a href="#1-4-信息化时代的步伐" class="headerlink" title="1.4 信息化时代的步伐"></a>1.4 信息化时代的步伐</h2><h3 id="1-4-1-题目"><a href="#1-4-1-题目" class="headerlink" title="1.4.1 题目"></a>1.4.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 也许中国可以早早进入信息化时代，但是被清政府拒绝了。附件中是数十年后一位伟人说的话的密文。请翻译出明文(答案为一串中文！)</span></span><br><span class="line"></span><br><span class="line"><span class="number">606046152623600817831216121621196386</span></span><br></pre></td></tr></table></figure>

<h3 id="1-4-2-解题思路"><a href="#1-4-2-解题思路" class="headerlink" title="1.4.2 解题思路"></a>1.4.2 解题思路</h3><p><strong>中文电码</strong>（标准中文电码、中文电报码或中文电报明码），最早将汉字转换为电子信号的一种编码方式，用于电报传输中文信息。</p>
<p>最早的汉字电码由威基杰（S.A. Viguer）编制，他借鉴《康熙字典》的部首分类方式，从中挑选 6800 多个常用汉字，编成《电报新书》。随后郑观应将其改编为《中国电报新编》，成为中国最早的汉字电码本。</p>
<p>中文电码表采用四位阿拉伯数字（0001 到 9999）为编码，用于表示最多一万个汉字、字母和符号。汉字按部首优先、笔画次之的顺序排列，字母和符号则被放置在电码表的末尾。</p>
<h3 id="1-4-3-解题脚本"><a href="#1-4-3-解题脚本" class="headerlink" title="1.4.3 解题脚本"></a>1.4.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line"></span><br><span class="line"><span class="comment"># 请求参数和头部</span></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&#x27;Accept-Language&#x27;</span>: <span class="string">&#x27;zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Referer&#x27;</span>: <span class="string">&#x27;http://code.mcdvisa.com/&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">params = (</span><br><span class="line">    (<span class="string">&#x27;action&#x27;</span>, <span class="string">&#x27;getcode&#x27;</span>),</span><br><span class="line">    (<span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;1&#x27;</span>),</span><br><span class="line">    (<span class="string">&#x27;w&#x27;</span>, <span class="string">&#x27;606046152623600817831216121621196386&#x27;</span>),</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 发送请求获取HTML内容</span></span><br><span class="line">response = requests.get(<span class="string">&#x27;http://code.mcdvisa.com/save.php&#x27;</span>, headers=headers, params=params, verify=<span class="literal">False</span>)</span><br><span class="line">response.encoding = <span class="string">&#x27;utf-8&#x27;</span></span><br><span class="line">root = etree.HTML(response.text)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 转换为字典</span></span><br><span class="line">result_dict = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> root.xpath(<span class="string">&#x27;//ul/li/text()&#x27;</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;：&#x27;</span> <span class="keyword">in</span> item:</span><br><span class="line">        code, char = item.split(<span class="string">&#x27;：&#x27;</span>, <span class="number">1</span>)</span><br><span class="line">        result_dict[code] = char</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(result_dict)</span><br><span class="line">data = <span class="string">&#x27;&#x27;</span>.join(result_dict.values())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;flag&#123;&#123;<span class="subst">&#123;data&#125;</span>&#125;&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag&#123;计算机要从娃抓起&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="1-5-Unencode"><a href="#1-5-Unencode" class="headerlink" title="1.5 Unencode"></a>1.5 Unencode</h2><h3 id="1-5-1-题目"><a href="#1-5-1-题目" class="headerlink" title="1.5.1 题目"></a>1.5.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">89FQA9WMD&lt;V1A&lt;V1S83DY.<span class="comment">#&lt;W3$Q,2TM]</span></span><br></pre></td></tr></table></figure>

<h3 id="1-5-2-解题思路"><a href="#1-5-2-解题思路" class="headerlink" title="1.5.2 解题思路"></a>1.5.2 解题思路</h3><p><strong>UUencode 编码</strong>：Unix 系统下用于通过 uucp 邮件系统传输二进制数据的一种编码格式。</p>
<h3 id="1-5-3-解题脚本"><a href="#1-5-3-解题脚本" class="headerlink" title="1.5.3 解题脚本"></a>1.5.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">UUencodeCipher</span>:</span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">uuencode</span>(<span class="params">data</span>):</span><br><span class="line">        <span class="comment"># 将所有字符转换为8位二进制并拼接</span></span><br><span class="line">        bin_str = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">format</span>(<span class="built_in">ord</span>(c), <span class="string">&#x27;08b&#x27;</span>) <span class="keyword">for</span> c <span class="keyword">in</span> data)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 补齐长度为24的倍数</span></span><br><span class="line">        bin_str += <span class="string">&#x27;0&#x27;</span> * ((<span class="number">24</span> - <span class="built_in">len</span>(bin_str) % <span class="number">24</span>) % <span class="number">24</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 添加长度字符（字节数）</span></span><br><span class="line">        encoded = <span class="built_in">chr</span>(<span class="number">32</span> + <span class="built_in">len</span>(data))</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 每6位转换为字符</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(bin_str), <span class="number">6</span>):</span><br><span class="line">            val = <span class="built_in">int</span>(bin_str[i:i+<span class="number">6</span>], <span class="number">2</span>)</span><br><span class="line">            encoded += <span class="built_in">chr</span>(<span class="number">0x60</span> <span class="keyword">if</span> val == <span class="number">0</span> <span class="keyword">else</span> val + <span class="number">32</span>)</span><br><span class="line">        <span class="keyword">return</span> encoded</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">uudecode</span>(<span class="params">data</span>):</span><br><span class="line">        <span class="comment"># 去除长度字符，解码为二进制字符串</span></span><br><span class="line">        bin_str = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">format</span>(<span class="number">0</span> <span class="keyword">if</span> c == <span class="string">&#x27;`&#x27;</span> <span class="keyword">else</span> <span class="built_in">ord</span>(c) - <span class="number">32</span>, <span class="string">&#x27;06b&#x27;</span>) <span class="keyword">for</span> c <span class="keyword">in</span> data[<span class="number">1</span>:])</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 每8位转换为原始字符</span></span><br><span class="line">        decoded = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(<span class="built_in">int</span>(bin_str[i:i+<span class="number">8</span>], <span class="number">2</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(bin_str), <span class="number">8</span>))</span><br><span class="line">        <span class="keyword">return</span> decoded</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    ciphertext = <span class="string">&quot;89FQA9WMD&lt;V1A&lt;V1S83DY.#&lt;W3$Q,2TM]&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(UUencodeCipher.uudecode(ciphertext))</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># flag&#123;dsdasdsa99877LLLKK&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="1-6-异性相吸"><a href="#1-6-异性相吸" class="headerlink" title="1.6 异性相吸"></a>1.6 异性相吸</h2><h3 id="1-6-1-题目"><a href="#1-6-1-题目" class="headerlink" title="1.6.1 题目"></a>1.6.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># key.txt</span></span><br><span class="line">asadsasdasdasdasdasdasdasdasdasdqwesqf</span><br><span class="line"></span><br><span class="line"><span class="comment"># 密文.txt</span></span><br><span class="line">07 1F <span class="number">00</span> 03 08 04 <span class="number">12</span> <span class="number">55</span> 03 <span class="number">10</span> <span class="number">54</span> <span class="number">58</span> 4B 5C <span class="number">58</span> 4A</span><br><span class="line"><span class="number">56</span> <span class="number">53</span> <span class="number">44</span> <span class="number">52</span> 03 <span class="number">44</span> 02 <span class="number">58</span> <span class="number">46</span> 06 <span class="number">54</span> <span class="number">47</span> 05 <span class="number">56</span> <span class="number">47</span> <span class="number">57</span></span><br><span class="line"><span class="number">44</span> <span class="number">12</span> 5D 4A <span class="number">14</span> 1B</span><br></pre></td></tr></table></figure>

<h3 id="1-6-2-解题思路"><a href="#1-6-2-解题思路" class="headerlink" title="1.6.2 解题思路"></a>1.6.2 解题思路</h3><p><strong>异或</strong></p>
<h3 id="1-6-3-解题脚本"><a href="#1-6-3-解题脚本" class="headerlink" title="1.6.3 解题脚本"></a>1.6.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> unhexlify</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;key.txt&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        file1 = bytes_to_long(f.read())</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;密文.txt&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        file2 = bytes_to_long(f.read())</span><br><span class="line"></span><br><span class="line">    res = file1 ^ file2</span><br><span class="line">    <span class="built_in">print</span>(unhexlify(<span class="built_in">hex</span>(res)[<span class="number">2</span>:]))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># flag&#123;ea1bc0988992276b7f95b54a7435e89e&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="1-7-密码学的心声"><a href="#1-7-密码学的心声" class="headerlink" title="1.7 密码学的心声"></a>1.7 密码学的心声</h2><h3 id="1-7-1-题目"><a href="#1-7-1-题目" class="headerlink" title="1.7.1 题目"></a>1.7.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">二战时期，某国军官与一个音乐家情妇相好，然而自从那时起，他屡战屡败，敌人似乎料事如神。他也有怀疑过他的情妇，但是他经过<span class="number">24</span>小时观察他的情妇，发现她每天都只是作曲，然后弹奏给战地电台，为士兵们鼓气，并未有任何逾越。那么，间谍到底是谁？这张曲谱是否有猫腻？ (答案为一个明文字符串，提交获得的有意义语句通顺字符串即可) </span><br></pre></td></tr></table></figure>

<center><img src=https://dstbp.com/data/imgs/posts/buuctf/密码学的心声.png width="600"></center>

<h3 id="1-7-2-解题思路"><a href="#1-7-2-解题思路" class="headerlink" title="1.7.2 解题思路"></a>1.7.2 解题思路</h3><p><strong>进制转换</strong>：八进制数字三个一组转换为 ASCII 码</p>
<h3 id="1-7-3-解题脚本"><a href="#1-7-3-解题脚本" class="headerlink" title="1.7.3 解题脚本"></a>1.7.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    ct = <span class="string">&#x27;111 114 157 166 145 123 145 143 165 162 151 164 171 126 145 162 171 115 165 143 150&#x27;</span></span><br><span class="line">    <span class="comment"># 八进制数转换为字符</span></span><br><span class="line">    cipher = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(<span class="built_in">int</span>(octal, <span class="number">8</span>)) <span class="keyword">for</span> octal <span class="keyword">in</span> ct.split())</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;flag&#123;&#123;<span class="subst">&#123;cipher&#125;</span>&#125;&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># flag&#123;ILoveSecurityVeryMuch&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="1-8-BJDCTF2020-这是base"><a href="#1-8-BJDCTF2020-这是base" class="headerlink" title="1.8 [BJDCTF2020]这是base??"></a>1.8 [BJDCTF2020]这是base??</h2><h3 id="1-8-1-题目"><a href="#1-8-1-题目" class="headerlink" title="1.8.1 题目"></a>1.8.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">dict</span>:&#123;<span class="number">0</span>: <span class="string">&#x27;J&#x27;</span>, <span class="number">1</span>: <span class="string">&#x27;K&#x27;</span>, <span class="number">2</span>: <span class="string">&#x27;L&#x27;</span>, <span class="number">3</span>: <span class="string">&#x27;M&#x27;</span>, <span class="number">4</span>: <span class="string">&#x27;N&#x27;</span>, <span class="number">5</span>: <span class="string">&#x27;O&#x27;</span>, <span class="number">6</span>: <span class="string">&#x27;x&#x27;</span>, <span class="number">7</span>: <span class="string">&#x27;y&#x27;</span>, <span class="number">8</span>: <span class="string">&#x27;U&#x27;</span>, <span class="number">9</span>: <span class="string">&#x27;V&#x27;</span>, <span class="number">10</span>: <span class="string">&#x27;z&#x27;</span>, <span class="number">11</span>: <span class="string">&#x27;A&#x27;</span>, <span class="number">12</span>: <span class="string">&#x27;B&#x27;</span>, <span class="number">13</span>: <span class="string">&#x27;C&#x27;</span>, <span class="number">14</span>: <span class="string">&#x27;D&#x27;</span>, <span class="number">15</span>: <span class="string">&#x27;E&#x27;</span>, <span class="number">16</span>: <span class="string">&#x27;F&#x27;</span>, <span class="number">17</span>: <span class="string">&#x27;G&#x27;</span>, <span class="number">18</span>: <span class="string">&#x27;H&#x27;</span>, <span class="number">19</span>: <span class="string">&#x27;7&#x27;</span>, <span class="number">20</span>: <span class="string">&#x27;8&#x27;</span>, <span class="number">21</span>: <span class="string">&#x27;9&#x27;</span>, <span class="number">22</span>: <span class="string">&#x27;P&#x27;</span>, <span class="number">23</span>: <span class="string">&#x27;Q&#x27;</span>, <span class="number">24</span>: <span class="string">&#x27;I&#x27;</span>, <span class="number">25</span>: <span class="string">&#x27;a&#x27;</span>, <span class="number">26</span>: <span class="string">&#x27;b&#x27;</span>, <span class="number">27</span>: <span class="string">&#x27;c&#x27;</span>, <span class="number">28</span>: <span class="string">&#x27;d&#x27;</span>, <span class="number">29</span>: <span class="string">&#x27;e&#x27;</span>, <span class="number">30</span>: <span class="string">&#x27;f&#x27;</span>, <span class="number">31</span>: <span class="string">&#x27;g&#x27;</span>, <span class="number">32</span>: <span class="string">&#x27;h&#x27;</span>, <span class="number">33</span>: <span class="string">&#x27;i&#x27;</span>, <span class="number">34</span>: <span class="string">&#x27;j&#x27;</span>, <span class="number">35</span>: <span class="string">&#x27;k&#x27;</span>, <span class="number">36</span>: <span class="string">&#x27;l&#x27;</span>, <span class="number">37</span>: <span class="string">&#x27;m&#x27;</span>, <span class="number">38</span>: <span class="string">&#x27;W&#x27;</span>, <span class="number">39</span>: <span class="string">&#x27;X&#x27;</span>, <span class="number">40</span>: <span class="string">&#x27;Y&#x27;</span>, <span class="number">41</span>: <span class="string">&#x27;Z&#x27;</span>, <span class="number">42</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">43</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">44</span>: <span class="string">&#x27;2&#x27;</span>, <span class="number">45</span>: <span class="string">&#x27;3&#x27;</span>, <span class="number">46</span>: <span class="string">&#x27;4&#x27;</span>, <span class="number">47</span>: <span class="string">&#x27;5&#x27;</span>, <span class="number">48</span>: <span class="string">&#x27;6&#x27;</span>, <span class="number">49</span>: <span class="string">&#x27;R&#x27;</span>, <span class="number">50</span>: <span class="string">&#x27;S&#x27;</span>, <span class="number">51</span>: <span class="string">&#x27;T&#x27;</span>, <span class="number">52</span>: <span class="string">&#x27;n&#x27;</span>, <span class="number">53</span>: <span class="string">&#x27;o&#x27;</span>, <span class="number">54</span>: <span class="string">&#x27;p&#x27;</span>, <span class="number">55</span>: <span class="string">&#x27;q&#x27;</span>, <span class="number">56</span>: <span class="string">&#x27;r&#x27;</span>, <span class="number">57</span>: <span class="string">&#x27;s&#x27;</span>, <span class="number">58</span>: <span class="string">&#x27;t&#x27;</span>, <span class="number">59</span>: <span class="string">&#x27;u&#x27;</span>, <span class="number">60</span>: <span class="string">&#x27;v&#x27;</span>, <span class="number">61</span>: <span class="string">&#x27;w&#x27;</span>, <span class="number">62</span>: <span class="string">&#x27;+&#x27;</span>, <span class="number">63</span>: <span class="string">&#x27;/&#x27;</span>, <span class="number">64</span>: <span class="string">&#x27;=&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">chipertext:</span><br><span class="line">FlZNfnF6Qol6e9w17WwQQoGYBQCgIkGTa9w3IQKw</span><br></pre></td></tr></table></figure>

<h3 id="1-8-2-解题思路"><a href="#1-8-2-解题思路" class="headerlink" title="1.8.2 解题思路"></a>1.8.2 解题思路</h3><p><strong>自定义码表 Base64</strong></p>
<h3 id="1-8-3-解题脚本"><a href="#1-8-3-解题脚本" class="headerlink" title="1.8.3 解题脚本"></a>1.8.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Optional</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BaseXEncoder</span>:</span><br><span class="line">    <span class="comment"># 常见进制的编码表</span></span><br><span class="line">    STANDARD_TABLES = &#123;</span><br><span class="line">        <span class="number">16</span>: <span class="string">b&quot;0123456789ABCDEF&quot;</span>,</span><br><span class="line">        <span class="number">32</span>: <span class="string">b&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ234567&quot;</span>,</span><br><span class="line">        <span class="number">58</span>: <span class="string">b&quot;123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz&quot;</span>,</span><br><span class="line">        <span class="number">62</span>: <span class="string">b&quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&quot;</span>,</span><br><span class="line">        <span class="number">64</span>: <span class="string">b&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span>,</span><br><span class="line">        <span class="number">91</span>: <span class="string">b&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!#$%&amp;()*+,./:;&lt;=&gt;?@[]^_`&#123;|&#125;~\&quot;&quot;</span>,</span><br><span class="line">        <span class="number">92</span>: <span class="string">b&quot;!\&quot;#$%&amp;&#x27;()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz&#123;|&#125;~&quot;</span>,</span><br><span class="line">        <span class="number">128</span>: <span class="built_in">bytes</span>(<span class="built_in">range</span>(<span class="number">128</span>)),  <span class="comment"># 每个字节本身</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encode</span>(<span class="params">self, data: <span class="built_in">bytes</span>, base: <span class="built_in">int</span>, table: <span class="type">Optional</span>[<span class="built_in">bytes</span>] = <span class="literal">None</span>, padding: <span class="type">Optional</span>[<span class="built_in">bytes</span>] = <span class="string">b&quot;=&quot;</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        编码函数：支持 base16, base32, base64, base58, base62, base91, base92, base128</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        table = table <span class="keyword">or</span> <span class="variable language_">self</span>.STANDARD_TABLES.get(base)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 标准 base 编码（内置支持填充）</span></span><br><span class="line">        <span class="keyword">if</span> base == <span class="number">16</span>:</span><br><span class="line">            encoded = base64.b16encode(data).translate(<span class="built_in">bytes</span>.maketrans(<span class="string">b&quot;0123456789ABCDEF&quot;</span>, table))</span><br><span class="line">        <span class="keyword">elif</span> base == <span class="number">32</span>:</span><br><span class="line">            encoded = base64.b32encode(data).translate(<span class="built_in">bytes</span>.maketrans(<span class="variable language_">self</span>.STANDARD_TABLES[<span class="number">32</span>], table))</span><br><span class="line">        <span class="keyword">elif</span> base == <span class="number">64</span>:</span><br><span class="line">            encoded = base64.b64encode(data).translate(<span class="built_in">bytes</span>.maketrans(<span class="variable language_">self</span>.STANDARD_TABLES[<span class="number">64</span>], table))</span><br><span class="line">        <span class="keyword">elif</span> base <span class="keyword">in</span> (<span class="number">58</span>, <span class="number">62</span>, <span class="number">91</span>, <span class="number">92</span>, <span class="number">128</span>):  <span class="comment"># 自定义 baseX 编码</span></span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">self</span>._baseX_encode(data, table).decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f&quot;Unsupported base: <span class="subst">&#123;base&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 处理填充字符</span></span><br><span class="line">        <span class="keyword">if</span> padding <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            encoded = encoded.rstrip(<span class="string">b&quot;=&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> padding != <span class="string">b&quot;=&quot;</span>:</span><br><span class="line">            encoded = encoded.rstrip(<span class="string">b&quot;=&quot;</span>).replace(<span class="string">b&quot;=&quot;</span>, padding)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> encoded.decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decode</span>(<span class="params">self, ciphertext: <span class="built_in">str</span>, base: <span class="built_in">int</span>, table: <span class="type">Optional</span>[<span class="built_in">bytes</span>] = <span class="literal">None</span>, padding: <span class="type">Optional</span>[<span class="built_in">bytes</span>] = <span class="string">b&quot;=&quot;</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        解码函数：对应 encode 函数的逆过程</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        encoded = ciphertext.encode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">        table = table <span class="keyword">or</span> <span class="variable language_">self</span>.STANDARD_TABLES.get(base)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> base <span class="keyword">in</span> (<span class="number">58</span>, <span class="number">62</span>, <span class="number">91</span>, <span class="number">92</span>, <span class="number">128</span>):</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">self</span>._baseX_decode(encoded, table)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 恢复 padding</span></span><br><span class="line">        <span class="keyword">if</span> padding <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> padding != <span class="string">b&quot;=&quot;</span>:</span><br><span class="line">            encoded = encoded.replace(padding, <span class="string">b&quot;=&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 计算并自动补足 base32/base64 所需的 padding 长度</span></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">pad_base</span>(<span class="params">data: <span class="built_in">bytes</span>, block_size: <span class="built_in">int</span> = <span class="number">8</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">            pad_len = (-<span class="built_in">len</span>(data)) % block_size</span><br><span class="line">            <span class="keyword">return</span> data + <span class="string">b&#x27;=&#x27;</span> * pad_len</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> base == <span class="number">16</span>:</span><br><span class="line">            <span class="keyword">return</span> base64.b16decode(encoded.translate(<span class="built_in">bytes</span>.maketrans(table, <span class="string">b&quot;0123456789ABCDEF&quot;</span>)))</span><br><span class="line">        <span class="keyword">elif</span> base == <span class="number">32</span>:</span><br><span class="line">            padded = pad_base(encoded)  <span class="comment"># base32 长度必须为 8 的倍数</span></span><br><span class="line">            <span class="keyword">return</span> base64.b32decode(padded.translate(<span class="built_in">bytes</span>.maketrans(table, <span class="variable language_">self</span>.STANDARD_TABLES[<span class="number">32</span>])))</span><br><span class="line">        <span class="keyword">elif</span> base == <span class="number">64</span>:</span><br><span class="line">            padded = pad_base(encoded, block_size=<span class="number">4</span>)  <span class="comment"># base64 长度必须为 4 的倍数</span></span><br><span class="line">            <span class="keyword">return</span> base64.b64decode(padded.translate(<span class="built_in">bytes</span>.maketrans(table, <span class="variable language_">self</span>.STANDARD_TABLES[<span class="number">64</span>])))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f&quot;Unsupported base: <span class="subst">&#123;base&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_baseX_encode</span>(<span class="params">self, data: <span class="built_in">bytes</span>, table: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        自定义 baseX 编码（如 base58/base62）：将字节数据按目标进制编码为字符表中的字符序列</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        num = <span class="built_in">int</span>.from_bytes(data, byteorder=<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">        base = <span class="built_in">len</span>(table)</span><br><span class="line">        encoded = <span class="built_in">bytearray</span>()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> num &gt; <span class="number">0</span>:</span><br><span class="line">            num, rem = <span class="built_in">divmod</span>(num, base)</span><br><span class="line">            encoded.insert(<span class="number">0</span>, table[rem])</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 前导 0 用 table[0] 表示</span></span><br><span class="line">        pad = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> data:</span><br><span class="line">            <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">                pad += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">bytes</span>([table[<span class="number">0</span>]]) * pad + <span class="built_in">bytes</span>(encoded)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_baseX_decode</span>(<span class="params">self, encoded: <span class="built_in">bytes</span>, table: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        自定义 baseX 解码：将字符序列转换回原始字节数据</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        base = <span class="built_in">len</span>(table)</span><br><span class="line">        index = &#123;char: i <span class="keyword">for</span> i, char <span class="keyword">in</span> <span class="built_in">enumerate</span>(table)&#125;</span><br><span class="line">        num = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> char <span class="keyword">in</span> encoded:</span><br><span class="line">            num = num * base + index[char]</span><br><span class="line"></span><br><span class="line">        decoded = num.to_bytes((num.bit_length() + <span class="number">7</span>) // <span class="number">8</span>, byteorder=<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 处理前导 0</span></span><br><span class="line">        pad = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> encoded:</span><br><span class="line">            <span class="keyword">if</span> c == table[<span class="number">0</span>]:</span><br><span class="line">                pad += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">b&#x27;\x00&#x27;</span> * pad + decoded</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    encoder = BaseXEncoder()</span><br><span class="line">    Codetable = &#123;<span class="number">0</span>: <span class="string">&#x27;J&#x27;</span>, <span class="number">1</span>: <span class="string">&#x27;K&#x27;</span>, <span class="number">2</span>: <span class="string">&#x27;L&#x27;</span>, <span class="number">3</span>: <span class="string">&#x27;M&#x27;</span>, <span class="number">4</span>: <span class="string">&#x27;N&#x27;</span>, <span class="number">5</span>: <span class="string">&#x27;O&#x27;</span>, <span class="number">6</span>: <span class="string">&#x27;x&#x27;</span>, <span class="number">7</span>: <span class="string">&#x27;y&#x27;</span>, <span class="number">8</span>: <span class="string">&#x27;U&#x27;</span>, <span class="number">9</span>: <span class="string">&#x27;V&#x27;</span>, <span class="number">10</span>: <span class="string">&#x27;z&#x27;</span>, <span class="number">11</span>: <span class="string">&#x27;A&#x27;</span>, <span class="number">12</span>: <span class="string">&#x27;B&#x27;</span>, <span class="number">13</span>: <span class="string">&#x27;C&#x27;</span>, <span class="number">14</span>: <span class="string">&#x27;D&#x27;</span>, <span class="number">15</span>: <span class="string">&#x27;E&#x27;</span>, <span class="number">16</span>: <span class="string">&#x27;F&#x27;</span>, <span class="number">17</span>: <span class="string">&#x27;G&#x27;</span>, <span class="number">18</span>: <span class="string">&#x27;H&#x27;</span>, <span class="number">19</span>: <span class="string">&#x27;7&#x27;</span>, <span class="number">20</span>: <span class="string">&#x27;8&#x27;</span>, <span class="number">21</span>: <span class="string">&#x27;9&#x27;</span>, <span class="number">22</span>: <span class="string">&#x27;P&#x27;</span>, <span class="number">23</span>: <span class="string">&#x27;Q&#x27;</span>, <span class="number">24</span>: <span class="string">&#x27;I&#x27;</span>, <span class="number">25</span>: <span class="string">&#x27;a&#x27;</span>, <span class="number">26</span>: <span class="string">&#x27;b&#x27;</span>, <span class="number">27</span>: <span class="string">&#x27;c&#x27;</span>, <span class="number">28</span>: <span class="string">&#x27;d&#x27;</span>, <span class="number">29</span>: <span class="string">&#x27;e&#x27;</span>, <span class="number">30</span>: <span class="string">&#x27;f&#x27;</span>, <span class="number">31</span>: <span class="string">&#x27;g&#x27;</span>, <span class="number">32</span>: <span class="string">&#x27;h&#x27;</span>, <span class="number">33</span>: <span class="string">&#x27;i&#x27;</span>, <span class="number">34</span>: <span class="string">&#x27;j&#x27;</span>, <span class="number">35</span>: <span class="string">&#x27;k&#x27;</span>, <span class="number">36</span>: <span class="string">&#x27;l&#x27;</span>, <span class="number">37</span>: <span class="string">&#x27;m&#x27;</span>, <span class="number">38</span>: <span class="string">&#x27;W&#x27;</span>, <span class="number">39</span>: <span class="string">&#x27;X&#x27;</span>, <span class="number">40</span>: <span class="string">&#x27;Y&#x27;</span>, <span class="number">41</span>: <span class="string">&#x27;Z&#x27;</span>, <span class="number">42</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">43</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">44</span>: <span class="string">&#x27;2&#x27;</span>, <span class="number">45</span>: <span class="string">&#x27;3&#x27;</span>, <span class="number">46</span>: <span class="string">&#x27;4&#x27;</span>, <span class="number">47</span>: <span class="string">&#x27;5&#x27;</span>, <span class="number">48</span>: <span class="string">&#x27;6&#x27;</span>, <span class="number">49</span>: <span class="string">&#x27;R&#x27;</span>, <span class="number">50</span>: <span class="string">&#x27;S&#x27;</span>, <span class="number">51</span>: <span class="string">&#x27;T&#x27;</span>, <span class="number">52</span>: <span class="string">&#x27;n&#x27;</span>, <span class="number">53</span>: <span class="string">&#x27;o&#x27;</span>, <span class="number">54</span>: <span class="string">&#x27;p&#x27;</span>, <span class="number">55</span>: <span class="string">&#x27;q&#x27;</span>, <span class="number">56</span>: <span class="string">&#x27;r&#x27;</span>, <span class="number">57</span>: <span class="string">&#x27;s&#x27;</span>, <span class="number">58</span>: <span class="string">&#x27;t&#x27;</span>, <span class="number">59</span>: <span class="string">&#x27;u&#x27;</span>, <span class="number">60</span>: <span class="string">&#x27;v&#x27;</span>, <span class="number">61</span>: <span class="string">&#x27;w&#x27;</span>, <span class="number">62</span>: <span class="string">&#x27;+&#x27;</span>, <span class="number">63</span>: <span class="string">&#x27;/&#x27;</span>, <span class="number">64</span>: <span class="string">&#x27;=&#x27;</span>&#125;</span><br><span class="line">    chipertext = <span class="string">&quot;FlZNfnF6Qol6e9w17WwQQoGYBQCgIkGTa9w3IQKw&quot;</span></span><br><span class="line">    table = <span class="string">&#x27;&#x27;</span>.join(Codetable[key] <span class="keyword">for</span> key <span class="keyword">in</span> Codetable).encode()</span><br><span class="line">    flag = encoder.decode(chipertext, <span class="number">64</span>, table[:-<span class="number">1</span>])</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># b&#x27;BJD&#123;D0_Y0u_kNoW_Th1s_b4se_map&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="1-9-这是什么"><a href="#1-9-这是什么" class="headerlink" title="1.9 这是什么"></a>1.9 这是什么</h2><h3 id="1-9-1-题目"><a href="#1-9-1-题目" class="headerlink" title="1.9.1 题目"></a>1.9.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 题目描述</span></span><br><span class="line">小明是一个软件专业的高材生，但是老师布置的这次的作业似乎不怎么靠谱，因为他们老师以前是学物理的！喜欢乱七八糟命名文件，还喜欢奇奇怪怪的编码。你快帮小明看一下这题，小明准备好了一箱子辣条。</span><br><span class="line"></span><br><span class="line">[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]+(!![]+[])[+[]]+(![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[!+[]+!+[]+[+[]]]+([]+[])[(![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(!![]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]()[+!+[]+[!+[]+!+[]]]+(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(+![]+[![]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]])[!+[]+!+[]+[+[]]]+(+[![]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[!+[]+!+[]+[+!+[]]]+(![]+[])[+!+[]]+[+[]]+[!+[]+!+[]+!+[]+!+[]]+[!+[]+!+[]+!+[]+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+(![]+[])[+[]]+([][[]]+[])[!+[]+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+[!+[]+!+[]+!+[]]+[+[]]+(+(+!+[]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(+![]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(+![]+[![]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]])[!+[]+!+[]+[+[]]]](!+[]+!+[]+[+[]])+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+[!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+[+!+[]]+[!+[]+!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+[+[]]+[!+[]+!+[]]+[+[]]+[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+[!+[]+!+[]+!+[]+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]]+[!+[]+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+([][[]]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(![]+[])[+!+[]]+[!+[]+!+[]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+!+[]]]+([][[]]+[])[+[]]+([][[]]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[+!+[]]+(+(!+[]+!+[]+[+!+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(+![]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(+![]+[![]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]])[!+[]+!+[]+[+[]]]](!+[]+!+[]+!+[]+[+!+[]])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]])()([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[+!+[]]+(+(!+[]+!+[]+[+!+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(+![]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(+![]+[![]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]])[!+[]+!+[]+[+[]]]](!+[]+!+[]+!+[]+[+!+[]])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]])()(([]+[])[([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[+[]]+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]]()[+[]])[+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+([][[]]+[])[!+[]+!+[]])+([]+[])[(![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(!![]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]()[+!+[]+[!+[]+!+[]]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[!+[]+!+[]+[+[]]])()</span><br></pre></td></tr></table></figure>

<h3 id="1-9-2-解题思路"><a href="#1-9-2-解题思路" class="headerlink" title="1.9.2 解题思路"></a>1.9.2 解题思路</h3><p><strong>文件后缀伪造</strong>（docx → apk）</p>
<p><strong>JSfuck 前端混淆</strong></p>
<h3 id="1-9-3-解题脚本"><a href="#1-9-3-解题脚本" class="headerlink" title="1.9.3 解题脚本"></a>1.9.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> unjsfuck <span class="keyword">import</span> unjsfuck</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    ct = <span class="string">&#x27;[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]....&#x27;</span></span><br><span class="line">    pt = unjsfuck(ct)</span><br><span class="line">    <span class="built_in">print</span>(pt)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># [][&#x27;filter&#x27;][&#x27;constructor&#x27;](&#x27;alert(&quot;flag&#123;a0448fd730b62c13ca80200c4529daa2&#125;&quot;)&#x27;)()</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="1-10-BJDCTF2020-signin"><a href="#1-10-BJDCTF2020-signin" class="headerlink" title="1.10 [BJDCTF2020]signin"></a>1.10 [BJDCTF2020]signin</h2><h3 id="1-10-1-题目"><a href="#1-10-1-题目" class="headerlink" title="1.10.1 题目"></a>1.10.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">welcome to crypto world！！</span><br><span class="line">密文：424a447b57653163306d655f74345f424a444354467d</span><br></pre></td></tr></table></figure>

<h3 id="1-10-2-解题思路"><a href="#1-10-2-解题思路" class="headerlink" title="1.10.2 解题思路"></a>1.10.2 解题思路</h3><p><strong>hex 编码</strong></p>
<h3 id="1-10-3-解题脚本"><a href="#1-10-3-解题脚本" class="headerlink" title="1.10.3 解题脚本"></a>1.10.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(<span class="number">0x424a447b57653163306d655f74345f424a444354467d</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># b&#x27;BJD&#123;We1c0me_t4_BJDCTF&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="1-11-传感器"><a href="#1-11-传感器" class="headerlink" title="1.11 传感器"></a>1.11 传感器</h2><h3 id="1-11-1-题目"><a href="#1-11-1-题目" class="headerlink" title="1.11.1 题目"></a>1.11.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">5555555595555A65556AA696AA6666666955</span><br><span class="line">这是某压力传感器无线数据包解调后但未解码的报文(<span class="built_in">hex</span>)</span><br><span class="line">  </span><br><span class="line">已知其ID为<span class="number">0xFED31F</span>，请继续将报文完整解码，提交<span class="built_in">hex</span>。</span><br><span class="line"></span><br><span class="line">提示<span class="number">1</span>：曼联</span><br></pre></td></tr></table></figure>

<h3 id="1-11-2-解题思路"><a href="#1-11-2-解题思路" class="headerlink" title="1.11.2 解题思路"></a>1.11.2 解题思路</h3><p>802.3 曼彻斯特编码（逆序） + 进制转换</p>
<h3 id="1-11-3-解题脚本"><a href="#1-11-3-解题脚本" class="headerlink" title="1.11.3 解题脚本"></a>1.11.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">convert_base</span>(<span class="params">num_str: <span class="built_in">str</span>, from_base: <span class="built_in">int</span>, to_base: <span class="built_in">int</span>, zfill: <span class="built_in">int</span> = <span class="number">0</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    通用进制转换函数，支持填充位数</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> (<span class="number">2</span> &lt;= from_base &lt;= <span class="number">36</span> <span class="keyword">and</span> <span class="number">2</span> &lt;= to_base &lt;= <span class="number">36</span>):</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;进制必须在 2 到 36 之间&quot;</span>)</span><br><span class="line"></span><br><span class="line">    digits = <span class="string">&quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 将输入字符串转换为10进制整数</span></span><br><span class="line">    num_str = num_str.strip().upper()</span><br><span class="line">    num = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> num_str:</span><br><span class="line">        val = digits.find(char)</span><br><span class="line">        <span class="keyword">if</span> val == -<span class="number">1</span> <span class="keyword">or</span> val &gt;= from_base:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f&quot;非法字符 &#x27;<span class="subst">&#123;char&#125;</span>&#x27; 对于进制 <span class="subst">&#123;from_base&#125;</span>&quot;</span>)</span><br><span class="line">        num = num * from_base + val</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 特殊情况：输入为 0</span></span><br><span class="line">    <span class="keyword">if</span> num == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;0&quot;</span>.zfill(zfill)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 转换为目标进制</span></span><br><span class="line">    result = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">while</span> num &gt; <span class="number">0</span>:</span><br><span class="line">        result = digits[num % to_base] + result</span><br><span class="line">        num //= to_base</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result.zfill(zfill)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ManchesterDecoder</span>:</span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">byteinvert</span>(<span class="params">str_bin</span>):</span><br><span class="line">        <span class="comment"># 字节内位反转（8位为一组）</span></span><br><span class="line">        ret = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(str_bin) // <span class="number">8</span>):</span><br><span class="line">            ret += str_bin[i*<span class="number">8</span>:i*<span class="number">8</span>+<span class="number">8</span>][::-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ---------- 解码函数 ----------</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">MCST_stand_decode</span>(<span class="params">str_bin, isinvert=<span class="literal">False</span></span>):</span><br><span class="line">        <span class="comment"># 标准曼彻斯特解码（Standard Manchester Encoding）</span></span><br><span class="line">        <span class="comment"># 规则：0 -&gt; 01，1 -&gt; 10</span></span><br><span class="line">        ret = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(str_bin) // <span class="number">2</span>):</span><br><span class="line">            x = str_bin[i*<span class="number">2</span>:i*<span class="number">2</span>+<span class="number">2</span>]</span><br><span class="line">            <span class="keyword">if</span> x == <span class="string">&#x27;01&#x27;</span>:</span><br><span class="line">                ret += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">            <span class="keyword">elif</span> x == <span class="string">&#x27;10&#x27;</span>:</span><br><span class="line">                ret += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;标准曼彻斯特解码错误！&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> isinvert:</span><br><span class="line">            <span class="keyword">return</span> ManchesterDecoder.byteinvert(ret)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">MCST_IEEE_decode</span>(<span class="params">str_bin, isinvert=<span class="literal">False</span></span>):</span><br><span class="line">        <span class="comment"># IEEE 802.3 曼彻斯特解码（逻辑与标准相反）</span></span><br><span class="line">        <span class="comment"># 规则：0 -&gt; 10，1 -&gt; 01</span></span><br><span class="line">        ret = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(str_bin) // <span class="number">2</span>):</span><br><span class="line">            x = str_bin[i*<span class="number">2</span>:i*<span class="number">2</span>+<span class="number">2</span>]</span><br><span class="line">            <span class="keyword">if</span> x == <span class="string">&#x27;01&#x27;</span>:</span><br><span class="line">                ret += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">            <span class="keyword">elif</span> x == <span class="string">&#x27;10&#x27;</span>:</span><br><span class="line">                ret += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;IEEE曼彻斯特解码错误！&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> isinvert:</span><br><span class="line">            <span class="keyword">return</span> ManchesterDecoder.byteinvert(ret)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">MCST_diff_decode</span>(<span class="params">str_bin, isinvert=<span class="literal">False</span></span>):</span><br><span class="line">        <span class="comment"># 差分曼彻斯特编码（Differential Manchester Encoding）解码</span></span><br><span class="line">        <span class="comment"># 解码逻辑：两段编码相同表示0，不同表示1</span></span><br><span class="line">        ret = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(str_bin) // <span class="number">2</span> - <span class="number">1</span>):</span><br><span class="line">            x1 = str_bin[i*<span class="number">2</span>:i*<span class="number">2</span>+<span class="number">2</span>]</span><br><span class="line">            x2 = str_bin[i*<span class="number">2</span>+<span class="number">2</span>:i*<span class="number">2</span>+<span class="number">4</span>]</span><br><span class="line">            <span class="keyword">if</span> x1 == x2:</span><br><span class="line">                ret += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                ret += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> isinvert:</span><br><span class="line">            <span class="keyword">return</span> ManchesterDecoder.byteinvert(ret)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ---------- 编码函数 ----------</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">MCST_stand_encode</span>(<span class="params">bit_str, isinvert=<span class="literal">False</span></span>):</span><br><span class="line">        <span class="comment"># 标准曼彻斯特编码</span></span><br><span class="line">        <span class="comment"># 0 -&gt; 01，1 -&gt; 10</span></span><br><span class="line">        <span class="keyword">if</span> isinvert:</span><br><span class="line">            bit_str = ManchesterDecoder.byteinvert(bit_str)</span><br><span class="line">        ret = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> bit <span class="keyword">in</span> bit_str:</span><br><span class="line">            <span class="keyword">if</span> bit == <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">                ret += <span class="string">&#x27;01&#x27;</span></span><br><span class="line">            <span class="keyword">elif</span> bit == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">                ret += <span class="string">&#x27;10&#x27;</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">&#x27;输入必须是二进制字符串&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">MCST_IEEE_encode</span>(<span class="params">bit_str, isinvert=<span class="literal">False</span></span>):</span><br><span class="line">        <span class="comment"># IEEE 802.3 曼彻斯特编码</span></span><br><span class="line">        <span class="comment"># 0 -&gt; 10，1 -&gt; 01</span></span><br><span class="line">        <span class="keyword">if</span> isinvert:</span><br><span class="line">            bit_str = ManchesterDecoder.byteinvert(bit_str)</span><br><span class="line">        ret = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> bit <span class="keyword">in</span> bit_str:</span><br><span class="line">            <span class="keyword">if</span> bit == <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">                ret += <span class="string">&#x27;10&#x27;</span></span><br><span class="line">            <span class="keyword">elif</span> bit == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">                ret += <span class="string">&#x27;01&#x27;</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">&#x27;输入必须是二进制字符串&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">MCST_diff_encode</span>(<span class="params">bit_str, isinvert=<span class="literal">False</span></span>):</span><br><span class="line">        <span class="comment"># 差分曼彻斯特编码</span></span><br><span class="line">        <span class="comment"># 差分曼彻斯特编码以一个初始状态开始，0表示保持前半周期电平不变，1表示反转</span></span><br><span class="line">        <span class="comment"># 这里用&#x27;01&#x27;和&#x27;10&#x27;代表两种状态，初始状态为&#x27;01&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> isinvert:</span><br><span class="line">            bit_str = ManchesterDecoder.byteinvert(bit_str)</span><br><span class="line">        ret = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        prev = <span class="string">&#x27;0&#x27;</span>  <span class="comment"># 假设初始电平为0，对应编码&#x27;01&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> bit <span class="keyword">in</span> bit_str:</span><br><span class="line">            <span class="keyword">if</span> bit == <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">                <span class="comment"># 0表示信号电平保持不变，编码为与上一个一样</span></span><br><span class="line">                <span class="keyword">if</span> prev == <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">                    ret += <span class="string">&#x27;01&#x27;</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    ret += <span class="string">&#x27;10&#x27;</span></span><br><span class="line">            <span class="keyword">elif</span> bit == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">                <span class="comment"># 1表示电平反转，编码为与上一个相反</span></span><br><span class="line">                <span class="keyword">if</span> prev == <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">                    ret += <span class="string">&#x27;10&#x27;</span></span><br><span class="line">                    prev = <span class="string">&#x27;1&#x27;</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    ret += <span class="string">&#x27;01&#x27;</span></span><br><span class="line">                    prev = <span class="string">&#x27;0&#x27;</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">&#x27;输入必须是二进制字符串&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    ct = <span class="string">&quot;5555555595555A65556AA696AA6666666955&quot;</span></span><br><span class="line">    ct = convert_base(ct, <span class="number">16</span>, <span class="number">2</span>, <span class="built_in">len</span>(ct)*<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">    result = ManchesterDecoder.MCST_IEEE_decode(ct, <span class="literal">True</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;flag&#123;&#123;<span class="subst">&#123;convert_base(result, <span class="number">2</span>, <span class="number">16</span>)&#125;</span>&#125;&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># flag&#123;FFFFFED31F645055F9&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="1-12-yxx"><a href="#1-12-yxx" class="headerlink" title="1.12 yxx"></a>1.12 yxx</h2><h3 id="1-12-1-题目"><a href="#1-12-1-题目" class="headerlink" title="1.12.1 题目"></a>1.12.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 明文.txt</span></span><br><span class="line">lovelovelovelovelovelovelovelove</span><br><span class="line"></span><br><span class="line"><span class="comment"># 密文.txt</span></span><br><span class="line">0A 03 <span class="number">17</span> 02 <span class="number">56</span> 01 <span class="number">15</span> <span class="number">11</span> 0A <span class="number">14</span> 0E 0A 1E <span class="number">30</span> 0E 0A</span><br><span class="line">1E <span class="number">30</span> 0E 0A 1E <span class="number">30</span> <span class="number">14</span> 0C <span class="number">19</span> 0D 1F <span class="number">10</span> 0E 06 03 <span class="number">18</span></span><br></pre></td></tr></table></figure>

<h3 id="1-12-2-解题思路"><a href="#1-12-2-解题思路" class="headerlink" title="1.12.2 解题思路"></a>1.12.2 解题思路</h3><p><strong>异或</strong></p>
<h3 id="1-12-3-解题脚本"><a href="#1-12-3-解题脚本" class="headerlink" title="1.12.3 解题脚本"></a>1.12.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    pt = <span class="string">b&#x27;lovelovelovelovelovelovelovelove&#x27;</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;yxx/密文.txt&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        ct = f.read()</span><br><span class="line"></span><br><span class="line">    result = <span class="built_in">bytes</span>([c ^ pt[i % <span class="built_in">len</span>(pt)] <span class="keyword">for</span> i, c <span class="keyword">in</span> <span class="built_in">enumerate</span>(ct)])</span><br><span class="line">    <span class="built_in">print</span>(result.decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># flag:nctf&#123;xor_xor_xor_biubiubiu&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="1-13-WUSTCTF2020-B-se"><a href="#1-13-WUSTCTF2020-B-se" class="headerlink" title="1.13 [WUSTCTF2020]B@se"></a>1.13 [WUSTCTF2020]B@se</h2><h3 id="1-13-1-题目"><a href="#1-13-1-题目" class="headerlink" title="1.13.1 题目"></a>1.13.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">瀵嗘枃锛歁yLkTaP3FaA7KOWjTmKkVjWjVzKjdeNvTnAjoH9iZOIvTeHbvD==</span><br><span class="line">JASGBWcQPRXEFLbCDIlmnHUVKTYZdMovwipatNOefghq56rs****kxyz012789+/</span><br><span class="line"></span><br><span class="line">oh holy shit, something <span class="keyword">is</span> missing...</span><br></pre></td></tr></table></figure>

<h3 id="1-13-2-解题思路"><a href="#1-13-2-解题思路" class="headerlink" title="1.13.2 解题思路"></a>1.13.2 解题思路</h3><p>爆破码表 + 自定义码表 Base64</p>
<h3 id="1-13-3-解题脚本"><a href="#1-13-3-解题脚本" class="headerlink" title="1.13.3 解题脚本"></a>1.13.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Optional</span></span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> permutations</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BaseXEncoder</span>:</span><br><span class="line">    <span class="comment"># 常见进制的编码表</span></span><br><span class="line">    STANDARD_TABLES = &#123;</span><br><span class="line">        <span class="number">16</span>: <span class="string">b&quot;0123456789ABCDEF&quot;</span>,</span><br><span class="line">        <span class="number">32</span>: <span class="string">b&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ234567&quot;</span>,</span><br><span class="line">        <span class="number">58</span>: <span class="string">b&quot;123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz&quot;</span>,</span><br><span class="line">        <span class="number">62</span>: <span class="string">b&quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&quot;</span>,</span><br><span class="line">        <span class="number">64</span>: <span class="string">b&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span>,</span><br><span class="line">        <span class="number">91</span>: <span class="string">b&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!#$%&amp;()*+,./:;&lt;=&gt;?@[]^_`&#123;|&#125;~\&quot;&quot;</span>,</span><br><span class="line">        <span class="number">92</span>: <span class="string">b&quot;!\&quot;#$%&amp;&#x27;()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz&#123;|&#125;~&quot;</span>,</span><br><span class="line">        <span class="number">128</span>: <span class="built_in">bytes</span>(<span class="built_in">range</span>(<span class="number">128</span>)),  <span class="comment"># 每个字节本身</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encode</span>(<span class="params">self, data: <span class="built_in">bytes</span>, base: <span class="built_in">int</span>, table: <span class="type">Optional</span>[<span class="built_in">bytes</span>] = <span class="literal">None</span>, padding: <span class="type">Optional</span>[<span class="built_in">bytes</span>] = <span class="string">b&quot;=&quot;</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        编码函数：支持 base16, base32, base64, base58, base62, base91, base92, base128</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        table = table <span class="keyword">or</span> <span class="variable language_">self</span>.STANDARD_TABLES.get(base)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 标准 base 编码（内置支持填充）</span></span><br><span class="line">        <span class="keyword">if</span> base == <span class="number">16</span>:</span><br><span class="line">            encoded = base64.b16encode(data).translate(<span class="built_in">bytes</span>.maketrans(<span class="string">b&quot;0123456789ABCDEF&quot;</span>, table))</span><br><span class="line">        <span class="keyword">elif</span> base == <span class="number">32</span>:</span><br><span class="line">            encoded = base64.b32encode(data).translate(<span class="built_in">bytes</span>.maketrans(<span class="variable language_">self</span>.STANDARD_TABLES[<span class="number">32</span>], table))</span><br><span class="line">        <span class="keyword">elif</span> base == <span class="number">64</span>:</span><br><span class="line">            encoded = base64.b64encode(data).translate(<span class="built_in">bytes</span>.maketrans(<span class="variable language_">self</span>.STANDARD_TABLES[<span class="number">64</span>], table))</span><br><span class="line">        <span class="keyword">elif</span> base <span class="keyword">in</span> (<span class="number">58</span>, <span class="number">62</span>, <span class="number">91</span>, <span class="number">92</span>, <span class="number">128</span>):  <span class="comment"># 自定义 baseX 编码</span></span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">self</span>._baseX_encode(data, table).decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f&quot;Unsupported base: <span class="subst">&#123;base&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 处理填充字符</span></span><br><span class="line">        <span class="keyword">if</span> padding <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            encoded = encoded.rstrip(<span class="string">b&quot;=&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> padding != <span class="string">b&quot;=&quot;</span>:</span><br><span class="line">            encoded = encoded.rstrip(<span class="string">b&quot;=&quot;</span>).replace(<span class="string">b&quot;=&quot;</span>, padding)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> encoded.decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decode</span>(<span class="params">self, ciphertext: <span class="built_in">str</span>, base: <span class="built_in">int</span>, table: <span class="type">Optional</span>[<span class="built_in">bytes</span>] = <span class="literal">None</span>, padding: <span class="type">Optional</span>[<span class="built_in">bytes</span>] = <span class="string">b&quot;=&quot;</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        解码函数：对应 encode 函数的逆过程</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        encoded = ciphertext.encode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">        table = table <span class="keyword">or</span> <span class="variable language_">self</span>.STANDARD_TABLES.get(base)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> base <span class="keyword">in</span> (<span class="number">58</span>, <span class="number">62</span>, <span class="number">91</span>, <span class="number">92</span>, <span class="number">128</span>):</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">self</span>._baseX_decode(encoded, table)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 恢复 padding</span></span><br><span class="line">        <span class="keyword">if</span> padding <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> padding != <span class="string">b&quot;=&quot;</span>:</span><br><span class="line">            encoded = encoded.replace(padding, <span class="string">b&quot;=&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 计算并自动补足 base32/base64 所需的 padding 长度</span></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">pad_base</span>(<span class="params">data: <span class="built_in">bytes</span>, block_size: <span class="built_in">int</span> = <span class="number">8</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">            pad_len = (-<span class="built_in">len</span>(data)) % block_size</span><br><span class="line">            <span class="keyword">return</span> data + <span class="string">b&#x27;=&#x27;</span> * pad_len</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> base == <span class="number">16</span>:</span><br><span class="line">            <span class="keyword">return</span> base64.b16decode(encoded.translate(<span class="built_in">bytes</span>.maketrans(table, <span class="string">b&quot;0123456789ABCDEF&quot;</span>)))</span><br><span class="line">        <span class="keyword">elif</span> base == <span class="number">32</span>:</span><br><span class="line">            padded = pad_base(encoded)  <span class="comment"># base32 长度必须为 8 的倍数</span></span><br><span class="line">            <span class="keyword">return</span> base64.b32decode(padded.translate(<span class="built_in">bytes</span>.maketrans(table, <span class="variable language_">self</span>.STANDARD_TABLES[<span class="number">32</span>])))</span><br><span class="line">        <span class="keyword">elif</span> base == <span class="number">64</span>:</span><br><span class="line">            padded = pad_base(encoded, block_size=<span class="number">4</span>)  <span class="comment"># base64 长度必须为 4 的倍数</span></span><br><span class="line">            <span class="keyword">return</span> base64.b64decode(padded.translate(<span class="built_in">bytes</span>.maketrans(table, <span class="variable language_">self</span>.STANDARD_TABLES[<span class="number">64</span>])))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f&quot;Unsupported base: <span class="subst">&#123;base&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_baseX_encode</span>(<span class="params">self, data: <span class="built_in">bytes</span>, table: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        自定义 baseX 编码（如 base58/base62）：将字节数据按目标进制编码为字符表中的字符序列</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        num = <span class="built_in">int</span>.from_bytes(data, byteorder=<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">        base = <span class="built_in">len</span>(table)</span><br><span class="line">        encoded = <span class="built_in">bytearray</span>()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> num &gt; <span class="number">0</span>:</span><br><span class="line">            num, rem = <span class="built_in">divmod</span>(num, base)</span><br><span class="line">            encoded.insert(<span class="number">0</span>, table[rem])</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 前导 0 用 table[0] 表示</span></span><br><span class="line">        pad = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> data:</span><br><span class="line">            <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">                pad += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">bytes</span>([table[<span class="number">0</span>]]) * pad + <span class="built_in">bytes</span>(encoded)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_baseX_decode</span>(<span class="params">self, encoded: <span class="built_in">bytes</span>, table: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        自定义 baseX 解码：将字符序列转换回原始字节数据</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        base = <span class="built_in">len</span>(table)</span><br><span class="line">        index = &#123;char: i <span class="keyword">for</span> i, char <span class="keyword">in</span> <span class="built_in">enumerate</span>(table)&#125;</span><br><span class="line">        num = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> char <span class="keyword">in</span> encoded:</span><br><span class="line">            num = num * base + index[char]</span><br><span class="line"></span><br><span class="line">        decoded = num.to_bytes((num.bit_length() + <span class="number">7</span>) // <span class="number">8</span>, byteorder=<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 处理前导 0</span></span><br><span class="line">        pad = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> encoded:</span><br><span class="line">            <span class="keyword">if</span> c == table[<span class="number">0</span>]:</span><br><span class="line">                pad += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">b&#x27;\x00&#x27;</span> * pad + decoded</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    encoder = BaseXEncoder()</span><br><span class="line">    STANDARD_ALPHABET = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line">    custom_alphabet = <span class="string">&quot;JASGBWcQPRXEFLbCDIlmnHUVKTYZdMovwipatNOefghq56rs****kxyz012789+/&quot;</span></span><br><span class="line">    diff_lst = [c <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">set</span>(STANDARD_ALPHABET) - <span class="built_in">set</span>(custom_alphabet)]</span><br><span class="line">    combos = permutations(diff_lst, <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 爆破 ****</span></span><br><span class="line">    <span class="keyword">for</span> combo <span class="keyword">in</span> combos:</span><br><span class="line">        table = custom_alphabet.replace(<span class="string">&#x27;****&#x27;</span>, <span class="string">&#x27;&#x27;</span>.join(combo))</span><br><span class="line">        ct = <span class="string">&#x27;MyLkTaP3FaA7KOWjTmKkVjWjVzKjdeNvTnAjoH9iZOIvTeHbvD==&#x27;</span></span><br><span class="line">        flag = BaseXEncoder().decode(ct, <span class="number">64</span>, table.encode())</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&#x27;wctf2020&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># wctf2020&#123;base64_1s_v3ry_e@sy_and_fuN&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="1-14-AFCTF2018-BASE"><a href="#1-14-AFCTF2018-BASE" class="headerlink" title="1.14 [AFCTF2018]BASE"></a>1.14 [AFCTF2018]BASE</h2><h3 id="1-14-1-题目"><a href="#1-14-1-题目" class="headerlink" title="1.14.1 题目"></a>1.14.1 题目</h3><p>附件： <a href="https://dstbp.com/data/attachments/posts/buuctf/AFCTF2018BASEAttachment.zip">attachment.zip</a> </p>
<h3 id="1-14-2-解题思路"><a href="#1-14-2-解题思路" class="headerlink" title="1.14.2 解题思路"></a>1.14.2 解题思路</h3><p>十六进制 + base64 + base32 + base16</p>
<h3 id="1-14-3-解题脚本"><a href="#1-14-3-解题脚本" class="headerlink" title="1.14.3 解题脚本"></a>1.14.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Optional</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BaseXEncoder</span>:</span><br><span class="line">    <span class="comment"># 常见进制的编码表</span></span><br><span class="line">    STANDARD_TABLES = &#123;</span><br><span class="line">        <span class="number">16</span>: <span class="string">b&quot;0123456789ABCDEF&quot;</span>,</span><br><span class="line">        <span class="number">32</span>: <span class="string">b&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ234567&quot;</span>,</span><br><span class="line">        <span class="number">58</span>: <span class="string">b&quot;123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz&quot;</span>,</span><br><span class="line">        <span class="number">62</span>: <span class="string">b&quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&quot;</span>,</span><br><span class="line">        <span class="number">64</span>: <span class="string">b&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span>,</span><br><span class="line">        <span class="number">91</span>: <span class="string">b&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!#$%&amp;()*+,./:;&lt;=&gt;?@[]^_`&#123;|&#125;~\&quot;&quot;</span>,</span><br><span class="line">        <span class="number">92</span>: <span class="string">b&quot;!\&quot;#$%&amp;&#x27;()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz&#123;|&#125;~&quot;</span>,</span><br><span class="line">        <span class="number">128</span>: <span class="built_in">bytes</span>(<span class="built_in">range</span>(<span class="number">128</span>)),  <span class="comment"># 每个字节本身</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encode</span>(<span class="params">self, data: <span class="built_in">bytes</span>, base: <span class="built_in">int</span>, table: <span class="type">Optional</span>[<span class="built_in">bytes</span>] = <span class="literal">None</span>, padding: <span class="type">Optional</span>[<span class="built_in">bytes</span>] = <span class="string">b&quot;=&quot;</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        编码函数：支持 base16, base32, base64, base58, base62, base91, base92, base128</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        table = table <span class="keyword">or</span> <span class="variable language_">self</span>.STANDARD_TABLES.get(base)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 标准 base 编码（内置支持填充）</span></span><br><span class="line">        <span class="keyword">if</span> base == <span class="number">16</span>:</span><br><span class="line">            encoded = base64.b16encode(data).translate(<span class="built_in">bytes</span>.maketrans(<span class="string">b&quot;0123456789ABCDEF&quot;</span>, table))</span><br><span class="line">        <span class="keyword">elif</span> base == <span class="number">32</span>:</span><br><span class="line">            encoded = base64.b32encode(data).translate(<span class="built_in">bytes</span>.maketrans(<span class="variable language_">self</span>.STANDARD_TABLES[<span class="number">32</span>], table))</span><br><span class="line">        <span class="keyword">elif</span> base == <span class="number">64</span>:</span><br><span class="line">            encoded = base64.b64encode(data).translate(<span class="built_in">bytes</span>.maketrans(<span class="variable language_">self</span>.STANDARD_TABLES[<span class="number">64</span>], table))</span><br><span class="line">        <span class="keyword">elif</span> base <span class="keyword">in</span> (<span class="number">58</span>, <span class="number">62</span>, <span class="number">91</span>, <span class="number">92</span>, <span class="number">128</span>):  <span class="comment"># 自定义 baseX 编码</span></span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">self</span>._baseX_encode(data, table).decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f&quot;Unsupported base: <span class="subst">&#123;base&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 处理填充字符</span></span><br><span class="line">        <span class="keyword">if</span> padding <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            encoded = encoded.rstrip(<span class="string">b&quot;=&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> padding != <span class="string">b&quot;=&quot;</span>:</span><br><span class="line">            encoded = encoded.rstrip(<span class="string">b&quot;=&quot;</span>).replace(<span class="string">b&quot;=&quot;</span>, padding)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> encoded.decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decode</span>(<span class="params">self, ciphertext: <span class="built_in">str</span>, base: <span class="built_in">int</span>, table: <span class="type">Optional</span>[<span class="built_in">bytes</span>] = <span class="literal">None</span>, padding: <span class="type">Optional</span>[<span class="built_in">bytes</span>] = <span class="string">b&quot;=&quot;</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        解码函数：对应 encode 函数的逆过程</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        encoded = ciphertext.encode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">        table = table <span class="keyword">or</span> <span class="variable language_">self</span>.STANDARD_TABLES.get(base)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> base <span class="keyword">in</span> (<span class="number">58</span>, <span class="number">62</span>, <span class="number">91</span>, <span class="number">92</span>, <span class="number">128</span>):</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">self</span>._baseX_decode(encoded, table)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 恢复 padding</span></span><br><span class="line">        <span class="keyword">if</span> padding <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> padding != <span class="string">b&quot;=&quot;</span>:</span><br><span class="line">            encoded = encoded.replace(padding, <span class="string">b&quot;=&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 计算并自动补足 base32/base64 所需的 padding 长度</span></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">pad_base</span>(<span class="params">data: <span class="built_in">bytes</span>, block_size: <span class="built_in">int</span> = <span class="number">8</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">            pad_len = (-<span class="built_in">len</span>(data)) % block_size</span><br><span class="line">            <span class="keyword">return</span> data + <span class="string">b&#x27;=&#x27;</span> * pad_len</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> base == <span class="number">16</span>:</span><br><span class="line">            <span class="keyword">return</span> base64.b16decode(encoded.translate(<span class="built_in">bytes</span>.maketrans(table, <span class="string">b&quot;0123456789ABCDEF&quot;</span>)))</span><br><span class="line">        <span class="keyword">elif</span> base == <span class="number">32</span>:</span><br><span class="line">            padded = pad_base(encoded)  <span class="comment"># base32 长度必须为 8 的倍数</span></span><br><span class="line">            <span class="keyword">return</span> base64.b32decode(padded.translate(<span class="built_in">bytes</span>.maketrans(table, <span class="variable language_">self</span>.STANDARD_TABLES[<span class="number">32</span>])))</span><br><span class="line">        <span class="keyword">elif</span> base == <span class="number">64</span>:</span><br><span class="line">            padded = pad_base(encoded, block_size=<span class="number">4</span>)  <span class="comment"># base64 长度必须为 4 的倍数</span></span><br><span class="line">            <span class="keyword">return</span> base64.b64decode(padded.translate(<span class="built_in">bytes</span>.maketrans(table, <span class="variable language_">self</span>.STANDARD_TABLES[<span class="number">64</span>])))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f&quot;Unsupported base: <span class="subst">&#123;base&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_baseX_encode</span>(<span class="params">self, data: <span class="built_in">bytes</span>, table: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        自定义 baseX 编码（如 base58/base62）：将字节数据按目标进制编码为字符表中的字符序列</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        num = <span class="built_in">int</span>.from_bytes(data, byteorder=<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">        base = <span class="built_in">len</span>(table)</span><br><span class="line">        encoded = <span class="built_in">bytearray</span>()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> num &gt; <span class="number">0</span>:</span><br><span class="line">            num, rem = <span class="built_in">divmod</span>(num, base)</span><br><span class="line">            encoded.insert(<span class="number">0</span>, table[rem])</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 前导 0 用 table[0] 表示</span></span><br><span class="line">        pad = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> data:</span><br><span class="line">            <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">                pad += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">bytes</span>([table[<span class="number">0</span>]]) * pad + <span class="built_in">bytes</span>(encoded)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_baseX_decode</span>(<span class="params">self, encoded: <span class="built_in">bytes</span>, table: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        自定义 baseX 解码：将字符序列转换回原始字节数据</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        base = <span class="built_in">len</span>(table)</span><br><span class="line">        index = &#123;char: i <span class="keyword">for</span> i, char <span class="keyword">in</span> <span class="built_in">enumerate</span>(table)&#125;</span><br><span class="line">        num = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> char <span class="keyword">in</span> encoded:</span><br><span class="line">            num = num * base + index[char]</span><br><span class="line"></span><br><span class="line">        decoded = num.to_bytes((num.bit_length() + <span class="number">7</span>) // <span class="number">8</span>, byteorder=<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 处理前导 0</span></span><br><span class="line">        pad = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> encoded:</span><br><span class="line">            <span class="keyword">if</span> c == table[<span class="number">0</span>]:</span><br><span class="line">                pad += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">b&#x27;\x00&#x27;</span> * pad + decoded</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    encoder = BaseXEncoder()</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;flag_encode.txt&quot;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        ct = f.read()</span><br><span class="line">    ct = <span class="built_in">bytes</span>.fromhex(ct).decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            ct = encoder.decode(ct, <span class="number">64</span>).decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                ct = encoder.decode(ct, <span class="number">32</span>).decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">            <span class="keyword">except</span> Exception:</span><br><span class="line">                ct = encoder.decode(ct, <span class="number">16</span>).decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;afctf&#x27;</span> <span class="keyword">in</span> ct:</span><br><span class="line">            <span class="built_in">print</span>(ct)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># afctf&#123;U_5h0u1d_Us3_T00l5&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="1-15-鸡藕椒盐味"><a href="#1-15-鸡藕椒盐味" class="headerlink" title="1.15 鸡藕椒盐味"></a>1.15 鸡藕椒盐味</h2><h3 id="1-15-1-题目"><a href="#1-15-1-题目" class="headerlink" title="1.15.1 题目"></a>1.15.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">公司食堂最新出了一种小吃，叫鸡藕椒盐味汉堡，售价八块钱，为了促销，上面有一个验证码，输入后可以再换取一个汉堡。但是问题是每个验证码几乎都有错误,而且打印的时候倒了一下。小明买到了一个汉堡，准备还原验证码，因为一个吃不饱啊验证码如下：<span class="number">1100</span> <span class="number">1010</span> <span class="number">0000</span> ,而且打印的时候倒了一下。把答案哈希一下就可以提交了。(答案为正确值(不包括数字之间的空格)的<span class="number">32</span>位md5值的小写形式) </span><br></pre></td></tr></table></figure>

<h3 id="1-15-2-解题思路"><a href="#1-15-2-解题思路" class="headerlink" title="1.15.2 解题思路"></a>1.15.2 解题思路</h3><p><strong>海明校验码</strong>：每个汉堡 8 块表示数据位为 8 bits，校验位为 4 bits，并且校验位在 $ 2^n $ 的位置。</p>
<h3 id="1-15-3-解题脚本"><a href="#1-15-3-解题脚本" class="headerlink" title="1.15.3 解题脚本"></a>1.15.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Union</span></span><br><span class="line"><span class="keyword">from</span> gmssl <span class="keyword">import</span> sm3</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">HammingCode</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;海明码校验&quot;&quot;&quot;</span></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_calculate_parity_bits</span>(<span class="params">m</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;计算所需的校验位数量&quot;&quot;&quot;</span></span><br><span class="line">        r = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> <span class="number">2</span>**r &lt; m + r + <span class="number">1</span>:</span><br><span class="line">            r += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> r</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_is_power_of_two</span>(<span class="params">n</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;判断是否为2的幂&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> n != <span class="number">0</span> <span class="keyword">and</span> (n &amp; (n - <span class="number">1</span>)) == <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encode</span>(<span class="params">self, data_bits</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;生成海明校验码&quot;&quot;&quot;</span></span><br><span class="line">        data = [<span class="built_in">int</span>(bit) <span class="keyword">for</span> bit <span class="keyword">in</span> <span class="built_in">str</span>(data_bits)]</span><br><span class="line">        m = <span class="built_in">len</span>(data)</span><br><span class="line">        r = <span class="variable language_">self</span>._calculate_parity_bits(m)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 初始化海明码，预留校验位位置</span></span><br><span class="line">        hamming = [<span class="number">0</span>] * (m + r)</span><br><span class="line">        data_idx = <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 填充数据位</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, m + r + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> <span class="variable language_">self</span>._is_power_of_two(i):</span><br><span class="line">                hamming[i-<span class="number">1</span>] = data[data_idx]</span><br><span class="line">                data_idx += <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 计算校验位</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(r):</span><br><span class="line">            pos = <span class="number">2</span>**i</span><br><span class="line">            parity = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, m + r + <span class="number">1</span>):</span><br><span class="line">                <span class="keyword">if</span> j &amp; pos:</span><br><span class="line">                    parity ^= hamming[j-<span class="number">1</span>]</span><br><span class="line">            hamming[pos-<span class="number">1</span>] = parity</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, hamming))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">verify</span>(<span class="params">self, hamming_code</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;验证/纠错海明码&quot;&quot;&quot;</span></span><br><span class="line">        received = [<span class="built_in">int</span>(bit) <span class="keyword">for</span> bit <span class="keyword">in</span> <span class="built_in">str</span>(hamming_code)]</span><br><span class="line">        n = <span class="built_in">len</span>(received)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 计算校验位数</span></span><br><span class="line">        r = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> <span class="number">2</span>**r &lt; n:</span><br><span class="line">            r += <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 计算错误位置</span></span><br><span class="line">        error_pos = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(r):</span><br><span class="line">            pos = <span class="number">2</span>**i</span><br><span class="line">            parity = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n + <span class="number">1</span>):</span><br><span class="line">                <span class="keyword">if</span> j &amp; pos:</span><br><span class="line">                    parity ^= received[j-<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">if</span> parity != <span class="number">0</span>:</span><br><span class="line">                error_pos += pos</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 纠正错误</span></span><br><span class="line">        corrected = received.copy()</span><br><span class="line">        <span class="keyword">if</span> error_pos != <span class="number">0</span> <span class="keyword">and</span> error_pos &lt;= <span class="built_in">len</span>(corrected):</span><br><span class="line">            corrected[error_pos - <span class="number">1</span>] ^= <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 提取原始数据</span></span><br><span class="line">        original_data = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> <span class="variable language_">self</span>._is_power_of_two(i):</span><br><span class="line">                original_data.append(<span class="built_in">str</span>(corrected[i-<span class="number">1</span>]))</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="string">&#x27;corrected_code&#x27;</span>: <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, corrected)),</span><br><span class="line">            <span class="string">&#x27;error_position&#x27;</span>: error_pos,</span><br><span class="line">            <span class="string">&#x27;original_data&#x27;</span>: <span class="string">&#x27;&#x27;</span>.join(original_data)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hash_data</span>(<span class="params">data: <span class="type">Union</span>[<span class="built_in">bytes</span>, <span class="built_in">str</span>], algorithm: <span class="built_in">str</span>, output_type: <span class="built_in">str</span> = <span class="string">&quot;hex&quot;</span>, hash_length: <span class="built_in">int</span> = <span class="literal">None</span>, hex_case: <span class="built_in">str</span> = <span class="string">&quot;lower&quot;</span></span>) -&gt; <span class="built_in">tuple</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    计算数据的哈希值，支持多种算法和输出类型</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 统一转换为字节类型（兼容字符串输入）</span></span><br><span class="line">    data_bytes = data.encode(<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">if</span> <span class="built_in">isinstance</span>(data, <span class="built_in">str</span>) <span class="keyword">else</span> data</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 计算哈希值及长度</span></span><br><span class="line">    <span class="keyword">match</span> algorithm.lower():</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;sha256&quot;</span> | <span class="string">&quot;md5&quot;</span> | <span class="string">&quot;sha1&quot;</span>:</span><br><span class="line">            hasher = hashlib.new(algorithm, data_bytes)</span><br><span class="line">            digest = hasher.digest()</span><br><span class="line">            original_length = hasher.digest_size</span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;sm3&quot;</span>:</span><br><span class="line">            hex_digest = sm3.sm3_hash(<span class="built_in">list</span>(data_bytes))  <span class="comment"># gmssl返回十六进制字符串</span></span><br><span class="line">            digest = <span class="built_in">bytes</span>.fromhex(hex_digest)           <span class="comment"># 转换为字节</span></span><br><span class="line">            original_length = <span class="number">32</span>                         <span class="comment"># SM3固定32字节</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> _:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f&quot;不支持的算法: <span class="subst">&#123;algorithm&#125;</span>（支持：sha256/md5/sha1/sm3）&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 长度控制</span></span><br><span class="line">    <span class="keyword">if</span> hash_length <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(hash_length, <span class="built_in">int</span>) <span class="keyword">or</span> hash_length &lt;= <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;hash_length必须是正整数&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> hash_length &gt; original_length:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f&quot;长度超出限制（最大<span class="subst">&#123;original_length&#125;</span>字节）&quot;</span>)</span><br><span class="line">        digest = digest[:hash_length]  <span class="comment"># 截断字节串</span></span><br><span class="line">        actual_length = hash_length</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        actual_length = original_length  <span class="comment"># 不截断时使用原始长度</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 转换输出类型</span></span><br><span class="line">    <span class="keyword">match</span> output_type.lower():</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;bytes&quot;</span>:</span><br><span class="line">            result = digest</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;hex&quot;</span>:</span><br><span class="line">            hex_str = digest.<span class="built_in">hex</span>()</span><br><span class="line">            <span class="comment"># 十六进制大小写转换</span></span><br><span class="line">            result = hex_str.upper() <span class="keyword">if</span> hex_case.lower() == <span class="string">&quot;upper&quot;</span> <span class="keyword">else</span> hex_str.lower()</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;int&quot;</span>:</span><br><span class="line">            result = <span class="built_in">int</span>.from_bytes(digest, byteorder=<span class="string">&quot;big&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> _:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f&quot;不支持的输出类型: <span class="subst">&#123;output_type&#125;</span>（支持：bytes/hex/int）&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result, actual_length</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    ct = <span class="string">&#x27;110010100000&#x27;</span>[::-<span class="number">1</span>]</span><br><span class="line">    hamming = HammingCode()</span><br><span class="line">    res = hamming.verify(ct)[<span class="string">&#x27;corrected_code&#x27;</span>][::-<span class="number">1</span>]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;flag&#123;&#123;<span class="subst">&#123;hash_data(res, <span class="string">&#x27;md5&#x27;</span>)[<span class="number">0</span>]&#125;</span>&#125;&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># flag&#123;d14084c7ceca6359eaac6df3c234dd3b&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="1-16-BJDCTF2020-编码与调制"><a href="#1-16-BJDCTF2020-编码与调制" class="headerlink" title="1.16 [BJDCTF2020]编码与调制"></a>1.16 [BJDCTF2020]编码与调制</h2><h3 id="1-16-1-题目"><a href="#1-16-1-题目" class="headerlink" title="1.16.1 题目"></a>1.16.1 题目</h3><center><img src=https://dstbp.com/data/imgs/posts/buuctf/BJDCTF2020编码与调制.png width="600"></center>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">密文：2559659965656A9A65656996696965A6695669A9695A699569666A5A6A6569666A59695A69AA696569666AA6</span><br></pre></td></tr></table></figure>

<h3 id="1-16-2-解题思路"><a href="#1-16-2-解题思路" class="headerlink" title="1.16.2 解题思路"></a>1.16.2 解题思路</h3><p>标准曼彻斯特编码 + 进制转换</p>
<h3 id="1-16-3-解题脚本"><a href="#1-16-3-解题脚本" class="headerlink" title="1.16.3 解题脚本"></a>1.16.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">convert_base</span>(<span class="params">num_str: <span class="built_in">str</span>, from_base: <span class="built_in">int</span>, to_base: <span class="built_in">int</span>, zfill: <span class="built_in">int</span> = <span class="number">0</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    通用进制转换函数，支持填充位数</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> (<span class="number">2</span> &lt;= from_base &lt;= <span class="number">36</span> <span class="keyword">and</span> <span class="number">2</span> &lt;= to_base &lt;= <span class="number">36</span>):</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;进制必须在 2 到 36 之间&quot;</span>)</span><br><span class="line"></span><br><span class="line">    digits = <span class="string">&quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 将输入字符串转换为10进制整数</span></span><br><span class="line">    num_str = num_str.strip().upper()</span><br><span class="line">    num = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> num_str:</span><br><span class="line">        val = digits.find(char)</span><br><span class="line">        <span class="keyword">if</span> val == -<span class="number">1</span> <span class="keyword">or</span> val &gt;= from_base:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f&quot;非法字符 &#x27;<span class="subst">&#123;char&#125;</span>&#x27; 对于进制 <span class="subst">&#123;from_base&#125;</span>&quot;</span>)</span><br><span class="line">        num = num * from_base + val</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 特殊情况：输入为 0</span></span><br><span class="line">    <span class="keyword">if</span> num == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;0&quot;</span>.zfill(zfill)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 转换为目标进制</span></span><br><span class="line">    result = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">while</span> num &gt; <span class="number">0</span>:</span><br><span class="line">        result = digits[num % to_base] + result</span><br><span class="line">        num //= to_base</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result.zfill(zfill)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ManchesterDecoder</span>:</span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">byteinvert</span>(<span class="params">str_bin</span>):</span><br><span class="line">        <span class="comment"># 字节内位反转（8位为一组）</span></span><br><span class="line">        ret = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(str_bin) // <span class="number">8</span>):</span><br><span class="line">            ret += str_bin[i*<span class="number">8</span>:i*<span class="number">8</span>+<span class="number">8</span>][::-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ---------- 解码函数 ----------</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">MCST_stand_decode</span>(<span class="params">str_bin, isinvert=<span class="literal">False</span></span>):</span><br><span class="line">        <span class="comment"># 标准曼彻斯特解码（Standard Manchester Encoding）</span></span><br><span class="line">        <span class="comment"># 规则：0 -&gt; 01，1 -&gt; 10</span></span><br><span class="line">        ret = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(str_bin) // <span class="number">2</span>):</span><br><span class="line">            x = str_bin[i*<span class="number">2</span>:i*<span class="number">2</span>+<span class="number">2</span>]</span><br><span class="line">            <span class="keyword">if</span> x == <span class="string">&#x27;01&#x27;</span>:</span><br><span class="line">                ret += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">            <span class="keyword">elif</span> x == <span class="string">&#x27;10&#x27;</span>:</span><br><span class="line">                ret += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;标准曼彻斯特解码错误！&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> isinvert:</span><br><span class="line">            <span class="keyword">return</span> ManchesterDecoder.byteinvert(ret)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">MCST_IEEE_decode</span>(<span class="params">str_bin, isinvert=<span class="literal">False</span></span>):</span><br><span class="line">        <span class="comment"># IEEE 802.3 曼彻斯特解码（逻辑与标准相反）</span></span><br><span class="line">        <span class="comment"># 规则：0 -&gt; 10，1 -&gt; 01</span></span><br><span class="line">        ret = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(str_bin) // <span class="number">2</span>):</span><br><span class="line">            x = str_bin[i*<span class="number">2</span>:i*<span class="number">2</span>+<span class="number">2</span>]</span><br><span class="line">            <span class="keyword">if</span> x == <span class="string">&#x27;01&#x27;</span>:</span><br><span class="line">                ret += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">            <span class="keyword">elif</span> x == <span class="string">&#x27;10&#x27;</span>:</span><br><span class="line">                ret += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;IEEE曼彻斯特解码错误！&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> isinvert:</span><br><span class="line">            <span class="keyword">return</span> ManchesterDecoder.byteinvert(ret)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">MCST_diff_decode</span>(<span class="params">str_bin, isinvert=<span class="literal">False</span></span>):</span><br><span class="line">        <span class="comment"># 差分曼彻斯特编码（Differential Manchester Encoding）解码</span></span><br><span class="line">        <span class="comment"># 解码逻辑：两段编码相同表示0，不同表示1</span></span><br><span class="line">        ret = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(str_bin) // <span class="number">2</span> - <span class="number">1</span>):</span><br><span class="line">            x1 = str_bin[i*<span class="number">2</span>:i*<span class="number">2</span>+<span class="number">2</span>]</span><br><span class="line">            x2 = str_bin[i*<span class="number">2</span>+<span class="number">2</span>:i*<span class="number">2</span>+<span class="number">4</span>]</span><br><span class="line">            <span class="keyword">if</span> x1 == x2:</span><br><span class="line">                ret += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                ret += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> isinvert:</span><br><span class="line">            <span class="keyword">return</span> ManchesterDecoder.byteinvert(ret)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ---------- 编码函数 ----------</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">MCST_stand_encode</span>(<span class="params">bit_str, isinvert=<span class="literal">False</span></span>):</span><br><span class="line">        <span class="comment"># 标准曼彻斯特编码</span></span><br><span class="line">        <span class="comment"># 0 -&gt; 01，1 -&gt; 10</span></span><br><span class="line">        <span class="keyword">if</span> isinvert:</span><br><span class="line">            bit_str = ManchesterDecoder.byteinvert(bit_str)</span><br><span class="line">        ret = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> bit <span class="keyword">in</span> bit_str:</span><br><span class="line">            <span class="keyword">if</span> bit == <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">                ret += <span class="string">&#x27;01&#x27;</span></span><br><span class="line">            <span class="keyword">elif</span> bit == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">                ret += <span class="string">&#x27;10&#x27;</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">&#x27;输入必须是二进制字符串&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">MCST_IEEE_encode</span>(<span class="params">bit_str, isinvert=<span class="literal">False</span></span>):</span><br><span class="line">        <span class="comment"># IEEE 802.3 曼彻斯特编码</span></span><br><span class="line">        <span class="comment"># 0 -&gt; 10，1 -&gt; 01</span></span><br><span class="line">        <span class="keyword">if</span> isinvert:</span><br><span class="line">            bit_str = ManchesterDecoder.byteinvert(bit_str)</span><br><span class="line">        ret = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> bit <span class="keyword">in</span> bit_str:</span><br><span class="line">            <span class="keyword">if</span> bit == <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">                ret += <span class="string">&#x27;10&#x27;</span></span><br><span class="line">            <span class="keyword">elif</span> bit == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">                ret += <span class="string">&#x27;01&#x27;</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">&#x27;输入必须是二进制字符串&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">MCST_diff_encode</span>(<span class="params">bit_str, isinvert=<span class="literal">False</span></span>):</span><br><span class="line">        <span class="comment"># 差分曼彻斯特编码</span></span><br><span class="line">        <span class="comment"># 差分曼彻斯特编码以一个初始状态开始，0表示保持前半周期电平不变，1表示反转</span></span><br><span class="line">        <span class="comment"># 这里用&#x27;01&#x27;和&#x27;10&#x27;代表两种状态，初始状态为&#x27;01&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> isinvert:</span><br><span class="line">            bit_str = ManchesterDecoder.byteinvert(bit_str)</span><br><span class="line">        ret = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        prev = <span class="string">&#x27;0&#x27;</span>  <span class="comment"># 假设初始电平为0，对应编码&#x27;01&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> bit <span class="keyword">in</span> bit_str:</span><br><span class="line">            <span class="keyword">if</span> bit == <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">                <span class="comment"># 0表示信号电平保持不变，编码为与上一个一样</span></span><br><span class="line">                <span class="keyword">if</span> prev == <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">                    ret += <span class="string">&#x27;01&#x27;</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    ret += <span class="string">&#x27;10&#x27;</span></span><br><span class="line">            <span class="keyword">elif</span> bit == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">                <span class="comment"># 1表示电平反转，编码为与上一个相反</span></span><br><span class="line">                <span class="keyword">if</span> prev == <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">                    ret += <span class="string">&#x27;10&#x27;</span></span><br><span class="line">                    prev = <span class="string">&#x27;1&#x27;</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    ret += <span class="string">&#x27;01&#x27;</span></span><br><span class="line">                    prev = <span class="string">&#x27;0&#x27;</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">&#x27;输入必须是二进制字符串&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    ct = <span class="string">&quot;2559659965656A9A65656996696965A6695669A9695A699569666A5A6A6569666A59695A69AA696569666AA6&quot;</span></span><br><span class="line">    ct = convert_base(ct, <span class="number">16</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    result = ManchesterDecoder.MCST_stand_decode(ct, <span class="literal">False</span>)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(result, <span class="number">2</span>)))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># b&#x27;BJD&#123;DifManchestercode&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<br>

<h1 id="2-传统古典密码"><a href="#2-传统古典密码" class="headerlink" title="2. 传统古典密码"></a>2. 传统古典密码</h1><h2 id="2-1-看我回旋踢"><a href="#2-1-看我回旋踢" class="headerlink" title="2.1 看我回旋踢"></a>2.1 看我回旋踢</h2><h3 id="2-1-1-题目"><a href="#2-1-1-题目" class="headerlink" title="2.1.1 题目"></a>2.1.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">synt&#123;5pq1004q-86n5-46q8-o720-oro5on0417r1&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-1-2-解题思路"><a href="#2-1-2-解题思路" class="headerlink" title="2.1.2 解题思路"></a>2.1.2 解题思路</h3><p><strong>ROT18</strong></p>
<h3 id="2-1-3-解题脚本"><a href="#2-1-3-解题脚本" class="headerlink" title="2.1.3 解题脚本"></a>2.1.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">RotCipher</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ROT系列加密算法实现（支持ROT3/5/10/13/18/47/ROT-5/ROT-6）&quot;&quot;&quot;</span></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_rotate_char</span>(<span class="params">char: <span class="built_in">str</span>, base: <span class="built_in">int</span>, shift: <span class="built_in">int</span>, range_size: <span class="built_in">int</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;对单个字符进行指定偏移量的 ROT 加密/解密&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> char.isspace():  <span class="comment"># 跳过空白字符</span></span><br><span class="line">            char_code = <span class="built_in">ord</span>(char)</span><br><span class="line">            <span class="keyword">if</span> base &lt;= char_code &lt; base + range_size:</span><br><span class="line">                <span class="comment"># 计算旋转后的字符代码</span></span><br><span class="line">                char_code = (char_code - base + shift) % range_size + base</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">chr</span>(char_code)</span><br><span class="line">        <span class="keyword">return</span> char</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">rot3</span>(<span class="params">text: <span class="built_in">str</span>, decrypt: <span class="built_in">bool</span> = <span class="literal">False</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot; Caesar Cipher 执行 ROT3 加密/解密，字母旋转3位 &quot;&quot;&quot;</span></span><br><span class="line">        shift = -<span class="number">3</span> <span class="keyword">if</span> decrypt <span class="keyword">else</span> <span class="number">3</span></span><br><span class="line">        result = []</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> text:</span><br><span class="line">            <span class="keyword">if</span> c.isupper():</span><br><span class="line">                result.append(RotCipher._rotate_char(c, <span class="number">65</span>, shift, <span class="number">26</span>))</span><br><span class="line">            <span class="keyword">elif</span> c.islower():</span><br><span class="line">                result.append(RotCipher._rotate_char(c, <span class="number">97</span>, shift, <span class="number">26</span>))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                result.append(c)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(result)</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">rot5</span>(<span class="params">text: <span class="built_in">str</span>, decrypt: <span class="built_in">bool</span> = <span class="literal">False</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;执行ROT5加密/解密（数字旋转5位）&quot;&quot;&quot;</span></span><br><span class="line">        shift = -<span class="number">5</span> <span class="keyword">if</span> decrypt <span class="keyword">else</span> <span class="number">5</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(RotCipher._rotate_char(c, <span class="number">48</span>, shift, <span class="number">10</span>) <span class="keyword">for</span> c <span class="keyword">in</span> text)</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">rot10</span>(<span class="params">text: <span class="built_in">str</span>, decrypt: <span class="built_in">bool</span> = <span class="literal">False</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot; Avocat 执行 ROT10 加密/解密，字母旋转10位 &quot;&quot;&quot;</span></span><br><span class="line">        shift = -<span class="number">10</span> <span class="keyword">if</span> decrypt <span class="keyword">else</span> <span class="number">10</span></span><br><span class="line">        result = []</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> text:</span><br><span class="line">            <span class="keyword">if</span> c.isupper():</span><br><span class="line">                result.append(RotCipher._rotate_char(c, <span class="number">65</span>, shift, <span class="number">26</span>))</span><br><span class="line">            <span class="keyword">elif</span> c.islower():</span><br><span class="line">                result.append(RotCipher._rotate_char(c, <span class="number">97</span>, shift, <span class="number">26</span>))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                result.append(c)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(result)</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">rot13</span>(<span class="params">text: <span class="built_in">str</span>, decrypt: <span class="built_in">bool</span> = <span class="literal">False</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;执行 ROT13 加密/解密（字母旋转13位）&quot;&quot;&quot;</span></span><br><span class="line">        shift = -<span class="number">13</span> <span class="keyword">if</span> decrypt <span class="keyword">else</span> <span class="number">13</span></span><br><span class="line">        result = []</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> text:</span><br><span class="line">            <span class="keyword">if</span> c.isupper():</span><br><span class="line">                result.append(RotCipher._rotate_char(c, <span class="number">65</span>, shift, <span class="number">26</span>))</span><br><span class="line">            <span class="keyword">elif</span> c.islower():</span><br><span class="line">                result.append(RotCipher._rotate_char(c, <span class="number">97</span>, shift, <span class="number">26</span>))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                result.append(c)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(result)</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">rot18</span>(<span class="params">text: <span class="built_in">str</span>, decrypt: <span class="built_in">bool</span> = <span class="literal">False</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;执行 ROT18 加密/解密（字母旋转13位 + 数字旋转5位）&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> decrypt:</span><br><span class="line">            <span class="keyword">return</span> RotCipher.rot5(RotCipher.rot13(text))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> RotCipher.rot13(RotCipher.rot5(text, decrypt=<span class="literal">True</span>), decrypt=<span class="literal">True</span>)</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">rot47</span>(<span class="params">text: <span class="built_in">str</span>, decrypt: <span class="built_in">bool</span> = <span class="literal">False</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;执行 ROT47 加密/解密（ASCII 33-126 旋转47位）&quot;&quot;&quot;</span></span><br><span class="line">        shift = -<span class="number">47</span> <span class="keyword">if</span> decrypt <span class="keyword">else</span> <span class="number">47</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(RotCipher._rotate_char(c, <span class="number">33</span>, shift, <span class="number">94</span>) <span class="keyword">for</span> c <span class="keyword">in</span> text)</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">rot_neg5</span>(<span class="params">text: <span class="built_in">str</span>, decrypt: <span class="built_in">bool</span> = <span class="literal">False</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot; Cassis 执行 ROT-5 加密/解密，数字反向旋转5位&quot;&quot;&quot;</span></span><br><span class="line">        shift = <span class="number">5</span> <span class="keyword">if</span> decrypt <span class="keyword">else</span> -<span class="number">5</span>  <span class="comment"># 反向旋转</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(RotCipher._rotate_char(c, <span class="number">48</span>, shift, <span class="number">10</span>) <span class="keyword">for</span> c <span class="keyword">in</span> text)</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">rot_neg6</span>(<span class="params">text: <span class="built_in">str</span>, decrypt: <span class="built_in">bool</span> = <span class="literal">False</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Cassette 执行 ROT-6 加密/解密（字母反向旋转6位，保留大小写）&quot;&quot;&quot;</span></span><br><span class="line">        shift = <span class="number">6</span> <span class="keyword">if</span> decrypt <span class="keyword">else</span> -<span class="number">6</span>  <span class="comment"># 反向旋转</span></span><br><span class="line">        result = []</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> text:</span><br><span class="line">            <span class="keyword">if</span> c.isupper():</span><br><span class="line">                result.append(RotCipher._rotate_char(c, <span class="number">65</span>, shift, <span class="number">26</span>))</span><br><span class="line">            <span class="keyword">elif</span> c.islower():</span><br><span class="line">                result.append(RotCipher._rotate_char(c, <span class="number">97</span>, shift, <span class="number">26</span>))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                result.append(c)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(result)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">shift_cipher</span>(<span class="params">text: <span class="built_in">str</span>, offset: <span class="built_in">int</span> = <span class="literal">None</span>, alphabet: <span class="built_in">str</span> = <span class="literal">None</span></span>) -&gt; <span class="built_in">dict</span> | <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        通用移位密码实现</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> alphabet <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="comment"># 默认使用标准字母表（大小写字母）</span></span><br><span class="line">            alphabet_upper = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span></span><br><span class="line">            alphabet_lower = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> offset <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                result = []</span><br><span class="line">                <span class="keyword">for</span> c <span class="keyword">in</span> text:</span><br><span class="line">                    <span class="keyword">if</span> c.isupper():</span><br><span class="line">                        idx = (alphabet_upper.index(c) + offset) % <span class="number">26</span></span><br><span class="line">                        result.append(alphabet_upper[idx])</span><br><span class="line">                    <span class="keyword">elif</span> c.islower():</span><br><span class="line">                        idx = (alphabet_lower.index(c) + offset) % <span class="number">26</span></span><br><span class="line">                        result.append(alphabet_lower[idx])</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        result.append(c)</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(result)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                results = &#123;&#125;</span><br><span class="line">                <span class="keyword">for</span> o <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">27</span>):  <span class="comment"># 字母表长度为26</span></span><br><span class="line">                    results[o] = RotCipher.shift_cipher(text, o, alphabet)</span><br><span class="line">                <span class="keyword">return</span> results</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># 使用自定义字符表</span></span><br><span class="line">            <span class="keyword">if</span> offset <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                result = []</span><br><span class="line">                <span class="keyword">for</span> c <span class="keyword">in</span> text:</span><br><span class="line">                    <span class="keyword">if</span> c <span class="keyword">in</span> alphabet:</span><br><span class="line">                        idx = (alphabet.index(c) + offset) % <span class="built_in">len</span>(alphabet)</span><br><span class="line">                        result.append(alphabet[idx])</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        result.append(c)  <span class="comment"># 不在字符表中的字符保持不变</span></span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(result)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                results = &#123;&#125;</span><br><span class="line">                <span class="keyword">for</span> o <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(alphabet)):</span><br><span class="line">                    results[o] = RotCipher.shift_cipher(text, o, alphabet)</span><br><span class="line">                <span class="keyword">return</span> results</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    res = RotCipher.rot18(<span class="string">&quot;synt&#123;5pq1004q-86n5-46q8-o720-oro5on0417r1&#125;&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(res)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># flag&#123;0cd6559d-31a0-91d3-b275-beb0ba5962e6&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="2-2-摩丝"><a href="#2-2-摩丝" class="headerlink" title="2.2 摩丝"></a>2.2 摩丝</h2><h3 id="2-2-1-题目"><a href="#2-2-1-题目" class="headerlink" title="2.2.1 题目"></a>2.2.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.. .-.. --- ...- . -.-- --- ..-</span><br></pre></td></tr></table></figure>

<h3 id="2-2-2-解题思路"><a href="#2-2-2-解题思路" class="headerlink" title="2.2.2 解题思路"></a>2.2.2 解题思路</h3><p><strong>Morse 密码</strong></p>
<h3 id="2-2-3-解题脚本"><a href="#2-2-3-解题脚本" class="headerlink" title="2.2.3 解题脚本"></a>2.2.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MorseCode</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;摩斯密码加解密类&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># 字符到摩斯码映射表</span></span><br><span class="line">        <span class="variable language_">self</span>.char_to_morse = &#123;</span><br><span class="line">            <span class="string">&#x27;A&#x27;</span>: <span class="string">&#x27;.-&#x27;</span>, <span class="string">&#x27;B&#x27;</span>: <span class="string">&#x27;-...&#x27;</span>, <span class="string">&#x27;C&#x27;</span>: <span class="string">&#x27;-.-.&#x27;</span>, <span class="string">&#x27;D&#x27;</span>: <span class="string">&#x27;-..&#x27;</span>, <span class="string">&#x27;E&#x27;</span>: <span class="string">&#x27;.&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;F&#x27;</span>: <span class="string">&#x27;..-.&#x27;</span>, <span class="string">&#x27;G&#x27;</span>: <span class="string">&#x27;--.&#x27;</span>, <span class="string">&#x27;H&#x27;</span>: <span class="string">&#x27;....&#x27;</span>, <span class="string">&#x27;I&#x27;</span>: <span class="string">&#x27;..&#x27;</span>, <span class="string">&#x27;J&#x27;</span>: <span class="string">&#x27;.---&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;K&#x27;</span>: <span class="string">&#x27;-.-&#x27;</span>, <span class="string">&#x27;L&#x27;</span>: <span class="string">&#x27;.-..&#x27;</span>, <span class="string">&#x27;M&#x27;</span>: <span class="string">&#x27;--&#x27;</span>, <span class="string">&#x27;N&#x27;</span>: <span class="string">&#x27;-.&#x27;</span>, <span class="string">&#x27;O&#x27;</span>: <span class="string">&#x27;---&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;P&#x27;</span>: <span class="string">&#x27;.--.&#x27;</span>, <span class="string">&#x27;Q&#x27;</span>: <span class="string">&#x27;--.-&#x27;</span>, <span class="string">&#x27;R&#x27;</span>: <span class="string">&#x27;.-.&#x27;</span>, <span class="string">&#x27;S&#x27;</span>: <span class="string">&#x27;...&#x27;</span>, <span class="string">&#x27;T&#x27;</span>: <span class="string">&#x27;-&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;U&#x27;</span>: <span class="string">&#x27;..-&#x27;</span>, <span class="string">&#x27;V&#x27;</span>: <span class="string">&#x27;...-&#x27;</span>, <span class="string">&#x27;W&#x27;</span>: <span class="string">&#x27;.--&#x27;</span>, <span class="string">&#x27;X&#x27;</span>: <span class="string">&#x27;-..-&#x27;</span>, <span class="string">&#x27;Y&#x27;</span>: <span class="string">&#x27;-.--&#x27;</span>, <span class="string">&#x27;Z&#x27;</span>: <span class="string">&#x27;--..&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;0&#x27;</span>: <span class="string">&#x27;-----&#x27;</span>, <span class="string">&#x27;1&#x27;</span>: <span class="string">&#x27;.----&#x27;</span>, <span class="string">&#x27;2&#x27;</span>: <span class="string">&#x27;..---&#x27;</span>, <span class="string">&#x27;3&#x27;</span>: <span class="string">&#x27;...--&#x27;</span>, <span class="string">&#x27;4&#x27;</span>: <span class="string">&#x27;....-&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;5&#x27;</span>: <span class="string">&#x27;.....&#x27;</span>, <span class="string">&#x27;6&#x27;</span>: <span class="string">&#x27;-....&#x27;</span>, <span class="string">&#x27;7&#x27;</span>: <span class="string">&#x27;--...&#x27;</span>, <span class="string">&#x27;8&#x27;</span>: <span class="string">&#x27;---..&#x27;</span>, <span class="string">&#x27;9&#x27;</span>: <span class="string">&#x27;----.&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;.&#x27;</span>: <span class="string">&#x27;.-.-.-&#x27;</span>, <span class="string">&#x27;,&#x27;</span>: <span class="string">&#x27;--..--&#x27;</span>, <span class="string">&#x27;?&#x27;</span>: <span class="string">&#x27;..--..&#x27;</span>, <span class="string">&quot;&#x27;&quot;</span>: <span class="string">&#x27;.----.&#x27;</span>, <span class="string">&#x27;!&#x27;</span>: <span class="string">&#x27;-.-.--&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;/&#x27;</span>: <span class="string">&#x27;-..-.&#x27;</span>, <span class="string">&#x27;(&#x27;</span>: <span class="string">&#x27;-.--.&#x27;</span>, <span class="string">&#x27;)&#x27;</span>: <span class="string">&#x27;-.--.-&#x27;</span>, <span class="string">&#x27;&amp;&#x27;</span>: <span class="string">&#x27;.-...&#x27;</span>, <span class="string">&#x27;:&#x27;</span>: <span class="string">&#x27;---...&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;;&#x27;</span>: <span class="string">&#x27;-.-.-.&#x27;</span>, <span class="string">&#x27;=&#x27;</span>: <span class="string">&#x27;-...-&#x27;</span>, <span class="string">&#x27;+&#x27;</span>: <span class="string">&#x27;.-.-.&#x27;</span>, <span class="string">&#x27;-&#x27;</span>: <span class="string">&#x27;-....-&#x27;</span>, <span class="string">&#x27;_&#x27;</span>: <span class="string">&#x27;..--.-&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;&quot;&#x27;</span>: <span class="string">&#x27;.-..-.&#x27;</span>, <span class="string">&#x27;$&#x27;</span>: <span class="string">&#x27;...-..-&#x27;</span>, <span class="string">&#x27;@&#x27;</span>: <span class="string">&#x27;.--.-.&#x27;</span>, <span class="string">&#x27; &#x27;</span>: <span class="string">&#x27;/&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"># 摩斯码到字符的反向映射</span></span><br><span class="line">        <span class="variable language_">self</span>.morse_to_char = &#123;v: k <span class="keyword">for</span> k, v <span class="keyword">in</span> <span class="variable language_">self</span>.char_to_morse.items()&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self, text: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;将普通文本加密为摩斯密码&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27; &#x27;</span>.join(</span><br><span class="line">            <span class="variable language_">self</span>.char_to_morse.get(char.upper(), char) <span class="keyword">for</span> char <span class="keyword">in</span> text</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">self, morse_code: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;将摩斯密码解密为普通文本&quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># 用空格分割每个摩斯字符</span></span><br><span class="line">        morse_list = morse_code.strip().split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">        decoded_chars = []</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> code <span class="keyword">in</span> morse_list:</span><br><span class="line">            <span class="keyword">if</span> code == <span class="string">&#x27;/&#x27;</span>:  <span class="comment"># 单词分隔符</span></span><br><span class="line">                decoded_chars.append(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                decoded_chars.append(<span class="variable language_">self</span>.morse_to_char.get(code, code))  <span class="comment"># 转换或保留原样</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(decoded_chars)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    ciphertext = <span class="string">&quot;.. .-.. --- ...- . -.-- --- ..-&quot;</span></span><br><span class="line">    decrypted = MorseCode().decrypt(ciphertext)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;解密: <span class="subst">&#123;ciphertext&#125;</span> → <span class="subst">&#123;decrypted&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;flag&#123;&#123;<span class="subst">&#123;decrypted&#125;</span>&#125;&#125;&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># flag&#123;ILOVEYOU&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="2-3-变异凯撒"><a href="#2-3-变异凯撒" class="headerlink" title="2.3 变异凯撒"></a>2.3 变异凯撒</h2><h3 id="2-3-1-题目"><a href="#2-3-1-题目" class="headerlink" title="2.3.1 题目"></a>2.3.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">加密密文：afZ_r9VYfScOeO_UL^RWUc</span><br><span class="line">格式：flag&#123; &#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-3-2-解题思路"><a href="#2-3-2-解题思路" class="headerlink" title="2.3.2 解题思路"></a>2.3.2 解题思路</h3><p>密文前四位 <code>afZ_</code> 对应明文 <code>flag</code>，可推测该加密方式为变种凯撒加密：每个字符按递增偏移量依次加密，首位偏移 5 位，之后逐位加 1。</p>
<h3 id="2-3-3-解题脚本"><a href="#2-3-3-解题脚本" class="headerlink" title="2.3.3 解题脚本"></a>2.3.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    ct = <span class="string">&quot;afZ_r9VYfScOeO_UL^RWUc&quot;</span></span><br><span class="line">    pt = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(<span class="built_in">ord</span>(c) + <span class="number">5</span> + i) <span class="keyword">for</span> i, c <span class="keyword">in</span> <span class="built_in">enumerate</span>(ct))</span><br><span class="line">    <span class="built_in">print</span>(pt)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># flag&#123;Caesar_variation&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="2-4-篱笆墙的影子"><a href="#2-4-篱笆墙的影子" class="headerlink" title="2.4 篱笆墙的影子"></a>2.4 篱笆墙的影子</h2><h3 id="2-4-1-题目"><a href="#2-4-1-题目" class="headerlink" title="2.4.1 题目"></a>2.4.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">星星还是那颗星星哟 月亮还是那个月亮 山也还是那座山哟 梁也还是那道梁 碾子是碾子 缸是缸哟 爹是爹来娘是娘 麻油灯呵还吱吱响 点的还是那么丁点亮 哦哦 注意：得到的 flag 请包上 flag&#123;&#125; 提交</span><br><span class="line"></span><br><span class="line">felhaagv&#123;ewtehtehfilnakgw&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-4-2-解题思路"><a href="#2-4-2-解题思路" class="headerlink" title="2.4.2 解题思路"></a>2.4.2 解题思路</h3><p><strong>栅栏密码</strong>（key &#x3D; 13）</p>
<h3 id="2-4-3-解题脚本"><a href="#2-4-3-解题脚本" class="headerlink" title="2.4.3 解题脚本"></a>2.4.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Railfence</span>:</span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">message, key=<span class="literal">None</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        加密函数：实现 Rail Fence Cipher 的分段加密。</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> key <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            ciphertext = <span class="string">&#x27;&#x27;</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(key):</span><br><span class="line">                ciphertext += message[i::key]</span><br><span class="line">            <span class="keyword">return</span> ciphertext</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># 遍历 key 从 2 到 12</span></span><br><span class="line">            results = &#123;&#125;</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="number">13</span>):</span><br><span class="line">                ciphertext = <span class="string">&#x27;&#x27;</span></span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">                    ciphertext += message[i::k]</span><br><span class="line">                results[k] = ciphertext</span><br><span class="line">            <span class="keyword">return</span> results</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">ciphertext, key=<span class="literal">None</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        解密函数：根据密文和密钥 key 还原原文。</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> key <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            plaintext = <span class="string">&#x27;&#x27;</span></span><br><span class="line">            row_length = math.ceil(<span class="built_in">len</span>(ciphertext) / key)</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(row_length):</span><br><span class="line">                plaintext += ciphertext[i::row_length]</span><br><span class="line">            <span class="keyword">return</span> plaintext</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># 遍历 key 从 2 到 16</span></span><br><span class="line">            results = &#123;&#125;</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="number">17</span>):</span><br><span class="line">                row_length = math.ceil(<span class="built_in">len</span>(ciphertext) / k)</span><br><span class="line">                plaintext = <span class="string">&#x27;&#x27;</span></span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(row_length):</span><br><span class="line">                    plaintext += ciphertext[i::row_length]</span><br><span class="line">                results[k] = plaintext</span><br><span class="line">            <span class="keyword">return</span> results</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    ciphertext = <span class="string">r&quot;felhaagv&#123;ewtehtehfilnakgw&#125;&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(Railfence.decrypt(ciphertext))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># flag&#123;wethinkwehavetheflag&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="2-5-大帝的密码武器"><a href="#2-5-大帝的密码武器" class="headerlink" title="2.5 大帝的密码武器"></a>2.5 大帝的密码武器</h2><h3 id="2-5-1-题目"><a href="#2-5-1-题目" class="headerlink" title="2.5.1 题目"></a>2.5.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 密文</span></span><br><span class="line">ComeChina</span><br><span class="line"></span><br><span class="line"><span class="comment"># 题目</span></span><br><span class="line">公元前一百年，在罗马出生了一位对世界影响巨大的人物，他生前是罗马三巨头之一。他率先使用了一种简单的加密函，因此这种加密方法以他的名字命名。</span><br><span class="line">以下密文被解开后可以获得一个有意义的单词：FRPHEVGL</span><br><span class="line">你可以用这个相同的加密向量加密附件中的密文，作为答案进行提交。</span><br></pre></td></tr></table></figure>

<h3 id="2-5-2-解题思路"><a href="#2-5-2-解题思路" class="headerlink" title="2.5.2 解题思路"></a>2.5.2 解题思路</h3><p>使用凯撒密码解密 <code>FRPHEVGL</code>，得到有意义单词 <code>SECURITY</code>。得到偏移量13（ROT13），使用该密钥对 ComeChina 进行加密。</p>
<h3 id="2-5-3-解题脚本"><a href="#2-5-3-解题脚本" class="headerlink" title="2.5.3 解题脚本"></a>2.5.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">RotCipher</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ROT系列加密算法实现（支持ROT3/5/10/13/18/47/ROT-5/ROT-6）&quot;&quot;&quot;</span></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_rotate_char</span>(<span class="params">char: <span class="built_in">str</span>, base: <span class="built_in">int</span>, shift: <span class="built_in">int</span>, range_size: <span class="built_in">int</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;对单个字符进行指定偏移量的 ROT 加密/解密&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> char.isspace():  <span class="comment"># 跳过空白字符</span></span><br><span class="line">            char_code = <span class="built_in">ord</span>(char)</span><br><span class="line">            <span class="keyword">if</span> base &lt;= char_code &lt; base + range_size:</span><br><span class="line">                <span class="comment"># 计算旋转后的字符代码</span></span><br><span class="line">                char_code = (char_code - base + shift) % range_size + base</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">chr</span>(char_code)</span><br><span class="line">        <span class="keyword">return</span> char</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">rot3</span>(<span class="params">text: <span class="built_in">str</span>, decrypt: <span class="built_in">bool</span> = <span class="literal">False</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot; Caesar Cipher 执行 ROT3 加密/解密，字母旋转3位 &quot;&quot;&quot;</span></span><br><span class="line">        shift = -<span class="number">3</span> <span class="keyword">if</span> decrypt <span class="keyword">else</span> <span class="number">3</span></span><br><span class="line">        result = []</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> text:</span><br><span class="line">            <span class="keyword">if</span> c.isupper():</span><br><span class="line">                result.append(RotCipher._rotate_char(c, <span class="number">65</span>, shift, <span class="number">26</span>))</span><br><span class="line">            <span class="keyword">elif</span> c.islower():</span><br><span class="line">                result.append(RotCipher._rotate_char(c, <span class="number">97</span>, shift, <span class="number">26</span>))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                result.append(c)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(result)</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">rot5</span>(<span class="params">text: <span class="built_in">str</span>, decrypt: <span class="built_in">bool</span> = <span class="literal">False</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;执行ROT5加密/解密（数字旋转5位）&quot;&quot;&quot;</span></span><br><span class="line">        shift = -<span class="number">5</span> <span class="keyword">if</span> decrypt <span class="keyword">else</span> <span class="number">5</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(RotCipher._rotate_char(c, <span class="number">48</span>, shift, <span class="number">10</span>) <span class="keyword">for</span> c <span class="keyword">in</span> text)</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">rot10</span>(<span class="params">text: <span class="built_in">str</span>, decrypt: <span class="built_in">bool</span> = <span class="literal">False</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot; Avocat 执行 ROT10 加密/解密，字母旋转10位 &quot;&quot;&quot;</span></span><br><span class="line">        shift = -<span class="number">10</span> <span class="keyword">if</span> decrypt <span class="keyword">else</span> <span class="number">10</span></span><br><span class="line">        result = []</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> text:</span><br><span class="line">            <span class="keyword">if</span> c.isupper():</span><br><span class="line">                result.append(RotCipher._rotate_char(c, <span class="number">65</span>, shift, <span class="number">26</span>))</span><br><span class="line">            <span class="keyword">elif</span> c.islower():</span><br><span class="line">                result.append(RotCipher._rotate_char(c, <span class="number">97</span>, shift, <span class="number">26</span>))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                result.append(c)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(result)</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">rot13</span>(<span class="params">text: <span class="built_in">str</span>, decrypt: <span class="built_in">bool</span> = <span class="literal">False</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;执行 ROT13 加密/解密（字母旋转13位）&quot;&quot;&quot;</span></span><br><span class="line">        shift = -<span class="number">13</span> <span class="keyword">if</span> decrypt <span class="keyword">else</span> <span class="number">13</span></span><br><span class="line">        result = []</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> text:</span><br><span class="line">            <span class="keyword">if</span> c.isupper():</span><br><span class="line">                result.append(RotCipher._rotate_char(c, <span class="number">65</span>, shift, <span class="number">26</span>))</span><br><span class="line">            <span class="keyword">elif</span> c.islower():</span><br><span class="line">                result.append(RotCipher._rotate_char(c, <span class="number">97</span>, shift, <span class="number">26</span>))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                result.append(c)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(result)</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">rot18</span>(<span class="params">text: <span class="built_in">str</span>, decrypt: <span class="built_in">bool</span> = <span class="literal">False</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;执行 ROT18 加密/解密（字母旋转13位 + 数字旋转5位）&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> decrypt:</span><br><span class="line">            <span class="keyword">return</span> RotCipher.rot5(RotCipher.rot13(text))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> RotCipher.rot13(RotCipher.rot5(text, decrypt=<span class="literal">True</span>), decrypt=<span class="literal">True</span>)</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">rot47</span>(<span class="params">text: <span class="built_in">str</span>, decrypt: <span class="built_in">bool</span> = <span class="literal">False</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;执行 ROT47 加密/解密（ASCII 33-126 旋转47位）&quot;&quot;&quot;</span></span><br><span class="line">        shift = -<span class="number">47</span> <span class="keyword">if</span> decrypt <span class="keyword">else</span> <span class="number">47</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(RotCipher._rotate_char(c, <span class="number">33</span>, shift, <span class="number">94</span>) <span class="keyword">for</span> c <span class="keyword">in</span> text)</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">rot_neg5</span>(<span class="params">text: <span class="built_in">str</span>, decrypt: <span class="built_in">bool</span> = <span class="literal">False</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot; Cassis 执行 ROT-5 加密/解密，数字反向旋转5位&quot;&quot;&quot;</span></span><br><span class="line">        shift = <span class="number">5</span> <span class="keyword">if</span> decrypt <span class="keyword">else</span> -<span class="number">5</span>  <span class="comment"># 反向旋转</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(RotCipher._rotate_char(c, <span class="number">48</span>, shift, <span class="number">10</span>) <span class="keyword">for</span> c <span class="keyword">in</span> text)</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">rot_neg6</span>(<span class="params">text: <span class="built_in">str</span>, decrypt: <span class="built_in">bool</span> = <span class="literal">False</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;Cassette 执行 ROT-6 加密/解密（字母反向旋转6位，保留大小写）&quot;&quot;&quot;</span></span><br><span class="line">        shift = <span class="number">6</span> <span class="keyword">if</span> decrypt <span class="keyword">else</span> -<span class="number">6</span>  <span class="comment"># 反向旋转</span></span><br><span class="line">        result = []</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> text:</span><br><span class="line">            <span class="keyword">if</span> c.isupper():</span><br><span class="line">                result.append(RotCipher._rotate_char(c, <span class="number">65</span>, shift, <span class="number">26</span>))</span><br><span class="line">            <span class="keyword">elif</span> c.islower():</span><br><span class="line">                result.append(RotCipher._rotate_char(c, <span class="number">97</span>, shift, <span class="number">26</span>))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                result.append(c)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(result)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">shift_cipher</span>(<span class="params">text: <span class="built_in">str</span>, offset: <span class="built_in">int</span> = <span class="literal">None</span>, alphabet: <span class="built_in">str</span> = <span class="literal">None</span></span>) -&gt; <span class="built_in">dict</span> | <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        通用移位密码实现</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> alphabet <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="comment"># 默认使用标准字母表（大小写字母）</span></span><br><span class="line">            alphabet_upper = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span></span><br><span class="line">            alphabet_lower = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> offset <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                result = []</span><br><span class="line">                <span class="keyword">for</span> c <span class="keyword">in</span> text:</span><br><span class="line">                    <span class="keyword">if</span> c.isupper():</span><br><span class="line">                        idx = (alphabet_upper.index(c) + offset) % <span class="number">26</span></span><br><span class="line">                        result.append(alphabet_upper[idx])</span><br><span class="line">                    <span class="keyword">elif</span> c.islower():</span><br><span class="line">                        idx = (alphabet_lower.index(c) + offset) % <span class="number">26</span></span><br><span class="line">                        result.append(alphabet_lower[idx])</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        result.append(c)</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(result)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                results = &#123;&#125;</span><br><span class="line">                <span class="keyword">for</span> o <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">27</span>):  <span class="comment"># 字母表长度为26</span></span><br><span class="line">                    results[o] = RotCipher.shift_cipher(text, o, alphabet)</span><br><span class="line">                <span class="keyword">return</span> results</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># 使用自定义字符表</span></span><br><span class="line">            <span class="keyword">if</span> offset <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                result = []</span><br><span class="line">                <span class="keyword">for</span> c <span class="keyword">in</span> text:</span><br><span class="line">                    <span class="keyword">if</span> c <span class="keyword">in</span> alphabet:</span><br><span class="line">                        idx = (alphabet.index(c) + offset) % <span class="built_in">len</span>(alphabet)</span><br><span class="line">                        result.append(alphabet[idx])</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        result.append(c)  <span class="comment"># 不在字符表中的字符保持不变</span></span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(result)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                results = &#123;&#125;</span><br><span class="line">                <span class="keyword">for</span> o <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(alphabet)):</span><br><span class="line">                    results[o] = RotCipher.shift_cipher(text, o, alphabet)</span><br><span class="line">                <span class="keyword">return</span> results</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="built_in">print</span>(RotCipher.shift_cipher(<span class="string">&quot;FRPHEVGL&quot;</span>))</span><br><span class="line">    pt = RotCipher.rot13(<span class="string">&quot;ComeChina&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;flag&#123;&#123;<span class="subst">&#123;pt&#125;</span>&#125;&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># flag&#123;PbzrPuvan&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="2-6-凯撒？替换？呵呵"><a href="#2-6-凯撒？替换？呵呵" class="headerlink" title="2.6 凯撒？替换？呵呵!"></a>2.6 凯撒？替换？呵呵!</h2><h3 id="2-6-1-题目"><a href="#2-6-1-题目" class="headerlink" title="2.6.1 题目"></a>2.6.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MTHJ&#123;CUBCGXGUGXWREXIPOYAOEYFIGXWRXCHTKHFCOHCFDUCGTXZOHIXOEOWMEHZO&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-6-2-解题思路"><a href="#2-6-2-解题思路" class="headerlink" title="2.6.2 解题思路"></a>2.6.2 解题思路</h3><p><strong>随机替换密码</strong>：一种将明文字母唯一且混乱地替换为不同字母的加密方法，密码字母表完全打乱，短密文需知晓字母对应规则才能解密，长密文则通常借助词频分析破译。使用 <a target="_blank" rel="noopener" href="http://quipqiup.com/">http://quipqiup.com/</a> 词频分析。</p>
<h3 id="2-6-3-解题脚本"><a href="#2-6-3-解题脚本" class="headerlink" title="2.6.3 解题脚本"></a>2.6.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib3</span><br><span class="line"></span><br><span class="line"><span class="comment"># 忽略 SSL 证书警告</span></span><br><span class="line">urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_with_quipqiup</span>(<span class="params">ciphertext: <span class="built_in">str</span>, clues: <span class="built_in">str</span>= <span class="string">&quot;&quot;</span></span>) -&gt; <span class="built_in">dict</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    使用 quipqiup.com 对替换加密密文进行自动解密。</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&quot;Accept&quot;</span>: <span class="string">&quot;*/*&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Accept-Language&quot;</span>: <span class="string">&quot;zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Content-type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Origin&quot;</span>: <span class="string">&quot;http://quipqiup.com&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Referer&quot;</span>: <span class="string">&quot;http://quipqiup.com/&quot;</span>,</span><br><span class="line">        <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0&quot;</span>,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    payload = &#123;</span><br><span class="line">        <span class="string">&quot;ciphertext&quot;</span>: ciphertext,</span><br><span class="line">        <span class="string">&quot;clues&quot;</span>: clues,</span><br><span class="line">        <span class="string">&quot;mode&quot;</span>: <span class="string">&quot;auto&quot;</span>,</span><br><span class="line">        <span class="string">&quot;was_auto&quot;</span>: <span class="literal">True</span>,</span><br><span class="line">        <span class="string">&quot;was_clue&quot;</span>: <span class="literal">False</span>,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 请求提交密文以开始解密</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = requests.post(<span class="string">&quot;http://quipqiup.com/solve&quot;</span>, headers=headers, json=payload, verify=<span class="literal">False</span>)</span><br><span class="line">        response.raise_for_status()</span><br><span class="line">        id_payload = &#123;<span class="string">&quot;id&quot;</span>: response.json().get(<span class="string">&quot;id&quot;</span>)&#125;</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;提交解密请求失败:&quot;</span>, e)</span><br><span class="line">        <span class="keyword">return</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 请求获取解密结果</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = requests.post(<span class="string">&quot;http://quipqiup.com/status&quot;</span>, headers=headers, json=id_payload, verify=<span class="literal">False</span>)</span><br><span class="line">        response.raise_for_status()</span><br><span class="line">        solutions = response.json().get(<span class="string">&quot;solutions&quot;</span>, [])</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;获取解密结果失败:&quot;</span>, e)</span><br><span class="line">        <span class="keyword">return</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 组织解密结果</span></span><br><span class="line">    result = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> solutions:</span><br><span class="line">        result[s[<span class="string">&quot;key&quot;</span>]] = s[<span class="string">&quot;plaintext&quot;</span>]</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    cipher = <span class="string">&quot;MTHJ&#123;CUBCGXGUGXWREXIPOYAOEYFIGXWRXCHTKHFCOHCFDUCGTXZOHIXOEOWMEHZO&#125;&quot;</span></span><br><span class="line">    result = decrypt_with_quipqiup(cipher, clues=<span class="string">&quot;MTHJ = flag&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> key, text <span class="keyword">in</span> result.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;flag&#x27;</span> <span class="keyword">in</span> text:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Key: <span class="subst">&#123;key&#125;</span>\nPlaintext: <span class="subst">&#123;text&#125;</span>\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># flag&#123;substitutioncipherdecryptionisalwayseasyjustlikeapieceofcake&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="2-7-萌萌哒的八戒"><a href="#2-7-萌萌哒的八戒" class="headerlink" title="2.7 萌萌哒的八戒"></a>2.7 萌萌哒的八戒</h2><h3 id="2-7-1-题目"><a href="#2-7-1-题目" class="headerlink" title="2.7.1 题目"></a>2.7.1 题目</h3><center><img src=https://dstbp.com/data/imgs/posts/buuctf/萌萌哒的八戒.png width="600"></center>

<h3 id="2-7-2-解题思路"><a href="#2-7-2-解题思路" class="headerlink" title="2.7.2 解题思路"></a>2.7.2 解题思路</h3><p><strong>猪圈密码</strong></p>
<center><img src=https://dstbp.com/data/imgs/posts/buuctf/pigpencipher.png width="500"></center>

<h3 id="2-7-3-解题脚本"><a href="#2-7-3-解题脚本" class="headerlink" title="2.7.3 解题脚本"></a>2.7.3 解题脚本</h3><p><code>flag&#123;whenthepigwanttoeat&#125;</code></p>
<br>

<h2 id="2-8-传统知识-古典密码"><a href="#2-8-传统知识-古典密码" class="headerlink" title="2.8 传统知识+古典密码"></a>2.8 传统知识+古典密码</h2><h3 id="2-8-1-题目"><a href="#2-8-1-题目" class="headerlink" title="2.8.1 题目"></a>2.8.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">小明某一天收到一封密信，信中写了几个不同的年份</span><br><span class="line">          辛卯，癸巳，丙戌，辛未，庚辰，癸酉，己卯，癸巳。</span><br><span class="line">          信的背面还写有“+甲子”，请解出这段密文。</span><br><span class="line"></span><br><span class="line">key值：CTF&#123;XXX&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-8-2-解题思路"><a href="#2-8-2-解题思路" class="headerlink" title="2.8.2 解题思路"></a>2.8.2 解题思路</h3><p>天干地支加密 + 栅栏密码（key&#x3D;2）+ 凯撒密码（key&#x3D;21）</p>
<h3 id="2-8-3-解题脚本"><a href="#2-8-3-解题脚本" class="headerlink" title="2.8.3 解题脚本"></a>2.8.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">tiangan_dizhi</span>:</span><br><span class="line">    ganzhi_dict = &#123;</span><br><span class="line">        <span class="number">1</span>: <span class="string">&quot;甲子&quot;</span>, <span class="number">2</span>: <span class="string">&quot;乙丑&quot;</span>, <span class="number">3</span>: <span class="string">&quot;丙寅&quot;</span>, <span class="number">4</span>: <span class="string">&quot;丁卯&quot;</span>, <span class="number">5</span>: <span class="string">&quot;戊辰&quot;</span>,</span><br><span class="line">        <span class="number">6</span>: <span class="string">&quot;己巳&quot;</span>, <span class="number">7</span>: <span class="string">&quot;庚午&quot;</span>, <span class="number">8</span>: <span class="string">&quot;辛未&quot;</span>, <span class="number">9</span>: <span class="string">&quot;壬申&quot;</span>, <span class="number">10</span>: <span class="string">&quot;癸酉&quot;</span>,</span><br><span class="line">        <span class="number">11</span>: <span class="string">&quot;甲戌&quot;</span>, <span class="number">12</span>: <span class="string">&quot;乙亥&quot;</span>, <span class="number">13</span>: <span class="string">&quot;丙子&quot;</span>, <span class="number">14</span>: <span class="string">&quot;丁丑&quot;</span>, <span class="number">15</span>: <span class="string">&quot;戊寅&quot;</span>,</span><br><span class="line">        <span class="number">16</span>: <span class="string">&quot;己卯&quot;</span>, <span class="number">17</span>: <span class="string">&quot;庚辰&quot;</span>, <span class="number">18</span>: <span class="string">&quot;辛巳&quot;</span>, <span class="number">19</span>: <span class="string">&quot;壬午&quot;</span>, <span class="number">20</span>: <span class="string">&quot;癸未&quot;</span>,</span><br><span class="line">        <span class="number">21</span>: <span class="string">&quot;甲申&quot;</span>, <span class="number">22</span>: <span class="string">&quot;乙酉&quot;</span>, <span class="number">23</span>: <span class="string">&quot;丙戌&quot;</span>, <span class="number">24</span>: <span class="string">&quot;丁亥&quot;</span>, <span class="number">25</span>: <span class="string">&quot;戊子&quot;</span>,</span><br><span class="line">        <span class="number">26</span>: <span class="string">&quot;己丑&quot;</span>, <span class="number">27</span>: <span class="string">&quot;庚寅&quot;</span>, <span class="number">28</span>: <span class="string">&quot;辛卯&quot;</span>, <span class="number">29</span>: <span class="string">&quot;壬辰&quot;</span>, <span class="number">30</span>: <span class="string">&quot;癸巳&quot;</span>,</span><br><span class="line">        <span class="number">31</span>: <span class="string">&quot;甲午&quot;</span>, <span class="number">32</span>: <span class="string">&quot;乙未&quot;</span>, <span class="number">33</span>: <span class="string">&quot;丙申&quot;</span>, <span class="number">34</span>: <span class="string">&quot;丁酉&quot;</span>, <span class="number">35</span>: <span class="string">&quot;戊戌&quot;</span>,</span><br><span class="line">        <span class="number">36</span>: <span class="string">&quot;己亥&quot;</span>, <span class="number">37</span>: <span class="string">&quot;庚子&quot;</span>, <span class="number">38</span>: <span class="string">&quot;辛丑&quot;</span>, <span class="number">39</span>: <span class="string">&quot;壬寅&quot;</span>, <span class="number">40</span>: <span class="string">&quot;癸卯&quot;</span>,</span><br><span class="line">        <span class="number">41</span>: <span class="string">&quot;甲辰&quot;</span>, <span class="number">42</span>: <span class="string">&quot;乙巳&quot;</span>, <span class="number">43</span>: <span class="string">&quot;丙午&quot;</span>, <span class="number">44</span>: <span class="string">&quot;丁未&quot;</span>, <span class="number">45</span>: <span class="string">&quot;戊申&quot;</span>,</span><br><span class="line">        <span class="number">46</span>: <span class="string">&quot;己酉&quot;</span>, <span class="number">47</span>: <span class="string">&quot;庚戌&quot;</span>, <span class="number">48</span>: <span class="string">&quot;辛亥&quot;</span>, <span class="number">49</span>: <span class="string">&quot;壬子&quot;</span>, <span class="number">50</span>: <span class="string">&quot;癸丑&quot;</span>,</span><br><span class="line">        <span class="number">51</span>: <span class="string">&quot;甲寅&quot;</span>, <span class="number">52</span>: <span class="string">&quot;乙卯&quot;</span>, <span class="number">53</span>: <span class="string">&quot;丙辰&quot;</span>, <span class="number">54</span>: <span class="string">&quot;丁巳&quot;</span>, <span class="number">55</span>: <span class="string">&quot;戊午&quot;</span>,</span><br><span class="line">        <span class="number">56</span>: <span class="string">&quot;己未&quot;</span>, <span class="number">57</span>: <span class="string">&quot;庚申&quot;</span>, <span class="number">58</span>: <span class="string">&quot;辛酉&quot;</span>, <span class="number">59</span>: <span class="string">&quot;壬戌&quot;</span>, <span class="number">60</span>: <span class="string">&quot;癸亥&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    reverse_dict = &#123;v: k <span class="keyword">for</span> k, v <span class="keyword">in</span> ganzhi_dict.items()&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">cls, ganzhi_list</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        将干支列表转换为对应的数字列表</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        result = []</span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> ganzhi_list:</span><br><span class="line">            <span class="keyword">if</span> item <span class="keyword">in</span> cls.reverse_dict:</span><br><span class="line">                result.append(cls.reverse_dict[item])</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">f&quot;无效的干支字符串: <span class="subst">&#123;item&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">cls, number_list</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        将数字列表转换为对应的干支列表</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        result = []</span><br><span class="line">        <span class="keyword">for</span> num <span class="keyword">in</span> number_list:</span><br><span class="line">            <span class="keyword">if</span> <span class="number">1</span> &lt;= num &lt;= <span class="number">60</span>:</span><br><span class="line">                result.append(cls.ganzhi_dict[num])</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">f&quot;数字超出范围 (1-60): <span class="subst">&#123;num&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Railfence</span>:</span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">message, key=<span class="literal">None</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        加密函数：实现 Rail Fence Cipher 的分段加密。</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> key <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            ciphertext = <span class="string">&#x27;&#x27;</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(key):</span><br><span class="line">                ciphertext += message[i::key]</span><br><span class="line">            <span class="keyword">return</span> ciphertext</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># 遍历 key 从 2 到 12</span></span><br><span class="line">            results = &#123;&#125;</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="number">13</span>):</span><br><span class="line">                ciphertext = <span class="string">&#x27;&#x27;</span></span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">                    ciphertext += message[i::k]</span><br><span class="line">                results[k] = ciphertext</span><br><span class="line">            <span class="keyword">return</span> results</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">ciphertext, key=<span class="literal">None</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        解密函数：根据密文和密钥 key 还原原文。</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> key <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            plaintext = <span class="string">&#x27;&#x27;</span></span><br><span class="line">            row_length = math.ceil(<span class="built_in">len</span>(ciphertext) / key)</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(row_length):</span><br><span class="line">                plaintext += ciphertext[i::row_length]</span><br><span class="line">            <span class="keyword">return</span> plaintext</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># 遍历 key 从 2 到 12</span></span><br><span class="line">            results = &#123;&#125;</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="number">13</span>):</span><br><span class="line">                row_length = math.ceil(<span class="built_in">len</span>(ciphertext) / k)</span><br><span class="line">                plaintext = <span class="string">&#x27;&#x27;</span></span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(row_length):</span><br><span class="line">                    plaintext += ciphertext[i::row_length]</span><br><span class="line">                results[k] = plaintext</span><br><span class="line">            <span class="keyword">return</span> results</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RotCipher</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ROT系列加密算法实现（支持ROT3/5/10/13/18/47/ROT-5/ROT-6）&quot;&quot;&quot;</span></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_rotate_char</span>(<span class="params">char: <span class="built_in">str</span>, base: <span class="built_in">int</span>, shift: <span class="built_in">int</span>, range_size: <span class="built_in">int</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;对单个字符进行指定偏移量的 ROT 加密/解密&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> char.isspace():  <span class="comment"># 跳过空白字符</span></span><br><span class="line">            char_code = <span class="built_in">ord</span>(char)</span><br><span class="line">            <span class="keyword">if</span> base &lt;= char_code &lt; base + range_size:</span><br><span class="line">                <span class="comment"># 计算旋转后的字符代码</span></span><br><span class="line">                char_code = (char_code - base + shift) % range_size + base</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">chr</span>(char_code)</span><br><span class="line">        <span class="keyword">return</span> char</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">shift_cipher</span>(<span class="params">text: <span class="built_in">str</span>, offset: <span class="built_in">int</span> = <span class="literal">None</span>, alphabet: <span class="built_in">str</span> = <span class="literal">None</span></span>) -&gt; <span class="built_in">dict</span> | <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        通用移位密码实现</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> alphabet <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="comment"># 默认使用标准字母表（大小写字母）</span></span><br><span class="line">            alphabet_upper = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span></span><br><span class="line">            alphabet_lower = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> offset <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                result = []</span><br><span class="line">                <span class="keyword">for</span> c <span class="keyword">in</span> text:</span><br><span class="line">                    <span class="keyword">if</span> c.isupper():</span><br><span class="line">                        idx = (alphabet_upper.index(c) + offset) % <span class="number">26</span></span><br><span class="line">                        result.append(alphabet_upper[idx])</span><br><span class="line">                    <span class="keyword">elif</span> c.islower():</span><br><span class="line">                        idx = (alphabet_lower.index(c) + offset) % <span class="number">26</span></span><br><span class="line">                        result.append(alphabet_lower[idx])</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        result.append(c)</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(result)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                results = &#123;&#125;</span><br><span class="line">                <span class="keyword">for</span> o <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">27</span>):  <span class="comment"># 字母表长度为26</span></span><br><span class="line">                    results[o] = RotCipher.shift_cipher(text, o, alphabet)</span><br><span class="line">                <span class="keyword">return</span> results</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># 使用自定义字符表</span></span><br><span class="line">            <span class="keyword">if</span> offset <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                result = []</span><br><span class="line">                <span class="keyword">for</span> c <span class="keyword">in</span> text:</span><br><span class="line">                    <span class="keyword">if</span> c <span class="keyword">in</span> alphabet:</span><br><span class="line">                        idx = (alphabet.index(c) + offset) % <span class="built_in">len</span>(alphabet)</span><br><span class="line">                        result.append(alphabet[idx])</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        result.append(c)  <span class="comment"># 不在字符表中的字符保持不变</span></span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(result)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                results = &#123;&#125;</span><br><span class="line">                <span class="keyword">for</span> o <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(alphabet)):</span><br><span class="line">                    results[o] = RotCipher.shift_cipher(text, o, alphabet)</span><br><span class="line">                <span class="keyword">return</span> results</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    encrypted = tiangan_dizhi.decrypt([<span class="string">&quot;辛卯&quot;</span>, <span class="string">&quot;癸巳&quot;</span>, <span class="string">&quot;丙戌&quot;</span>, <span class="string">&quot;辛未&quot;</span>, <span class="string">&quot;庚辰&quot;</span>, <span class="string">&quot;癸酉&quot;</span>, <span class="string">&quot;己卯&quot;</span>, <span class="string">&quot;癸巳&quot;</span>])</span><br><span class="line">    msg1 = <span class="string">&quot;&quot;</span>.join([<span class="built_in">chr</span>(i + <span class="number">60</span>) <span class="keyword">for</span> i <span class="keyword">in</span> encrypted])</span><br><span class="line">    msg2 = Railfence.decrypt(msg1, <span class="number">2</span>)</span><br><span class="line">    msg3 = RotCipher.shift_cipher(msg2, <span class="number">21</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;CTF&#123;&#123;<span class="subst">&#123;msg3&#125;</span>&#125;&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># CTF&#123;SHUANGYU&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="2-9-世上无难事"><a href="#2-9-世上无难事" class="headerlink" title="2.9 世上无难事"></a>2.9 世上无难事</h2><h3 id="2-9-1-题目"><a href="#2-9-1-题目" class="headerlink" title="2.9.1 题目"></a>2.9.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">以下是某国现任总统外发的一段指令，经过一种奇异的加密方式，毫无规律，看来只能分析了。请将这段语句还原成通顺语句，并从中找到key作为答案提交，答案是<span class="number">32</span>位，包含小写字母。</span><br><span class="line"></span><br><span class="line">VIZZB IFIUOJBWO NVXAP OBC XZZ UKHVN IFIUOJBWO HB XVIXW XAW VXFI X QIXN VBD KQ IFIUOJBWO WBKAH NBWXO VBD XJBCN NKG QLKEIU DI XUI VIUI DKNV QNCWIANQ XN DXPIMKIZW VKHV QEVBBZ KA XUZKAHNBA FKUHKAKX XAW DI VXFI HBN QNCWIANQ NCAKAH KA MUBG XZZ XEUBQQ XGIUKEX MUBG PKAWIUHXUNIA NVUBCHV 12NV HUXWI XAW DI XUI SCQN QB HZXW NVXN XZZ EBCZW SBKA CQ NBWXO XAW DI DXAN NB NVXAP DXPIMKIZW MBU JIKAH QCEV XA BCNQNXAWKAH VBQN HKFI OBCUQIZFIQ X JKH UBCAW BM XLLZXCQI XAW NVI PIO KQ 640I11012805M211J0XJ24MM02X1IW09</span><br></pre></td></tr></table></figure>

<h3 id="2-9-2-解题思路"><a href="#2-9-2-解题思路" class="headerlink" title="2.9.2 解题思路"></a>2.9.2 解题思路</h3><p><strong>随机替换密码</strong>：使用 <a target="_blank" rel="noopener" href="http://quipqiup.com/">http://quipqiup.com/</a> 词频分析。</p>
<h3 id="2-9-3-解题脚本"><a href="#2-9-3-解题脚本" class="headerlink" title="2.9.3 解题脚本"></a>2.9.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib3</span><br><span class="line"></span><br><span class="line"><span class="comment"># 忽略 SSL 证书警告</span></span><br><span class="line">urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_with_quipqiup</span>(<span class="params">ciphertext: <span class="built_in">str</span>, clues: <span class="built_in">str</span>= <span class="string">&quot;&quot;</span></span>) -&gt; <span class="built_in">dict</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    使用 quipqiup.com 对替换加密密文进行自动解密。</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&quot;Accept&quot;</span>: <span class="string">&quot;*/*&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Accept-Language&quot;</span>: <span class="string">&quot;zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Content-type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Origin&quot;</span>: <span class="string">&quot;http://quipqiup.com&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Referer&quot;</span>: <span class="string">&quot;http://quipqiup.com/&quot;</span>,</span><br><span class="line">        <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0&quot;</span>,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    payload = &#123;</span><br><span class="line">        <span class="string">&quot;ciphertext&quot;</span>: ciphertext,</span><br><span class="line">        <span class="string">&quot;clues&quot;</span>: clues,</span><br><span class="line">        <span class="string">&quot;mode&quot;</span>: <span class="string">&quot;auto&quot;</span>,</span><br><span class="line">        <span class="string">&quot;was_auto&quot;</span>: <span class="literal">True</span>,</span><br><span class="line">        <span class="string">&quot;was_clue&quot;</span>: <span class="literal">False</span>,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 请求提交密文以开始解密</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = requests.post(<span class="string">&quot;http://quipqiup.com/solve&quot;</span>, headers=headers, json=payload, verify=<span class="literal">False</span>)</span><br><span class="line">        response.raise_for_status()</span><br><span class="line">        id_payload = &#123;<span class="string">&quot;id&quot;</span>: response.json().get(<span class="string">&quot;id&quot;</span>)&#125;</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;提交解密请求失败:&quot;</span>, e)</span><br><span class="line">        <span class="keyword">return</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 请求获取解密结果</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = requests.post(<span class="string">&quot;http://quipqiup.com/status&quot;</span>, headers=headers, json=id_payload, verify=<span class="literal">False</span>)</span><br><span class="line">        response.raise_for_status()</span><br><span class="line">        solutions = response.json().get(<span class="string">&quot;solutions&quot;</span>, [])</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;获取解密结果失败:&quot;</span>, e)</span><br><span class="line">        <span class="keyword">return</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 组织解密结果</span></span><br><span class="line">    result = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> solutions:</span><br><span class="line">        result[s[<span class="string">&quot;key&quot;</span>]] = s[<span class="string">&quot;plaintext&quot;</span>]</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    cipher = <span class="string">&quot;VIZZB IFIUOJBWO NVXAP OBC XZZ UKHVN IFIUOJBWO HB XVIXW XAW VXFI X QIXN VBD KQ IFIUOJBWO WBKAH NBWXO VBD XJBCN NKG QLKEIU DI XUI VIUI DKNV QNCWIANQ XN DXPIMKIZW VKHV QEVBBZ KA XUZKAHNBA FKUHKAKX XAW DI VXFI HBN QNCWIANQ NCAKAH KA MUBG XZZ XEUBQQ XGIUKEX MUBG PKAWIUHXUNIA NVUBCHV 12NV HUXWI XAW DI XUI SCQN QB HZXW NVXN XZZ EBCZW SBKA CQ NBWXO XAW DI DXAN NB NVXAP DXPIMKIZW MBU JIKAH QCEV XA BCNQNXAWKAH VBQN HKFI OBCUQIZFIQ X JKH UBCAW BM XLLZXCQI XAW NVI PIO KQ 640I11012805M211J0XJ24MM02X1IW09&quot;</span></span><br><span class="line">    result = decrypt_with_quipqiup(cipher)</span><br><span class="line">    <span class="keyword">for</span> key, text <span class="keyword">in</span> result.items():</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Key: <span class="subst">&#123;key&#125;</span>\nPlaintext: <span class="subst">&#123;text&#125;</span>\n&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    </span><br><span class="line">        <span class="comment"># flag&#123;640E11012805F211B0AB24FF02A1ED09&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="2-10-old-fashion"><a href="#2-10-old-fashion" class="headerlink" title="2.10 old-fashion"></a>2.10 old-fashion</h2><h3 id="2-10-1-题目"><a href="#2-10-1-题目" class="headerlink" title="2.10.1 题目"></a>2.10.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Os drnuzearyuwn, y jtkjzoztzoes douwlr oj y ilzwex eq lsdexosa kn pwodw tsozj eq ufyoszlbz yrl rlufydlx pozw douwlrzlbz, ydderxosa ze y rlatfyr jnjzli; mjy gfbmw vla xy wbfnsy symmyew (mjy vrwm qrvvrf), hlbew rd symmyew, mebhsymw rd symmyew, vbomgeyw rd mjy lxrzy, lfk wr dremj. Mjy eyqybzye kyqbhjyew mjy myom xa hyedrevbfn lf bfzyewy wgxwmbmgmbrf. Wr mjy dsln bw f1_2jyf-k3_jg1-vb-vl_l</span><br></pre></td></tr></table></figure>

<h3 id="2-10-2-解题思路"><a href="#2-10-2-解题思路" class="headerlink" title="2.10.2 解题思路"></a>2.10.2 解题思路</h3><p><strong>随机替换密码</strong>：使用 <a target="_blank" rel="noopener" href="http://quipqiup.com/">http://quipqiup.com/</a> 词频分析。</p>
<h3 id="2-10-3-解题脚本"><a href="#2-10-3-解题脚本" class="headerlink" title="2.10.3 解题脚本"></a>2.10.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib3</span><br><span class="line"></span><br><span class="line"><span class="comment"># 忽略 SSL 证书警告</span></span><br><span class="line">urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_with_quipqiup</span>(<span class="params">ciphertext: <span class="built_in">str</span>, clues: <span class="built_in">str</span>= <span class="string">&quot;&quot;</span></span>) -&gt; <span class="built_in">dict</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    使用 quipqiup.com 对替换加密密文进行自动解密。</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&quot;Accept&quot;</span>: <span class="string">&quot;*/*&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Accept-Language&quot;</span>: <span class="string">&quot;zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Content-type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Origin&quot;</span>: <span class="string">&quot;http://quipqiup.com&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Referer&quot;</span>: <span class="string">&quot;http://quipqiup.com/&quot;</span>,</span><br><span class="line">        <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0&quot;</span>,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    payload = &#123;</span><br><span class="line">        <span class="string">&quot;ciphertext&quot;</span>: ciphertext,</span><br><span class="line">        <span class="string">&quot;clues&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;mode&quot;</span>: <span class="string">&quot;auto&quot;</span>,</span><br><span class="line">        <span class="string">&quot;was_auto&quot;</span>: <span class="literal">True</span>,</span><br><span class="line">        <span class="string">&quot;was_clue&quot;</span>: <span class="literal">False</span>,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 请求提交密文以开始解密</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = requests.post(<span class="string">&quot;http://quipqiup.com/solve&quot;</span>, headers=headers, json=payload, verify=<span class="literal">False</span>)</span><br><span class="line">        response.raise_for_status()</span><br><span class="line">        id_payload = &#123;<span class="string">&quot;id&quot;</span>: response.json().get(<span class="string">&quot;id&quot;</span>)&#125;</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;提交解密请求失败:&quot;</span>, e)</span><br><span class="line">        <span class="keyword">return</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 请求获取解密结果</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = requests.post(<span class="string">&quot;http://quipqiup.com/status&quot;</span>, headers=headers, json=id_payload, verify=<span class="literal">False</span>)</span><br><span class="line">        response.raise_for_status()</span><br><span class="line">        solutions = response.json().get(<span class="string">&quot;solutions&quot;</span>, [])</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;获取解密结果失败:&quot;</span>, e)</span><br><span class="line">        <span class="keyword">return</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 组织解密结果</span></span><br><span class="line">    result = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> solutions:</span><br><span class="line">        result[s[<span class="string">&quot;key&quot;</span>]] = s[<span class="string">&quot;plaintext&quot;</span>]</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    cipher = <span class="string">&quot;Os drnuzearyuwn, y jtkjzoztzoes douwlr oj y ilzwex eq lsdexosa kn pwodw tsozj eq ufyoszlbz yrl rlufydlx pozw douwlrzlbz, ydderxosa ze y rlatfyr jnjzli; mjy gfbmw vla xy wbfnsy symmyew (mjy vrwm qrvvrf), hlbew rd symmyew, mebhsymw rd symmyew, vbomgeyw rd mjy lxrzy, lfk wr dremj. Mjy eyqybzye kyqbhjyew mjy myom xa hyedrevbfn lf bfzyewy wgxwmbmgmbrf. Wr mjy dsln bw f1_2jyf-k3_jg1-vb-vl_l&quot;</span></span><br><span class="line"></span><br><span class="line">    result = decrypt_with_quipqiup(cipher)</span><br><span class="line">    <span class="keyword">for</span> key, text <span class="keyword">in</span> result.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;flag&#x27;</span> <span class="keyword">in</span> text:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Key: <span class="subst">&#123;key&#125;</span>\nPlaintext: <span class="subst">&#123;text&#125;</span>\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># flag&#123;n1_2hen-d3_hu1-mi-ma_a&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="2-11-AFCTF2018-Morse"><a href="#2-11-AFCTF2018-Morse" class="headerlink" title="2.11 [AFCTF2018]Morse"></a>2.11 [AFCTF2018]Morse</h2><h3 id="2-11-1-题目"><a href="#2-11-1-题目" class="headerlink" title="2.11.1 题目"></a>2.11.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-..../.----/-..../-..../-..../...--/--.../....-/-..../-..../--.../-.../...--/.----/--.../...--/..---/--.../--.../....-/...../..-./--.../...--/...--/-----/...../..-./...--/...--/...--/....-/...--/...../--.../----./--.../-..</span><br></pre></td></tr></table></figure>

<h3 id="2-11-2-解题思路"><a href="#2-11-2-解题思路" class="headerlink" title="2.11.2 解题思路"></a>2.11.2 解题思路</h3><p><strong>Morse 密码</strong></p>
<h3 id="2-11-3-解题脚本"><a href="#2-11-3-解题脚本" class="headerlink" title="2.11.3 解题脚本"></a>2.11.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MorseCode</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;摩斯密码加解密类&quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># 字符到摩斯码映射表</span></span><br><span class="line">        <span class="variable language_">self</span>.char_to_morse = &#123;</span><br><span class="line">            <span class="string">&#x27;A&#x27;</span>: <span class="string">&#x27;.-&#x27;</span>, <span class="string">&#x27;B&#x27;</span>: <span class="string">&#x27;-...&#x27;</span>, <span class="string">&#x27;C&#x27;</span>: <span class="string">&#x27;-.-.&#x27;</span>, <span class="string">&#x27;D&#x27;</span>: <span class="string">&#x27;-..&#x27;</span>, <span class="string">&#x27;E&#x27;</span>: <span class="string">&#x27;.&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;F&#x27;</span>: <span class="string">&#x27;..-.&#x27;</span>, <span class="string">&#x27;G&#x27;</span>: <span class="string">&#x27;--.&#x27;</span>, <span class="string">&#x27;H&#x27;</span>: <span class="string">&#x27;....&#x27;</span>, <span class="string">&#x27;I&#x27;</span>: <span class="string">&#x27;..&#x27;</span>, <span class="string">&#x27;J&#x27;</span>: <span class="string">&#x27;.---&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;K&#x27;</span>: <span class="string">&#x27;-.-&#x27;</span>, <span class="string">&#x27;L&#x27;</span>: <span class="string">&#x27;.-..&#x27;</span>, <span class="string">&#x27;M&#x27;</span>: <span class="string">&#x27;--&#x27;</span>, <span class="string">&#x27;N&#x27;</span>: <span class="string">&#x27;-.&#x27;</span>, <span class="string">&#x27;O&#x27;</span>: <span class="string">&#x27;---&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;P&#x27;</span>: <span class="string">&#x27;.--.&#x27;</span>, <span class="string">&#x27;Q&#x27;</span>: <span class="string">&#x27;--.-&#x27;</span>, <span class="string">&#x27;R&#x27;</span>: <span class="string">&#x27;.-.&#x27;</span>, <span class="string">&#x27;S&#x27;</span>: <span class="string">&#x27;...&#x27;</span>, <span class="string">&#x27;T&#x27;</span>: <span class="string">&#x27;-&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;U&#x27;</span>: <span class="string">&#x27;..-&#x27;</span>, <span class="string">&#x27;V&#x27;</span>: <span class="string">&#x27;...-&#x27;</span>, <span class="string">&#x27;W&#x27;</span>: <span class="string">&#x27;.--&#x27;</span>, <span class="string">&#x27;X&#x27;</span>: <span class="string">&#x27;-..-&#x27;</span>, <span class="string">&#x27;Y&#x27;</span>: <span class="string">&#x27;-.--&#x27;</span>, <span class="string">&#x27;Z&#x27;</span>: <span class="string">&#x27;--..&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;0&#x27;</span>: <span class="string">&#x27;-----&#x27;</span>, <span class="string">&#x27;1&#x27;</span>: <span class="string">&#x27;.----&#x27;</span>, <span class="string">&#x27;2&#x27;</span>: <span class="string">&#x27;..---&#x27;</span>, <span class="string">&#x27;3&#x27;</span>: <span class="string">&#x27;...--&#x27;</span>, <span class="string">&#x27;4&#x27;</span>: <span class="string">&#x27;....-&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;5&#x27;</span>: <span class="string">&#x27;.....&#x27;</span>, <span class="string">&#x27;6&#x27;</span>: <span class="string">&#x27;-....&#x27;</span>, <span class="string">&#x27;7&#x27;</span>: <span class="string">&#x27;--...&#x27;</span>, <span class="string">&#x27;8&#x27;</span>: <span class="string">&#x27;---..&#x27;</span>, <span class="string">&#x27;9&#x27;</span>: <span class="string">&#x27;----.&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;.&#x27;</span>: <span class="string">&#x27;.-.-.-&#x27;</span>, <span class="string">&#x27;,&#x27;</span>: <span class="string">&#x27;--..--&#x27;</span>, <span class="string">&#x27;?&#x27;</span>: <span class="string">&#x27;..--..&#x27;</span>, <span class="string">&quot;&#x27;&quot;</span>: <span class="string">&#x27;.----.&#x27;</span>, <span class="string">&#x27;!&#x27;</span>: <span class="string">&#x27;-.-.--&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;/&#x27;</span>: <span class="string">&#x27;-..-.&#x27;</span>, <span class="string">&#x27;(&#x27;</span>: <span class="string">&#x27;-.--.&#x27;</span>, <span class="string">&#x27;)&#x27;</span>: <span class="string">&#x27;-.--.-&#x27;</span>, <span class="string">&#x27;&amp;&#x27;</span>: <span class="string">&#x27;.-...&#x27;</span>, <span class="string">&#x27;:&#x27;</span>: <span class="string">&#x27;---...&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;;&#x27;</span>: <span class="string">&#x27;-.-.-.&#x27;</span>, <span class="string">&#x27;=&#x27;</span>: <span class="string">&#x27;-...-&#x27;</span>, <span class="string">&#x27;+&#x27;</span>: <span class="string">&#x27;.-.-.&#x27;</span>, <span class="string">&#x27;-&#x27;</span>: <span class="string">&#x27;-....-&#x27;</span>, <span class="string">&#x27;_&#x27;</span>: <span class="string">&#x27;..--.-&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;&quot;&#x27;</span>: <span class="string">&#x27;.-..-.&#x27;</span>, <span class="string">&#x27;$&#x27;</span>: <span class="string">&#x27;...-..-&#x27;</span>, <span class="string">&#x27;@&#x27;</span>: <span class="string">&#x27;.--.-.&#x27;</span>, <span class="string">&#x27; &#x27;</span>: <span class="string">&#x27;/&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"># 摩斯码到字符的反向映射</span></span><br><span class="line">        <span class="variable language_">self</span>.morse_to_char = &#123;v: k <span class="keyword">for</span> k, v <span class="keyword">in</span> <span class="variable language_">self</span>.char_to_morse.items()&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self, text: <span class="built_in">str</span>, interval: <span class="built_in">str</span> = <span class="string">&#x27; &#x27;</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;将普通文本加密为摩斯密码&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> interval.join(</span><br><span class="line">            <span class="variable language_">self</span>.char_to_morse.get(char.upper(), char) <span class="keyword">for</span> char <span class="keyword">in</span> text</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">self, morse_code: <span class="built_in">str</span>, interval: <span class="built_in">str</span> = <span class="string">&#x27; &#x27;</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;将摩斯密码解密为普通文本&quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># 用空格分割每个摩斯字符</span></span><br><span class="line">        morse_list = morse_code.strip().split(interval)</span><br><span class="line">        decoded_chars = []</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> code <span class="keyword">in</span> morse_list:</span><br><span class="line">            <span class="keyword">if</span> code == <span class="string">&#x27;/&#x27;</span>:  <span class="comment"># 单词分隔符</span></span><br><span class="line">                decoded_chars.append(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                decoded_chars.append(<span class="variable language_">self</span>.morse_to_char.get(code, code))  <span class="comment"># 转换或保留原样</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(decoded_chars)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    ciphertext = <span class="string">&quot;-..../.----/-..../-..../-..../...--/--.../....-/-..../-..../--.../-.../...--/.----/--.../...--/..---/--.../--.../....-/...../..-./--.../...--/...--/-----/...../..-./...--/...--/...--/....-/...--/...../--.../----./--.../-..&quot;</span></span><br><span class="line">    decrypted = MorseCode().decrypt(ciphertext, <span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;解密: <span class="subst">&#123;ciphertext&#125;</span> → <span class="subst">&#123;decrypted&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(decrypted))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># b&quot;afctf&#123;1s&#x27;t_s0_345y&#125;&quot;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="2-12-GXYCTF2019-CheckIn"><a href="#2-12-GXYCTF2019-CheckIn" class="headerlink" title="2.12 [GXYCTF2019]CheckIn"></a>2.12 [GXYCTF2019]CheckIn</h2><h3 id="2-12-1-题目"><a href="#2-12-1-题目" class="headerlink" title="2.12.1 题目"></a>2.12.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dikqTCpfRjA8fUBIMD5GNDkwMjNARkUwI0BFTg==</span><br></pre></td></tr></table></figure>

<h3 id="2-12-2-解题思路"><a href="#2-12-2-解题思路" class="headerlink" title="2.12.2 解题思路"></a>2.12.2 解题思路</h3><p>Base64 编码 + ROT47</p>
<h3 id="2-12-3-解题脚本"><a href="#2-12-3-解题脚本" class="headerlink" title="2.12.3 解题脚本"></a>2.12.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RotCipher</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ROT系列加密算法实现（支持ROT3/5/10/13/18/47/ROT-5/ROT-6）&quot;&quot;&quot;</span></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_rotate_char</span>(<span class="params">char: <span class="built_in">str</span>, base: <span class="built_in">int</span>, shift: <span class="built_in">int</span>, range_size: <span class="built_in">int</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;对单个字符进行指定偏移量的 ROT 加密/解密&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> char.isspace():  <span class="comment"># 跳过空白字符</span></span><br><span class="line">            char_code = <span class="built_in">ord</span>(char)</span><br><span class="line">            <span class="keyword">if</span> base &lt;= char_code &lt; base + range_size:</span><br><span class="line">                <span class="comment"># 计算旋转后的字符代码</span></span><br><span class="line">                char_code = (char_code - base + shift) % range_size + base</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">chr</span>(char_code)</span><br><span class="line">        <span class="keyword">return</span> char</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">rot47</span>(<span class="params">text: <span class="built_in">str</span>, decrypt: <span class="built_in">bool</span> = <span class="literal">False</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;执行 ROT47 加密/解密（ASCII 33-126 旋转47位）&quot;&quot;&quot;</span></span><br><span class="line">        shift = -<span class="number">47</span> <span class="keyword">if</span> decrypt <span class="keyword">else</span> <span class="number">47</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(RotCipher._rotate_char(c, <span class="number">33</span>, shift, <span class="number">94</span>) <span class="keyword">for</span> c <span class="keyword">in</span> text)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    ct = <span class="string">b&quot;dikqTCpfRjA8fUBIMD5GNDkwMjNARkUwI0BFTg==&quot;</span></span><br><span class="line">    msg = b64decode(ct).decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(RotCipher.rot47(msg))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># GXY&#123;Y0u_kNow_much_about_Rot&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="2-13-Cipher"><a href="#2-13-Cipher" class="headerlink" title="2.13 Cipher"></a>2.13 Cipher</h2><h3 id="2-13-1-题目"><a href="#2-13-1-题目" class="headerlink" title="2.13.1 题目"></a>2.13.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">还能提示什么呢？公平的玩吧（密钥自己找） Dncnoqqfliqrpgeklwmppu </span><br></pre></td></tr></table></figure>

<h3 id="2-13-2-解题思路"><a href="#2-13-2-解题思路" class="headerlink" title="2.13.2 解题思路"></a>2.13.2 解题思路</h3><p><strong>Playfair 密码</strong>（key &#x3D; <code>playfair</code>）</p>
<h3 id="2-13-3-解题脚本"><a href="#2-13-3-解题脚本" class="headerlink" title="2.13.3 解题脚本"></a>2.13.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Optional</span>, <span class="type">Tuple</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Playfair</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, key: <span class="type">Optional</span>[<span class="built_in">str</span>] = <span class="literal">None</span></span>):</span><br><span class="line">        <span class="variable language_">self</span>._init_matrix(key)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_init_matrix</span>(<span class="params">self, key: <span class="built_in">str</span></span>):</span><br><span class="line">        key = (key <span class="keyword">or</span> <span class="string">&quot;&quot;</span>).upper().replace(<span class="string">&quot;J&quot;</span>, <span class="string">&quot;I&quot;</span>)</span><br><span class="line">        letters = <span class="string">&quot;ABCDEFGHIKLMNOPQRSTUVWXYZ&quot;</span>       <span class="comment"># 去掉 J</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 去重并保留顺序：先 key 再剩余字母</span></span><br><span class="line">        sequence = []</span><br><span class="line">        <span class="keyword">for</span> ch <span class="keyword">in</span> key + letters:</span><br><span class="line">            <span class="keyword">if</span> ch.isalpha() <span class="keyword">and</span> ch <span class="keyword">not</span> <span class="keyword">in</span> sequence:</span><br><span class="line">                sequence.append(ch)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 构造 5x5 矩阵</span></span><br><span class="line">        <span class="variable language_">self</span>.matrix = [sequence[i:i+<span class="number">5</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">25</span>, <span class="number">5</span>)]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_find</span>(<span class="params">self, ch: <span class="built_in">str</span></span>) -&gt; <span class="type">Tuple</span>[<span class="built_in">int</span>, <span class="built_in">int</span>]:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        查找字符在矩阵中的行列索引</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">for</span> r, row <span class="keyword">in</span> <span class="built_in">enumerate</span>(<span class="variable language_">self</span>.matrix):</span><br><span class="line">            <span class="keyword">if</span> ch <span class="keyword">in</span> row:</span><br><span class="line">                <span class="keyword">return</span> r, row.index(ch)</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">f&quot;字符 <span class="subst">&#123;ch&#125;</span> 不在矩阵中&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_preprocess</span>(<span class="params">self, text: <span class="built_in">str</span></span>) -&gt; <span class="built_in">list</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        预处理明文：去空格、大写、替换 J-&gt;I，按规则分组</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        src = text.upper().replace(<span class="string">&quot; &quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;J&quot;</span>, <span class="string">&quot;I&quot;</span>)</span><br><span class="line">        pairs = []</span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> i &lt; <span class="built_in">len</span>(src):</span><br><span class="line">            a = src[i]</span><br><span class="line">            b = src[i+<span class="number">1</span>] <span class="keyword">if</span> i+<span class="number">1</span> &lt; <span class="built_in">len</span>(src) <span class="keyword">else</span> <span class="string">&#x27;X&#x27;</span></span><br><span class="line">            <span class="comment"># 同字符或末尾补 X</span></span><br><span class="line">            <span class="keyword">if</span> a == b:</span><br><span class="line">                pairs.append((a, <span class="string">&#x27;X&#x27;</span>))</span><br><span class="line">                i += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                pairs.append((a, b))</span><br><span class="line">                i += <span class="number">2</span></span><br><span class="line">        <span class="comment"># 若最后剩单字符，则补 X</span></span><br><span class="line">        <span class="keyword">if</span> pairs <span class="keyword">and</span> <span class="built_in">len</span>(pairs[-<span class="number">1</span>]) == <span class="number">1</span>:</span><br><span class="line">            pairs[-<span class="number">1</span>] = (pairs[-<span class="number">1</span>][<span class="number">0</span>], <span class="string">&#x27;X&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> pairs</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_transform</span>(<span class="params">self, a: <span class="built_in">str</span>, b: <span class="built_in">str</span>, mode: <span class="built_in">int</span> = <span class="number">1</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        核心变换：mode=1 加密右下移，mode=-1 解密左上移</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        r1, c1 = <span class="variable language_">self</span>._find(a)</span><br><span class="line">        r2, c2 = <span class="variable language_">self</span>._find(b)</span><br><span class="line">        <span class="comment"># 同行：左右移动</span></span><br><span class="line">        <span class="keyword">if</span> r1 == r2:</span><br><span class="line">            <span class="keyword">return</span> (<span class="variable language_">self</span>.matrix[r1][(c1 + mode) % <span class="number">5</span>] +</span><br><span class="line">                    <span class="variable language_">self</span>.matrix[r2][(c2 + mode) % <span class="number">5</span>])</span><br><span class="line">        <span class="comment"># 同列：上下移动</span></span><br><span class="line">        <span class="keyword">if</span> c1 == c2:</span><br><span class="line">            <span class="keyword">return</span> (<span class="variable language_">self</span>.matrix[(r1 + mode) % <span class="number">5</span>][c1] +</span><br><span class="line">                    <span class="variable language_">self</span>.matrix[(r2 + mode) % <span class="number">5</span>][c2])</span><br><span class="line">        <span class="comment"># 矩形对角交换列索引</span></span><br><span class="line">        <span class="keyword">return</span> (<span class="variable language_">self</span>.matrix[r1][c2] + <span class="variable language_">self</span>.matrix[r2][c1])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self, plaintext: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        加密明文，并返回密文字符串</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        pairs = <span class="variable language_">self</span>._preprocess(plaintext)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(<span class="variable language_">self</span>._transform(a, b, mode=<span class="number">1</span>) <span class="keyword">for</span> a, b <span class="keyword">in</span> pairs)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">self, ciphertext: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        解密密文，并返回去填充后的明文</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># 分组：每两个字符一对</span></span><br><span class="line">        ciphertext = ciphertext.upper()</span><br><span class="line">        pairs = [(ciphertext[i], ciphertext[i+<span class="number">1</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(ciphertext), <span class="number">2</span>)]</span><br><span class="line">        raw = <span class="string">&#x27;&#x27;</span>.join(<span class="variable language_">self</span>._transform(a, b, mode=-<span class="number">1</span>) <span class="keyword">for</span> a, b <span class="keyword">in</span> pairs)</span><br><span class="line">        <span class="comment"># 去掉填充 X</span></span><br><span class="line">        <span class="keyword">return</span> raw.replace(<span class="string">&#x27;X&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    pf = Playfair(<span class="string">&#x27;playfair&#x27;</span>)</span><br><span class="line">    pt = pf.decrypt(<span class="string">&#x27;Dncnoqqfliqrpgeklwmppu&#x27;</span>).lower()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;flag&#123;&#123;<span class="subst">&#123;pt&#125;</span>&#125;&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># flag&#123;itisnotaproblemhavefun&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="2-14-robomunication"><a href="#2-14-robomunication" class="headerlink" title="2.14 robomunication"></a>2.14 robomunication</h2><h3 id="2-14-1-题目"><a href="#2-14-1-题目" class="headerlink" title="2.14.1 题目"></a>2.14.1 题目</h3><p>摩斯密码音频：<code>.... . .-.. .-.. --- .-- .... .- - .. ... - .... . -.- . -.-- .. - .. ... -... --- --- .--. -... . . .--.</code></p>
<h3 id="2-14-2-解题思路"><a href="#2-14-2-解题思路" class="headerlink" title="2.14.2 解题思路"></a>2.14.2 解题思路</h3><p><strong>Morse 密码</strong></p>
<h3 id="2-14-3-解题脚本"><a href="#2-14-3-解题脚本" class="headerlink" title="2.14.3 解题脚本"></a>2.14.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MorseCode</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;摩斯密码加解密类&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># 字符到摩斯码映射表</span></span><br><span class="line">        <span class="variable language_">self</span>.char_to_morse = &#123;</span><br><span class="line">            <span class="string">&#x27;A&#x27;</span>: <span class="string">&#x27;.-&#x27;</span>, <span class="string">&#x27;B&#x27;</span>: <span class="string">&#x27;-...&#x27;</span>, <span class="string">&#x27;C&#x27;</span>: <span class="string">&#x27;-.-.&#x27;</span>, <span class="string">&#x27;D&#x27;</span>: <span class="string">&#x27;-..&#x27;</span>, <span class="string">&#x27;E&#x27;</span>: <span class="string">&#x27;.&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;F&#x27;</span>: <span class="string">&#x27;..-.&#x27;</span>, <span class="string">&#x27;G&#x27;</span>: <span class="string">&#x27;--.&#x27;</span>, <span class="string">&#x27;H&#x27;</span>: <span class="string">&#x27;....&#x27;</span>, <span class="string">&#x27;I&#x27;</span>: <span class="string">&#x27;..&#x27;</span>, <span class="string">&#x27;J&#x27;</span>: <span class="string">&#x27;.---&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;K&#x27;</span>: <span class="string">&#x27;-.-&#x27;</span>, <span class="string">&#x27;L&#x27;</span>: <span class="string">&#x27;.-..&#x27;</span>, <span class="string">&#x27;M&#x27;</span>: <span class="string">&#x27;--&#x27;</span>, <span class="string">&#x27;N&#x27;</span>: <span class="string">&#x27;-.&#x27;</span>, <span class="string">&#x27;O&#x27;</span>: <span class="string">&#x27;---&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;P&#x27;</span>: <span class="string">&#x27;.--.&#x27;</span>, <span class="string">&#x27;Q&#x27;</span>: <span class="string">&#x27;--.-&#x27;</span>, <span class="string">&#x27;R&#x27;</span>: <span class="string">&#x27;.-.&#x27;</span>, <span class="string">&#x27;S&#x27;</span>: <span class="string">&#x27;...&#x27;</span>, <span class="string">&#x27;T&#x27;</span>: <span class="string">&#x27;-&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;U&#x27;</span>: <span class="string">&#x27;..-&#x27;</span>, <span class="string">&#x27;V&#x27;</span>: <span class="string">&#x27;...-&#x27;</span>, <span class="string">&#x27;W&#x27;</span>: <span class="string">&#x27;.--&#x27;</span>, <span class="string">&#x27;X&#x27;</span>: <span class="string">&#x27;-..-&#x27;</span>, <span class="string">&#x27;Y&#x27;</span>: <span class="string">&#x27;-.--&#x27;</span>, <span class="string">&#x27;Z&#x27;</span>: <span class="string">&#x27;--..&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;0&#x27;</span>: <span class="string">&#x27;-----&#x27;</span>, <span class="string">&#x27;1&#x27;</span>: <span class="string">&#x27;.----&#x27;</span>, <span class="string">&#x27;2&#x27;</span>: <span class="string">&#x27;..---&#x27;</span>, <span class="string">&#x27;3&#x27;</span>: <span class="string">&#x27;...--&#x27;</span>, <span class="string">&#x27;4&#x27;</span>: <span class="string">&#x27;....-&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;5&#x27;</span>: <span class="string">&#x27;.....&#x27;</span>, <span class="string">&#x27;6&#x27;</span>: <span class="string">&#x27;-....&#x27;</span>, <span class="string">&#x27;7&#x27;</span>: <span class="string">&#x27;--...&#x27;</span>, <span class="string">&#x27;8&#x27;</span>: <span class="string">&#x27;---..&#x27;</span>, <span class="string">&#x27;9&#x27;</span>: <span class="string">&#x27;----.&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;.&#x27;</span>: <span class="string">&#x27;.-.-.-&#x27;</span>, <span class="string">&#x27;,&#x27;</span>: <span class="string">&#x27;--..--&#x27;</span>, <span class="string">&#x27;?&#x27;</span>: <span class="string">&#x27;..--..&#x27;</span>, <span class="string">&quot;&#x27;&quot;</span>: <span class="string">&#x27;.----.&#x27;</span>, <span class="string">&#x27;!&#x27;</span>: <span class="string">&#x27;-.-.--&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;/&#x27;</span>: <span class="string">&#x27;-..-.&#x27;</span>, <span class="string">&#x27;(&#x27;</span>: <span class="string">&#x27;-.--.&#x27;</span>, <span class="string">&#x27;)&#x27;</span>: <span class="string">&#x27;-.--.-&#x27;</span>, <span class="string">&#x27;&amp;&#x27;</span>: <span class="string">&#x27;.-...&#x27;</span>, <span class="string">&#x27;:&#x27;</span>: <span class="string">&#x27;---...&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;;&#x27;</span>: <span class="string">&#x27;-.-.-.&#x27;</span>, <span class="string">&#x27;=&#x27;</span>: <span class="string">&#x27;-...-&#x27;</span>, <span class="string">&#x27;+&#x27;</span>: <span class="string">&#x27;.-.-.&#x27;</span>, <span class="string">&#x27;-&#x27;</span>: <span class="string">&#x27;-....-&#x27;</span>, <span class="string">&#x27;_&#x27;</span>: <span class="string">&#x27;..--.-&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;&quot;&#x27;</span>: <span class="string">&#x27;.-..-.&#x27;</span>, <span class="string">&#x27;$&#x27;</span>: <span class="string">&#x27;...-..-&#x27;</span>, <span class="string">&#x27;@&#x27;</span>: <span class="string">&#x27;.--.-.&#x27;</span>, <span class="string">&#x27; &#x27;</span>: <span class="string">&#x27;/&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"># 摩斯码到字符的反向映射</span></span><br><span class="line">        <span class="variable language_">self</span>.morse_to_char = &#123;v: k <span class="keyword">for</span> k, v <span class="keyword">in</span> <span class="variable language_">self</span>.char_to_morse.items()&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self, text: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;将普通文本加密为摩斯密码&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27; &#x27;</span>.join(</span><br><span class="line">            <span class="variable language_">self</span>.char_to_morse.get(char.upper(), char) <span class="keyword">for</span> char <span class="keyword">in</span> text</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">self, morse_code: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;将摩斯密码解密为普通文本&quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># 用空格分割每个摩斯字符</span></span><br><span class="line">        morse_list = morse_code.strip().split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">        decoded_chars = []</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> code <span class="keyword">in</span> morse_list:</span><br><span class="line">            <span class="keyword">if</span> code == <span class="string">&#x27;/&#x27;</span>:  <span class="comment"># 单词分隔符</span></span><br><span class="line">                decoded_chars.append(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                decoded_chars.append(<span class="variable language_">self</span>.morse_to_char.get(code, code))  <span class="comment"># 转换或保留原样</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(decoded_chars)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    ciphertext = <span class="string">&quot;.... . .-.. .-.. --- .-- .... .- - .. ... - .... . -.- . -.-- .. - .. ... -... --- --- .--. -... . . .--.&quot;</span></span><br><span class="line">    decrypted = MorseCode().decrypt(ciphertext)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;解密: <span class="subst">&#123;ciphertext&#125;</span> → <span class="subst">&#123;decrypted&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># flag&#123;HELLOWHATISTHEKEYITISBOOPBEEP&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="2-15-MRCTF2020-古典密码知多少"><a href="#2-15-MRCTF2020-古典密码知多少" class="headerlink" title="2.15 [MRCTF2020]古典密码知多少"></a>2.15 [MRCTF2020]古典密码知多少</h2><h3 id="2-15-1-题目"><a href="#2-15-1-题目" class="headerlink" title="2.15.1 题目"></a>2.15.1 题目</h3><center><img src=https://dstbp.com/data/imgs/posts/buuctf/古典密码知多少.png width="600"></center>

<h3 id="2-15-2-解题思路"><a href="#2-15-2-解题思路" class="headerlink" title="2.15.2 解题思路"></a>2.15.2 解题思路</h3><p>猪圈密码 + 圣堂武士密码 + 标准银河字母 + 栅栏密码（key&#x3D;3）</p>
<h3 id="2-15-3-解题脚本"><a href="#2-15-3-解题脚本" class="headerlink" title="2.15.3 解题脚本"></a>2.15.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 猪圈密码 + 圣堂武士密码 + 标准银河字母 得到：fgcpflirtuasyon</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Railfence</span>:</span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">message, key=<span class="literal">None</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        加密函数：实现 Rail Fence Cipher 的分段加密。</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> key <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            ciphertext = <span class="string">&#x27;&#x27;</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(key):</span><br><span class="line">                ciphertext += message[i::key]</span><br><span class="line">            <span class="keyword">return</span> ciphertext</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># 遍历 key 从 2 到 12</span></span><br><span class="line">            results = &#123;&#125;</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="number">13</span>):</span><br><span class="line">                ciphertext = <span class="string">&#x27;&#x27;</span></span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">                    ciphertext += message[i::k]</span><br><span class="line">                results[k] = ciphertext</span><br><span class="line">            <span class="keyword">return</span> results</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">ciphertext, key=<span class="literal">None</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        解密函数：根据密文和密钥 key 还原原文。</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> key <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            plaintext = <span class="string">&#x27;&#x27;</span></span><br><span class="line">            row_length = math.ceil(<span class="built_in">len</span>(ciphertext) / key)</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(row_length):</span><br><span class="line">                plaintext += ciphertext[i::row_length]</span><br><span class="line">            <span class="keyword">return</span> plaintext</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># 遍历 key 从 2 到 16</span></span><br><span class="line">            results = &#123;&#125;</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="number">17</span>):</span><br><span class="line">                row_length = math.ceil(<span class="built_in">len</span>(ciphertext) / k)</span><br><span class="line">                plaintext = <span class="string">&#x27;&#x27;</span></span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(row_length):</span><br><span class="line">                    plaintext += ciphertext[i::row_length]</span><br><span class="line">                results[k] = plaintext</span><br><span class="line">            <span class="keyword">return</span> results</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    ciphertext = <span class="string">r&quot;fgcpflirtuasyon&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="number">17</span>):</span><br><span class="line">        pt = Railfence.decrypt(ciphertext, i)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;flag&#x27;</span> <span class="keyword">in</span> pt:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;flag&#123;&#123;<span class="subst">&#123;pt&#125;</span>&#125;&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># flag&#123;flagiscryptofun&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="2-16-WUSTCTF2020-佛说：只能四天"><a href="#2-16-WUSTCTF2020-佛说：只能四天" class="headerlink" title="2.16 [WUSTCTF2020]佛说：只能四天"></a>2.16 [WUSTCTF2020]佛说：只能四天</h2><h3 id="2-16-1-题目"><a href="#2-16-1-题目" class="headerlink" title="2.16.1 题目"></a>2.16.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 题目描述.txt</span></span><br><span class="line">圣经分为《旧约全书》和《新约全书》</span><br><span class="line"></span><br><span class="line"><span class="comment"># hint.txt</span></span><br><span class="line"><span class="number">1.</span> 虽然有点不环保，但hint好像是一次性的，得到后就没有利用价值了。</span><br><span class="line"><span class="number">2.</span> 凯撒不是最后一步，by the way，凯撒为什么叫做凯撒？</span><br><span class="line"></span><br><span class="line"><span class="comment"># 题目.txt</span></span><br><span class="line">尊即寂修我劫修如婆愍闍嚤婆莊愍耨羅嚴是喼婆斯吶眾喼修迦慧迦嚩喼斯願嚤摩隸所迦摩吽即塞願修咒莊波斯訶喃壽祗僧若即亦嘇蜜迦須色喼羅囉咒諦若陀喃慧愍夷羅波若劫蜜斯哆咒塞隸蜜波哆咤慧聞亦吽念彌諸嘚嚴諦咒陀叻咤叻諦缽隸祗婆諦嚩阿兜宣囉吽色缽吶諸劫婆咤咤喼愍尊寂色缽嘚闍兜阿婆若叻般壽聞彌即念若降宣空陀壽愍嚤亦喼寂僧迦色莊壽吽哆尊僧喼喃壽嘚兜我空所吶般所即諸吽薩咤諸莊囉隸般咤色空咤亦喃亦色兜哆嘇亦隸空闍修眾哆咒婆菩迦壽薩塞宣嚩缽寂夷摩所修囉菩阿伏嘚宣嚩薩塞菩波吶波菩哆若慧愍蜜訶壽色咒兜摩缽摩諦劫諸陀即壽所波咤聞如訶摩壽宣咤彌即嚩蜜叻劫嘇缽所摩闍壽波壽劫修訶如嚩嘇囉薩色嚤薩壽修闍夷闍是壽僧劫祗蜜嚴嚩我若空伏諦念降若心吽咤隸嘚耨缽伏吽色寂喃喼吽壽夷若心眾祗喃慧嚴即聞空僧須夷嚴叻心願哆波隸塞吶心須嘇摩咤壽嘚吶夷亦心亦喃若咒壽亦壽囑囑</span><br></pre></td></tr></table></figure>

<h3 id="2-16-2-解题思路"><a href="#2-16-2-解题思路" class="headerlink" title="2.16.2 解题思路"></a>2.16.2 解题思路</h3><p>新佛曰密码 + 社会主义核心价值观加密 + 栅栏密码（key&#x3D;4） + 凯撒密码（key&#x3D;3） + Base32</p>
<h3 id="2-16-3-解题脚本"><a href="#2-16-3-解题脚本" class="headerlink" title="2.16.3 解题脚本"></a>2.16.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># http://www.pcmoe.net/article-89-1.html</span></span><br><span class="line"><span class="comment"># 新佛曰密码网站失效，等待后续开源，这里直接用前人的 wp 假装已经解出佛曰加密。</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> parse</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">List</span></span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Optional</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ChineseCoreSocialistValues</span>:</span><br><span class="line">    VALUE = <span class="string">&#x27;富强民主文明和谐自由平等公正法治爱国敬业诚信友善&#x27;</span>      <span class="comment"># 映射的中文字符，每两个字符编码一个数值（0~15）</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_to_url_hex</span>(<span class="params">inp: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;step1：将字符串转为 URL 编码后去掉 &#x27;%&#x27; 并转为大写十六进制&quot;&quot;&quot;</span></span><br><span class="line">        reg = re.<span class="built_in">compile</span>(<span class="string">r&#x27;[A-Za-z0-9\-\_\.\!\~\*\&#x27;\(\)]&#x27;</span>)</span><br><span class="line">        <span class="comment"># 非保留字符转换为十六进制，其它保留</span></span><br><span class="line">        tmp = reg.sub(<span class="keyword">lambda</span> g: <span class="built_in">hex</span>(<span class="built_in">ord</span>(g.group(<span class="number">0</span>)))[<span class="number">2</span>:], inp)</span><br><span class="line">        <span class="keyword">return</span> parse.quote(tmp).replace(<span class="string">&#x27;%&#x27;</span>, <span class="string">&#x27;&#x27;</span>).upper()</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_hex_to_int_sequence</span>(<span class="params">hex_str: <span class="built_in">str</span></span>) -&gt; <span class="type">List</span>[<span class="built_in">int</span>]:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;step2：将十六进制字符串转为整数序列（0~15），带编码标记&quot;&quot;&quot;</span></span><br><span class="line">        result = []</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> hex_str:</span><br><span class="line">            v = <span class="built_in">int</span>(c, <span class="number">16</span>)</span><br><span class="line">            <span class="keyword">if</span> v &lt; <span class="number">10</span>:</span><br><span class="line">                result.append(v)</span><br><span class="line">            <span class="keyword">elif</span> random.random() &lt; <span class="number">0.5</span>:</span><br><span class="line">                result.extend([<span class="number">11</span>, v - <span class="number">6</span>])  <span class="comment"># 标记11：值为 v = x + 6</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                result.extend([<span class="number">10</span>, v - <span class="number">10</span>])  <span class="comment"># 标记10：值为 v = x + 10</span></span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_int_sequence_to_chinese</span>(<span class="params">cls, seq: <span class="type">List</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;step3：将整数序列转为中文字符序列（每2字符表示1数值）&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(cls.VALUE[v &lt;&lt; <span class="number">1</span>] + cls.VALUE[v &lt;&lt; <span class="number">1</span> | <span class="number">1</span>] <span class="keyword">for</span> v <span class="keyword">in</span> seq)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">cls, text: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;完整加密过程：明文 -&gt; URL Hex -&gt; 编码序列 -&gt; 中文&quot;&quot;&quot;</span></span><br><span class="line">        hex_str = cls._to_url_hex(text)</span><br><span class="line">        seq = cls._hex_to_int_sequence(hex_str)</span><br><span class="line">        <span class="keyword">return</span> cls._int_sequence_to_chinese(seq)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_chinese_to_int_sequence</span>(<span class="params">cls, enc: <span class="built_in">str</span></span>) -&gt; <span class="type">List</span>[<span class="built_in">int</span>]:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;step6：中文密文转整数序列&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">assert</span> <span class="built_in">len</span>(enc) % <span class="number">2</span> == <span class="number">0</span></span><br><span class="line">        <span class="keyword">return</span> [cls.VALUE.index(enc[i:i+<span class="number">2</span>]) &gt;&gt; <span class="number">1</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(enc), <span class="number">2</span>)]</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_int_sequence_to_hex</span>(<span class="params">seq: <span class="type">List</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;step5：整数序列还原为十六进制字符串&quot;&quot;&quot;</span></span><br><span class="line">        result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> i &lt; <span class="built_in">len</span>(seq):</span><br><span class="line">            <span class="keyword">if</span> seq[i] &lt; <span class="number">10</span>:</span><br><span class="line">                result += <span class="built_in">str</span>(seq[i])</span><br><span class="line">                i += <span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> seq[i] == <span class="number">10</span>:</span><br><span class="line">                result += <span class="built_in">hex</span>(seq[i + <span class="number">1</span>] + <span class="number">10</span>)[<span class="number">2</span>:]</span><br><span class="line">                i += <span class="number">2</span></span><br><span class="line">            <span class="keyword">elif</span> seq[i] == <span class="number">11</span>:</span><br><span class="line">                result += <span class="built_in">hex</span>(seq[i + <span class="number">1</span>] + <span class="number">6</span>)[<span class="number">2</span>:]</span><br><span class="line">                i += <span class="number">2</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">f&#x27;非法数据：<span class="subst">&#123;seq[i]&#125;</span>&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_hex_to_text</span>(<span class="params">hex_str: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;step4：十六进制字符串还原为明文&quot;&quot;&quot;</span></span><br><span class="line">        percent_encoded = <span class="string">&#x27;&#x27;</span>.join(<span class="string">&#x27;%&#x27;</span> + hex_str[i:i+<span class="number">2</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(hex_str), <span class="number">2</span>))</span><br><span class="line">        <span class="keyword">return</span> parse.unquote(percent_encoded)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">cls, enc: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;完整解密过程：中文 -&gt; 编码序列 -&gt; hex -&gt; 明文&quot;&quot;&quot;</span></span><br><span class="line">        seq = cls._chinese_to_int_sequence(enc)</span><br><span class="line">        hex_str = cls._int_sequence_to_hex(seq)</span><br><span class="line">        <span class="keyword">return</span> cls._hex_to_text(hex_str)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Railfence</span>:</span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">message, key=<span class="literal">None</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        加密函数：实现 Rail Fence Cipher 的分段加密。</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> key <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            ciphertext = <span class="string">&#x27;&#x27;</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(key):</span><br><span class="line">                ciphertext += message[i::key]</span><br><span class="line">            <span class="keyword">return</span> ciphertext</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># 遍历 key 从 2 到 12</span></span><br><span class="line">            results = &#123;&#125;</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="number">13</span>):</span><br><span class="line">                ciphertext = <span class="string">&#x27;&#x27;</span></span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">                    ciphertext += message[i::k]</span><br><span class="line">                results[k] = ciphertext</span><br><span class="line">            <span class="keyword">return</span> results</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">ciphertext, key=<span class="literal">None</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        解密函数：根据密文和密钥 key 还原原文。</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> key <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            plaintext = <span class="string">&#x27;&#x27;</span></span><br><span class="line">            row_length = math.ceil(<span class="built_in">len</span>(ciphertext) / key)</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(row_length):</span><br><span class="line">                plaintext += ciphertext[i::row_length]</span><br><span class="line">            <span class="keyword">return</span> plaintext</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># 遍历 key 从 2 到 16</span></span><br><span class="line">            results = &#123;&#125;</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="number">17</span>):</span><br><span class="line">                row_length = math.ceil(<span class="built_in">len</span>(ciphertext) / k)</span><br><span class="line">                plaintext = <span class="string">&#x27;&#x27;</span></span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(row_length):</span><br><span class="line">                    plaintext += ciphertext[i::row_length]</span><br><span class="line">                results[k] = plaintext</span><br><span class="line">            <span class="keyword">return</span> results</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RotCipher</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ROT系列加密算法实现（支持ROT3/5/10/13/18/47/ROT-5/ROT-6）&quot;&quot;&quot;</span></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_rotate_char</span>(<span class="params">char: <span class="built_in">str</span>, base: <span class="built_in">int</span>, shift: <span class="built_in">int</span>, range_size: <span class="built_in">int</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;对单个字符进行指定偏移量的 ROT 加密/解密&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> char.isspace():  <span class="comment"># 跳过空白字符</span></span><br><span class="line">            char_code = <span class="built_in">ord</span>(char)</span><br><span class="line">            <span class="keyword">if</span> base &lt;= char_code &lt; base + range_size:</span><br><span class="line">                <span class="comment"># 计算旋转后的字符代码</span></span><br><span class="line">                char_code = (char_code - base + shift) % range_size + base</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">chr</span>(char_code)</span><br><span class="line">        <span class="keyword">return</span> char</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">shift_cipher</span>(<span class="params">text: <span class="built_in">str</span>, offset: <span class="built_in">int</span> = <span class="literal">None</span>, alphabet: <span class="built_in">str</span> = <span class="literal">None</span></span>) -&gt; <span class="built_in">dict</span> | <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        通用移位密码实现</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> alphabet <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="comment"># 默认使用标准字母表（大小写字母）</span></span><br><span class="line">            alphabet_upper = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span></span><br><span class="line">            alphabet_lower = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> offset <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                result = []</span><br><span class="line">                <span class="keyword">for</span> c <span class="keyword">in</span> text:</span><br><span class="line">                    <span class="keyword">if</span> c.isupper():</span><br><span class="line">                        idx = (alphabet_upper.index(c) + offset) % <span class="number">26</span></span><br><span class="line">                        result.append(alphabet_upper[idx])</span><br><span class="line">                    <span class="keyword">elif</span> c.islower():</span><br><span class="line">                        idx = (alphabet_lower.index(c) + offset) % <span class="number">26</span></span><br><span class="line">                        result.append(alphabet_lower[idx])</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        result.append(c)</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(result)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                results = &#123;&#125;</span><br><span class="line">                <span class="keyword">for</span> o <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">27</span>):  <span class="comment"># 字母表长度为26</span></span><br><span class="line">                    results[o] = RotCipher.shift_cipher(text, o, alphabet)</span><br><span class="line">                <span class="keyword">return</span> results</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># 使用自定义字符表</span></span><br><span class="line">            <span class="keyword">if</span> offset <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                result = []</span><br><span class="line">                <span class="keyword">for</span> c <span class="keyword">in</span> text:</span><br><span class="line">                    <span class="keyword">if</span> c <span class="keyword">in</span> alphabet:</span><br><span class="line">                        idx = (alphabet.index(c) + offset) % <span class="built_in">len</span>(alphabet)</span><br><span class="line">                        result.append(alphabet[idx])</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        result.append(c)  <span class="comment"># 不在字符表中的字符保持不变</span></span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(result)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                results = &#123;&#125;</span><br><span class="line">                <span class="keyword">for</span> o <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(alphabet)):</span><br><span class="line">                    results[o] = RotCipher.shift_cipher(text, o, alphabet)</span><br><span class="line">                <span class="keyword">return</span> results</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BaseXEncoder</span>:</span><br><span class="line">    <span class="comment"># 常见进制的编码表</span></span><br><span class="line">    STANDARD_TABLES = &#123;</span><br><span class="line">        <span class="number">16</span>: <span class="string">b&quot;0123456789ABCDEF&quot;</span>,</span><br><span class="line">        <span class="number">32</span>: <span class="string">b&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ234567&quot;</span>,</span><br><span class="line">        <span class="number">58</span>: <span class="string">b&quot;123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz&quot;</span>,</span><br><span class="line">        <span class="number">62</span>: <span class="string">b&quot;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&quot;</span>,</span><br><span class="line">        <span class="number">64</span>: <span class="string">b&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&quot;</span>,</span><br><span class="line">        <span class="number">91</span>: <span class="string">b&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!#$%&amp;()*+,./:;&lt;=&gt;?@[]^_`&#123;|&#125;~\&quot;&quot;</span>,</span><br><span class="line">        <span class="number">92</span>: <span class="string">b&quot;!\&quot;#$%&amp;&#x27;()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz&#123;|&#125;~&quot;</span>,</span><br><span class="line">        <span class="number">128</span>: <span class="built_in">bytes</span>(<span class="built_in">range</span>(<span class="number">128</span>)),  <span class="comment"># 每个字节本身</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encode</span>(<span class="params">self, data: <span class="built_in">bytes</span>, base: <span class="built_in">int</span>, table: <span class="type">Optional</span>[<span class="built_in">bytes</span>] = <span class="literal">None</span>, padding: <span class="type">Optional</span>[<span class="built_in">bytes</span>] = <span class="string">b&quot;=&quot;</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        编码函数：支持 base16, base32, base64, base58, base62, base91, base92, base128</span></span><br><span class="line"><span class="string">        :param data: 待编码的原始字节数据</span></span><br><span class="line"><span class="string">        :param base: 编码使用的进制</span></span><br><span class="line"><span class="string">        :param table: 自定义编码表（可选）</span></span><br><span class="line"><span class="string">        :param padding: 指定填充字符（如 b&#x27;=&#x27;），传 None 表示不加填充</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        table = table <span class="keyword">or</span> <span class="variable language_">self</span>.STANDARD_TABLES.get(base)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 标准 base 编码（内置支持填充）</span></span><br><span class="line">        <span class="keyword">if</span> base == <span class="number">16</span>:</span><br><span class="line">            encoded = base64.b16encode(data).translate(<span class="built_in">bytes</span>.maketrans(<span class="string">b&quot;0123456789ABCDEF&quot;</span>, table))</span><br><span class="line">        <span class="keyword">elif</span> base == <span class="number">32</span>:</span><br><span class="line">            encoded = base64.b32encode(data).translate(<span class="built_in">bytes</span>.maketrans(<span class="variable language_">self</span>.STANDARD_TABLES[<span class="number">32</span>], table))</span><br><span class="line">        <span class="keyword">elif</span> base == <span class="number">64</span>:</span><br><span class="line">            encoded = base64.b64encode(data).translate(<span class="built_in">bytes</span>.maketrans(<span class="variable language_">self</span>.STANDARD_TABLES[<span class="number">64</span>], table))</span><br><span class="line">        <span class="keyword">elif</span> base <span class="keyword">in</span> (<span class="number">58</span>, <span class="number">62</span>, <span class="number">91</span>, <span class="number">92</span>, <span class="number">128</span>):  <span class="comment"># 自定义 baseX 编码</span></span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">self</span>._baseX_encode(data, table).decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f&quot;Unsupported base: <span class="subst">&#123;base&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 处理填充字符</span></span><br><span class="line">        <span class="keyword">if</span> padding <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            encoded = encoded.rstrip(<span class="string">b&quot;=&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> padding != <span class="string">b&quot;=&quot;</span>:</span><br><span class="line">            encoded = encoded.rstrip(<span class="string">b&quot;=&quot;</span>).replace(<span class="string">b&quot;=&quot;</span>, padding)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> encoded.decode(<span class="string">&quot;utf8&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decode</span>(<span class="params">self, ciphertext: <span class="built_in">str</span>, base: <span class="built_in">int</span>, table: <span class="type">Optional</span>[<span class="built_in">bytes</span>] = <span class="literal">None</span>, padding: <span class="type">Optional</span>[<span class="built_in">bytes</span>] = <span class="string">b&quot;=&quot;</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        解码函数：对应 encode 函数的逆过程</span></span><br><span class="line"><span class="string">        :param ciphertext: 加密后的字符串</span></span><br><span class="line"><span class="string">        :param base: 使用的进制</span></span><br><span class="line"><span class="string">        :param table: 使用的编码表</span></span><br><span class="line"><span class="string">        :param padding: 填充字符（如 b&#x27;=&#x27;），传 None 表示密文无填充</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        encoded = ciphertext.encode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">        table = table <span class="keyword">or</span> <span class="variable language_">self</span>.STANDARD_TABLES.get(base)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> base <span class="keyword">in</span> (<span class="number">58</span>, <span class="number">62</span>, <span class="number">91</span>, <span class="number">92</span>, <span class="number">128</span>):</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">self</span>._baseX_decode(encoded, table)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 恢复 padding</span></span><br><span class="line">        <span class="keyword">if</span> padding <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> padding != <span class="string">b&quot;=&quot;</span>:</span><br><span class="line">            encoded = encoded.replace(padding, <span class="string">b&quot;=&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 计算并自动补足 base32/base64 所需的 padding 长度</span></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">pad_base</span>(<span class="params">data: <span class="built_in">bytes</span>, block_size: <span class="built_in">int</span> = <span class="number">8</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">            pad_len = (-<span class="built_in">len</span>(data)) % block_size</span><br><span class="line">            <span class="keyword">return</span> data + <span class="string">b&#x27;=&#x27;</span> * pad_len</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> base == <span class="number">16</span>:</span><br><span class="line">            <span class="keyword">return</span> base64.b16decode(encoded.translate(<span class="built_in">bytes</span>.maketrans(table, <span class="string">b&quot;0123456789ABCDEF&quot;</span>)))</span><br><span class="line">        <span class="keyword">elif</span> base == <span class="number">32</span>:</span><br><span class="line">            padded = pad_base(encoded)  <span class="comment"># base32 长度必须为 8 的倍数</span></span><br><span class="line">            <span class="keyword">return</span> base64.b32decode(padded.translate(<span class="built_in">bytes</span>.maketrans(table, <span class="variable language_">self</span>.STANDARD_TABLES[<span class="number">32</span>])))</span><br><span class="line">        <span class="keyword">elif</span> base == <span class="number">64</span>:</span><br><span class="line">            padded = pad_base(encoded, block_size=<span class="number">4</span>)  <span class="comment"># base64 长度必须为 4 的倍数</span></span><br><span class="line">            <span class="keyword">return</span> base64.b64decode(padded.translate(<span class="built_in">bytes</span>.maketrans(table, <span class="variable language_">self</span>.STANDARD_TABLES[<span class="number">64</span>])))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f&quot;Unsupported base: <span class="subst">&#123;base&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_baseX_encode</span>(<span class="params">self, data: <span class="built_in">bytes</span>, table: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        自定义 baseX 编码（如 base58/base62）：将字节数据按目标进制编码为字符表中的字符序列</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        num = <span class="built_in">int</span>.from_bytes(data, byteorder=<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">        base = <span class="built_in">len</span>(table)</span><br><span class="line">        encoded = <span class="built_in">bytearray</span>()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> num &gt; <span class="number">0</span>:</span><br><span class="line">            num, rem = <span class="built_in">divmod</span>(num, base)</span><br><span class="line">            encoded.insert(<span class="number">0</span>, table[rem])</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 前导 0 用 table[0] 表示</span></span><br><span class="line">        pad = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> data:</span><br><span class="line">            <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">                pad += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">bytes</span>([table[<span class="number">0</span>]]) * pad + <span class="built_in">bytes</span>(encoded)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_baseX_decode</span>(<span class="params">self, encoded: <span class="built_in">bytes</span>, table: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        自定义 baseX 解码：将字符序列转换回原始字节数据</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        base = <span class="built_in">len</span>(table)</span><br><span class="line">        index = &#123;char: i <span class="keyword">for</span> i, char <span class="keyword">in</span> <span class="built_in">enumerate</span>(table)&#125;</span><br><span class="line">        num = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> char <span class="keyword">in</span> encoded:</span><br><span class="line">            num = num * base + index[char]</span><br><span class="line"></span><br><span class="line">        decoded = num.to_bytes((num.bit_length() + <span class="number">7</span>) // <span class="number">8</span>, byteorder=<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 处理前导 0</span></span><br><span class="line">        pad = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> encoded:</span><br><span class="line">            <span class="keyword">if</span> c == table[<span class="number">0</span>]:</span><br><span class="line">                pad += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">b&#x27;\x00&#x27;</span> * pad + decoded</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    encoder = BaseXEncoder()</span><br><span class="line">    ct = <span class="string">&#x27;平等文明自由友善公正自由诚信富强自由自由平等民主平等自由自由友善敬业平等公正平等富强平等自由平等民主和谐公正自由诚信平等和谐公正公正自由法治平等法治法治法治和谐和谐平等自由和谐自由自由和谐公正自由敬业自由文明和谐平等自由文明和谐平等和谐文明自由和谐自由和谐和谐平等和谐法治公正诚信平等公正诚信民主自由和谐公正民主平等平等平等平等自由和谐和谐和谐平等和谐自由诚信平等和谐自由自由友善敬业平等和谐自由友善敬业平等法治自由法治和谐和谐自由友善公正法治敬业公正友善爱国公正民主法治文明自由民主平等公正自由法治平等文明平等友善自由平等和谐自由友善自由平等文明自由民主自由平等平等敬业自由平等平等诚信富强平等友善敬业公正诚信平等公正友善敬业公正平等平等诚信平等公正自由公正诚信平等法治敬业公正诚信平等法治平等公正友善平等公正诚信自由公正友善敬业法治法治公正公正公正平等公正诚信自由公正和谐公正平等&#x27;</span></span><br><span class="line">    dec1 = ChineseCoreSocialistValues.decrypt(ct)</span><br><span class="line">    dec2 = Railfence.decrypt(dec1[:<span class="number">71</span>])</span><br><span class="line">    dec3 = RotCipher.shift_cipher(dec2[<span class="number">4</span>][:<span class="number">55</span>])</span><br><span class="line">    flag = encoder.decode(dec3[<span class="number">23</span>], <span class="number">32</span>, padding=<span class="string">b&quot;=&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># b&#x27;wctf2020&#123;ni_hao_xiang_xiang_da_wo&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="2-17-rot"><a href="#2-17-rot" class="headerlink" title="2.17 rot"></a>2.17 rot</h2><h3 id="2-17-1-题目"><a href="#2-17-1-题目" class="headerlink" title="2.17.1 题目"></a>2.17.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">破解下面的密文：</span><br><span class="line"></span><br><span class="line"><span class="number">83</span> <span class="number">89</span> <span class="number">78</span> <span class="number">84</span> <span class="number">45</span> <span class="number">86</span> <span class="number">96</span> <span class="number">45</span> <span class="number">115</span> <span class="number">121</span> <span class="number">110</span> <span class="number">116</span> <span class="number">136</span> <span class="number">132</span> <span class="number">132</span> <span class="number">132</span> <span class="number">108</span> <span class="number">128</span> <span class="number">117</span> <span class="number">118</span> <span class="number">134</span> <span class="number">110</span> <span class="number">123</span> <span class="number">111</span> <span class="number">110</span> <span class="number">127</span> <span class="number">108</span> <span class="number">112</span> <span class="number">124</span> <span class="number">122</span> <span class="number">108</span> <span class="number">118</span> <span class="number">128</span> <span class="number">108</span> <span class="number">131</span> <span class="number">114</span> <span class="number">127</span> <span class="number">134</span> <span class="number">108</span> <span class="number">116</span> <span class="number">124</span> <span class="number">124</span> <span class="number">113</span> <span class="number">108</span> <span class="number">76</span> <span class="number">76</span> <span class="number">76</span> <span class="number">76</span> <span class="number">138</span> <span class="number">23</span> <span class="number">90</span> <span class="number">81</span> <span class="number">66</span> <span class="number">71</span> <span class="number">64</span> <span class="number">69</span> <span class="number">114</span> <span class="number">65</span> <span class="number">112</span> <span class="number">64</span> <span class="number">66</span> <span class="number">63</span> <span class="number">69</span> <span class="number">61</span> <span class="number">70</span> <span class="number">114</span> <span class="number">62</span> <span class="number">66</span> <span class="number">61</span> <span class="number">62</span> <span class="number">69</span> <span class="number">67</span> <span class="number">70</span> <span class="number">63</span> <span class="number">61</span> <span class="number">110</span> <span class="number">110</span> <span class="number">112</span> <span class="number">64</span> <span class="number">68</span> <span class="number">62</span> <span class="number">70</span> <span class="number">61</span> <span class="number">112</span> <span class="number">111</span> <span class="number">112</span></span><br><span class="line"></span><br><span class="line">flag格式flag&#123;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-17-2-解题思路"><a href="#2-17-2-解题思路" class="headerlink" title="2.17.2 解题思路"></a>2.17.2 解题思路</h3><p>ROT-13 + MD5 爆破</p>
<h3 id="2-17-3-解题脚本"><a href="#2-17-3-解题脚本" class="headerlink" title="2.17.3 解题脚本"></a>2.17.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">from</span> gmssl <span class="keyword">import</span> sm3</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Union</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RotCipher</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ROT系列加密算法实现（支持ROT3/5/10/13/18/47/ROT-5/ROT-6）&quot;&quot;&quot;</span></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_rotate_char</span>(<span class="params">char: <span class="built_in">str</span>, base: <span class="built_in">int</span>, shift: <span class="built_in">int</span>, range_size: <span class="built_in">int</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;对单个字符进行指定偏移量的 ROT 加密/解密&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> char.isspace():  <span class="comment"># 跳过空白字符</span></span><br><span class="line">            char_code = <span class="built_in">ord</span>(char)</span><br><span class="line">            <span class="keyword">if</span> base &lt;= char_code &lt; base + range_size:</span><br><span class="line">                <span class="comment"># 计算旋转后的字符代码</span></span><br><span class="line">                char_code = (char_code - base + shift) % range_size + base</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">chr</span>(char_code)</span><br><span class="line">        <span class="keyword">return</span> char</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">shift_cipher</span>(<span class="params">text: <span class="built_in">str</span>, offset: <span class="built_in">int</span> = <span class="literal">None</span>, alphabet: <span class="built_in">str</span> = <span class="literal">None</span></span>) -&gt; <span class="built_in">dict</span> | <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        通用移位密码实现</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> alphabet <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="comment"># 默认使用标准字母表（大小写字母）</span></span><br><span class="line">            alphabet_upper = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span></span><br><span class="line">            alphabet_lower = <span class="string">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> offset <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                result = []</span><br><span class="line">                <span class="keyword">for</span> c <span class="keyword">in</span> text:</span><br><span class="line">                    <span class="keyword">if</span> c.isupper():</span><br><span class="line">                        idx = (alphabet_upper.index(c) + offset) % <span class="number">26</span></span><br><span class="line">                        result.append(alphabet_upper[idx])</span><br><span class="line">                    <span class="keyword">elif</span> c.islower():</span><br><span class="line">                        idx = (alphabet_lower.index(c) + offset) % <span class="number">26</span></span><br><span class="line">                        result.append(alphabet_lower[idx])</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        result.append(c)</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(result)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                results = &#123;&#125;</span><br><span class="line">                <span class="keyword">for</span> o <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">27</span>):  <span class="comment"># 字母表长度为26</span></span><br><span class="line">                    results[o] = RotCipher.shift_cipher(text, o, alphabet)</span><br><span class="line">                <span class="keyword">return</span> results</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># 使用自定义字符表</span></span><br><span class="line">            <span class="keyword">if</span> offset <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                result = []</span><br><span class="line">                <span class="keyword">for</span> c <span class="keyword">in</span> text:</span><br><span class="line">                    <span class="keyword">if</span> c <span class="keyword">in</span> alphabet:</span><br><span class="line">                        idx = (alphabet.index(c) + offset) % <span class="built_in">len</span>(alphabet)</span><br><span class="line">                        result.append(alphabet[idx])</span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        result.append(c)  <span class="comment"># 不在字符表中的字符保持不变</span></span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(result)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                results = &#123;&#125;</span><br><span class="line">                <span class="keyword">for</span> o <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(alphabet)):</span><br><span class="line">                    results[o] = RotCipher.shift_cipher(text, o, alphabet)</span><br><span class="line">                <span class="keyword">return</span> results</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hash_data</span>(<span class="params">data: <span class="type">Union</span>[<span class="built_in">bytes</span>, <span class="built_in">str</span>], algorithm: <span class="built_in">str</span>, output_type: <span class="built_in">str</span> = <span class="string">&quot;hex&quot;</span>, hash_length: <span class="built_in">int</span> = <span class="literal">None</span>, hex_case: <span class="built_in">str</span> = <span class="string">&quot;lower&quot;</span></span>) -&gt; <span class="built_in">tuple</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    计算数据的哈希值，支持多种算法和输出类型</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 统一转换为字节类型（兼容字符串输入）</span></span><br><span class="line">    data_bytes = data.encode(<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">if</span> <span class="built_in">isinstance</span>(data, <span class="built_in">str</span>) <span class="keyword">else</span> data</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 计算哈希值及长度</span></span><br><span class="line">    <span class="keyword">match</span> algorithm.lower():</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;sha256&quot;</span> | <span class="string">&quot;md5&quot;</span> | <span class="string">&quot;sha1&quot;</span>:</span><br><span class="line">            hasher = hashlib.new(algorithm, data_bytes)</span><br><span class="line">            digest = hasher.digest()</span><br><span class="line">            original_length = hasher.digest_size</span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;sm3&quot;</span>:</span><br><span class="line">            hex_digest = sm3.sm3_hash(<span class="built_in">list</span>(data_bytes))  <span class="comment"># gmssl返回十六进制字符串</span></span><br><span class="line">            digest = <span class="built_in">bytes</span>.fromhex(hex_digest)           <span class="comment"># 转换为字节</span></span><br><span class="line">            original_length = <span class="number">32</span>                         <span class="comment"># SM3固定32字节</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> _:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f&quot;不支持的算法: <span class="subst">&#123;algorithm&#125;</span>（支持：sha256/md5/sha1/sm3）&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 长度控制</span></span><br><span class="line">    <span class="keyword">if</span> hash_length <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(hash_length, <span class="built_in">int</span>) <span class="keyword">or</span> hash_length &lt;= <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;hash_length必须是正整数&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> hash_length &gt; original_length:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f&quot;长度超出限制（最大<span class="subst">&#123;original_length&#125;</span>字节）&quot;</span>)</span><br><span class="line">        digest = digest[:hash_length]  <span class="comment"># 截断字节串</span></span><br><span class="line">        actual_length = hash_length</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        actual_length = original_length  <span class="comment"># 不截断时使用原始长度</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 转换输出类型</span></span><br><span class="line">    <span class="keyword">match</span> output_type.lower():</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;bytes&quot;</span>:</span><br><span class="line">            result = digest</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;hex&quot;</span>:</span><br><span class="line">            hex_str = digest.<span class="built_in">hex</span>()</span><br><span class="line">            <span class="comment"># 十六进制大小写转换</span></span><br><span class="line">            result = hex_str.upper() <span class="keyword">if</span> hex_case.lower() == <span class="string">&quot;upper&quot;</span> <span class="keyword">else</span> hex_str.lower()</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;int&quot;</span>:</span><br><span class="line">            result = <span class="built_in">int</span>.from_bytes(digest, byteorder=<span class="string">&quot;big&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> _:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f&quot;不支持的输出类型: <span class="subst">&#123;output_type&#125;</span>（支持：bytes/hex/int）&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result, actual_length</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    ct = [<span class="number">83</span>, <span class="number">89</span>, <span class="number">78</span>, <span class="number">84</span>, <span class="number">45</span>, <span class="number">86</span>, <span class="number">96</span>, <span class="number">45</span>, <span class="number">115</span>, <span class="number">121</span>, <span class="number">110</span>, <span class="number">116</span>, <span class="number">136</span>, <span class="number">132</span>, <span class="number">132</span>, <span class="number">132</span>, <span class="number">108</span>, <span class="number">128</span>, <span class="number">117</span>, <span class="number">118</span>, <span class="number">134</span>, <span class="number">110</span>, <span class="number">123</span>, <span class="number">111</span>, <span class="number">110</span>, <span class="number">127</span>, <span class="number">108</span>, <span class="number">112</span>, <span class="number">124</span>, <span class="number">122</span>, <span class="number">108</span>, <span class="number">118</span>, <span class="number">128</span>, <span class="number">108</span>, <span class="number">131</span>, <span class="number">114</span>, <span class="number">127</span>, <span class="number">134</span>, <span class="number">108</span>, <span class="number">116</span>, <span class="number">124</span>, <span class="number">124</span>, <span class="number">113</span>, <span class="number">108</span>, <span class="number">76</span>, <span class="number">76</span>, <span class="number">76</span>, <span class="number">76</span>, <span class="number">138</span>, <span class="number">23</span>, <span class="number">90</span>, <span class="number">81</span>, <span class="number">66</span>, <span class="number">71</span>, <span class="number">64</span>, <span class="number">69</span>, <span class="number">114</span>, <span class="number">65</span>, <span class="number">112</span>, <span class="number">64</span>, <span class="number">66</span>, <span class="number">63</span>, <span class="number">69</span>, <span class="number">61</span>, <span class="number">70</span>, <span class="number">114</span>, <span class="number">62</span>, <span class="number">66</span>, <span class="number">61</span>, <span class="number">62</span>, <span class="number">69</span>, <span class="number">67</span>, <span class="number">70</span>, <span class="number">63</span>, <span class="number">61</span>, <span class="number">110</span>, <span class="number">110</span>, <span class="number">112</span>, <span class="number">64</span>, <span class="number">68</span>, <span class="number">62</span>, <span class="number">70</span>, <span class="number">61</span>, <span class="number">112</span>, <span class="number">111</span>, <span class="number">112</span>]</span><br><span class="line">    res = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">chr</span>, ct))</span><br><span class="line">    all_ascii_chars = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">    <span class="built_in">print</span>(RotCipher.shift_cipher(res, -<span class="number">13</span>, all_ascii_chars))</span><br><span class="line">    <span class="comment"># FLAG IS flag&#123;www_shiyanbar_com_is_very_good_????&#125;</span></span><br><span class="line">    <span class="comment"># MD5:38e4c352809e150186920aac37190cbc</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> chars <span class="keyword">in</span> itertools.product(<span class="built_in">map</span>(<span class="built_in">chr</span>, <span class="built_in">range</span>(<span class="number">32</span>, <span class="number">127</span>)), repeat=<span class="number">4</span>):</span><br><span class="line">        m = <span class="string">&#x27;flag&#123;www_shiyanbar_com_is_very_good_&#x27;</span> + <span class="string">&#x27;&#x27;</span>.join(chars) + <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line">        des, _ = hash_data(m, <span class="string">&#x27;md5&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;38e4c352809e150186920aac37190cbc&#x27;</span> == des:</span><br><span class="line">            <span class="built_in">print</span>(m)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># flag&#123;www_shiyanbar_com_is_very_good_@8Mu&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="2-18-MRCTF2020-天干地支-甲子"><a href="#2-18-MRCTF2020-天干地支-甲子" class="headerlink" title="2.18 [MRCTF2020]天干地支+甲子"></a>2.18 [MRCTF2020]天干地支+甲子</h2><h3 id="2-18-1-题目"><a href="#2-18-1-题目" class="headerlink" title="2.18.1 题目"></a>2.18.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">得到得字符串用MRCTF&#123;&#125;包裹</span><br><span class="line">一天Eki收到了一封来自Sndav的信，但是他有点迷希望您来解决一下</span><br><span class="line">甲戌</span><br><span class="line">甲寅</span><br><span class="line">甲寅</span><br><span class="line">癸卯</span><br><span class="line">己酉 </span><br><span class="line">甲寅</span><br><span class="line">辛丑</span><br></pre></td></tr></table></figure>

<h3 id="2-18-2-解题思路"><a href="#2-18-2-解题思路" class="headerlink" title="2.18.2 解题思路"></a>2.18.2 解题思路</h3><p>天干地支加密</p>
<h3 id="2-18-3-解题脚本"><a href="#2-18-3-解题脚本" class="headerlink" title="2.18.3 解题脚本"></a>2.18.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, inverse, GCD, bytes_to_long</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">tiangan_dizhi</span>:</span><br><span class="line">    ganzhi_dict = &#123;</span><br><span class="line">        <span class="number">1</span>: <span class="string">&quot;甲子&quot;</span>, <span class="number">2</span>: <span class="string">&quot;乙丑&quot;</span>, <span class="number">3</span>: <span class="string">&quot;丙寅&quot;</span>, <span class="number">4</span>: <span class="string">&quot;丁卯&quot;</span>, <span class="number">5</span>: <span class="string">&quot;戊辰&quot;</span>,</span><br><span class="line">        <span class="number">6</span>: <span class="string">&quot;己巳&quot;</span>, <span class="number">7</span>: <span class="string">&quot;庚午&quot;</span>, <span class="number">8</span>: <span class="string">&quot;辛未&quot;</span>, <span class="number">9</span>: <span class="string">&quot;壬申&quot;</span>, <span class="number">10</span>: <span class="string">&quot;癸酉&quot;</span>,</span><br><span class="line">        <span class="number">11</span>: <span class="string">&quot;甲戌&quot;</span>, <span class="number">12</span>: <span class="string">&quot;乙亥&quot;</span>, <span class="number">13</span>: <span class="string">&quot;丙子&quot;</span>, <span class="number">14</span>: <span class="string">&quot;丁丑&quot;</span>, <span class="number">15</span>: <span class="string">&quot;戊寅&quot;</span>,</span><br><span class="line">        <span class="number">16</span>: <span class="string">&quot;己卯&quot;</span>, <span class="number">17</span>: <span class="string">&quot;庚辰&quot;</span>, <span class="number">18</span>: <span class="string">&quot;辛巳&quot;</span>, <span class="number">19</span>: <span class="string">&quot;壬午&quot;</span>, <span class="number">20</span>: <span class="string">&quot;癸未&quot;</span>,</span><br><span class="line">        <span class="number">21</span>: <span class="string">&quot;甲申&quot;</span>, <span class="number">22</span>: <span class="string">&quot;乙酉&quot;</span>, <span class="number">23</span>: <span class="string">&quot;丙戌&quot;</span>, <span class="number">24</span>: <span class="string">&quot;丁亥&quot;</span>, <span class="number">25</span>: <span class="string">&quot;戊子&quot;</span>,</span><br><span class="line">        <span class="number">26</span>: <span class="string">&quot;己丑&quot;</span>, <span class="number">27</span>: <span class="string">&quot;庚寅&quot;</span>, <span class="number">28</span>: <span class="string">&quot;辛卯&quot;</span>, <span class="number">29</span>: <span class="string">&quot;壬辰&quot;</span>, <span class="number">30</span>: <span class="string">&quot;癸巳&quot;</span>,</span><br><span class="line">        <span class="number">31</span>: <span class="string">&quot;甲午&quot;</span>, <span class="number">32</span>: <span class="string">&quot;乙未&quot;</span>, <span class="number">33</span>: <span class="string">&quot;丙申&quot;</span>, <span class="number">34</span>: <span class="string">&quot;丁酉&quot;</span>, <span class="number">35</span>: <span class="string">&quot;戊戌&quot;</span>,</span><br><span class="line">        <span class="number">36</span>: <span class="string">&quot;己亥&quot;</span>, <span class="number">37</span>: <span class="string">&quot;庚子&quot;</span>, <span class="number">38</span>: <span class="string">&quot;辛丑&quot;</span>, <span class="number">39</span>: <span class="string">&quot;壬寅&quot;</span>, <span class="number">40</span>: <span class="string">&quot;癸卯&quot;</span>,</span><br><span class="line">        <span class="number">41</span>: <span class="string">&quot;甲辰&quot;</span>, <span class="number">42</span>: <span class="string">&quot;乙巳&quot;</span>, <span class="number">43</span>: <span class="string">&quot;丙午&quot;</span>, <span class="number">44</span>: <span class="string">&quot;丁未&quot;</span>, <span class="number">45</span>: <span class="string">&quot;戊申&quot;</span>,</span><br><span class="line">        <span class="number">46</span>: <span class="string">&quot;己酉&quot;</span>, <span class="number">47</span>: <span class="string">&quot;庚戌&quot;</span>, <span class="number">48</span>: <span class="string">&quot;辛亥&quot;</span>, <span class="number">49</span>: <span class="string">&quot;壬子&quot;</span>, <span class="number">50</span>: <span class="string">&quot;癸丑&quot;</span>,</span><br><span class="line">        <span class="number">51</span>: <span class="string">&quot;甲寅&quot;</span>, <span class="number">52</span>: <span class="string">&quot;乙卯&quot;</span>, <span class="number">53</span>: <span class="string">&quot;丙辰&quot;</span>, <span class="number">54</span>: <span class="string">&quot;丁巳&quot;</span>, <span class="number">55</span>: <span class="string">&quot;戊午&quot;</span>,</span><br><span class="line">        <span class="number">56</span>: <span class="string">&quot;己未&quot;</span>, <span class="number">57</span>: <span class="string">&quot;庚申&quot;</span>, <span class="number">58</span>: <span class="string">&quot;辛酉&quot;</span>, <span class="number">59</span>: <span class="string">&quot;壬戌&quot;</span>, <span class="number">60</span>: <span class="string">&quot;癸亥&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    reverse_dict = &#123;v: k <span class="keyword">for</span> k, v <span class="keyword">in</span> ganzhi_dict.items()&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">cls, ganzhi_list</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        将干支列表转换为对应的数字列表</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        result = []</span><br><span class="line">        <span class="keyword">for</span> item <span class="keyword">in</span> ganzhi_list:</span><br><span class="line">            <span class="keyword">if</span> item <span class="keyword">in</span> cls.reverse_dict:</span><br><span class="line">                result.append(cls.reverse_dict[item])</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">f&quot;无效的干支字符串: <span class="subst">&#123;item&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">cls, number_list</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        将数字列表转换为对应的干支列表</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        result = []</span><br><span class="line">        <span class="keyword">for</span> num <span class="keyword">in</span> number_list:</span><br><span class="line">            <span class="keyword">if</span> <span class="number">1</span> &lt;= num &lt;= <span class="number">60</span>:</span><br><span class="line">                result.append(cls.ganzhi_dict[num])</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">f&quot;数字超出范围 (1-60): <span class="subst">&#123;num&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    encrypted = tiangan_dizhi.decrypt([<span class="string">&quot;甲戌&quot;</span>, <span class="string">&quot;甲寅&quot;</span>, <span class="string">&quot;甲寅&quot;</span>, <span class="string">&quot;癸卯&quot;</span>, <span class="string">&quot;己酉&quot;</span>, <span class="string">&quot;甲寅&quot;</span>, <span class="string">&quot;辛丑&quot;</span>])</span><br><span class="line">    msg1 = <span class="string">&quot;&quot;</span>.join([<span class="built_in">chr</span>(i + <span class="number">60</span>) <span class="keyword">for</span> i <span class="keyword">in</span> encrypted])</span><br><span class="line">    <span class="built_in">print</span>(msg1)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># flag&#123;Goodjob&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="2-19-NCTF2019-Keyboard"><a href="#2-19-NCTF2019-Keyboard" class="headerlink" title="2.19 [NCTF2019]Keyboard"></a>2.19 [NCTF2019]Keyboard</h2><h3 id="2-19-1-题目"><a href="#2-19-1-题目" class="headerlink" title="2.19.1 题目"></a>2.19.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ooo yyy ii w uuu ee uuuu yyy uuuu y w uuu i i rr w i i rr rrr uuuu rrr uuuu t ii uuuu i w u rrr ee www ee yyy eee www w tt ee</span><br></pre></td></tr></table></figure>

<h3 id="2-19-2-解题思路"><a href="#2-19-2-解题思路" class="headerlink" title="2.19.2 解题思路"></a>2.19.2 解题思路</h3><p><strong>九键键盘密码</strong>（特点：字母组合中每组字符位数为 1 至 4 位不等）</p>
<h3 id="2-19-3-解题脚本"><a href="#2-19-3-解题脚本" class="headerlink" title="2.19.3 解题脚本"></a>2.19.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">T9_password</span>(<span class="params">cipher: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    解码 T9 九键密码（支持数字或字母输入）</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    table = [<span class="string">&quot; &quot;</span>, <span class="string">&quot; &quot;</span>, <span class="string">&quot;abc&quot;</span>, <span class="string">&quot;def&quot;</span>, <span class="string">&quot;ghi&quot;</span>, <span class="string">&quot;jkl&quot;</span>, <span class="string">&quot;mno&quot;</span>, <span class="string">&quot;pqrs&quot;</span>, <span class="string">&quot;tuv&quot;</span>, <span class="string">&quot;wxyz&quot;</span>]</span><br><span class="line">    base = <span class="string">&quot; qwertyuiop&quot;</span></span><br><span class="line">    result = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> part <span class="keyword">in</span> cipher.split():</span><br><span class="line">        key_index = <span class="built_in">int</span>(part[<span class="number">0</span>]) <span class="keyword">if</span> part.isdigit() <span class="keyword">else</span> base.index(part[<span class="number">0</span>])</span><br><span class="line">        char_index = <span class="built_in">len</span>(part) - <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> <span class="number">0</span> &lt;= key_index &lt; <span class="built_in">len</span>(table) <span class="keyword">and</span> char_index &lt; <span class="built_in">len</span>(table[key_index]):</span><br><span class="line">            result.append(table[key_index][char_index])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(result)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    ct = <span class="string">&quot;ooo yyy ii w uuu ee uuuu yyy uuuu y w uuu i i rr w i i rr rrr uuuu rrr uuuu t ii uuuu i w u rrr ee www ee yyy eee www w tt ee&quot;</span></span><br><span class="line">    m = T9_password(ct)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;flag&#123;&#123;<span class="subst">&#123;m&#125;</span>&#125;&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># flag&#123;youaresosmartthatthisisjustapieceofcake&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="2-20-MRCTF2020-vigenere"><a href="#2-20-MRCTF2020-vigenere" class="headerlink" title="2.20 [MRCTF2020]vigenere"></a>2.20 [MRCTF2020]vigenere</h2><h3 id="2-20-1-题目"><a href="#2-20-1-题目" class="headerlink" title="2.20.1 题目"></a>2.20.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cipher.txt</span></span><br><span class="line">g vjganxsymda ux ylt vtvjttajwsgt bl udfteyhfgt</span><br><span class="line">oe btlc ckjwc qnxdta </span><br><span class="line">vbbwwrbrtlx su gnw nrshylwmpy cgwps, lum bipee ynecgy gk jaryz frs fzwjp, x puej jgbs udfteyhfgt, gnw sil uuej su zofi. sc okzfpu bl lmi uhzmwi, x nyc dsj bl lmi enyl ys argnj yh nrgsi. nba swi cbz ojprbsw fqdam mx. cdh nsai cb ygaigroysxn jnwwi lr msylte.</span><br><span class="line">cw mekr tg jptpzwi kdikjsqtaz, ftv pek oj pxxkdd xd ugnj scr, yg n esqxwxw nba onxw au ywipgkj fyiuujnxn gnss xwnz onxw jnahl avhwwxn vzkjpu nrofch fvwfoh. v jwhppek lmi vyutfp hbiafp hcguj at nxw gyxyjask ib hw seihxsqpn vtvjttajwsx ds zzj xnegfsmtf egz wtrq lt mbcukj sc hy. qty wnbw ss bbxsq vxtnl ys ghrw zw cbx vt cdh vgxwtfy ssc brzzthh bl wsjdeiwricg cw mekr zjzi grgktr ib lwfv.</span><br><span class="line">vbbwwrbrtlx hteonj xwroj oyhg vgbigf ljtq iuk utrhrtl tj iuk ytztetwi. cdh nsai crolmig fudngxgkv ssg ekujmkrj gzvh. jk vnh cbz aszxgk qty. nba vt rdg qfta jf, tgw hd lum prdj umw aderv. hcqrxkuerr jgjw cbz dni lvzznr nbaj gsgqkjx. hd aul ylxaq lmei lum hec oaaqh xg, gk yldhmz nx lrxw f tjorah gdaylwyrgogs tgbpwhx. nba ufrcbz. ay mh nt shx ds tsyygr gfi mi txgbw xgywqj iuxgzkw baj hsaykuymkr guymday.</span><br><span class="line">qty wnbw ssi rtyfktq of tyg txwfx paj yfxwrxask rbtnjvhnzatr, cbx vnh nba uwipgk lmi lrgdyl ds umw qpeqwytaniwx. cdh jg ssi xtgb sje imqxjek, gzv tgnahw, de zzj ycjxayxta igiih gnsy eaeksic eeunnht baj xsrvkld qdek gwhte zzfr rbadi ft bhlfmcrj td ecl ux dsje oeushvzatrh.</span><br><span class="line">lum hppvs lmigr gjj tgbhdjqh nsgsk jf zzfx nba fjis gu ktpkr. egz yhr zznw rygar eh nt wcgjfk lt mcigvj sje vjjgxailx. qpae gk xwryw uvdorwrw sbt<span class="string">&#x27;l jbxfz. omigr zzjvt nxw wipy igsjavilx, awrxw yltek swi leuflw, lr caqp xqkfymul zzjq paj sihgryk yltz hq tyg zkssw. lr gjj jdesask dhx gbr hbiafp rbtlwerg. zznw vbbwwrpaiw bmay gjnwt niutvsvty ys iuk utrsvzatrh bl gzv lbxdi, rdg egzvh. baj bsgyj ax hxslwwicg.</span></span><br><span class="line"><span class="string">iqgigfvshi rbtknwif ux yvpayshxxbtk, wianzatrhuohx, ecq zztyvuz aywtyl, swvplkv qmzr g kyecqofl apik as xwr cwg su baj hsbzafngpgogsw. dhxk nw p jujqh iugl nw qbzz jzteeomigr gfi rdjnwwi, qhz ay mh aul bltek tthxry dnzt.</span></span><br><span class="line"><span class="string">jk swi reksymct g otvaq zzfx pyr efc tazww axgngzx eeonnpttk gw tgrpmimrr guhsgqkv gc gniw, jgdaueng ebcww, qxyolfvn sujhi, de ylfxxbt gk fxezz.</span></span><br><span class="line"><span class="string">bi pek uwipgofl e lbxdi awrxw frnbtw, frnjnwwi bne wctgryk mmh bx zjv qrrajjh, au efxirx zta hvtyzppe, cayldhz xjeg bl tjmct igjvrrj asxd fodjrrr uj hscsujrmil.</span></span><br><span class="line"><span class="string">egzv armsq gdaiwuxh bl hwserxld, imcxwxwxbt, aiicgold, qdikejri, ntv hscgkpy hd aul fteye lt yh. gnwd egr gdq fpfkv tr bnzljv, paj lmigr ok ss bnzljv wrxw.</span></span><br><span class="line"><span class="string">tyg vjwsxxgowx lpik ft fdqowx, wd, htdnot lum, bi rntftx dozsnr dejww fn cnqxmrnr utigpogs. at okdnikr zzfx ueue jxwvik, jravmzyicrj kjpu-vtljvtfz, ssh iuk utqbbtojea, baj lskrxffrrr caqp tzkjli. dhx aiicgolnih zgq gi svylwmqhzwi ereukx qpae gk cdhx bzvxfjahxxbtk. ylt btdd ppj zzfx pyr gzv rbtkymihkfy gjyzmwih jumqh vrtwweaye jjgdttaei xf zzj kdyjws vjyk. oj ldck oj axyr tj eqyk lt fjvrv tyg cgjymrhrsw wdyalnscf uf ylpg hsxmh. oal bi rntftx ppiwux iuk ktpjgogsw nba swi pgzwrtivty ys xzvgxi.</span></span><br><span class="line"><span class="string">xa zzj ycvzwi winzwx, cdh nsai ibjsd ggrgljh p ygo, ylt gkdjgdzsmsmrnzatrh ekxtvb nil, blxpn jjtjqosyih lumw sla igswivzmymda gfi mcfadyw iuk vwipzy gk ntslwwwda, csxlxamltr, bvrd, resvygs, htguizikvrdj, ecq hjfrsrok. yltfk vwipzy ezwi auo gi qbxf frtj of zw.</span></span><br><span class="line"><span class="string">nba swi irxjnjxrj gk cdhx gbr ruodivta, yasgt gnwd egr tsymkry as e lbxdi awrxw dsj jodq eajgqx ft vsenkgntlx. ftpgmxi nba xjeg gnwr, cdh kfyvjfz qtyg oajjejpxshmtf cayl iuk hfvtazsq vtfvgswxoodnxxry qty pek lts rbcswhal zg hscsxgsx nbajxiaikk. nr dhx otvaq, gdq xwr ywsxxzkfyw paj wctgryknscf ux mybntayc, ueue ylt qktfwxam lt xwr gfliavi, swi enxlx su n ywfqaryk bldyk, lmi vyutfp rbtnjvhnzatr ds hayw. lr issrdg ywuegnzw ylt noj ylpg iztotf ljtq iuk snv jcuf blxpn onrvf hwfx.</span></span><br><span class="line"><span class="string">xa iznrp, tkjrecl, ljfrrr, xmxwxn, yaskpcujj, minrq frs gnw zrxgkv xxpgkk, dsj nxw yvnvty ys lnxv tju gnw amghy gk pxokjyc ql kjjgivty lypej htwif gl ylt sxgsxxrxk tj rlhwwweniw. yltfk efc zrkh tyi gnw hscggynsc suj f wbnrd ymbr, hmy xwre onpa aul bsgx of f aderv ylpg caqp hbuf gi qygfpiirj as fxg-hwfvxam ejhxn.</span></span><br><span class="line"><span class="string">egzv xaijjehvtyqc doygqiir ofksgzglnsc vtvzwieowx adhrv uigcklzeir zzjqhrrnjw ql vjttdfofl ppjy, as ebrxahe paj wqwtjnwwi, iugl hppvs lt sla yhjiru olxias zzwsjtngzx iuk otvaq. zzjwt ygox adhrv iirygjj msrgk ys qr gftxwrx ashjfzjnea cxgiyrg, tg rsgr tggpt gnss txt ojtr. xa umw aderv, blpgknjv iuk zzqpa sash bne uwipgk ufr qr xwuvdqaujh paj vnwieotzxtq ofkmcvzwqc pg tg hshg. zzj kabhsq gdabwdecpk gk xwbaymx cb rgskte xwvyxekk dsje lshxdeowx xd niutqeyokm.</span></span><br><span class="line"><span class="string">xwryw nrreksxmctrq mshgodj ecq igqscvgd ripfajjw eyguj yh vt lmi hnsw ushvzatr pf zztwt cxwamdhy dtztey gk jgrkvtq paj kjpu-qkljvbvtsymda czt lpq zg wiyril ylt nalmsgvzajw ds jaxxpaz, msmcsujris cuojvh. jk ezwi qkuqegr umw zxezmfp hrrnjw xzsmsi ib egzv hbbwwixttld, ikrt sx at pufymchk lt gdaywsx ib egzv ghrw tzte umw fdqowx. at jodq weeksi sjeywqztf guwshf zzj tantwy wd gnsy rd btw hec nxjjwi baj yldhmzyw.</span></span><br><span class="line"><span class="string">lr caqp reksyi p ponnpxmglnsc bl lmi bvtv nr rlhwwweniw. ren vz tj qdek zzqpak ssh unoj ylpa zzj aderv dsje mgaigaswsxh ugnj qpqk tjjdek.</span></span><br><span class="line"><span class="string">xqev vy ewgis balicrxw hvnczg hvppq efr, eyksxi pqj mshteyutvt ntv hygye twerry.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># vigenere.txt</span></span><br><span class="line"><span class="string">from ctf import source_text, key_string</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">getdiff = lambda char: ord(char)-ord(&#x27;</span>a<span class="string">&#x27;)</span></span><br><span class="line"><span class="string">getchar = lambda num: chr(ord(&#x27;</span>a<span class="string">&#x27;)+num)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">def vigenere(src: chr, key: chr) -&gt; chr:</span></span><br><span class="line"><span class="string">    assert(src.isalpha() and key.isalpha())</span></span><br><span class="line"><span class="string">    return(getchar((getdiff(src) + getdiff(key) + 1) % 26))</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">src = source_text.lower()</span></span><br><span class="line"><span class="string">count = 0</span></span><br><span class="line"><span class="string">assert(len(key_string) &gt; 5 and len(key_string) &lt; 10)</span></span><br><span class="line"><span class="string">for i in src:</span></span><br><span class="line"><span class="string">    if(i.isalpha()):</span></span><br><span class="line"><span class="string">        print(vigenere(i, key_string[count % len(key_string)]), end=&#x27;</span><span class="string">&#x27;)</span></span><br><span class="line"><span class="string">        count+=1</span></span><br><span class="line"><span class="string">    else:</span></span><br><span class="line"><span class="string">        print(i, end=&#x27;</span><span class="string">&#x27;)</span></span><br></pre></td></tr></table></figure>

<h3 id="2-20-2-解题思路"><a href="#2-20-2-解题思路" class="headerlink" title="2.20.2 解题思路"></a>2.20.2 解题思路</h3><p><strong>无密钥维吉尼亚密码</strong></p>
<h3 id="2-20-3-解题脚本"><a href="#2-20-3-解题脚本" class="headerlink" title="2.20.3 解题脚本"></a>2.20.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> parsel <span class="keyword">import</span> Selector</span><br><span class="line"><span class="keyword">from</span> fake_useragent <span class="keyword">import</span> UserAgent</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">VigenereWithoutKey</span>(<span class="params">ciphertext</span>):</span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&#x27;accept&#x27;</span>: <span class="string">&#x27;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;content-type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;origin&#x27;</span>: <span class="string">&#x27;https://guballa.de&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;referer&#x27;</span>: <span class="string">&#x27;https://guballa.de/vigenere-solver&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;sec-ch-ua&#x27;</span>: <span class="string">&#x27;&quot;Chromium&quot;;v=&quot;136&quot;, &quot;Microsoft Edge&quot;;v=&quot;136&quot;, &quot;Not.A/Brand&quot;;v=&quot;99&quot;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;user-agent&#x27;</span>: UserAgent().random,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    response = requests.get(<span class="string">&#x27;https://guballa.de/vigenere-solver&#x27;</span>, headers=headers)</span><br><span class="line">    selector = Selector(text=response.text)</span><br><span class="line">    unique_form_id = selector.xpath(<span class="string">&#x27;//input[@name=&quot;__unique_form_id__&quot;]/@value&#x27;</span>).get()</span><br><span class="line">    form_nonce = selector.xpath(<span class="string">&#x27;//input[@name=&quot;form-nonce&quot;]/@value&#x27;</span>).get()</span><br><span class="line"></span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&#x27;data[ciphertext]&#x27;</span>: ciphertext,</span><br><span class="line">        <span class="string">&#x27;data[variant]&#x27;</span>: <span class="string">&#x27;vigenere&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;data[language]&#x27;</span>: <span class="string">&#x27;en&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;data[keylength]&#x27;</span>: <span class="string">&#x27;3-30&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;__form-name__&#x27;</span>: <span class="string">&#x27;vig-breaker&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;__unique_form_id__&#x27;</span>: unique_form_id,</span><br><span class="line">        <span class="string">&#x27;form-nonce&#x27;</span>: form_nonce</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    response = requests.post(<span class="string">&#x27;https://guballa.de/vigenere-solver&#x27;</span>, headers=headers, data=data)</span><br><span class="line">    selector = Selector(text=response.text)</span><br><span class="line"></span><br><span class="line">    key_text = selector.xpath(<span class="string">&#x27;//*[@id=&quot;body-wrapper&quot;]/section/div/div[2]/div[1]/p/text()&#x27;</span>).get()</span><br><span class="line">    plaintext = selector.xpath(<span class="string">&#x27;//*[@id=&quot;body-wrapper&quot;]/section/div/div[2]/textarea/text()&#x27;</span>).get()</span><br><span class="line"></span><br><span class="line">    key_match = re.search(<span class="string">r&#x27;&quot;(.*?)&quot;&#x27;</span>, key_text <span class="keyword">or</span> <span class="string">&quot;&quot;</span>)</span><br><span class="line">    key = key_match.group(<span class="number">1</span>) <span class="keyword">if</span> key_match <span class="keyword">else</span> <span class="literal">None</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="string">&#x27;key&#x27;</span>: key,</span><br><span class="line">        <span class="string">&#x27;decrypted&#x27;</span>: plaintext</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&#x27;cipher.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&quot;utf8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        vigenere_cipher = f.read()</span><br><span class="line">    <span class="built_in">print</span>(VigenereWithoutKey(vigenere_cipher))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ...flag is mrctf vigenere crypto crack man...</span></span><br><span class="line">    <span class="comment"># flag&#123;vigenere_crypto_crack_man&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="2-21-MRCTF2020-keyboard"><a href="#2-21-MRCTF2020-keyboard" class="headerlink" title="2.21 [MRCTF2020]keyboard"></a>2.21 [MRCTF2020]keyboard</h2><h3 id="2-21-1-题目"><a href="#2-21-1-题目" class="headerlink" title="2.21.1 题目"></a>2.21.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">得到的flag用</span><br><span class="line">MRCTF&#123;xxxxxx&#125;形式上叫</span><br><span class="line">都为小写字母</span><br><span class="line"></span><br><span class="line"><span class="number">6</span></span><br><span class="line"><span class="number">666</span></span><br><span class="line"><span class="number">22</span></span><br><span class="line"><span class="number">444</span></span><br><span class="line"><span class="number">555</span></span><br><span class="line"><span class="number">33</span></span><br><span class="line"><span class="number">7</span></span><br><span class="line"><span class="number">44</span></span><br><span class="line"><span class="number">666</span></span><br><span class="line"><span class="number">66</span></span><br><span class="line"><span class="number">3</span></span><br></pre></td></tr></table></figure>

<h3 id="2-21-2-解题思路"><a href="#2-21-2-解题思路" class="headerlink" title="2.21.2 解题思路"></a>2.21.2 解题思路</h3><p><strong>九键键盘密码</strong></p>
<h3 id="2-21-3-解题脚本"><a href="#2-21-3-解题脚本" class="headerlink" title="2.21.3 解题脚本"></a>2.21.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">T9_password</span>(<span class="params">cipher: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    解码 T9 九键密码（支持数字或字母输入）</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    table = [<span class="string">&quot; &quot;</span>, <span class="string">&quot; &quot;</span>, <span class="string">&quot;abc&quot;</span>, <span class="string">&quot;def&quot;</span>, <span class="string">&quot;ghi&quot;</span>, <span class="string">&quot;jkl&quot;</span>, <span class="string">&quot;mno&quot;</span>, <span class="string">&quot;pqrs&quot;</span>, <span class="string">&quot;tuv&quot;</span>, <span class="string">&quot;wxyz&quot;</span>]</span><br><span class="line">    base = <span class="string">&quot; qwertyuiop&quot;</span></span><br><span class="line">    result = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> part <span class="keyword">in</span> cipher.split():</span><br><span class="line">        key_index = <span class="built_in">int</span>(part[<span class="number">0</span>]) <span class="keyword">if</span> part.isdigit() <span class="keyword">else</span> base.index(part[<span class="number">0</span>])</span><br><span class="line">        char_index = <span class="built_in">len</span>(part) - <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> <span class="number">0</span> &lt;= key_index &lt; <span class="built_in">len</span>(table) <span class="keyword">and</span> char_index &lt; <span class="built_in">len</span>(table[key_index]):</span><br><span class="line">            result.append(table[key_index][char_index])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(result)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    ct_number = <span class="string">&quot;6 666 22 444 555 33 7 44 666 66 3&quot;</span></span><br><span class="line">    m_number = T9_password(ct_number)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;flag&#123;&#123;<span class="subst">&#123;m_number&#125;</span>&#125;&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># flag&#123;mobilephond&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="2-22-一张谍报"><a href="#2-22-一张谍报" class="headerlink" title="2.22 一张谍报"></a>2.22 一张谍报</h2><h3 id="2-22-1-题目"><a href="#2-22-1-题目" class="headerlink" title="2.22.1 题目"></a>2.22.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 家能源总部经过派出卧底长期刺探，终于找到一个潜伏已久的国外内鬼：三楼能源楼管老王。由于抓捕仓促，老王服毒自尽了。侦查部门搜出老王每日看的报纸原来是特制的情报。聪明的你能从附件的报纸中找出情报么？flag是老王说的暗号。（由于老王的线人曾今做的土匪，所以用的行话）</span></span><br><span class="line"></span><br><span class="line">国家能源时报<span class="number">2015</span>年<span class="number">3</span>月<span class="number">5</span>日</span><br><span class="line">平时要针对性的吃些防辐射菜</span><br><span class="line">对于和电脑“朝夕相处”的人们来说,辐射的确是个让人忧心的“副产物”。因此,平时针对性的吃些可以防辐射的菜是很有好处的。特别是现在接近年底，加班加点是家常便饭，对着电脑更是辐射吸收得满满的，唯有趁一日三餐进食的时候吃点防辐射的食物了。</span><br><span class="line"></span><br><span class="line">朝歌区梆子公司三更放炮</span><br><span class="line">老小区居民大爷联合抵制</span><br><span class="line">今天上午，朝歌区梆子公司决定，在每天三更天不亮免费在各大小区门口设卡为全城提供二次震耳欲聋的敲更提醒，呼吁大家早睡早起，不要因为贪睡断送大好人生，时代的符号是前进。为此，全区老人都蹲在该公司东边树丛合力抵制，不给公司人员放行，场面混乱。李罗鹰住进朝歌区五十年了，人称老鹰头，几年孙子李虎南刚从东北当猎户回来，每月还寄回来几块鼹鼠干。李罗鹰当年遇到的老婆是朝歌一枝花，所以李南虎是长得非常秀气的一个汉子。李罗鹰表示：无论梆子公司做的对错，反正不能打扰他孙子睡觉，子曰：‘睡觉乃人之常情’。梆子公司这是连菩萨睡觉都不放过啊。李南虎表示：梆子公司智商捉急，小心居民猴急跳墙！这三伏天都不给睡觉，这不扯淡么！</span><br><span class="line">到了中午人群仍未离散，更有人提议要烧掉这个公司，公司高层似乎恨不得找个洞钻进去。直到治安人员出现才疏散人群归家，但是李南虎仍旧表示爷爷年纪大了，睡不好对身体不好。</span><br><span class="line"></span><br><span class="line">朝歌区梆子公司三更放炮</span><br><span class="line">老小区居民大爷联合抵制</span><br><span class="line">喵天上午，汪歌区哞叽公司决定，在每天八哇天不全免费在各大小区门脑设卡为全城提供双次震耳欲聋的敲哇提醒，呼吁大家早睡早起，不要因为贪睡断送大好人生，时代的编号是前进。为此，全区眠人都足在该公司流边草丛合力抵制，不给公司人员放行，场面混乱。李罗鸟住进汪歌区五十年了，人称眠鸟顶，几年孙叽李熬值刚从流北当屁户回来，每月还寄回来几块报信干。李罗鸟当年遇到的眠婆是汪歌一枝花，所以李值熬是长得非常秀气的一个汉叽。李罗鸟表示：无论哞叽公司做的对错，反正不能打扰他孙叽睡觉，叽叶：‘睡觉乃人之常情’。哞叽公司这是连衣服睡觉都不放过啊。李值熬表示：哞叽公司智商捉急，小心居民猴急跳墙！这八伏天都不给睡觉，这不扯淡么！</span><br><span class="line">到了中午人群仍未离散，哇有人提议要烧掉这个公司，公司高层似乎恨不得找个洞钻进去。直到治安人员出现才疏散人群归家，但是李值熬仍旧表示爷爷年纪大了，睡不好对身体不好。</span><br><span class="line"></span><br><span class="line">听书做作业</span><br><span class="line"></span><br><span class="line">喵汪哞叽双哇顶，眠鸟足屁流脑，八哇报信断流脑全叽，眠鸟进北脑上草，八枝遇孙叽，孙叽对熬编叶：值天衣服放鸟捉猴顶。鸟对：北汪罗汉伏熬乱天门。合编放行，卡编扯呼。人离烧草，报信归洞，孙叽找爷爷。</span><br></pre></td></tr></table></figure>

<h3 id="2-22-2-解题思路"><a href="#2-22-2-解题思路" class="headerlink" title="2.22.2 解题思路"></a>2.22.2 解题思路</h3><p><strong>单表替换密码</strong>：单表替换，可见两段重复新闻内容略有差异，对比提取不同之处组成翻译表，还原明文。</p>
<h3 id="2-22-3-解题脚本"><a href="#2-22-3-解题脚本" class="headerlink" title="2.22.3 解题脚本"></a>2.22.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    flag=<span class="string">&quot;&quot;</span></span><br><span class="line">    str1=<span class="string">&quot;今天上午，朝歌区梆子公司决定，在每天三更天不亮免费在各大小区门口设卡为全城提供二次震耳欲聋的敲更提醒，呼吁大家早睡早起，不要因为贪睡断送大好人生，时代的符号是前进。为此，全区老人都蹲在该公司东边树丛合力抵制，不给公司人员放行，场面混乱。李罗鹰住进朝歌区五十年了，人称老鹰头，几年孙子李虎南刚从东北当猎户回来，每月还寄回来几块鼹鼠干。李罗鹰当年遇到的老婆是朝歌一枝花，所以李南虎是长得非常秀气的一个汉子。李罗鹰表示：无论梆子公司做的对错，反正不能打扰他孙子睡觉，子曰：‘睡觉乃人之常情’。梆子公司这是连菩萨睡觉都不放过啊。李南虎表示：梆子公司智商捉急，小心居民猴急跳墙！这三伏天都不给睡觉，这不扯淡么！到了中午人群仍未离散，更有人提议要烧掉这个公司，公司高层似乎恨不得找个洞钻进去。直到治安人员出现才疏散人群归家，但是李南虎仍旧表示爷爷年纪大了，睡不好对身体不好。&quot;</span></span><br><span class="line">    str2=<span class="string">&quot;喵天上午，汪歌区哞叽公司决定，在每天八哇天不全免费在各大小区门脑设卡为全城提供双次震耳欲聋的敲哇提醒，呼吁大家早睡早起，不要因为贪睡断送大好人生，时代的编号是前进。为此，全区眠人都足在该公司流边草丛合力抵制，不给公司人员放行，场面混乱。李罗鸟住进汪歌区五十年了，人称眠鸟顶，几年孙叽李熬值刚从流北当屁户回来，每月还寄回来几块报信干。李罗鸟当年遇到的眠婆是汪歌一枝花，所以李值熬是长得非常秀气的一个汉叽。李罗鸟表示：无论哞叽公司做的对错，反正不能打扰他孙叽睡觉，叽叶：‘睡觉乃人之常情’。哞叽公司这是连衣服睡觉都不放过啊。李值熬表示：哞叽公司智商捉急，小心居民猴急跳墙！这八伏天都不给睡觉，这不扯淡么！到了中午人群仍未离散，哇有人提议要烧掉这个公司，公司高层似乎恨不得找个洞钻进去。直到治安人员出现才疏散人群归家，但是李值熬仍旧表示爷爷年纪大了，睡不好对身体不好。&quot;</span></span><br><span class="line">    str3=<span class="string">&quot;喵汪哞叽双哇顶，眠鸟足屁流脑，八哇报信断流脑全叽，眠鸟进北脑上草，八枝遇孙叽，孙叽对熬编叶：值天衣服放鸟捉猴顶。鸟对：北汪罗汉伏熬乱天门。合编放行，卡编扯呼。人离烧草，报信归洞，孙叽找爷爷。&quot;</span></span><br><span class="line">    </span><br><span class="line">    diff_dict = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> c1, c2 <span class="keyword">in</span> <span class="built_in">zip</span>(str1, str2):</span><br><span class="line">        <span class="keyword">if</span> c1 != c2:</span><br><span class="line">            diff_dict[c2] = c1</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(diff_dict.get(c, c) <span class="keyword">for</span> c <span class="keyword">in</span> str3))</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># flag&#123;南天菩萨放鹰捉猴头&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="2-23-AFCTF2018-Vigenere"><a href="#2-23-AFCTF2018-Vigenere" class="headerlink" title="2.23 [AFCTF2018]Vigenère"></a>2.23 [AFCTF2018]Vigenère</h2><h3 id="2-23-1-题目"><a href="#2-23-1-题目" class="headerlink" title="2.23.1 题目"></a>2.23.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;string.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;stdlib.h&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line">	freopen(<span class="string">&quot;flag.txt&quot;</span>,<span class="string">&quot;r&quot;</span>,stdin);</span><br><span class="line">	freopen(<span class="string">&quot;flag_encode.txt&quot;</span>,<span class="string">&quot;w&quot;</span>,stdout);</span><br><span class="line">	char key[] = /*SADLY SAYING! Key <span class="keyword">is</span> eaten by Monster!*/;</span><br><span class="line">	<span class="built_in">int</span> <span class="built_in">len</span> = strlen(key);</span><br><span class="line">	char ch;</span><br><span class="line">	<span class="built_in">int</span> index = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>((ch = getchar()) != EOF)&#123;</span><br><span class="line">		<span class="keyword">if</span>(ch&gt;=<span class="string">&#x27;a&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;z&#x27;</span>)&#123;</span><br><span class="line">			putchar((ch-<span class="string">&#x27;a&#x27;</span>+key[index%<span class="built_in">len</span>]-<span class="string">&#x27;a&#x27;</span>)%<span class="number">26</span>+<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">			++index;</span><br><span class="line">		&#125;<span class="keyword">else</span> <span class="keyword">if</span>(ch&gt;=<span class="string">&#x27;A&#x27;</span>&amp;&amp;ch&lt;=<span class="string">&#x27;Z&#x27;</span>)&#123;</span><br><span class="line">			putchar((ch-<span class="string">&#x27;A&#x27;</span>+key[index%<span class="built_in">len</span>]-<span class="string">&#x27;a&#x27;</span>)%<span class="number">26</span>+<span class="string">&#x27;A&#x27;</span>);</span><br><span class="line">			++index;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			putchar(ch);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># flag_encode.txt</span></span><br><span class="line">Yzyj ia zqm Cbatky kf uavin rbgfno ig hnkozku fyyefyjzy sut gha pruyte gu famooybn bhr vqdcpipgu jaaju obecu njde pupfyytrj cpez cklb wnbzqmr ntf li wsfavm azupy nde cufmrf uh lba enxcp, tuk uwjwrnzn inq ksmuh sggcqoa zq obecu zqm Lncu gz Jagaam aaj qx Hwthxn<span class="string">&#x27;a Gbj gfnetyk cpez, g fwwang xnapriv li phr uyqnvupk ib mnttqnq xgioerry cpag zjws ohbaul drinsla tuk liufku obecu ovxey zjwg po gnn aecgtsneoa.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Cn poyj vzyoe gxdbhf zq ty oeyl-ndiqkpl, ndag gut mrt cjy yrrgcmd rwwsf, phnz cpel gtw yjdbcnl bl zjwcn Cekjboe cklb yeezjqn htcdcannhum Rvmjlm, phnz juoam vzyoe nxn Tisk, Navarge jvd gng honshoc wf Ugrhcjefy. — Cpag zq kyyuek cpefk taadtf, Mxdeetowhps nxn qnfzklopeq gvwnt Sgf, xarvbrvg gngal fufz ywwrxu xlkm gnn koaygfn kf gnn ooiktfyz, — Tugc ehrtgnyn aae Owrz uh Yireetvmng hguiief jnateaelcre bl cpefk gfxo, ig ob bhr Xkybp os zqm Prurdy po nrcmr bx vg uxoyobp ig, gpv nk iaycqthzg fys Gbbnznzkpl, fwyvtp qtf lqmhzagoxv oa ywub lrvtlqpyku shz oemjvimopy cps cufmrf op koyh suau, af zq lbam fnjtl fkge gksg rrseye vg ybfric bhrot Kubege jvd Ugrhcjefy. Yzuqkpuy, enqknl, wvrn vcytnzn bhnz Igparasnvtf rqfa asggktifngv mdohrm vog hg ubwntkm noe rkybp aaj czaaykwhp cnabms; ntf swyoejrvgye cdf axckaqeaig zuph fnnen gncl gwnxowl aek ogla dvyywsrj vg mqfska, ehvrg wpelf gam shlhwlwbyk cpaa zq jcchg zqmmfknnyo bl gkwlvyjahc tuk owrzy vg qdipn cpel gtw uychycwmrj. Dmn shrt j toam vjuen bl jjufku shz ufaaxagoqfm, lueydqnt opnuninhug tuk usga Oopnkt rbkfwas n jnaitt vg ladhin bhrs wfxar nhbwlhzg Vyopbzram, vz kk ndevx aqguz, kl co tukrz dhza, li pheuf wfs ywub Coikavmrtv, shz tb vawvvjg fys Ghgals sut lbaie ldbuek uwwqrvzh. — Aupn jsm xert cpe cgvayjt faoneegpuy kf gnnae Pungheef; gwl shij am joj zqm nrigkmetl cqqcu iqfmprnowa tuko li wlgka bhrot xinmrx Bgsgkok ib Gbbnznzkpl. Nde uobboee qx nde cxnaeaz Mahc os Mamag Htanwia ob i hvyvglu os xnxenzgv cjjhxrms ntf mmqrcgcqoay, cdf daiowo ia jkjyyt bhsmcg zjw yotnhuqsusgfn kf nt jjsbrwly Pyegwvy bbgj ndefk Bbagku. Li lrbbn bhvy, nwn Bapzb je fadecptrj cw a pgpvcz wbxul.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Hr nck lafhynl hvy Ckmang zx Tajy, vzy iofz fpoykugga aaj wmcryuslu fbx cpe caddcy gbum.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Pe ugu xinbvjmmn uou Yireetxzs gu rsmo Lncb wf vsowxeagk jvd cxgkment ovxoezcfwa, uarnas fauhyjdrj rv tukkj ileegcqoa zkdf dif Gbaeaz uziqlq hn wbggkfyz; aaj fpea yq kooprtmmd, uk jsm qtgkaty akidyytrj cw agzgfx po gnnu.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Hr nck lafhynl tb vckm ktuka Tajy hgl phr glkozsqvupibt xn lnxiw xesgxrktf uh hykpyk, dvlryu lbksr vnwpyk ygohd ekuqndakkb phr xrohg uh Jylrrynvtnzkgh en gnn Tetoudupuek, j zitnv ahasgovibyk vg ndez gwl fbxoaxwbyk cw tlxcfno oarh.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Pe ugu uuhlrj cwgrzjwl hetobtagoxw vkdvkb it crcuyo uaabcay, apuiifbxcibyk, cfx zifzjvt sxqe nde qkywsvzqjs kf gnnqr Caddcy Rrixzdf, lqj nde fuum phxrgma os ljbitakfa phrs rvtb iqejhintlm wvzj zco mrgbcrry.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Jw bws qobaoybgv Lapekbmnggvapa Hbabms ekrwupeqrh, noe urhioiam fqtu scffu fvxvvefy jam enigbqoay qf nde eopptf uh lba pruyte.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Uk jsm nesabmd sut s fknt zrue, nlvwl oupn mqsfunmneoay, cw cnauw iphrxb bo ok gdyytrj, fpeekdq nde Ykpqsygvapa Pbcnzs, vtesjwbyk xn Aatkzchagoxv, hnbg jypuetnl tb zjw Jaocrn it ygtyy boe zqmie kzwlyifk; cpe Fzcly nezgrviam kf nde zkjv tvsg wrlofkm bo nrn lba dntpmrf uh ahrafoxv feuo ocphbac, inq iqfpqlfoxvs jovzcj.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Hr nja eajgspkuekm bo cxgnyjt gnn xocansneoa uo bhryg Knwtry; owr gncl jqrcubm ooyvjoytvtp bhr Rcom boe Tjbuegnatwtvuw wf Sutwccnrxb; zesauahc tb vjas bzjwlo tb kwkohxcyy phroa uitxclcknf nrbhrx, cfx navyrvg gng uijdvzrwnf uh fys Acvawpeoclcknf uo Taaju.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Zy daf ukateaelyz tuk Jlmvtkknnagoxv os Pwknecr hh zesauahc hvy Jasrtv li Hajy owr ryvsvhifnrvg Wafaweaee Ywwrxu.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Zy daf sjle Wafyyo drvnvdrtv gh dif Crtl nrqfy boe zqm trtwjy kf gnnqr blhawas, ntm bhr gogojt ntm xalsgfn kf gnnqr fgnsleef.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">luig vy cxwpf&#123;Jnxwobuqg_O_Cogiqi!&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Hr nck ynepznl a zanlcpuqk xn Nrc Qxzecry, jvd fkpl betuka awnxok ib Oslrkeey vg bwrnyb wue vggjhe ntm mag uwl ndevx bcbfzcfwa.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Hr nja krvv sgknt ab, qn goowm kf ckjke, Fzcfxent Gauiry yandohz cpe Pupkyjt bl xcr ykiamhagaams.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Uk jsm wfsklbeq zq jyjdrx cpe Zonanwrl owleckpvyjt bl jvd farwleoe zx bhr Iknch Pbcnz.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Hr nck wkmoowmd jovz iphrxb bo fadbyyt hy cw a watamzipzrwn sutwccn gu xcr pupknethzrwn, ntf mhwcxtxelrjiwx xy baa tajy; iapent nra Afygfn po gnnqr Nivk ib pekcmnqkf Dycifrjbibt:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Hgl munxcmrvti dungr hxliry qx unmrj czobvu sgknt ab:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Noe vtgnacgowo tuko, ts w mbit Brvgn xlkm cawqsusgfn boe gwg Mhxfwlo wuolp tuka kbkuyj lwmzov gh phr Owpaoovshps bl cpefk Ulupef:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Lxz chzvahc osl xcr Gxcvy sign jtl cgtlm kf gnn eoerf:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Xin izvxaiam Vsras bt da wvzjgop ohx Lwnfkpl:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Zkr qkyziiopy oo ia sjvy pguwm, kf gnn jeakhan kf Gxril oe Lmlu:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Fbx czaayrglpiam da breqfx Oeny cw br ztayz fbx yzegkpvyz oslnvcry:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Hgl wbbrrahvti lba fekn Ayfzge ib Eamuqsu Rcom en n tnqguhqmlent Vawvvtew, yotnhuqsuopy ndeekrv aa Gttcprnxh ooiktfgang, gwl earcjaent oca Bbapvuniry bw af zq jyjdrx rb ag upuy wn rdjupyk cfx big owateaowhp fbx rvteufmwent zqm snsg svooyacm rhrg ahpo gnnae Pungheef</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Lxz tnqkfa wwne xcr Pncjnarf, gkwlvyjahc ohx vwsg bcdowbyk Uiwf gpv uhtrxrvg sapvuieazjtll zjw Zkrzy xn ohx Igparasnvtf:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Lqj mqsckwliam qml kwa Rnoifrclonef, gwl drinslent zqmmfknnyo iabnatrj yand pbcnz tb rgycolnzn noe au ah wly ijaef cjsnoorbnz.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Hr nck uxdvijbeq Mqnynnzkwb hrxg, ts zeprjziam wk iqt bl qqs Cxqlyytvuw inq ccycjg Jga ignopkn qs.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Uk qis crwfxarrj xcr fkck, lwvnmnl ohx eguotf, hdzng uwj nkway, jvd qkullkyrj cpe yoxwm kf baa xebvnw.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Ba if gc bhvy vaga tegwapbxvahc lnxpm Aeskwm kf suamitt Owlyeagaqef zq uiipykjb tuk yglgs bl mmagn, fwmklnzrwn, ntf lsnaath, ilekcvs xetaw eign ealyuzycinpku gz Yrhkuby &amp; Cktxczy fijzcrra hunayrnteq op lba mbyc jaehcjiqs nmna, aaj vgnwlye dvwbxvzs phr Nnid bl c ucriyoimd agvaij.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Hr nja cbtullwiakm wue lgdfkw Pocqzrtu lugea Ijxtvbg gh phr nroh Fkck nk brga Irzy cyuenfz cpevx Egojtee, cw briqey phr kgmchzkgharf uo bhrot xleeajb inq Htwndrrt, xz tb lcdf phrsbmliku ts phroa Paaju.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Zy daf kgkigkf viiefzrk iaywjlacgoxvs nsqfaot hy, jvd ugu whzenbxcrrj vg vniam xv tuk kfbwbvzjvtf uh gon feuwbirxu, lba mrxlqlryu Ahzint Bivnmgk qdofk tvojt tmfa os cjzfnxg, am wn htmqsgopyoesukm lefztmwpibt xn ayr cyyo, srdna aaj eghzigoxvs.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Vt gnyny fzjoe bl vzyoe Bvyzefykgho Wr njde Ckvaneoakm noe Xgvlasf ow bhr sqkn duzhum trxok: Iqr ekymagkf Hypigoxvs ugxw vaea gwawrxgv ijll hh zeckclyz iapdzy. N Vtahye, jnxae pncjuytrx ra tuau eunkrj kg eiktq uyt jnrkh zga vybiak j Byegpl, co ualrb tb hg lba rhrnz os g hjya pruyte.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Aut zure Jk kmea ccfnent ow itgkplcknf zx wue Htanesu hamtuxgf. Qa hnbn eaetgv ndez lawm goow nk tvsn wf nzvwgltf hh bhrot dycifrjbuek vg yttrtm in htyslnaazjjlr pwjcodvicqoa uxwl qs. Jk qivr xgecjdrj cpez uh lba cvxlcmfzcfwas bl xcr rskylwtvuw inq yglnhezkwb hrxg. Oy daik jxprgnwx po gnnqr agvapa jhycqcr gpv gwgagwqmvza, shz wr njde pupboneq zqmm oe vzy piry xn ohx eggioa qrvdekf li zifgeww gngky qshxyitvupk, qdipn fwuyj kfyriggkty vtvwlnucz xcr pupfyytvuwa aaj eglnefvxvdrtew. Ndel zxw hnbg tyan qkjn tb zjw pkipk xn jhyvawa aaj xn cbtushcuvtrby. Jk ommp, tukamfbxg, swmuvkbke vt vzy jepkbaige, yzcyh qkwwuaigk iqr Fkyirnzkgh, wnq nxtd gnge, uo wr nxtd gng jyot bl vinxopv, Yjezona ia Ccj, cj Prglm Feogfxo.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Wr, zqmrrlqjy, phr Xnxrrygfnwtvbna os zjw ojigkm Atnzgk ib Azkaqcn, op Yyjeegu Koamtwmo, Afynubykf, sjlenrrvg gu vzy Oucxnue Wafyy kf gnn eoerf xin tuk amcgovmxa os udz iazgfneoay, mw, ia zjw Hwmr, gwl bl Gwlbkrvzh wf gng yikd Ckxxlr uh lbasr Ixtoaogk, mklrswty caddcoh ntm leprcjy, Phnz cpefk wfcpeq Ixtoaogk une, ntm wf Eoizn kutnc bo ok Hjya aaj Rvdrvgfxang Ycitry, vzup tukh irr Gdkihvrj ozoz gnd Uhlrmrinpk vg nde Oxrbifn Ejisn, ntm bhnz cdf loyocqcnr eghjepzrwn okvoyan gnnu aaj vzy Otnzn wf Txgsn Xrvzjqn, vy cfx kutnc bo ok vgnwlye mqsfunnyz; aaj cpag gu Xlae ntm Qnqkrwhzeaz Bbagku, lbay ugem fhrn Hisee zx teie Ysl, yoaiucdr Vgswa, cbtczapz Cdfeaaina, efzctfesu Ixumrxew, ujd gu mw ayr qlbar Nica aaj Vzcjgf cqqcu Opvyleajnvt Fzclyo mne xn rvmjl xk. — Aaj owr gng kolpbxc wf gnkk Xacygaitvup, ocph n lrzm eknaujcr uw bhr vtgnacgoxv os Jkncje Cxxdiqkpuy, se zaccayra hfadtk cw enij gndee udz Lvbgk, iqr Suabuaku, shz ohx bicekf Zijoe.</span></span><br></pre></td></tr></table></figure>

<h3 id="2-23-2-解题思路"><a href="#2-23-2-解题思路" class="headerlink" title="2.23.2 解题思路"></a>2.23.2 解题思路</h3><p><strong>无密钥维吉尼亚密码</strong></p>
<h3 id="2-23-3-解题脚本"><a href="#2-23-3-解题脚本" class="headerlink" title="2.23.3 解题脚本"></a>2.23.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> parsel <span class="keyword">import</span> Selector</span><br><span class="line"><span class="keyword">from</span> fake_useragent <span class="keyword">import</span> UserAgent</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">VigenereWithoutKey</span>(<span class="params">ciphertext</span>):</span><br><span class="line">    results = &#123;&#125;</span><br><span class="line"></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&#x27;accept&#x27;</span>: <span class="string">&#x27;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;content-type&#x27;</span>: <span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;origin&#x27;</span>: <span class="string">&#x27;https://guballa.de&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;referer&#x27;</span>: <span class="string">&#x27;https://guballa.de/vigenere-solver&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;sec-ch-ua&#x27;</span>: <span class="string">&#x27;&quot;Chromium&quot;;v=&quot;136&quot;, &quot;Microsoft Edge&quot;;v=&quot;136&quot;, &quot;Not.A/Brand&quot;;v=&quot;99&quot;&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;user-agent&#x27;</span>: UserAgent().random,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    response = requests.get(<span class="string">&#x27;https://guballa.de/vigenere-solver&#x27;</span>, headers=headers)</span><br><span class="line">    selector = Selector(text=response.text)</span><br><span class="line">    unique_form_id = selector.xpath(<span class="string">&#x27;//input[@name=&quot;__unique_form_id__&quot;]/@value&#x27;</span>).get()</span><br><span class="line">    form_nonce = selector.xpath(<span class="string">&#x27;//input[@name=&quot;form-nonce&quot;]/@value&#x27;</span>).get()</span><br><span class="line"></span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&#x27;data[ciphertext]&#x27;</span>: ciphertext,</span><br><span class="line">        <span class="string">&#x27;data[variant]&#x27;</span>: <span class="string">&#x27;vigenere&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;data[language]&#x27;</span>: <span class="string">&#x27;en&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;data[keylength]&#x27;</span>: <span class="string">&#x27;3-30&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;__form-name__&#x27;</span>: <span class="string">&#x27;vig-breaker&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;__unique_form_id__&#x27;</span>: unique_form_id,</span><br><span class="line">        <span class="string">&#x27;form-nonce&#x27;</span>: form_nonce</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    response = requests.post(<span class="string">&#x27;https://guballa.de/vigenere-solver&#x27;</span>, headers=headers, data=data)</span><br><span class="line">    selector = Selector(text=response.text)</span><br><span class="line"></span><br><span class="line">    key_text = selector.xpath(<span class="string">&#x27;//*[@id=&quot;body-wrapper&quot;]/section/div/div[2]/div[1]/p/text()&#x27;</span>).get()</span><br><span class="line">    plaintext = selector.xpath(<span class="string">&#x27;//*[@id=&quot;body-wrapper&quot;]/section/div/div[2]/textarea/text()&#x27;</span>).get()</span><br><span class="line"></span><br><span class="line">    key_match = re.search(<span class="string">r&#x27;&quot;(.*?)&quot;&#x27;</span>, key_text <span class="keyword">or</span> <span class="string">&quot;&quot;</span>)</span><br><span class="line">    key = key_match.group(<span class="number">1</span>) <span class="keyword">if</span> key_match <span class="keyword">else</span> <span class="literal">None</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="string">&#x27;key&#x27;</span>: key,</span><br><span class="line">        <span class="string">&#x27;decrypted&#x27;</span>: plaintext</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&#x27;flag_encode.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&quot;utf8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        vigenere_cipher = f.read()</span><br><span class="line">    <span class="built_in">print</span>(VigenereWithoutKey(vigenere_cipher))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ...flag is afctf&#123;Whooooooo_U_Gotcha!&#125;\n\nHe has...</span></span><br><span class="line">    <span class="comment"># afctf&#123;Whooooooo_U_Gotcha!&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="2-24-AFCTF2018-Single"><a href="#2-24-AFCTF2018-Single" class="headerlink" title="2.24 [AFCTF2018]Single"></a>2.24 [AFCTF2018]Single</h2><h3 id="2-24-1-题目"><a href="#2-24-1-题目" class="headerlink" title="2.24.1 题目"></a>2.24.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include &lt;bits/stdc++.h&gt;</span></span><br><span class="line">using namespace std;</span><br><span class="line"><span class="built_in">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line">	freopen(<span class="string">&quot;Plain.txt&quot;</span>,<span class="string">&quot;r&quot;</span>,stdin);</span><br><span class="line">	freopen(<span class="string">&quot;Cipher.txt&quot;</span>,<span class="string">&quot;w&quot;</span>,stdout);</span><br><span class="line">	<span class="built_in">map</span>&lt;char, char&gt; f;</span><br><span class="line">	<span class="built_in">int</span> arr[<span class="number">26</span>];</span><br><span class="line">	<span class="keyword">for</span>(<span class="built_in">int</span> i=<span class="number">0</span>;i&lt;<span class="number">26</span>;++i)&#123;</span><br><span class="line">		arr[i]=i;</span><br><span class="line">	&#125;</span><br><span class="line">	random_shuffle(arr,arr+<span class="number">26</span>);</span><br><span class="line">	<span class="keyword">for</span>(<span class="built_in">int</span> i=<span class="number">0</span>;i&lt;<span class="number">26</span>;++i)&#123;</span><br><span class="line">		f[<span class="string">&#x27;a&#x27;</span>+i]=<span class="string">&#x27;a&#x27;</span>+arr[i];</span><br><span class="line">		f[<span class="string">&#x27;A&#x27;</span>+i]=<span class="string">&#x27;A&#x27;</span>+arr[i];</span><br><span class="line">	&#125;</span><br><span class="line">	char ch;</span><br><span class="line">	<span class="keyword">while</span>((ch=getchar())!=EOF)&#123;</span><br><span class="line">		<span class="keyword">if</span>(f.count(ch))&#123;</span><br><span class="line">			putchar(f[ch]);</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			putchar(ch);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Jmqrida rva Lfmz (JRL) eu m uqajemf seny xl enlxdomrexn uajiderc jxoqarerexnu. Rvada mda rvdaa jxooxn rcqau xl JRLu: Paxqmdyc, Mrrmjs-Yalanja mny oekay.</span><br><span class="line"></span><br><span class="line">Paxqmdyc-urcfa JRLu vmu m jxiqfa xl giaurexnu (rmusu) en dmnza xl jmrazxdeau. Lxd akmoqfa, Wab, Lxdanuej, Jdcqrx, Benmdc xd uxoarvenz afua. Ramo jmn zmen uxoa qxenru lxd atadc uxftay rmus. Oxda qxenru lxd oxda jxoqfejmray rmusu iuimffc. Rva nakr rmus en jvmen jmn ba xqanay xnfc mlrad uxoa ramo uxfta qdatexiu rmus. Rvan rva zmoa reoa eu xtad uio xl qxenru uvxwu cxi m JRL wenad. Lmoxiu akmoqfa xl uijv JRL eu Yaljxn JRL gimfu.</span><br><span class="line"></span><br><span class="line">Waff, mrrmjs-yalanja eu mnxrvad enradaurenz seny xl jxoqarerexnu. Vada atadc ramo vmu xwn narwxds(xd xnfc xna vxur) werv tifnmdmbfa uadtejau. Cxid ramo vmu reoa lxd qmrjvenz cxid uadtejau mny yatafxqenz akqfxeru iuimffc. Ux, rvan xdzmnehadu jxnnajru qmdrejeqmnru xl jxoqarerexn mny rva wmdzmoa urmdru! Cxi uvxify qdxrajr xwn uadtejau lxd yalanja qxenru mny vmjs xqqxnanru lxd mrrmjs qxenru. Veurxdejmffc rveu eu m ledur rcqa xl JRLu, atadcbxyc snxwu mbxir YAL JXN JRL - uxoarvenz fesa m Wxdfy Jiq xl mff xrvad jxoqarerexnu.</span><br><span class="line"></span><br><span class="line">Oekay jxoqarerexnu omc tmdc qxuuebfa lxdomru. Er omc ba uxoarvenz fesa wmdzmoa werv uqajemf reoa lxd rmus-bmuay afaoanru (a.z. IJUB eJRL).</span><br><span class="line"></span><br><span class="line">JRL zmoau xlran rxijv xn omnc xrvad muqajru xl enlxdomrexn uajiderc: jdcqrxzdmqvc, urazx, benmdc mnmfcueu, datadua anzanaadenz, oxbefa uajiderc mny xrvadu. Zxxy ramou zanadmffc vmta urdxnz useffu mny akqadeanja en mff rvaua euuiau.</span><br><span class="line"></span><br><span class="line">Iuimffc, lfmz eu uxoa urdenz xl dmnyxo ymrm xd rakr en uxoa lxdomr. Akmoqfa mljrl&#123;Xv_I_lxiny_er_neja_rDc&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-24-2-解题思路"><a href="#2-24-2-解题思路" class="headerlink" title="2.24.2 解题思路"></a>2.24.2 解题思路</h3><p><strong>随机替换密码</strong>：使用 <a target="_blank" rel="noopener" href="http://quipqiup.com/">http://quipqiup.com/</a> 词频分析。</p>
<h3 id="2-24-3-解题脚本"><a href="#2-24-3-解题脚本" class="headerlink" title="2.24.3 解题脚本"></a>2.24.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib3</span><br><span class="line"></span><br><span class="line"><span class="comment"># 忽略 SSL 证书警告</span></span><br><span class="line">urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_with_quipqiup</span>(<span class="params">ciphertext: <span class="built_in">str</span>, clues: <span class="built_in">str</span>= <span class="string">&quot;&quot;</span></span>) -&gt; <span class="built_in">dict</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    使用 quipqiup.com 对替换加密密文进行自动解密。</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&quot;Accept&quot;</span>: <span class="string">&quot;*/*&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Accept-Language&quot;</span>: <span class="string">&quot;zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Content-type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Origin&quot;</span>: <span class="string">&quot;http://quipqiup.com&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Referer&quot;</span>: <span class="string">&quot;http://quipqiup.com/&quot;</span>,</span><br><span class="line">        <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0&quot;</span>,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    payload = &#123;</span><br><span class="line">        <span class="string">&quot;ciphertext&quot;</span>: ciphertext,</span><br><span class="line">        <span class="string">&quot;clues&quot;</span>: clues,</span><br><span class="line">        <span class="string">&quot;mode&quot;</span>: <span class="string">&quot;auto&quot;</span>,</span><br><span class="line">        <span class="string">&quot;was_auto&quot;</span>: <span class="literal">True</span>,</span><br><span class="line">        <span class="string">&quot;was_clue&quot;</span>: <span class="literal">False</span>,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 请求提交密文以开始解密</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = requests.post(<span class="string">&quot;http://quipqiup.com/solve&quot;</span>, headers=headers, json=payload, verify=<span class="literal">False</span>)</span><br><span class="line">        response.raise_for_status()</span><br><span class="line">        id_payload = &#123;<span class="string">&quot;id&quot;</span>: response.json().get(<span class="string">&quot;id&quot;</span>)&#125;</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;提交解密请求失败:&quot;</span>, e)</span><br><span class="line">        <span class="keyword">return</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 请求获取解密结果</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = requests.post(<span class="string">&quot;http://quipqiup.com/status&quot;</span>, headers=headers, json=id_payload, verify=<span class="literal">False</span>)</span><br><span class="line">        response.raise_for_status()</span><br><span class="line">        solutions = response.json().get(<span class="string">&quot;solutions&quot;</span>, [])</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;获取解密结果失败:&quot;</span>, e)</span><br><span class="line">        <span class="keyword">return</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 组织解密结果</span></span><br><span class="line">    result = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> solutions:</span><br><span class="line">        result[s[<span class="string">&quot;key&quot;</span>]] = s[<span class="string">&quot;plaintext&quot;</span>]</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;Cipher.txt&quot;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        ct = f.read()</span><br><span class="line">    result = decrypt_with_quipqiup(ct)</span><br><span class="line">    <span class="keyword">for</span> key, text <span class="keyword">in</span> result.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;afctf&#x27;</span> <span class="keyword">in</span> text:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Key: <span class="subst">&#123;key&#125;</span>\nPlaintext: <span class="subst">&#123;text&#125;</span>\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># afctf&#123;Oh_U_found_it_nice_tRy&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="2-25-UTCTF2020-basic-crypto"><a href="#2-25-UTCTF2020-basic-crypto" class="headerlink" title="2.25 [UTCTF2020]basic-crypto"></a>2.25 [UTCTF2020]basic-crypto</h2><h3 id="2-25-1-题目"><a href="#2-25-1-题目" class="headerlink" title="2.25.1 题目"></a>2.25.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>1010101 01101000 <span class="number">00</span>101101 01101111 01101000 <span class="number">00</span>101100 <span class="number">00</span>100000 01101100 01101111 01101111 01101011 01110011 <span class="number">00</span>100000 01101100 01101001 01101011 01100101 <span class="number">00</span>100000 01110111 01100101 <span class="number">00</span>100000 01101000 01100001 01110110 01100101 <span class="number">00</span>100000 01100001 01101110 01101111 01110100 01101000 01100101 01110010 <span class="number">00</span>100000 01100010 01101100 01101111 01100011 01101011 <span class="number">00</span>100000 01101111 01100110 <span class="number">00</span>100000 01110100 01100101 01111000 01110100 <span class="number">00</span>101100 <span class="number">00</span>100000 01110111 01101001 01110100 01101000 <span class="number">00</span>100000 01110011 01101111 01101101 01100101 <span class="number">00</span>100000 01110011 01101111 01110010 01110100 <span class="number">00</span>100000 01101111 01100110 <span class="number">00</span>100000 01110011 01110000 01100101 01100011 01101001 01100001 01101100 <span class="number">00</span>100000 01100101 01101110 01100011 01101111 01100100 01101001 01101110 01100111 <span class="number">00</span>101110 <span class="number">00</span>100000 <span class="number">0</span>1000011 01100001 01101110 <span class="number">00</span>100000 01111001 01101111 01110101 <span class="number">00</span>100000 01100110 01101001 01100111 01110101 01110010 01100101 <span class="number">00</span>100000 01101111 01110101 01110100 <span class="number">00</span>100000 01110111 01101000 01100001 01110100 <span class="number">00</span>100000 01110100 01101000 01101001 01110011 <span class="number">00</span>100000 01100101 01101110 01100011 01101111 01100100 01101001 01101110 01100111 <span class="number">00</span>100000 01101001 01110011 00111111 <span class="number">00</span>100000 <span class="number">00</span>101000 01101000 01101001 01101110 01110100 00111010 <span class="number">00</span>100000 01101001 01100110 <span class="number">00</span>100000 01111001 01101111 01110101 <span class="number">00</span>100000 01101100 01101111 01101111 01101011 <span class="number">00</span>100000 01100011 01100001 01110010 01100101 01100110 01110101 01101100 01101100 01111001 <span class="number">00</span>101100 <span class="number">00</span>100000 01111001 01101111 01110101 <span class="number">00</span>100111 01101100 01101100 <span class="number">00</span>100000 01101110 01101111 01110100 01101001 01100011 01100101 <span class="number">00</span>100000 01110100 01101000 01100001 01110100 <span class="number">00</span>100000 01110100 01101000 01100101 01110010 01100101 <span class="number">00</span>100000 01101111 01101110 01101100 01111001 <span class="number">00</span>100000 01100011 01101000 01100001 01110010 01100001 01100011 01110100 01100101 01110010 01110011 <span class="number">00</span>100000 01110000 01110010 01100101 01110011 01100101 01101110 01110100 <span class="number">00</span>100000 01100001 01110010 01100101 <span class="number">00</span>100000 <span class="number">0</span>1000001 <span class="number">00</span>101101 <span class="number">0</span>1011010 <span class="number">00</span>101100 <span class="number">00</span>100000 01100001 <span class="number">00</span>101101 01111010 <span class="number">00</span>101100 <span class="number">00</span>100000 00110000 <span class="number">00</span>101101 00111001 <span class="number">00</span>101100 <span class="number">00</span>100000 01100001 01101110 01100100 <span class="number">00</span>100000 01110011 01101111 01101101 01100101 01110100 01101001 01101101 01100101 01110011 <span class="number">00</span>100000 <span class="number">00</span>101111 <span class="number">00</span>100000 01100001 01101110 01100100 <span class="number">00</span>100000 <span class="number">00</span>101011 <span class="number">00</span>101110 <span class="number">00</span>100000 <span class="number">0</span>1010011 01100101 01100101 <span class="number">00</span>100000 01101001 01100110 <span class="number">00</span>100000 01111001 01101111 01110101 <span class="number">00</span>100000 01100011 01100001 01101110 <span class="number">00</span>100000 01100110 01101001 01101110 01100100 <span class="number">00</span>100000 01100001 01101110 <span class="number">00</span>100000 01100101 01101110 01100011 01101111 01100100 01101001 01101110 01100111 <span class="number">00</span>100000 01110100 01101000 01100001 01110100 <span class="number">00</span>100000 01101100 01101111 01101111 01101011 01110011 <span class="number">00</span>100000 01101100 01101001 01101011 01100101 <span class="number">00</span>100000 01110100 01101000 01101001 01110011 <span class="number">00</span>100000 01101111 01101110 01100101 <span class="number">00</span>101110 <span class="number">00</span>101001 <span class="number">0000</span>1010 <span class="number">0</span>1010100 01101101 <span class="number">0</span>1010110 00110011 <span class="number">0</span>1001001 <span class="number">0</span>1000111 <span class="number">0</span>1001110 01101111 <span class="number">0</span>1011001 <span class="number">0</span>1010111 01111000 01110011 <span class="number">0</span>1011010 <span class="number">0</span>1010111 00110101 01101110 <span class="number">0</span>1011010 <span class="number">0</span>1010011 <span class="number">0</span>1000101 01100111 <span class="number">0</span>1010001 00110010 <span class="number">0</span>1000110 01110101 <span class="number">0</span>1001001 <span class="number">0</span>1001000 01101100 01110110 01100100 <span class="number">0</span>1010011 <span class="number">0</span>1000010 01101101 01100001 <span class="number">0</span>1010111 01100100 00110001 01100011 01101101 <span class="number">0</span>1010101 01100111 01100010 00110011 <span class="number">0</span>1010110 00110000 <span class="number">0</span>1001001 <span class="number">0</span>1001000 01100100 01101111 <span class="number">0</span>1011001 <span class="number">0</span>1011000 <span class="number">0</span>1010001 01101110 01100011 01111001 <span class="number">0</span>1000010 01101110 01100010 00110010 01101100 01110101 <span class="number">0</span>1011010 01111001 <span class="number">0</span>1000010 01110110 01100010 01101001 <span class="number">0</span>1000010 01101111 <span class="number">0</span>1011010 <span class="number">0</span>1011000 <span class="number">0</span>1001010 01101100 <span class="number">0</span>1010000 01111001 <span class="number">0</span>1000010 <span class="number">0</span>1001010 01100100 <span class="number">0</span>1000011 <span class="number">0</span>1000010 01110011 01100010 00110010 00111001 01110010 01100011 01111001 <span class="number">0</span>1000010 01110011 01100001 <span class="number">0</span>1010111 01110100 01101100 <span class="number">0</span>1001001 <span class="number">0</span>1001000 <span class="number">0</span>1010010 01101111 <span class="number">0</span>1011010 <span class="number">0</span>1010011 <span class="number">0</span>1000010 01110011 <span class="number">0</span>1011010 <span class="number">0</span>1011000 <span class="number">0</span>1010010 00110000 <span class="number">0</span>1011010 <span class="number">0</span>1011000 <span class="number">0</span>1001010 01111010 <span class="number">0</span>1001001 <span class="number">0</span>1000111 <span class="number">0</span>1000110 01111001 <span class="number">0</span>1011010 <span class="number">0</span>1010011 <span class="number">0</span>1000010 01111010 01100001 <span class="number">0</span>1000111 01101100 01101101 01100100 <span class="number">0</span>1000111 <span class="number">0</span>1010110 01101011 <span class="number">0</span>1001001 <span class="number">0</span>1000111 <span class="number">0</span>1001010 00110101 <span class="number">0</span>1001001 <span class="number">0</span>1001000 <span class="number">0</span>1001110 01110110 01100010 <span class="number">0</span>1010111 <span class="number">0</span>1010101 01100111 <span class="number">0</span>1011001 00110010 00111001 01110101 01100011 00110011 <span class="number">0</span>1010010 01101000 01100010 01101110 <span class="number">0</span>1010001 01110101 <span class="number">0</span>1001001 <span class="number">0</span>1000011 01101000 01101111 01100001 <span class="number">0</span>1010111 00110101 00110000 <span class="number">0</span>1001111 01101001 <span class="number">0</span>1000010 00110101 01100010 00110011 <span class="number">0</span>1010101 01100111 01100010 <span class="number">0</span>1010111 01101100 01101110 01100001 <span class="number">0</span>1001000 <span class="number">0</span>1010001 01100111 01100100 00110010 <span class="number">0</span>1000110 01110101 01100100 <span class="number">0</span>1000011 <span class="number">0</span>1000010 00110000 01100010 01111001 <span class="number">0</span>1000010 01111010 01100100 <span class="number">0</span>1000111 <span class="number">0</span>1000110 01111001 01100100 <span class="number">0</span>1000011 <span class="number">0</span>1000010 01110011 01100010 00110010 00111001 01110010 01100001 <span class="number">0</span>1010111 00110101 01101110 <span class="number">0</span>1001001 <span class="number">0</span>1001000 <span class="number">0</span>1010110 01110111 <span class="number">0</span>1001001 <span class="number">0</span>1000110 <span class="number">0</span>1001010 01110110 01100010 <span class="number">0</span>1010111 <span class="number">0</span>1000110 01110101 <span class="number">0</span>1001001 <span class="number">0</span>1001000 <span class="number">0</span>1000010 01101100 01100010 00110011 <span class="number">0</span>1000010 01110011 <span class="number">0</span>1011010 <span class="number">0</span>1010011 01101011 01110101 <span class="number">0</span>1000011 01101101 01110100 00110010 <span class="number">0</span>1011001 01101110 <span class="number">0</span>1001110 01111000 01100011 01101101 <span class="number">0</span>1010001 01110011 <span class="number">0</span>1001001 <span class="number">0</span>1000111 01101100 00110101 <span class="number">0</span>1011010 <span class="number">0</span>1010011 01100100 01101001 01100010 01111001 <span class="number">0</span>1000010 01110010 01100100 01101110 01100100 00110101 <span class="number">0</span>1011001 00110010 <span class="number">0</span>1010001 01100111 <span class="number">0</span>1011010 <span class="number">0</span>1001000 <span class="number">0</span>1001010 01110110 <span class="number">0</span>1011001 01101101 00111000 01101000 <span class="number">0</span>1001001 <span class="number">0</span>1000110 01101000 00110101 <span class="number">0</span>1011010 01111001 <span class="number">0</span>1000010 01110111 01100101 <span class="number">0</span>1010111 <span class="number">0</span>1001001 01100111 <span class="number">0</span>1011010 <span class="number">0</span>1001000 <span class="number">0</span>1001010 01110110 <span class="number">0</span>1001001 <span class="number">0</span>1001000 <span class="number">0</span>1000010 01111010 01100101 <span class="number">0</span>1000111 01110100 00110010 <span class="number">0</span>1001001 <span class="number">0</span>1000011 01101000 01110010 01100101 <span class="number">0</span>1000111 00110100 01100111 01100100 00110010 01110100 01110000 01100010 <span class="number">0</span>1000111 00111000 01100111 <span class="number">0</span>1011010 <span class="number">0</span>1001000 <span class="number">0</span>1001010 01110110 <span class="number">0</span>1001001 <span class="number">0</span>1001000 <span class="number">0</span>1001010 01110010 <span class="number">0</span>1011001 01101101 00110101 01110110 <span class="number">0</span>1011001 00110010 <span class="number">0</span>1010001 01110101 <span class="number">0</span>1001100 01101001 00110100 01110000 <span class="number">0</span>1001001 <span class="number">0</span>1001000 01110000 01110010 <span class="number">0</span>1011001 01101101 <span class="number">0</span>1010001 00110110 <span class="number">0</span>1001001 <span class="number">0</span>1000111 01110011 01100111 <span class="number">0</span>1011001 00110010 <span class="number">0</span>1010110 01110011 <span class="number">0</span>1011001 00110010 <span class="number">0</span>1010010 01111010 <span class="number">0</span>1011010 <span class="number">0</span>1000111 <span class="number">0</span>1010110 01101011 01100011 00110011 01101100 00110100 <span class="number">0</span>1001001 <span class="number">0</span>1000111 00110001 01111010 01100101 01101110 <span class="number">0</span>1001010 01110110 <span class="number">0</span>1011001 01101001 00110100 01100111 <span class="number">0</span>1010101 00110011 01100111 01100111 <span class="number">0</span>1011010 <span class="number">0</span>1001000 <span class="number">0</span>1001010 01110110 <span class="number">0</span>1001001 <span class="number">0</span>1001000 <span class="number">0</span>1000010 00110101 01100100 01101110 <span class="number">0</span>1011010 00110101 <span class="number">0</span>1011010 00110011 <span class="number">0</span>1001110 00110100 01100011 <span class="number">0</span>1010011 <span class="number">0</span>1000010 01101011 01100010 00110010 01101000 01101011 <span class="number">0</span>1001100 <span class="number">0</span>1000011 <span class="number">0</span>1000010 <span class="number">0</span>1010100 <span class="number">0</span>1001010 00110010 <span class="number">0</span>1011010 01110110 <span class="number">0</span>1001001 <span class="number">0</span>1000111 <span class="number">0</span>1010010 01110010 01100100 <span class="number">0</span>1010111 00111001 00110100 <span class="number">0</span>1001001 <span class="number">0</span>1001000 01100100 01110000 <span class="number">0</span>1001001 <span class="number">0</span>1001000 01100100 01110110 <span class="number">0</span>1011001 00110010 <span class="number">0</span>1001110 01110010 01100011 <span class="number">0</span>1010111 00111000 01100111 01100001 00110011 01101000 01110101 <span class="number">0</span>1001001 <span class="number">0</span>1000111 <span class="number">0</span>1001010 01110110 01100101 01101110 <span class="number">0</span>1011010 01110010 01100010 <span class="number">0</span>1010111 00111001 01110101 <span class="number">0</span>1001001 <span class="number">0</span>1000111 00111001 01101101 01100010 00110010 <span class="number">0</span>1001010 01110000 <span class="number">0</span>1001001 <span class="number">0</span>1000111 01110100 00110010 01100101 01101110 <span class="number">0</span>1001010 01110010 01100010 <span class="number">0</span>1000111 00111001 01101011 01100011 00110010 00110000 01100111 01100010 <span class="number">0</span>1011000 <span class="number">0</span>1001010 01110010 <span class="number">0</span>1011001 01101101 01110100 01110100 <span class="number">0</span>1011010 <span class="number">0</span>1000111 00111001 01101001 <span class="number">0</span>1001001 <span class="number">0</span>1000111 01100100 01111010 <span class="number">0</span>1011010 <span class="number">0</span>1001000 <span class="number">0</span>1001001 01100111 01100001 01111001 <span class="number">0</span>1000010 01110100 01100101 <span class="number">0</span>1010111 <span class="number">0</span>1001010 01101001 01100010 00110010 <span class="number">0</span>1001110 00110110 01100101 <span class="number">0</span>1011000 01101000 01110101 01100010 00110011 01101000 01110100 01100010 01111001 <span class="number">0</span>1000010 01101011 01100101 <span class="number">0</span>1010011 <span class="number">0</span>1000010 01110010 <span class="number">0</span>1001001 <span class="number">0</span>1000111 00110101 01111010 01100011 <span class="number">0</span>1001000 <span class="number">0</span>1000010 01110110 <span class="number">0</span>1011001 01101101 00111001 00110100 <span class="number">0</span>1011010 <span class="number">0</span>1000011 <span class="number">0</span>1000010 01110100 01100011 01101101 01110100 01101001 01100001 00110010 00110001 01101011 01100010 00110010 <span class="number">0</span>1001001 01100111 <span class="number">0</span>1001100 <span class="number">0</span>1010011 <span class="number">0</span>1000010 00110001 01100101 <span class="number">0</span>1001000 01101100 01101110 01100101 <span class="number">0</span>1000011 <span class="number">0</span>1000010 01110010 <span class="number">0</span>1011001 01111001 <span class="number">0</span>1000010 01110010 <span class="number">0</span>1001001 <span class="number">0</span>1000111 <span class="number">0</span>1001110 01101100 01100010 <span class="number">0</span>1000111 <span class="number">0</span>1001110 01101011 01100011 00110010 <span class="number">0</span>1010010 01101100 <span class="number">0</span>1011010 <span class="number">0</span>1001000 <span class="number">0</span>1001110 00110101 01100101 <span class="number">0</span>1000011 <span class="number">0</span>1000010 01110100 01100011 00110011 01110000 01111001 01100010 00110010 <span class="number">0</span>1001001 01110101 <span class="number">0</span>1001001 <span class="number">0</span>1000101 00110001 01110010 01100101 <span class="number">0</span>1000011 <span class="number">0</span>1000010 01110000 01100101 <span class="number">0</span>1010111 <span class="number">0</span>1010101 01100111 01100011 <span class="number">0</span>1001000 <span class="number">0</span>1001110 00110100 01100010 01101001 <span class="number">0</span>1000010 01101011 01100011 01101101 00111000 01100111 01100011 <span class="number">0</span>1001000 <span class="number">0</span>1001110 00110100 01100001 00110011 <span class="number">0</span>1011001 01100111 01100011 <span class="number">0</span>1001000 <span class="number">0</span>1011010 01110010 01100011 <span class="number">0</span>1010100 00111000 01100111 01100011 01101110 <span class="number">0</span>1001110 00110100 <span class="number">0</span>1011010 <span class="number">0</span>1000100 01101111 01100111 <span class="number">0</span>1010010 00110010 00111000 01100111 01100100 <span class="number">0</span>1011000 01101000 00110101 <span class="number">0</span>1011010 01111001 <span class="number">0</span>1000010 01101011 01100011 01101101 01110100 01101011 <span class="number">0</span>1001001 <span class="number">0</span>1000111 <span class="number">0</span>1010010 01111001 01100010 01111001 <span class="number">0</span>1000010 01110111 01100100 01101101 01110100 01111000 <span class="number">0</span>1001001 <span class="number">0</span>1001000 <span class="number">0</span>1001110 01101010 <span class="number">0</span>1001001 <span class="number">0</span>1001000 <span class="number">0</span>1000110 00110101 01100011 00110011 01101000 01111000 <span class="number">0</span>1001001 <span class="number">0</span>1000111 <span class="number">0</span>1010010 00110101 <span class="number">0</span>1001001 <span class="number">0</span>1000111 01111000 01110110 <span class="number">0</span>1001001 <span class="number">0</span>1001000 01101100 01110111 <span class="number">0</span>1001001 <span class="number">0</span>1000111 <span class="number">0</span>1010010 01111001 01100010 01111001 <span class="number">0</span>1000010 01110111 01100101 <span class="number">0</span>1010111 <span class="number">0</span>1001010 00110011 01100001 00110010 <span class="number">0</span>1010001 01100111 <span class="number">0</span>1011010 <span class="number">0</span>1010111 <span class="number">0</span>1010010 01110111 01100100 01101101 01110100 01111000 01100101 01111001 00110100 01110101 <span class="number">0</span>1001100 01101110 00110000 01100111 <span class="number">0</span>1001100 <span class="number">0</span>1010011 <span class="number">0</span>1000010 01101110 01100011 01101110 <span class="number">0</span>1001110 01110100 01100011 01101001 <span class="number">0</span>1000010 00110011 01100010 00110010 01110100 00110100 <span class="number">0</span>1011001 01111001 <span class="number">0</span>1000010 01101011 01100011 01101101 01110100 01101011 <span class="number">0</span>1001001 <span class="number">0</span>1001000 <span class="number">0</span>1001110 01110111 <span class="number">0</span>1001001 <span class="number">0</span>1000111 01101100 00110101 <span class="number">0</span>1011010 <span class="number">0</span>1010011 <span class="number">0</span>1000010 01101010 01100010 00110010 00111000 01100111 <span class="number">0</span>1011010 <span class="number">0</span>1001000 <span class="number">0</span>1001010 01110010 <span class="number">0</span>1011010 <span class="number">0</span>1000011 <span class="number">0</span>1000010 00110110 01100001 00110010 <span class="number">0</span>1010010 01101011 01100010 00110010 <span class="number">0</span>1001010 00110100 <span class="number">0</span>1001100 <span class="number">0</span>1000011 <span class="number">0</span>1000010 01110000 01100101 <span class="number">0</span>1010111 <span class="number">0</span>1010101 01100111 01100100 <span class="number">0</span>1011000 01101000 00110101 <span class="number">0</span>1011010 01111001 <span class="number">0</span>1000010 01101110 01100011 01101101 01110100 01101011 <span class="number">0</span>1001001 <span class="number">0</span>1000111 <span class="number">0</span>1010010 01111001 01100010 01111001 <span class="number">0</span>1000010 01110100 01100101 <span class="number">0</span>1010111 <span class="number">0</span>1001010 01101001 01100010 00110010 <span class="number">0</span>1001110 00110110 01100101 <span class="number">0</span>1011000 01101000 01110101 01100010 00110011 01101000 01110100 01100010 00110010 <span class="number">0</span>1001101 01100111 01100011 <span class="number">0</span>1001000 01101100 01101001 <span class="number">0</span>1001001 <span class="number">0</span>1000111 <span class="number">0</span>1010101 01110011 <span class="number">0</span>1001001 <span class="number">0</span>1000111 <span class="number">0</span>1010001 01110011 <span class="number">0</span>1001001 <span class="number">0</span>1001000 <span class="number">0</span>1000001 01110011 <span class="number">0</span>1001001 <span class="number">0</span>1001000 <span class="number">0</span>1011001 01100111 01100001 01111001 01110111 01100111 01100001 00110011 01101000 01110101 <span class="number">0</span>1001001 <span class="number">0</span>1001000 <span class="number">0</span>1000101 01100111 01100001 00110010 <span class="number">0</span>1001010 01110110 <span class="number">0</span>1001100 01101001 <span class="number">0</span>1000010 <span class="number">0</span>1001010 01100101 <span class="number">0</span>1010111 <span class="number">0</span>1010101 01100111 01100010 <span class="number">0</span>1010111 01110100 00110100 <span class="number">0</span>1001001 <span class="number">0</span>1001000 01110000 01101001 01100101 <span class="number">0</span>1010111 01111000 01110010 01100010 <span class="number">0</span>1001000 <span class="number">0</span>1011010 01110000 <span class="number">0</span>1001001 <span class="number">0</span>1000111 01100100 00110101 <span class="number">0</span>1011001 01101110 <span class="number">0</span>1010101 01100111 01100101 <span class="number">0</span>1010111 <span class="number">0</span>1010110 01101011 <span class="number">0</span>1001001 <span class="number">0</span>1000111 <span class="number">0</span>1010010 01111001 01100010 01111001 <span class="number">0</span>1000010 01101001 01100010 00110011 01100100 01110010 01100011 00110011 01101000 01111010 01100101 <span class="number">0</span>1001000 <span class="number">0</span>1000101 01100111 01100010 <span class="number">0</span>1011000 <span class="number">0</span>1001010 01110010 <span class="number">0</span>1011001 01101101 01110100 01110100 <span class="number">0</span>1011010 <span class="number">0</span>1000111 00111001 01101001 <span class="number">0</span>1011001 01111001 <span class="number">0</span>1000010 01110011 01100001 <span class="number">0</span>1010011 <span class="number">0</span>1000010 01101001 01100010 00110011 01110000 00110010 01100001 00110010 00110001 01111010 01100101 <span class="number">0</span>1001000 <span class="number">0</span>1000101 01100111 <span class="number">0</span>1011010 <span class="number">0</span>1001000 <span class="number">0</span>1001010 01110110 01100100 01111001 <span class="number">0</span>1000010 01110010 01100101 <span class="number">0</span>1000111 00110100 01100111 01100011 00110011 01101000 01110111 01100010 00110010 <span class="number">0</span>1001010 01101001 01100011 00110011 01101000 01111000 <span class="number">0</span>1001001 <span class="number">0</span>1000111 00110001 00110101 01100100 00110011 01100100 00110101 01100101 <span class="number">0</span>1000011 <span class="number">0</span>1000010 01101110 01100101 <span class="number">0</span>1010111 <span class="number">0</span>1001010 01110101 <span class="number">0</span>1011001 01111001 <span class="number">0</span>1000010 01111010 01100101 <span class="number">0</span>1000011 <span class="number">0</span>1000010 01101011 01100011 01101101 00111000 01100111 <span class="number">0</span>1010100 00110011 01101000 01111000 01100100 01101110 <span class="number">0</span>1001110 01101010 01100011 01101001 <span class="number">0</span>1000010 00110010 01100001 00110011 01101000 01111000 <span class="number">0</span>1011010 <span class="number">0</span>1010111 01110100 01111000 01100010 01111001 00110100 01100111 <span class="number">0</span>1010011 00110011 01101000 00110101 <span class="number">0</span>1011010 <span class="number">0</span>1001000 <span class="number">0</span>1001010 01110110 <span class="number">0</span>1011001 01101001 <span class="number">0</span>1000010 01111000 <span class="number">0</span>1011001 01101101 00111001 01110010 <span class="number">0</span>1011010 <span class="number">0</span>1000011 <span class="number">0</span>1000010 00110011 01100010 00110010 <span class="number">0</span>1010010 01111001 01100101 <span class="number">0</span>1010111 00110100 01100111 01100011 00110010 <span class="number">0</span>1001101 01100111 <span class="number">0</span>1011010 <span class="number">0</span>1001000 01101011 01100111 <span class="number">0</span>1011010 <span class="number">0</span>1010111 <span class="number">0</span>1001110 01110110 <span class="number">0</span>1001001 <span class="number">0</span>1001000 <span class="number">0</span>1000010 01101001 01100010 00110010 <span class="number">0</span>1000110 01101100 01100010 00110011 01101000 01110100 01100001 <span class="number">0</span>1010011 <span class="number">0</span>1000010 01110010 01100101 <span class="number">0</span>1000111 01110100 00110010 01100001 <span class="number">0</span>1010111 <span class="number">0</span>1001110 01111010 <span class="number">0</span>1011001 01111010 01101111 01100111 <span class="number">0</span>1011010 00110010 00111000 01100111 01100100 <span class="number">0</span>1011000 01101000 00110101 <span class="number">0</span>1011010 01111001 <span class="number">0</span>1000010 01101011 01100011 01101101 01110100 01101011 <span class="number">0</span>1001001 <span class="number">0</span>1000011 01100100 01110110 <span class="number">0</span>1001010 01111001 <span class="number">0</span>1000010 01101010 01100011 01101110 01101100 01101110 <span class="number">0</span>1011001 01111001 <span class="number">0</span>1000010 01101100 01100101 01101001 <span class="number">0</span>1000010 00110011 01100101 <span class="number">0</span>1010111 <span class="number">0</span>1001110 01101011 <span class="number">0</span>1001001 <span class="number">0</span>1001000 01101100 01110111 <span class="number">0</span>1011010 <span class="number">0</span>1000111 00111001 00110100 <span class="number">0</span>1001001 <span class="number">0</span>1001000 <span class="number">0</span>1001110 00110100 <span class="number">0</span>1001001 <span class="number">0</span>1000111 <span class="number">0</span>1010010 01111001 01100010 01111001 <span class="number">0</span>1000010 01110010 01100100 01101110 01110000 01111001 01100001 00110010 01111000 01110110 <span class="number">0</span>1011010 <span class="number">0</span>1000011 01110111 01100111 <span class="number">0</span>1011001 00110011 01101011 01100111 <span class="number">0</span>1011010 <span class="number">0</span>1001000 <span class="number">0</span>1001010 01110010 <span class="number">0</span>1011010 <span class="number">0</span>1000011 01100100 01101010 <span class="number">0</span>1001001 <span class="number">0</span>1001000 01110000 01101001 01100101 <span class="number">0</span>1010111 01111000 01110010 01100010 <span class="number">0</span>1001000 <span class="number">0</span>1011010 01110000 <span class="number">0</span>1001001 <span class="number">0</span>1000111 <span class="number">0</span>1010010 01111001 01100010 01111001 <span class="number">0</span>1000010 00110011 01100101 <span class="number">0</span>1010111 <span class="number">0</span>1001110 01101011 <span class="number">0</span>1001001 <span class="number">0</span>1000111 00110001 00110101 01100100 00110011 01100100 00110101 01100101 <span class="number">0</span>1000011 <span class="number">0</span>1000010 01110100 01100011 01101101 01110100 01101001 01100001 00110010 00110001 01101011 01100010 00110010 <span class="number">0</span>1001001 01100111 01100011 00110011 01100111 01100111 <span class="number">0</span>1011010 <span class="number">0</span>1001000 <span class="number">0</span>1001010 01110110 <span class="number">0</span>1001001 <span class="number">0</span>1000111 <span class="number">0</span>1010010 01110110 01100001 <span class="number">0</span>1000111 <span class="number">0</span>1010001 01110011 <span class="number">0</span>1001001 <span class="number">0</span>1001000 <span class="number">0</span>1000010 00110101 01100100 01101110 <span class="number">0</span>1011010 00110101 <span class="number">0</span>1011010 00110010 00111001 01110101 <span class="number">0</span>1001001 <span class="number">0</span>1000111 01111000 01110000 <span class="number">0</span>1001001 <span class="number">0</span>1000011 01100100 01101011 <span class="number">0</span>1001010 01111001 01110111 01100111 01100001 00110011 01101000 01110101 <span class="number">0</span>1001001 <span class="number">0</span>1000111 <span class="number">0</span>1001110 00110101 <span class="number">0</span>1001001 <span class="number">0</span>1001000 01101100 00110100 <span class="number">0</span>1001100 01101001 <span class="number">0</span>1000010 <span class="number">0</span>1011010 01100101 <span class="number">0</span>1000111 00110001 01110110 <span class="number">0</span>1001001 <span class="number">0</span>1000111 01101100 00110101 <span class="number">0</span>1011010 <span class="number">0</span>1010011 <span class="number">0</span>1000010 00110001 01100101 <span class="number">0</span>1001000 01101100 01101110 <span class="number">0</span>1001001 <span class="number">0</span>1000111 01110011 01100111 01100011 <span class="number">0</span>1000111 00111001 01101110 <span class="number">0</span>1001001 <span class="number">0</span>1000111 00110001 01111001 01100001 00110010 <span class="number">0</span>1001010 01110010 01100010 <span class="number">0</span>1010111 <span class="number">0</span>1010010 01110110 <span class="number">0</span>1011001 01101101 <span class="number">0</span>1001101 01110011 <span class="number">0</span>1001001 <span class="number">0</span>1000111 01101100 00110101 <span class="number">0</span>1011010 <span class="number">0</span>1010011 <span class="number">0</span>1000010 01110100 01100001 00110011 01100111 01100111 01100011 00110011 01101000 01110111 01100010 00110010 <span class="number">0</span>1001001 01100111 <span class="number">0</span>1011010 <span class="number">0</span>1001000 <span class="number">0</span>1001010 01110110 <span class="number">0</span>1001001 <span class="number">0</span>1000111 <span class="number">0</span>1001010 01110110 <span class="number">0</span>1011001 00110010 <span class="number">0</span>1010001 01100111 01100101 <span class="number">0</span>1011000 <span class="number">0</span>1000001 01100111 <span class="number">0</span>1011010 <span class="number">0</span>1001000 <span class="number">0</span>1001010 01110110 <span class="number">0</span>1001001 <span class="number">0</span>1000111 01100100 00110101 <span class="number">0</span>1011001 01101101 00110101 01101010 <span class="number">0</span>1001001 <span class="number">0</span>1000111 01111000 01110010 <span class="number">0</span>1011001 00110010 00111001 01110101 <span class="number">0</span>1001001 <span class="number">0</span>1001000 01101100 00110100 <span class="number">0</span>1001001 <span class="number">0</span>1000111 00110001 00110101 01100100 00110011 01100100 00110101 01100101 <span class="number">0</span>1000011 <span class="number">0</span>1000010 01101110 01100101 <span class="number">0</span>1010111 <span class="number">0</span>1001010 01110101 <span class="number">0</span>1011001 01111001 <span class="number">0</span>1000010 01101011 01100011 01101101 01110100 01101011 <span class="number">0</span>1001001 <span class="number">0</span>1000111 <span class="number">0</span>1001110 01111001 01100101 <span class="number">0</span>1010111 01100011 01100111 <span class="number">0</span>1011010 <span class="number">0</span>1011000 01101111 01100111 01100011 00110011 01100111 01100111 <span class="number">0</span>1011010 <span class="number">0</span>1001000 <span class="number">0</span>1001010 01110110 <span class="number">0</span>1001001 <span class="number">0</span>1000101 00111001 00110100 01100011 <span class="number">0</span>1011000 <span class="number">0</span>1011010 01111010 <span class="number">0</span>1011001 00110011 <span class="number">0</span>1001001 01100111 01100100 01101101 01110100 00110100 01100011 <span class="number">0</span>1010111 <span class="number">0</span>1010110 01110010 01100011 <span class="number">0</span>1010111 00111000 01110101 <span class="number">0</span>1000011 01101110 <span class="number">0</span>1001010 01101110 01100001 <span class="number">0</span>1000111 00110101 00110100 01100011 00110010 <span class="number">0</span>1010010 01101101 01100101 <span class="number">0</span>1011000 <span class="number">0</span>1001110 01101011 01100100 <span class="number">0</span>1000111 01100100 01101111 01100100 <span class="number">0</span>1010011 <span class="number">0</span>1000101 01100111 01100011 <span class="number">0</span>1010111 01100100 01101101 <span class="number">0</span>1001001 <span class="number">0</span>1000111 01101100 01111010 <span class="number">0</span>1011001 <span class="number">0</span>1010111 01110011 01100111 <span class="number">0</span>1011001 00110011 <span class="number">0</span>1010010 01101111 01100100 <span class="number">0</span>1001000 <span class="number">0</span>1010110 01110000 01100001 00110010 <span class="number">0</span>1010101 01100111 <span class="number">0</span>1011010 <span class="number">0</span>1000111 01101100 01110010 <span class="number">0</span>1001001 <span class="number">0</span>1001000 01110000 01110010 01100010 01101110 <span class="number">0</span>1010010 01101111 01100001 <span class="number">0</span>1000111 01110100 00110100 <span class="number">0</span>1001001 <span class="number">0</span>1001000 <span class="number">0</span>1001010 00110100 01100011 <span class="number">0</span>1010111 01111000 01101011 <span class="number">0</span>1011010 00110010 00110101 00110100 01100011 00110010 01111000 01110000 01100011 <span class="number">0</span>1010011 <span class="number">0</span>1000010 01111001 01100001 <span class="number">0</span>1011000 <span class="number">0</span>1001110 00110101 01100101 <span class="number">0</span>1010111 01110100 01101111 01100010 01101101 01110011 01110101 <span class="number">0</span>1001001 <span class="number">0</span>1000111 01101100 01110010 01100101 <span class="number">0</span>1000111 01110011 01100111 01100100 <span class="number">0</span>1001000 <span class="number">0</span>1010101 01100111 01100011 01111001 <span class="number">0</span>1000010 01101010 01100101 <span class="number">0</span>1011000 <span class="number">0</span>1001110 01110101 <span class="number">0</span>1001001 <span class="number">0</span>1000111 <span class="number">0</span>1001110 01101110 01100101 <span class="number">0</span>1000011 <span class="number">0</span>1000010 01111010 01100101 <span class="number">0</span>1011000 01101011 01100111 01100011 <span class="number">0</span>1010111 01100100 01101101 01100101 <span class="number">0</span>1000011 <span class="number">0</span>1000010 01110000 01100011 00110011 01101000 01101100 <span class="number">0</span>1001001 <span class="number">0</span>1000111 01110100 01101010 <span class="number">0</span>1011001 00110010 01100100 00110100 <span class="number">0</span>1011010 <span class="number">0</span>1001000 <span class="number">0</span>1010101 00110110 <span class="number">0</span>1001001 <span class="number">0</span>1000111 <span class="number">0</span>1011010 01101011 <span class="number">0</span>1011001 00110011 01101100 01111010 01100010 01101110 01110100 01101111 <span class="number">0</span>1001101 <span class="number">0</span>1001000 <span class="number">0</span>1011010 01100110 <span class="number">0</span>1011010 <span class="number">0</span>1000111 01101011 00110000 <span class="number">0</span>1011010 <span class="number">0</span>1001000 <span class="number">0</span>1010110 01100110 01100100 01101101 01101011 00110000 <span class="number">0</span>1011010 <span class="number">0</span>1000110 00111001 00110000 <span class="number">0</span>1011000 00110011 <span class="number">0</span>1001001 00110000 01100101 <span class="number">0</span>1011000 01101100 01100110 01100011 01101110 01101000 01111000 01100010 <span class="number">0</span>1000111 <span class="number">0</span>1010001 01110111 01100110 <span class="number">0</span>1010011 00110100 01100111 01100011 <span class="number">0</span>1010111 01100100 01101101 <span class="number">0</span>1001001 <span class="number">0</span>1001000 <span class="number">0</span>1011010 00110000 01100101 <span class="number">0</span>1011000 01101011 01100111 <span class="number">0</span>1011001 00110011 <span class="number">0</span>1010010 01101111 <span class="number">0</span>1011010 <span class="number">0</span>1010011 <span class="number">0</span>1000010 01101011 01100001 <span class="number">0</span>1011000 <span class="number">0</span>1001110 01101011 <span class="number">0</span>1001001 <span class="number">0</span>1001000 <span class="number">0</span>1001101 01100111 01100101 <span class="number">0</span>1010111 01100100 01101011 <span class="number">0</span>1001001 <span class="number">0</span>1000111 01100100 01101010 <span class="number">0</span>1001001 <span class="number">0</span>1001000 <span class="number">0</span>1001010 00110100 01100011 <span class="number">0</span>1010111 01111000 01101011 <span class="number">0</span>1011010 00110010 00110101 00110100 01100011 00110010 01111000 01110000 01100011 <span class="number">0</span>1010011 <span class="number">0</span>1000010 00110000 01100100 <span class="number">0</span>1010011 <span class="number">0</span>1000010 01110111 <span class="number">0</span>1011010 01101110 <span class="number">0</span>1010110 01101011 <span class="number">0</span>1001001 <span class="number">0</span>1001000 01110000 01101101 01100100 <span class="number">0</span>1001000 01101100 01101100 01100100 <span class="number">0</span>1000111 01101000 01110101 <span class="number">0</span>1001001 <span class="number">0</span>1000111 01100100 01101010 <span class="number">0</span>1011001 01111001 <span class="number">0</span>1000010 01101011 01100001 <span class="number">0</span>1011000 <span class="number">0</span>1010010 00110001 <span class="number">0</span>1001001 <span class="number">0</span>1001000 <span class="number">0</span>1010110 01101110 01100101 <span class="number">0</span>1000111 <span class="number">0</span>1010001 01100111 <span class="number">0</span>1011010 00110010 <span class="number">0</span>1001101 01100111 01100101 01101110 <span class="number">0</span>1001110 00110001 01100100 <span class="number">0</span>1001000 <span class="number">0</span>1001001 01100111 <span class="number">0</span>1011001 01101101 01101000 01101110 01100100 01101110 01101100 01110010 <span class="number">0</span>1011010 <span class="number">0</span>1010111 00110101 01110010 <span class="number">0</span>1001100 <span class="number">0</span>1000011 <span class="number">0</span>1000010 01111010 01100001 <span class="number">0</span>1000111 <span class="number">0</span>1010101 01100111 01100100 <span class="number">0</span>1000111 <span class="number">0</span>1010001 01100111 01100101 <span class="number">0</span>1000111 01110100 01111010 01100101 <span class="number">0</span>1011000 01101100 01111000 <span class="number">0</span>1001001 <span class="number">0</span>1001000 <span class="number">0</span>1010010 00110001 <span class="number">0</span>1001001 <span class="number">0</span>1000111 01101000 01101110 <span class="number">0</span>1011010 <span class="number">0</span>1000011 <span class="number">0</span>1000010 00110001 <span class="number">0</span>1011010 01111001 <span class="number">0</span>1000010 00110110 01100011 00110010 <span class="number">0</span>1010101 01100111 01100011 00110010 <span class="number">0</span>1001110 01101011 01100001 00110011 01100111 01100111 01100011 00110011 01101100 00110101 <span class="number">0</span>1001100 01101001 <span class="number">0</span>1000010 01110000 <span class="number">0</span>1011010 00110010 01111000 01110010 <span class="number">0</span>1001001 <span class="number">0</span>1001000 <span class="number">0</span>1000110 01101110 <span class="number">0</span>1011010 01101001 <span class="number">0</span>1000010 01110010 01100001 <span class="number">0</span>1001000 <span class="number">0</span>1000010 01101110 01100011 <span class="number">0</span>1010111 01110100 01101100 <span class="number">0</span>1001001 <span class="number">0</span>1000111 <span class="number">0</span>1010010 01110000 01100001 01111001 <span class="number">0</span>1000010 01111001 01100001 <span class="number">0</span>1011000 <span class="number">0</span>1001110 00110101 01100101 <span class="number">0</span>1010111 01110100 01101111 01100010 01101101 01110011 01101000</span><br></pre></td></tr></table></figure>

<h3 id="2-25-2-解题思路"><a href="#2-25-2-解题思路" class="headerlink" title="2.25.2 解题思路"></a>2.25.2 解题思路</h3><p>二进制编码 + Base64 编码 + Avocat 密码（key&#x3D;10） + 随机替换密码</p>
<h3 id="2-25-3-解题脚本"><a href="#2-25-3-解题脚本" class="headerlink" title="2.25.3 解题脚本"></a>2.25.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib3</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 忽略 SSL 证书警告</span></span><br><span class="line">urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_with_quipqiup</span>(<span class="params">ciphertext: <span class="built_in">str</span>, clues: <span class="built_in">str</span>= <span class="string">&quot;&quot;</span></span>) -&gt; <span class="built_in">dict</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    使用 quipqiup.com 对替换加密密文进行自动解密。</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    headers = &#123;</span><br><span class="line">        <span class="string">&quot;Accept&quot;</span>: <span class="string">&quot;*/*&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Accept-Language&quot;</span>: <span class="string">&quot;zh-CN,zh;q=0.9,en;q=0.8,en-GB;q=0.7,en-US;q=0.6&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Content-type&quot;</span>: <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Origin&quot;</span>: <span class="string">&quot;http://quipqiup.com&quot;</span>,</span><br><span class="line">        <span class="string">&quot;Referer&quot;</span>: <span class="string">&quot;http://quipqiup.com/&quot;</span>,</span><br><span class="line">        <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0&quot;</span>,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    payload = &#123;</span><br><span class="line">        <span class="string">&quot;ciphertext&quot;</span>: ciphertext,</span><br><span class="line">        <span class="string">&quot;clues&quot;</span>: clues,</span><br><span class="line">        <span class="string">&quot;mode&quot;</span>: <span class="string">&quot;auto&quot;</span>,</span><br><span class="line">        <span class="string">&quot;was_auto&quot;</span>: <span class="literal">True</span>,</span><br><span class="line">        <span class="string">&quot;was_clue&quot;</span>: <span class="literal">False</span>,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 请求提交密文以开始解密</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = requests.post(<span class="string">&quot;http://quipqiup.com/solve&quot;</span>, headers=headers, json=payload, verify=<span class="literal">False</span>)</span><br><span class="line">        response.raise_for_status()</span><br><span class="line">        id_payload = &#123;<span class="string">&quot;id&quot;</span>: response.json().get(<span class="string">&quot;id&quot;</span>)&#125;</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;提交解密请求失败:&quot;</span>, e)</span><br><span class="line">        <span class="keyword">return</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 请求获取解密结果</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = requests.post(<span class="string">&quot;http://quipqiup.com/status&quot;</span>, headers=headers, json=id_payload, verify=<span class="literal">False</span>)</span><br><span class="line">        response.raise_for_status()</span><br><span class="line">        solutions = response.json().get(<span class="string">&quot;solutions&quot;</span>, [])</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;获取解密结果失败:&quot;</span>, e)</span><br><span class="line">        <span class="keyword">return</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 组织解密结果</span></span><br><span class="line">    result = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> solutions:</span><br><span class="line">        result[s[<span class="string">&quot;key&quot;</span>]] = s[<span class="string">&quot;plaintext&quot;</span>]</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RotCipher</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ROT系列加密算法实现（支持ROT3/5/10/13/18/47/ROT-5/ROT-6）&quot;&quot;&quot;</span></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_rotate_char</span>(<span class="params">char: <span class="built_in">str</span>, base: <span class="built_in">int</span>, shift: <span class="built_in">int</span>, range_size: <span class="built_in">int</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;对单个字符进行指定偏移量的 ROT 加密/解密&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> char.isspace():  <span class="comment"># 跳过空白字符</span></span><br><span class="line">            char_code = <span class="built_in">ord</span>(char)</span><br><span class="line">            <span class="keyword">if</span> base &lt;= char_code &lt; base + range_size:</span><br><span class="line">                <span class="comment"># 计算旋转后的字符代码</span></span><br><span class="line">                char_code = (char_code - base + shift) % range_size + base</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">chr</span>(char_code)</span><br><span class="line">        <span class="keyword">return</span> char</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">rot10</span>(<span class="params">text: <span class="built_in">str</span>, decrypt: <span class="built_in">bool</span> = <span class="literal">False</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot; Avocat 执行 ROT10 加密/解密，字母旋转10位 &quot;&quot;&quot;</span></span><br><span class="line">        shift = -<span class="number">10</span> <span class="keyword">if</span> decrypt <span class="keyword">else</span> <span class="number">10</span></span><br><span class="line">        result = []</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> text:</span><br><span class="line">            <span class="keyword">if</span> c.isupper():</span><br><span class="line">                result.append(RotCipher._rotate_char(c, <span class="number">65</span>, shift, <span class="number">26</span>))</span><br><span class="line">            <span class="keyword">elif</span> c.islower():</span><br><span class="line">                result.append(RotCipher._rotate_char(c, <span class="number">97</span>, shift, <span class="number">26</span>))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                result.append(c)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(result)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;attachment.txt&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        ct = f.read().split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"></span><br><span class="line">    res1 = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(<span class="built_in">int</span>(c, <span class="number">2</span>)) <span class="keyword">for</span> c <span class="keyword">in</span> ct)</span><br><span class="line">    res2 = b64decode(res1[<span class="number">307</span>:].encode()).decode()</span><br><span class="line">    res3 = RotCipher.rot10(res2[<span class="number">169</span>:])</span><br><span class="line">    res4 = decrypt_with_quipqiup(res3[<span class="number">10</span>][<span class="number">915</span>:])</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> key, text <span class="keyword">in</span> res4.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;flag&#x27;</span> <span class="keyword">in</span> text:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Key: <span class="subst">&#123;key&#125;</span>\nPlaintext: <span class="subst">&#123;text&#125;</span>\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># utflag&#123;n0w_th4ts_wh4t_i_c4ll_crypt0&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="2-26-四面八方"><a href="#2-26-四面八方" class="headerlink" title="2.26 四面八方"></a>2.26 四面八方</h2><h3 id="2-26-1-题目"><a href="#2-26-1-题目" class="headerlink" title="2.26.1 题目"></a>2.26.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">四方门主东方青木看着四面八方涌过来的极客，非常震惊，转头便进入了祖祠中的地下室，发现这丫传自唐朝的密室还设计了英文密码。旁边的石头上（附件中有拓本）刻着密码和密文，大家快帮助门主解出密码(答案为一串通顺语义字符串) </span><br><span class="line"></span><br><span class="line">key1:security</span><br><span class="line">key2:information</span><br><span class="line"></span><br><span class="line">密文啊这是，骚年加油：zhnjinhoopcfcuktlj</span><br></pre></td></tr></table></figure>

<h3 id="2-26-2-解题思路"><a href="#2-26-2-解题思路" class="headerlink" title="2.26.2 解题思路"></a>2.26.2 解题思路</h3><p><strong>四方密码</strong></p>
<h3 id="2-26-3-解题脚本"><a href="#2-26-3-解题脚本" class="headerlink" title="2.26.3 解题脚本"></a>2.26.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> OrderedDict</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">FourSquareCipher</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, key1, key2</span>):</span><br><span class="line">        <span class="variable language_">self</span>.matrix = <span class="string">&#x27;ABCDEFGHIJKLMNOPRSTUVWXYZ&#x27;</span>  <span class="comment"># 不含Q的25字母表</span></span><br><span class="line">        <span class="variable language_">self</span>.pla = <span class="string">&#x27;abcdefghijklmnoprstuvwxyz&#x27;</span>     <span class="comment"># 明文小写字母表（不含q）</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 处理密钥（移除重复字符，无需处理[]）</span></span><br><span class="line">        <span class="variable language_">self</span>.key1 = <span class="variable language_">self</span>._process_key(key1)</span><br><span class="line">        <span class="variable language_">self</span>.key2 = <span class="variable language_">self</span>._process_key(key2)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 生成加密矩阵</span></span><br><span class="line">        <span class="variable language_">self</span>.matrix1 = <span class="variable language_">self</span>._generate_matrix(<span class="variable language_">self</span>.key1)</span><br><span class="line">        <span class="variable language_">self</span>.matrix2 = <span class="variable language_">self</span>._generate_matrix(<span class="variable language_">self</span>.key2)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 明文矩阵（5x5分割）</span></span><br><span class="line">        <span class="variable language_">self</span>.pla_list = [<span class="built_in">list</span>(<span class="variable language_">self</span>.pla[i:i+<span class="number">5</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">25</span>, <span class="number">5</span>)]</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 预计算位置映射表（加速查找）</span></span><br><span class="line">        <span class="variable language_">self</span>.pla_pos = <span class="variable language_">self</span>._build_position_map(<span class="variable language_">self</span>.pla_list)</span><br><span class="line">        <span class="variable language_">self</span>.matrix1_pos = <span class="variable language_">self</span>._build_position_map(<span class="variable language_">self</span>.matrix1)</span><br><span class="line">        <span class="variable language_">self</span>.matrix2_pos = <span class="variable language_">self</span>._build_position_map(<span class="variable language_">self</span>.matrix2)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_process_key</span>(<span class="params">self, key</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;处理密钥：移除重复字符，保留大写字母，忽略其他字符&quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># 仅保留大写字母（若输入小写则转为大写）</span></span><br><span class="line">        key_clean = re.sub(<span class="string">r&#x27;[^A-Z]&#x27;</span>, <span class="string">&#x27;&#x27;</span>, key.upper())</span><br><span class="line">        <span class="comment"># 移除重复字符（保持首次出现顺序）</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(OrderedDict.fromkeys(key_clean))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_generate_matrix</span>(<span class="params">self, key</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;生成5x5加密矩阵：密钥 + 字母表剩余字符&quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># 过滤掉密钥中已包含的字母</span></span><br><span class="line">        remaining_chars = [c <span class="keyword">for</span> c <span class="keyword">in</span> <span class="variable language_">self</span>.matrix <span class="keyword">if</span> c <span class="keyword">not</span> <span class="keyword">in</span> key]</span><br><span class="line">        <span class="comment"># 拼接密钥和剩余字符，组成25字符</span></span><br><span class="line">        full_matrix = key + <span class="string">&#x27;&#x27;</span>.join(remaining_chars)</span><br><span class="line">        <span class="comment"># 按5个字符一行分割为矩阵</span></span><br><span class="line">        <span class="keyword">return</span> [<span class="built_in">list</span>(full_matrix[i:i+<span class="number">5</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">25</span>, <span class="number">5</span>)]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_build_position_map</span>(<span class="params">self, matrix</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;构建字符到（行, 列）的映射字典&quot;&quot;&quot;</span></span><br><span class="line">        pos_map = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> row_idx, row <span class="keyword">in</span> <span class="built_in">enumerate</span>(matrix):</span><br><span class="line">            <span class="keyword">for</span> col_idx, char <span class="keyword">in</span> <span class="built_in">enumerate</span>(row):</span><br><span class="line">                pos_map[char] = (row_idx, col_idx)</span><br><span class="line">        <span class="keyword">return</span> pos_map</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self, plaintext</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;加密明文：处理空格和q，按对加密&quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># 预处理：移除空格，替换q为无（或按规则替换），转为小写</span></span><br><span class="line">        plain_clean = plaintext.replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27;q&#x27;</span>, <span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27;Q&#x27;</span>, <span class="string">&#x27;&#x27;</span>).lower()</span><br><span class="line">        <span class="comment"># 确保长度为偶数（不足补x）</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(plain_clean) % <span class="number">2</span> != <span class="number">0</span>:</span><br><span class="line">            plain_clean += <span class="string">&#x27;x&#x27;</span></span><br><span class="line">        <span class="comment"># 按两个字符一组加密</span></span><br><span class="line">        ciphertext = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(plain_clean), <span class="number">2</span>):</span><br><span class="line">            pair = plain_clean[i:i+<span class="number">2</span>]</span><br><span class="line">            ciphertext.append(<span class="variable language_">self</span>._encrypt_pair(pair))</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(ciphertext)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_encrypt_pair</span>(<span class="params">self, pair</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;加密单个字符对（a, b）&quot;&quot;&quot;</span></span><br><span class="line">        a, b = pair[<span class="number">0</span>], pair[<span class="number">1</span>]</span><br><span class="line">        <span class="comment"># 获取明文在矩阵中的位置（行, 列）</span></span><br><span class="line">        row_a, col_a = <span class="variable language_">self</span>.pla_pos[a]</span><br><span class="line">        row_b, col_b = <span class="variable language_">self</span>.pla_pos[b]</span><br><span class="line">        <span class="comment"># 四方密码规则：(row_a, col_b) 取自matrix1，(row_b, col_a) 取自matrix2</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.matrix1[row_a][col_b] + <span class="variable language_">self</span>.matrix2[row_b][col_a]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">self, ciphertext</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;解密密文：按对解密，返回小写明文&quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># 预处理：移除空格，保留大写字母</span></span><br><span class="line">        cipher_clean = ciphertext.replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;&#x27;</span>).upper()</span><br><span class="line">        <span class="comment"># 按两个字符一组解密</span></span><br><span class="line">        plaintext = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(cipher_clean), <span class="number">2</span>):</span><br><span class="line">            pair = cipher_clean[i:i+<span class="number">2</span>]</span><br><span class="line">            plaintext.append(<span class="variable language_">self</span>._decrypt_pair(pair))</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(plaintext)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_decrypt_pair</span>(<span class="params">self, pair</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;解密单个字符对（c1, c2）&quot;&quot;&quot;</span></span><br><span class="line">        c1, c2 = pair[<span class="number">0</span>], pair[<span class="number">1</span>]</span><br><span class="line">        <span class="comment"># 获取密文在矩阵中的位置（行, 列）</span></span><br><span class="line">        row_c1, col_c1 = <span class="variable language_">self</span>.matrix1_pos[c1]</span><br><span class="line">        row_c2, col_c2 = <span class="variable language_">self</span>.matrix2_pos[c2]</span><br><span class="line">        <span class="comment"># 四方密码规则：(row_c1, col_c2) 和 (row_c2, col_c1) 取自明文矩阵</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.pla_list[row_c1][col_c2] + <span class="variable language_">self</span>.pla_list[row_c2][col_c1]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    cipher = FourSquareCipher(<span class="string">&quot;security&quot;</span>, <span class="string">&quot;information&quot;</span>)</span><br><span class="line">    pt = cipher.decrypt(<span class="string">&#x27;zhnjinhoopcfcuktlj&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;flag&#123;&#123;<span class="subst">&#123;pt&#125;</span>&#125;&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># flag&#123;youngandsuccessful&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="2-27-NPUCTF2020-Classical-Cipher"><a href="#2-27-NPUCTF2020-Classical-Cipher" class="headerlink" title="2.27 [NPUCTF2020]Classical Cipher"></a>2.27 [NPUCTF2020]Classical Cipher</h2><h3 id="2-27-1-题目"><a href="#2-27-1-题目" class="headerlink" title="2.27.1 题目"></a>2.27.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># key.txt</span></span><br><span class="line">解密后的flag请用flag&#123;&#125;包裹</span><br><span class="line"></span><br><span class="line">压缩包密码：gsv_pvb_rh_zgyzhs</span><br><span class="line"></span><br><span class="line">对应明文：   ***_key_**_******</span><br></pre></td></tr></table></figure>

<center><img src=https://dstbp.com/data/imgs/posts/buuctf/NPUCTF2020ClassicalCipher.png width="600"></center>

<h3 id="2-27-2-解题思路"><a href="#2-27-2-解题思路" class="headerlink" title="2.27.2 解题思路"></a>2.27.2 解题思路</h3><p>Atbash 密码 + 变种猪圈密码 + 古埃及象形文字</p>
<h3 id="2-27-3-解题脚本"><a href="#2-27-3-解题脚本" class="headerlink" title="2.27.3 解题脚本"></a>2.27.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">AtBashCipher</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, key=<span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span></span>):</span><br><span class="line">        <span class="variable language_">self</span>.key = key</span><br><span class="line">        <span class="comment"># 预计算加密映射表</span></span><br><span class="line">        <span class="variable language_">self</span>.encrypt_map = &#123;</span><br><span class="line">            key[i]: key[<span class="number">25</span> - i]</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"># 解密映射表与加密相同（对称加密）</span></span><br><span class="line">        <span class="variable language_">self</span>.decrypt_map = <span class="variable language_">self</span>.encrypt_map</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self, plaintext</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;加密明文：将每个字母替换为字母表中对称位置的字母&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(</span><br><span class="line">            <span class="variable language_">self</span>.encrypt_map.get(c.upper(), c)</span><br><span class="line">            <span class="keyword">for</span> c <span class="keyword">in</span> plaintext</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">self, ciphertext</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;解密密文：与加密逻辑完全相同&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.encrypt(ciphertext)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    ct = <span class="string">&#x27;gsv_pvb_rh_zgyzhs&#x27;</span></span><br><span class="line">    result = AtBashCipher().decrypt(ct).lower()</span><br><span class="line">    <span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># the_key_is_atbash</span></span><br><span class="line">    <span class="comment"># flag&#123;classicalcode&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="2-28-BJDCTF2020-Polybius"><a href="#2-28-BJDCTF2020-Polybius" class="headerlink" title="2.28 [BJDCTF2020]Polybius"></a>2.28 [BJDCTF2020]Polybius</h2><h3 id="2-28-1-题目"><a href="#2-28-1-题目" class="headerlink" title="2.28.1 题目"></a>2.28.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">密文：ouauuuoooeeaaiaeauieuooeeiea</span><br><span class="line">hint：VGhlIGxlbmd0aCBvZiB0aGlzIHBsYWludGV4dDogMTQ=</span><br><span class="line">flag:解出明文后，请加上BJD&#123;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-28-2-解题思路"><a href="#2-28-2-解题思路" class="headerlink" title="2.28.2 解题思路"></a>2.28.2 解题思路</h3><p>hint（base64）：The length of this plaintext: 14</p>
<p><strong>Polybius Square Cipher</strong>（棋盘密码）：利用波利比奥斯方阵进行加密的密码方式，密文长度是明文长度的两倍，密文只有五种字符。</p>
<h3 id="2-28-3-解题脚本"><a href="#2-28-3-解题脚本" class="headerlink" title="2.28.3 解题脚本"></a>2.28.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Polybius</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, key: <span class="built_in">str</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        初始化 Polybius 类</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(key) != <span class="number">5</span> <span class="keyword">or</span> <span class="built_in">set</span>(key) != <span class="built_in">set</span>(<span class="string">&#x27;aeoiu&#x27;</span>):</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;Key 必须是 &#x27;aeoiu&#x27; 的排列&quot;</span>)</span><br><span class="line">        <span class="variable language_">self</span>.key = key</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self, plaintext: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        加密函数：将明文加密为 5 元音字母构成的密文</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        cipher = <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">for</span> ch <span class="keyword">in</span> plaintext:</span><br><span class="line">            <span class="keyword">if</span> ch == <span class="string">&#x27;j&#x27;</span>:  <span class="comment"># 传统替代 j-&gt;i</span></span><br><span class="line">                ch = <span class="string">&#x27;i&#x27;</span></span><br><span class="line">            ascii_code = <span class="built_in">ord</span>(ch)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;a&#x27;</span> &lt;= ch &lt;= <span class="string">&#x27;z&#x27;</span>:</span><br><span class="line">                <span class="keyword">if</span> ascii_code &gt; <span class="built_in">ord</span>(<span class="string">&#x27;i&#x27;</span>):</span><br><span class="line">                    ascii_code -= <span class="number">1</span>  <span class="comment"># 去掉 j 后偏移</span></span><br><span class="line">                row, col = <span class="built_in">divmod</span>(ascii_code - <span class="number">97</span>, <span class="number">5</span>)</span><br><span class="line">                cipher += <span class="variable language_">self</span>.key[row] + <span class="variable language_">self</span>.key[col]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">f&quot;不支持字符: <span class="subst">&#123;ch&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> cipher</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">self, cipher: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        解密函数：将密文还原为明文</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(cipher) % <span class="number">2</span> != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;密文长度必须为偶数&quot;</span>)</span><br><span class="line">        solve_c = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">str</span>(<span class="variable language_">self</span>.key.index(c)) <span class="keyword">for</span> c <span class="keyword">in</span> cipher)</span><br><span class="line">        res = <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(solve_c), <span class="number">2</span>):</span><br><span class="line">            row = <span class="built_in">int</span>(solve_c[i])</span><br><span class="line">            col = <span class="built_in">int</span>(solve_c[i + <span class="number">1</span>])</span><br><span class="line">            ascii_code = row * <span class="number">5</span> + col + <span class="number">97</span></span><br><span class="line">            <span class="keyword">if</span> ascii_code &gt;= <span class="built_in">ord</span>(<span class="string">&#x27;j&#x27;</span>):</span><br><span class="line">                ascii_code += <span class="number">1</span>  <span class="comment"># 跳过 j</span></span><br><span class="line">            res += <span class="built_in">chr</span>(ascii_code)</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    cipher = <span class="string">&quot;ouauuuoooeeaaiaeauieuooeeiea&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> key_candidate <span class="keyword">in</span> itertools.permutations(<span class="string">&#x27;aeoiu&#x27;</span>):</span><br><span class="line">        key_str = <span class="string">&#x27;&#x27;</span>.join(key_candidate)</span><br><span class="line">        poly = Polybius(key_str)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            plaintext = poly.decrypt(cipher)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;flag&#x27;</span> <span class="keyword">in</span> plaintext:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;找到可能的key:&quot;</span>, key_str)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;解密结果:&quot;</span>, plaintext)</span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># flag&#123;flagispolybius&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="2-29-ACTF新生赛2020-crypto-classic1"><a href="#2-29-ACTF新生赛2020-crypto-classic1" class="headerlink" title="2.29 [ACTF新生赛2020]crypto-classic1"></a>2.29 [ACTF新生赛2020]crypto-classic1</h2><h3 id="2-29-1-题目"><a href="#2-29-1-题目" class="headerlink" title="2.29.1 题目"></a>2.29.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># hint.txt</span></span><br><span class="line">哇，这里有压缩包的密码哦，于是我低下了头，看向了我的双手，试图从中找到某些规律</span><br><span class="line">xdfv ujko98 edft54 xdfv pok,.; wsdr43</span><br></pre></td></tr></table></figure>

<h3 id="2-29-2-解题思路"><a href="#2-29-2-解题思路" class="headerlink" title="2.29.2 解题思路"></a>2.29.2 解题思路</h3><p><strong>电脑键盘密码</strong>：取每组字母环绕所包围的中心字母作为明文。根据这种规则，得到压缩包密码为：circle。</p>
<p>解压得到：<code>SRLU&#123;LZPL_S_UASHKXUPD_NXYTFTJT&#125;</code>，根据压缩名字提示<strong>维吉尼亚密码</strong>。</p>
<h3 id="2-29-3-解题脚本"><a href="#2-29-3-解题脚本" class="headerlink" title="2.29.3 解题脚本"></a>2.29.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">QwertyKeyboardPassword2</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;围绕式电脑键盘密码&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.letter = &#123;</span><br><span class="line">            <span class="string">&#x27;q&#x27;</span>: <span class="string">&#x27;aw21&#x27;</span>, <span class="string">&#x27;w&#x27;</span>: <span class="string">&#x27;2qase3&#x27;</span>, <span class="string">&#x27;e&#x27;</span>: <span class="string">&#x27;3wsdr4&#x27;</span>, <span class="string">&#x27;r&#x27;</span>: <span class="string">&#x27;4edft5&#x27;</span>, <span class="string">&#x27;t&#x27;</span>: <span class="string">&#x27;5rfgy6&#x27;</span>, <span class="string">&#x27;y&#x27;</span>: <span class="string">&#x27;6tghu7&#x27;</span>, <span class="string">&#x27;u&#x27;</span>: <span class="string">&#x27;7yhji8&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;i&#x27;</span>: <span class="string">&#x27;8ujko9&#x27;</span>, <span class="string">&#x27;o&#x27;</span>: <span class="string">&#x27;9iklp0&#x27;</span>, <span class="string">&#x27;p&#x27;</span>: <span class="string">&#x27;0ol;[-&#x27;</span>, <span class="string">&#x27;a&#x27;</span>: <span class="string">&#x27;qwsz&#x27;</span>, <span class="string">&#x27;s&#x27;</span>: <span class="string">&#x27;wazxde&#x27;</span>, <span class="string">&#x27;d&#x27;</span>: <span class="string">&#x27;esxcfr&#x27;</span>, <span class="string">&#x27;f&#x27;</span>: <span class="string">&#x27;rdcvgt&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;g&#x27;</span>: <span class="string">&#x27;tfvbhy&#x27;</span>, <span class="string">&#x27;h&#x27;</span>: <span class="string">&#x27;ygbnju&#x27;</span>, <span class="string">&#x27;j&#x27;</span>: <span class="string">&#x27;uhnmki&#x27;</span>, <span class="string">&#x27;k&#x27;</span>: <span class="string">&#x27;ijm,lo&#x27;</span>, <span class="string">&#x27;l&#x27;</span>: <span class="string">&#x27;ok,.;p&#x27;</span>, <span class="string">&#x27;z&#x27;</span>: <span class="string">&#x27;xsa&#x27;</span>, <span class="string">&#x27;x&#x27;</span>: <span class="string">&#x27;zsdc&#x27;</span>, </span><br><span class="line">            <span class="string">&#x27;c&#x27;</span>: <span class="string">&#x27;xdfv&#x27;</span>, <span class="string">&#x27;v&#x27;</span>: <span class="string">&#x27;cfgb&#x27;</span>, <span class="string">&#x27;b&#x27;</span>: <span class="string">&#x27;vghn&#x27;</span>, <span class="string">&#x27;n&#x27;</span>: <span class="string">&#x27;bhjm&#x27;</span>, <span class="string">&#x27;m&#x27;</span>: <span class="string">&#x27;njk,&#x27;</span>,</span><br><span class="line"></span><br><span class="line">            <span class="string">&#x27;Q&#x27;</span>: <span class="string">&#x27;AW21&#x27;</span>, <span class="string">&#x27;W&#x27;</span>: <span class="string">&#x27;2QASE3&#x27;</span>, <span class="string">&#x27;E&#x27;</span>: <span class="string">&#x27;3WSDR4&#x27;</span>, <span class="string">&#x27;R&#x27;</span>: <span class="string">&#x27;4EDFT5&#x27;</span>, <span class="string">&#x27;T&#x27;</span>: <span class="string">&#x27;5RFGY6&#x27;</span>, <span class="string">&#x27;Y&#x27;</span>: <span class="string">&#x27;6TGHU7&#x27;</span>, <span class="string">&#x27;U&#x27;</span>: <span class="string">&#x27;7YHJI8&#x27;</span>, </span><br><span class="line">            <span class="string">&#x27;I&#x27;</span>: <span class="string">&#x27;8UJKO9&#x27;</span>, <span class="string">&#x27;O&#x27;</span>: <span class="string">&#x27;9IKLP0&#x27;</span>, <span class="string">&#x27;P&#x27;</span>: <span class="string">&#x27;0OL;[-&#x27;</span>, <span class="string">&#x27;A&#x27;</span>: <span class="string">&#x27;QWSZ&#x27;</span>, <span class="string">&#x27;S&#x27;</span>: <span class="string">&#x27;WAZXDE&#x27;</span>, <span class="string">&#x27;D&#x27;</span>: <span class="string">&#x27;ESXCFR&#x27;</span>, <span class="string">&#x27;F&#x27;</span>: <span class="string">&#x27;RDCVGT&#x27;</span>, </span><br><span class="line">            <span class="string">&#x27;G&#x27;</span>: <span class="string">&#x27;TFVBHY&#x27;</span>, <span class="string">&#x27;H&#x27;</span>: <span class="string">&#x27;YGBNJU&#x27;</span>, <span class="string">&#x27;J&#x27;</span>: <span class="string">&#x27;UHNMKI&#x27;</span>, <span class="string">&#x27;K&#x27;</span>: <span class="string">&#x27;IJM,LO&#x27;</span>, <span class="string">&#x27;L&#x27;</span>: <span class="string">&#x27;OK,.;P&#x27;</span>, <span class="string">&#x27;Z&#x27;</span>: <span class="string">&#x27;XSA&#x27;</span>, <span class="string">&#x27;X&#x27;</span>: <span class="string">&#x27;ZSDC&#x27;</span>, </span><br><span class="line">            <span class="string">&#x27;C&#x27;</span>: <span class="string">&#x27;XDFV&#x27;</span>, <span class="string">&#x27;V&#x27;</span>: <span class="string">&#x27;CFGB&#x27;</span>, <span class="string">&#x27;B&#x27;</span>: <span class="string">&#x27;VGHN&#x27;</span>, <span class="string">&#x27;N&#x27;</span>: <span class="string">&#x27;BHJM&#x27;</span>, <span class="string">&#x27;M&#x27;</span>: <span class="string">&#x27;NJK,&#x27;</span>,</span><br><span class="line"></span><br><span class="line">            <span class="string">&#x27;1&#x27;</span>: <span class="string">&#x27;2q`&#x27;</span>, <span class="string">&#x27;2&#x27;</span>: <span class="string">&#x27;1qw3&#x27;</span>, <span class="string">&#x27;3&#x27;</span>: <span class="string">&#x27;2we4&#x27;</span>, <span class="string">&#x27;4&#x27;</span>: <span class="string">&#x27;3er5&#x27;</span>, <span class="string">&#x27;5&#x27;</span>: <span class="string">&#x27;4rt6&#x27;</span>, <span class="string">&#x27;6&#x27;</span>: <span class="string">&#x27;5ty7&#x27;</span>, <span class="string">&#x27;7&#x27;</span>: <span class="string">&#x27;6yu8&#x27;</span>, <span class="string">&#x27;8&#x27;</span>: <span class="string">&#x27;7ui9&#x27;</span>, <span class="string">&#x27;9&#x27;</span>: <span class="string">&#x27;8io0&#x27;</span>, <span class="string">&#x27;0&#x27;</span>: <span class="string">&#x27;9op-&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encode</span>(<span class="params">self, pt</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(<span class="variable language_">self</span>.letter.get(i) <span class="keyword">for</span> i <span class="keyword">in</span> pt)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decode</span>(<span class="params">self, ct</span>):</span><br><span class="line">        res = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> ct:</span><br><span class="line">            <span class="keyword">for</span> key, value <span class="keyword">in</span> <span class="variable language_">self</span>.letter.items():</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">set</span>(i) == <span class="built_in">set</span>(value):</span><br><span class="line">                    res += key</span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Vigenere</span>:</span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">msg, key</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;维吉尼亚解密&quot;&quot;&quot;</span></span><br><span class="line">        lower_tab = string.ascii_lowercase    <span class="comment"># 小写字母</span></span><br><span class="line">        upper_tab = string.ascii_uppercase    <span class="comment"># 大写字母</span></span><br><span class="line">        digit_tab = string.digits</span><br><span class="line"></span><br><span class="line">        plain_text = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        key_index = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> char <span class="keyword">in</span> msg:</span><br><span class="line">            <span class="keyword">if</span> char.isupper():</span><br><span class="line">                offset = <span class="built_in">ord</span>(key[key_index % <span class="built_in">len</span>(key)].upper()) - <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>)</span><br><span class="line">                plain_text += upper_tab[(upper_tab.index(char) - offset) % <span class="number">26</span>]</span><br><span class="line">                key_index += <span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> char.islower():</span><br><span class="line">                offset = <span class="built_in">ord</span>(key[key_index % <span class="built_in">len</span>(key)].lower()) - <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">                plain_text += lower_tab[(lower_tab.index(char) - offset) % <span class="number">26</span>]</span><br><span class="line">                key_index += <span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> char.isdigit():</span><br><span class="line">                offset = <span class="built_in">ord</span>(key[key_index % <span class="built_in">len</span>(key)].upper()) - <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>)</span><br><span class="line">                plain_text += digit_tab[(digit_tab.index(char) - offset) % <span class="number">10</span>]</span><br><span class="line">                key_index += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                plain_text += char</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> plain_text</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">msg, key</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;维吉尼亚加密&quot;&quot;&quot;</span></span><br><span class="line">        lower_tab = string.ascii_lowercase  <span class="comment"># 小写字母</span></span><br><span class="line">        upper_tab = string.ascii_uppercase  <span class="comment"># 大写字母</span></span><br><span class="line">        digit_tab = string.digits</span><br><span class="line"></span><br><span class="line">        cipher_text = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        key_index = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> char <span class="keyword">in</span> msg:</span><br><span class="line">            <span class="keyword">if</span> char.isupper():</span><br><span class="line">                offset = <span class="built_in">ord</span>(key[key_index % <span class="built_in">len</span>(key)].upper()) - <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>)</span><br><span class="line">                cipher_text += upper_tab[(upper_tab.index(char) + offset) % <span class="number">26</span>]</span><br><span class="line">                key_index += <span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> char.islower():</span><br><span class="line">                offset = <span class="built_in">ord</span>(key[key_index % <span class="built_in">len</span>(key)].lower()) - <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">                cipher_text += lower_tab[(lower_tab.index(char) + offset) % <span class="number">26</span>]</span><br><span class="line">                key_index += <span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> char.isdigit():</span><br><span class="line">                offset = <span class="built_in">ord</span>(key[key_index % <span class="built_in">len</span>(key)].upper()) - <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>)</span><br><span class="line">                cipher_text += digit_tab[(digit_tab.index(char) + offset) % <span class="number">10</span>]</span><br><span class="line">                key_index += <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                cipher_text += char</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> cipher_text</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">recover_key_fragment</span>(<span class="params">plaintext, ciphertext</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;已知部分明文和密文，恢复维吉尼亚密钥片段&quot;&quot;&quot;</span></span><br><span class="line">        key_fragment = []</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> p_char, c_char <span class="keyword">in</span> <span class="built_in">zip</span>(plaintext, ciphertext):</span><br><span class="line">            <span class="keyword">if</span> p_char.isalpha() <span class="keyword">and</span> c_char.isalpha():</span><br><span class="line">                p_offset = <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) <span class="keyword">if</span> p_char.isupper() <span class="keyword">else</span> <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">                c_offset = <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) <span class="keyword">if</span> c_char.isupper() <span class="keyword">else</span> <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"></span><br><span class="line">                key_val = (<span class="built_in">ord</span>(c_char) - c_offset - (<span class="built_in">ord</span>(p_char) - p_offset) + <span class="number">26</span>) % <span class="number">26</span></span><br><span class="line">                key_char = <span class="built_in">chr</span>(<span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) + key_val)  <span class="comment"># 默认输出大写字母</span></span><br><span class="line">                key_fragment.append(key_char)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">continue</span>  <span class="comment"># 非字母字符跳过</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(key_fragment)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    ct = <span class="string">&#x27;xdfv ujko98 edft54 xdfv pok,.; wsdr43&#x27;</span>.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(QwertyKeyboardPassword2().decode(ct))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># circle</span></span><br><span class="line"></span><br><span class="line">    part_pt = <span class="string">&#x27;ACTF&#x27;</span></span><br><span class="line">    part_ct = <span class="string">&#x27;SRLU&#x27;</span></span><br><span class="line">    secret_key = Vigenere.recover_key_fragment(part_pt, part_ct)</span><br><span class="line">    cipher_text = <span class="string">r&#x27;SRLU&#123;LZPL_S_UASHKXUPD_NXYTFTJT&#125;&#x27;</span></span><br><span class="line">    plain_text = Vigenere.decrypt(cipher_text, secret_key)</span><br><span class="line">    <span class="built_in">print</span>(plain_text)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ACTF&#123;TKXW_A_FIDPVFFXO_VIGENERE&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="2-30-浪里淘沙"><a href="#2-30-浪里淘沙" class="headerlink" title="2.30 浪里淘沙"></a>2.30 浪里淘沙</h2><h3 id="2-30-1-题目"><a href="#2-30-1-题目" class="headerlink" title="2.30.1 题目"></a>2.30.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">我有密集恐惧症，所以大家自求多福吧，把获得的单词连在一起提交即可。（我这里有一串数字：<span class="number">4</span>，<span class="number">8</span>，<span class="number">11</span>，<span class="number">15</span>，<span class="number">16</span>）</span><br><span class="line"></span><br><span class="line">tonightsuccessnoticenoticewewesuccesstonightweexamplecryptoshouldwebackspacetonightbackspaceexamplelearnwesublimlearnbackspacetheshouldwelearnfoundsublimsystemexamplesublimfoundlearnshouldmorningsublimsystemuserlearnthecryptomorningexamplenoticetonightlearntonightlearntonightsublimenterusermorningfoundtonightweenterfoundnoticethecryptomorningthebackspacelearntonightlearnsublimtonightlearnfoundenterfoundsuccesstonightsuccessuserfoundmorningtonighttheshouldsublimentertonightenterbackspacelearnexamplenoticeexamplefoundsystemsuccesssublimsuccessshouldtonightcryptowelearncryptofoundshouldsublimsublimweentertonightsuccessshouldentertheentercryptouserbackspaceshouldentersystemsuccesssystementerfoundenterlearnexampletonightnoticemorningusertonightlearnmorningtonightfoundfoundsuccessnoticesystementerlearnexamplebackspaceshouldcryptocryptosublimweexampletonighttheshouldthemorningbackspacelearntonightsystemsuccesssuccessbackspacemorningnoticeuserfoundfoundtonightmorningenterenterthefoundbackspacelearnenterentershouldthesystemfounduserlearnlearnsystemnoticetonighttheshouldlearnuserbackspaceweusernoticeshouldthewefoundsystemwecryptocryptowethebackspacesystementershouldtonightsystemnoticemorningsystemweentermorningfoundsuccessusertonightsuccesstonightbackspaceshouldweenterthewesystemusernoticesystemthelearnexamplelearnfoundlearnnoticeexamplesystemthecryptocryptolearnsystemthecryptoenterlearnexamplemorningmorningweenterentersuccessexampleuserthebackspacenoticesublimenterbackspacesuccessbackspacethesublimexamplesystemtheexamplecryptolearnuserexamplelearnsystemusersuccessenterentersuccesstheuserbackspacelearnsuccessbackspacethesublimshouldwebackspaceexamplesuccesssuccesstonightweusershouldsuccessmorningcryptomorningfoundbackspacesublimshouldentershouldnoticesuccessmorningsuccessexamplelearnshouldsublimlearntonightshoulduserbackspacesublimlearncryptosuccessenternoticetonightmorningtonightwesuccessweuserbackspaceexamplewesystemnoticemorningsystemmorningcryptolearnsystemthethefoundcryptouserlearnusersystemwemorningenterexampleshouldlearncryptofoundenterbackspacelearnenterenterbackspaceshouldbackspacetheshouldthesystemshouldshouldsuccessmorningthefoundsystementersystemtonightcryptowelearnexampleexamplesystementerbackspaceshouldtheentersublimtonightfoundfoundsuccesssuccesssystemsublimcryptoshouldentersublimmorninglearnfoundtonightcryptobackspacesuccesscryptowebackspacefoundshouldnoticeshouldmorningnoticesystemcryptosystemlearnsystemnoticemorningsystementerwemorninglearnsuccessfoundwesuccesswetheusercryptousernoticebackspacesuccessshouldtonightmorningentermorninguserenternoticefoundmorningwetonightsystemthecryptotonightcryptosystemuserthefoundexampletonightusersystemcryptosublimmorninguserthefoundbackspaceshouldsuccesscryptotonightsystemnoticebackspaceusershouldenterthecryptomorningwesublimnoticesuccessnoticeusersuccesstonightlearnweuserenterfounduserexampleshouldshouldtonightwelearnthenoticethewefoundmorningexampleshouldexamplethesuccessnoticeenterfoundthecryptonoticeuserlearnuserweenterfoundmorningsystemweexamplenoticethebackspaceexamplesublimtheusermorningtonightthesuccesscryptosuccessusersuccesstonighttonightwelearnenterenterthemorningentersystemcryptobackspacemorningsystemexamplecryptouserexamplelearnsublimsuccessusersystemfoundmorningshouldcryptotonightsublimtheexamplemorningsystemuserexampleweexamplenoticesuccesssublimnoticecryptoshouldbackspaceshouldthetonightfoundsublimbackspacebackspacetonightshouldbackspacesuccesstonightbackspacesuccessmorningsystemcryptobackspaceentertonighttonightnoticelearnshoulduserfoundexamplesystemthesuccessweusertonightcryptousernoticeenternoticebackspaceusersystemfoundusernoticeshouldlearnuserfoundexampleusermorningshouldsuccessmorningmorningexampleexamplefoundsublimfoundenterbackspacenoticelearnfoundmorningcryptonoticecryptoshouldweshouldtonightcryptobackspacesublimcryptosublimenterentersublimentercryptonoticethethesublimexampleenterentershouldlearncryptoentershouldmorninglearnnoticeuserexamplesublimtonightshouldfoundtonightsuccessshouldmorningfoundtheweuserlearnsublimsystembackspacecryptotheusertonightcryptosublimmorningmorningexamplenoticetheenterlearnshouldmorningsublimfoundtonightsublimsublimexamplefounduserexamplethefoundwemorningnoticefoundcryptosuccesssublimsublimexamplethesuccessexamplenoticesuccessbackspacesublimlearnuserexamplesuccesssuccesssystemsuccessmorningmorninglearnexamplemorningtonightfoundbackspaceenternoticemorningentersuccessmorningusermorningbackspacelearncryptoenteruserenteruserthetonighttonightsuccesslearnenterfoundsuccesssystemfoundbackspaceenterlearnsystemsublimcryptoentermorningwetonightshouldlearnenterfoundcryptonoticelearnlearnshouldfoundsuccessexampletonightthesuccessfoundusertonightenterfoundsuccessshouldmorningusernoticemorningsystemsystemsuccessshouldwelearnenterfoundexamplewethefoundweshouldsystemsystemmorningmorningbackspaceshouldentersublimentertonightsuccesssystemsystemcryptousershouldsublimfoundwetonightnoticeexamplewewesuccessfoundusertonightfoundsystemexamplecryptofoundshouldshouldsuccessenterbackspaceexampletonightthelearnnoticeuserlearnsystemsublimfoundlearnsuccesssystemshouldsublimnoticelearnsystemnoticetonightexamplefoundusernoticeenterlearnnoticecryptousersystemmorningthewesystemfoundfoundshouldsystementerenterbackspacesystemsublimcryptousermorninglearnlearntonightsublimlearnenterenterbackspacesystemuserusercryptoentershouldtheusersublimnoticeexamplemorningexamplesublimsublimbackspacesystemexampleshouldsublimlearnfoundenterbackspacelearnmorningmorningfoundthetonightmorningnoticeenterlearnusersystemtonightbackspaceexamplelearntonightbackspaceweshouldcryptosuccessbackspaceexamplesuccesstheshouldmorninguserbackspacelearnthetheshouldcryptocryptotonightbackspacecryptocryptobackspacebackspacenoticeusertonightentermorningfoundweenterexampleenterfoundusersublimsystemtheexampleexamplesystemsuccessusersublimentermorningbackspacesystemfoundlearnsystemshouldsublimsublimentershouldtheusershouldexampleexampleshouldsuccesswelearnfoundsublimshoulduserweentertonightwenoticesublimsystemlearnshouldfoundsuccessuserentersuccessmorningcryptoenteruserfoundexampletonightlearnexampleexamplefoundlearnsuccesssystembackspacecryptonoticethefoundbackspacelearncryptothelearnlearnexamplesuccessnoticenoticesystemmorningcryptotonightnoticenoticeentersuccesscryptoenterbackspacesublimexampleenterfoundtonightcryptotonightsublimnoticesuccesssublimtheentertonighttheshouldthefoundsystemtonightuserbackspacesuccessshouldwebackspacenoticebackspacebackspacenoticewecryptobackspacebackspaceusertonightlearnsuccessmorningusertonightsuccessshouldbackspacecryptoenterentershouldsublimsystemexamplemorningcryptonoticethesuccessthebackspacenoticelearnsublimlearnsuccesscryptothesuccessenternoticecryptosystemsublimsuccesswebackspaceuserenterlearnuserwewemorningsuccesslearncryptobackspacewecryptosystemlearnenterenteruserexamplefoundsystemcryptousernoticefoundusersublimbackspacewesublimnoticemorningshouldexamplenoticecryptoshouldtonightmorningthefoundsystementerentersystemthecryptobackspacesublimlearnsuccessmorningsublimsystemcryptousersublimwesuccessmorningsublimbackspacecryptobackspacesublimthelearnsuccesssublimlearncryptoweweexamplecryptowenoticelearnfoundbackspacesystemsystemexampleshouldlearnsuccesssublimcryptobackspacetonightbackspacemorningmorningnoticeshouldnoticefoundthetheshouldtheshouldfoundfoundcryptosuccessbackspacesuccessshouldweenternoticeweweshouldmorningfoundusersuccessbackspacewenoticeusersuccessenterenterexamplelearnfoundwetonightusercryptothesublimsublimtonightsuccesslearnbackspacetonightentertonightthesublimnoticewefoundcryptobackspaceenterenterlearnlearntonightexamplesystementersublimnoticecryptoshoulduseruserbackspaceuserwesublimmorningwesystemshouldtonighttheusershouldnoticefoundusernoticeentersublimwethewefoundfoundlearnfoundwecryptosystemexamplemorningcryptocryptosublimtheexamplenoticefoundlearnwelearnmorningtheenterthesystemsublimtonightsuccesssystemlearnshouldenterbackspaceentersuccesssuccessbackspaceexamplenoticeentershouldsublimlearnbackspacetheshouldexamplelearnsystemusersublimbackspacebackspacesuccesswelearntonightexamplewecryptoenterwesystemsystemsublimexamplecryptolearnmorningsublimfoundsublimfoundbackspacefoundtonighttonightnoticesuccesssuccessexampleusersuccesstonightsublimcryptosystemweenterexamplesystemthethenoticesublimtonightbackspacenoticesystemexamplethesuccesstonightmorningsuccesstonightwenoticesublimtonightwelearntonightmorningsublimbackspaceenterthetonightenterwecryptofoundtheenternoticebackspacesuccesswesystemuserexamplebackspaceentersuccesstonightsublimwemorningsuccesssuccesswesublimsuccessnoticesublimfoundlearnlearnweexamplecryptonoticelearnweusershoulduserfoundcryptolearnfoundmorningtonightmorningmorningnoticewecryptowewesuccessfoundsublimweuserentershouldshouldshouldsublimbackspacetonightenterwesublimsuccessshouldfoundthethetonightwecryptoweenterfoundcryptoshouldcryptouseruserfoundentersublimsublimthelearntheshouldnoticebackspacefoundsuccessshouldtonightentermorningsystemmorningtonightwenoticelearnbackspaceexampleusershouldnoticesublimsublimexamplethesuccessnoticesystemmorningnoticecryptosystemsublimcryptosystemsuccessshouldmorningbackspaceshouldmorninglearnnoticenoticeshouldthewewesublimsublimnoticeusersuccessentersystemfoundshouldshouldcryptobackspaceusermorningsystemshouldshouldtonightwesublimuserfoundlearnbackspacethetonightmorningexampleuserthefoundbackspaceshouldtonightcryptocryptofounduserexamplenoticecryptousernoticethenoticeshouldweshouldfoundwemorningcryptosuccesslearnfoundtonightsublimnoticenoticewefoundwewesuccesssublimsublimcryptoweexampletonightsuccessfoundshouldsuccesstonightbackspacesystemshouldwesystemnoticebackspaceusersystembackspacewenoticelearnnoticenoticesuccesslearntonightuserlearnsuccessbackspacesuccesswesystemusercryptonoticethesystemusernoticewethesuccessweshouldfoundshouldcryptomorningtonightwethewesuccesslearntheshouldweexampletonightsuccessnoticenoticemorningfoundmorningfoundusersublimsystemsuccessbackspacesuccessmorninguserthefoundweexamplemorningsublimlearnfoundfoundnoticemorningshouldweuserwemorningexamplesuccesssuccessfoundthetheshouldweusershouldtheshouldexamplenoticefoundsuccesssystemfoundshouldsublimbackspacetonightshouldsystemtonightsuccesslearntonightsystemsublimsuccesscryptobackspacesystemsublimmorningmorningshouldmorninglearnsuccesslearnmorningusermorninglearnexamplecryptoshouldbackspacesublimshouldfoundbackspacesystemsystemweexamplesystemtonightsublimmorningmorninguserfoundcryptolearnbackspaceshouldbackspacenoticesublimfoundthecryptousershouldsuccesssystemsuccessshouldsystembackspacesublimshouldsublimsystembackspaceexampleshouldbackspacesublimnoticelearnsublimuserbackspaceusersublimsuccesssublimuserusernoticeshouldsuccessnoticenoticelearnexamplesystemweexamplesublimbackspacebackspacecryptoshouldusercryptosublimbackspacesublimshouldsystemnoticenoticethesuccesssuccesslearnsystemsublimwenoticelearnusersublimsystemusernoticeuserthesuccesslearnwelearnwenoticecryptolearncryptonoticenoticebackspacecryptothecryptousercryptobackspacesuccesslearnthesystemsuccessthesystemsystemcryptosuccessbackspacesublimlearnsublimcryptobackspacelearnsublimusersublimexamplecryptosublimsystemnoticecryptocryptousertheusernoticebackspacenoticenoticethecryptocryptosystembackspacesublimbackspacecryptocryptobackspacesystemuserthenoticesystemsystemsystemusernoticethecryptouserusersystemtheusercryptoexamplenoticecryptoexamplenoticetheexampleexamplethecryptotheusernoticetheexampleexamplecryptotheexampleexamplethenoticethecryptocryptoexampletheexamplecryptocryptothenoticeexamplecryptonoticetheexampleexampleexamplecryptocryptoexampleexamplethenoticethecryptothethethethethetheexampleexamplethetheexampletheexampletheexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexampleexample</span><br></pre></td></tr></table></figure>

<h3 id="2-30-2-解题思路"><a href="#2-30-2-解题思路" class="headerlink" title="2.30.2 解题思路"></a>2.30.2 解题思路</h3><p><strong>词频分析</strong>：获取每个单词出现的频率，升序排列，最后将排在 4，8，11，15，16 的单词。</p>
<h3 id="2-30-3-解题脚本"><a href="#2-30-3-解题脚本" class="headerlink" title="2.30.3 解题脚本"></a>2.30.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;浪里淘沙.txt&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        ct = f.read()</span><br><span class="line">    lst = [<span class="string">&#x27;tonight&#x27;</span>,<span class="string">&#x27;success&#x27;</span>,<span class="string">&#x27;notice&#x27;</span>,<span class="string">&#x27;example&#x27;</span>,<span class="string">&#x27;should&#x27;</span>,<span class="string">&#x27;crypto&#x27;</span>,<span class="string">&#x27;backspace&#x27;</span>,<span class="string">&#x27;learn&#x27;</span>,<span class="string">&#x27;found&#x27;</span>,<span class="string">&#x27;morning&#x27;</span>,<span class="string">&#x27;we&#x27;</span>,<span class="string">&#x27;system&#x27;</span>,<span class="string">&#x27;sublim&#x27;</span>,<span class="string">&#x27;the&#x27;</span>,<span class="string">&#x27;user&#x27;</span>,<span class="string">&#x27;enter&#x27;</span>]</span><br><span class="line">    hint = [<span class="number">4</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">16</span>]</span><br><span class="line"></span><br><span class="line">    res = <span class="built_in">sorted</span>([(ct.count(word), word) <span class="keyword">for</span> word <span class="keyword">in</span> lst <span class="keyword">if</span> word <span class="keyword">in</span> ct], reverse=<span class="literal">False</span>)</span><br><span class="line">    flag = <span class="string">&#x27;&#x27;</span>.join(res[i-<span class="number">1</span>][<span class="number">1</span>] <span class="keyword">for</span> i <span class="keyword">in</span> hint)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;flag&#123;&#123;<span class="subst">&#123;flag&#125;</span>&#125;&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># flag&#123;weshouldlearnthecrypto&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h1 id="3-现代对称密码"><a href="#3-现代对称密码" class="headerlink" title="3. 现代对称密码"></a>3. 现代对称密码</h1><h2 id="3-1-Rabbit"><a href="#3-1-Rabbit" class="headerlink" title="3.1 Rabbit"></a>3.1 Rabbit</h2><h3 id="3-1-1-题目"><a href="#3-1-1-题目" class="headerlink" title="3.1.1 题目"></a>3.1.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">U2FsdGVkX1/+ydnDPowGbjjJXhZxm2MP2AgI</span><br></pre></td></tr></table></figure>

<h3 id="3-1-2-解题思路"><a href="#3-1-2-解题思路" class="headerlink" title="3.1.2 解题思路"></a>3.1.2 解题思路</h3><p><strong>Rabbit 流密码</strong>：一种高速流加密算法，2003 年首次在 FSE 研讨会上提出。它使用 128 位密钥和 64 位初始化向量（IV），核心是一种能每轮输出 128 位密钥流的位流生成器，用于加密等长明文。Rabbit 设计轻量、运算高效，特别适用于资源受限设备。</p>
<h3 id="3-1-3-解题脚本"><a href="#3-1-3-解题脚本" class="headerlink" title="3.1.3 解题脚本"></a>3.1.3 解题脚本</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title class_">CryptoJS</span> = <span class="title class_">CryptoJS</span> || <span class="keyword">function</span> (<span class="params">n, l</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> i = &#123;&#125;</span><br><span class="line">    , j = i.<span class="property">lib</span> = &#123;&#125;</span><br><span class="line">    , k = j.<span class="property">Base</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">function</span> <span class="title function_">b</span>(<span class="params"></span>) &#123; &#125;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">extend</span>: <span class="keyword">function</span> (<span class="params">p</span>) &#123;</span><br><span class="line">          b.<span class="property"><span class="keyword">prototype</span></span> = <span class="variable language_">this</span>;</span><br><span class="line">          <span class="keyword">var</span> a = <span class="keyword">new</span> b;</span><br><span class="line">          p &amp;&amp; a.<span class="title function_">mixIn</span>(p);</span><br><span class="line">          a.<span class="property">$super</span> = <span class="variable language_">this</span>;</span><br><span class="line">          <span class="keyword">return</span> a</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">create</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">          <span class="keyword">var</span> b = <span class="variable language_">this</span>.<span class="title function_">extend</span>();</span><br><span class="line">          b.<span class="property">init</span>.<span class="title function_">apply</span>(b, <span class="variable language_">arguments</span>);</span><br><span class="line">          <span class="keyword">return</span> b</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">init</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123; &#125;,</span><br><span class="line">        <span class="attr">mixIn</span>: <span class="keyword">function</span> (<span class="params">b</span>) &#123;</span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">var</span> a <span class="keyword">in</span> b)</span><br><span class="line">            b.<span class="title function_">hasOwnProperty</span>(a) &amp;&amp; (<span class="variable language_">this</span>[a] = b[a]);</span><br><span class="line">          b.<span class="title function_">hasOwnProperty</span>(<span class="string">&quot;toString&quot;</span>) &amp;&amp; (<span class="variable language_">this</span>.<span class="property">toString</span> = b.<span class="property">toString</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">clone</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">$super</span>.<span class="title function_">extend</span>(<span class="variable language_">this</span>)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;()</span><br><span class="line">    , e = j.<span class="property">WordArray</span> = k.<span class="title function_">extend</span>(&#123;</span><br><span class="line">      <span class="attr">init</span>: <span class="keyword">function</span> (<span class="params">b, a</span>) &#123;</span><br><span class="line">        b = <span class="variable language_">this</span>.<span class="property">words</span> = b || [];</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">sigBytes</span> = a != l ? a : <span class="number">4</span> * b.<span class="property">length</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">toString</span>: <span class="keyword">function</span> (<span class="params">b</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> (b || c).<span class="title function_">stringify</span>(<span class="variable language_">this</span>)</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">concat</span>: <span class="keyword">function</span> (<span class="params">b</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> a = <span class="variable language_">this</span>.<span class="property">words</span></span><br><span class="line">          , c = b.<span class="property">words</span></span><br><span class="line">          , g = <span class="variable language_">this</span>.<span class="property">sigBytes</span></span><br><span class="line">          , b = b.<span class="property">sigBytes</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">clamp</span>();</span><br><span class="line">        <span class="keyword">if</span> (g % <span class="number">4</span>)</span><br><span class="line">          <span class="keyword">for</span> (<span class="keyword">var</span> h = <span class="number">0</span>; h &lt; b; h++)</span><br><span class="line">            a[g + h &gt;&gt;&gt; <span class="number">2</span>] |= (c[h &gt;&gt;&gt; <span class="number">2</span>] &gt;&gt;&gt; <span class="number">24</span> - <span class="number">8</span> * (h % <span class="number">4</span>) &amp; <span class="number">255</span>) &lt;&lt; <span class="number">24</span> - <span class="number">8</span> * ((g + h) % <span class="number">4</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (<span class="number">65535</span> &lt; c.<span class="property">length</span>)</span><br><span class="line">          <span class="keyword">for</span> (h = <span class="number">0</span>; h &lt; b; h += <span class="number">4</span>)</span><br><span class="line">            a[g + h &gt;&gt;&gt; <span class="number">2</span>] = c[h &gt;&gt;&gt; <span class="number">2</span>];</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">          a.<span class="property">push</span>.<span class="title function_">apply</span>(a, c);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">sigBytes</span> += b;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">clamp</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> b = <span class="variable language_">this</span>.<span class="property">words</span></span><br><span class="line">          , a = <span class="variable language_">this</span>.<span class="property">sigBytes</span>;</span><br><span class="line">        b[a &gt;&gt;&gt; <span class="number">2</span>] &amp;= <span class="number">4294967295</span> &lt;&lt; <span class="number">32</span> - <span class="number">8</span> * (a % <span class="number">4</span>);</span><br><span class="line">        b.<span class="property">length</span> = n.<span class="title function_">ceil</span>(a / <span class="number">4</span>)</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">clone</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> b = k.<span class="property">clone</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>);</span><br><span class="line">        b.<span class="property">words</span> = <span class="variable language_">this</span>.<span class="property">words</span>.<span class="title function_">slice</span>(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> b</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">random</span>: <span class="keyword">function</span> (<span class="params">b</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> a = [], c = <span class="number">0</span>; c &lt; b; c += <span class="number">4</span>)</span><br><span class="line">          a.<span class="title function_">push</span>(<span class="number">4294967296</span> * n.<span class="title function_">random</span>() | <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> e.<span class="title function_">create</span>(a, b)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    , d = i.<span class="property">enc</span> = &#123;&#125;</span><br><span class="line">    , c = d.<span class="property">Hex</span> = &#123;</span><br><span class="line">      <span class="attr">stringify</span>: <span class="keyword">function</span> (<span class="params">b</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> a = b.<span class="property">words</span>, b = b.<span class="property">sigBytes</span>, c = [], g = <span class="number">0</span>; g &lt; b; g++) &#123;</span><br><span class="line">          <span class="keyword">var</span> h = a[g &gt;&gt;&gt; <span class="number">2</span>] &gt;&gt;&gt; <span class="number">24</span> - <span class="number">8</span> * (g % <span class="number">4</span>) &amp; <span class="number">255</span>;</span><br><span class="line">          c.<span class="title function_">push</span>((h &gt;&gt;&gt; <span class="number">4</span>).<span class="title function_">toString</span>(<span class="number">16</span>));</span><br><span class="line">          c.<span class="title function_">push</span>((h &amp; <span class="number">15</span>).<span class="title function_">toString</span>(<span class="number">16</span>))</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> c.<span class="title function_">join</span>(<span class="string">&quot;&quot;</span>)</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">parse</span>: <span class="keyword">function</span> (<span class="params">b</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> a = b.<span class="property">length</span>, c = [], g = <span class="number">0</span>; g &lt; a; g += <span class="number">2</span>)</span><br><span class="line">          c[g &gt;&gt;&gt; <span class="number">3</span>] |= <span class="built_in">parseInt</span>(b.<span class="title function_">substr</span>(g, <span class="number">2</span>), <span class="number">16</span>) &lt;&lt; <span class="number">24</span> - <span class="number">4</span> * (g % <span class="number">8</span>);</span><br><span class="line">        <span class="keyword">return</span> e.<span class="title function_">create</span>(c, a / <span class="number">2</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    , a = d.<span class="property">Latin1</span> = &#123;</span><br><span class="line">      <span class="attr">stringify</span>: <span class="keyword">function</span> (<span class="params">b</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> a = b.<span class="property">words</span>, b = b.<span class="property">sigBytes</span>, c = [], g = <span class="number">0</span>; g &lt; b; g++)</span><br><span class="line">                c.<span class="title function_">push</span>(<span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(a[g &gt;&gt;&gt; <span class="number">2</span>] &gt;&gt;&gt; <span class="number">24</span> - <span class="number">8</span> * (g % <span class="number">4</span>) &amp; <span class="number">255</span>));</span><br><span class="line">            <span class="keyword">return</span> c.<span class="title function_">join</span>(<span class="string">&quot;&quot;</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">parse</span>: <span class="keyword">function</span> (<span class="params">b</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> a = b.<span class="property">length</span>, c = [], g = <span class="number">0</span>; g &lt; a; g++)</span><br><span class="line">                c[g &gt;&gt;&gt; <span class="number">2</span>] |= (b.<span class="title function_">charCodeAt</span>(g) &amp; <span class="number">255</span>) &lt;&lt; <span class="number">24</span> - <span class="number">8</span> * (g % <span class="number">4</span>);</span><br><span class="line">            <span class="keyword">return</span> e.<span class="title function_">create</span>(c, a)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    , f = d.<span class="property">Utf8</span> = &#123;</span><br><span class="line">        <span class="attr">stringify</span>: <span class="keyword">function</span> (<span class="params">b</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">decodeURIComponent</span>(<span class="built_in">escape</span>(a.<span class="title function_">stringify</span>(b)))</span><br><span class="line">            &#125; <span class="keyword">catch</span> (c) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="title class_">Error</span>(<span class="string">&quot;Malformed UTF-8 data&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">parse</span>: <span class="keyword">function</span> (<span class="params">b</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> a.<span class="title function_">parse</span>(<span class="built_in">unescape</span>(<span class="built_in">encodeURIComponent</span>(b)))</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    , o = j.<span class="property">BufferedBlockAlgorithm</span> = k.<span class="title function_">extend</span>(&#123;</span><br><span class="line">        <span class="attr">reset</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_data</span> = e.<span class="title function_">create</span>();</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_nDataBytes</span> = <span class="number">0</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">_append</span>: <span class="keyword">function</span> (<span class="params">b</span>) &#123;</span><br><span class="line">            <span class="string">&quot;string&quot;</span> == <span class="keyword">typeof</span> b &amp;&amp; (b = f.<span class="title function_">parse</span>(b));</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_data</span>.<span class="title function_">concat</span>(b);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_nDataBytes</span> += b.<span class="property">sigBytes</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">_process</span>: <span class="keyword">function</span> (<span class="params">b</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> a = <span class="variable language_">this</span>.<span class="property">_data</span></span><br><span class="line">                , c = a.<span class="property">words</span></span><br><span class="line">                , g = a.<span class="property">sigBytes</span></span><br><span class="line">                , h = <span class="variable language_">this</span>.<span class="property">blockSize</span></span><br><span class="line">                , m = g / (<span class="number">4</span> * h)</span><br><span class="line">                , m = b ? n.<span class="title function_">ceil</span>(m) : n.<span class="title function_">max</span>((m | <span class="number">0</span>) - <span class="variable language_">this</span>.<span class="property">_minBufferSize</span>, <span class="number">0</span>)</span><br><span class="line">                , b = m * h</span><br><span class="line">                , g = n.<span class="title function_">min</span>(<span class="number">4</span> * b, g);</span><br><span class="line">            <span class="keyword">if</span> (b) &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> o = <span class="number">0</span>; o &lt; b; o += h)</span><br><span class="line">                    <span class="variable language_">this</span>.<span class="title function_">_doProcessBlock</span>(c, o);</span><br><span class="line">                o = c.<span class="title function_">splice</span>(<span class="number">0</span>, b);</span><br><span class="line">                a.<span class="property">sigBytes</span> -= g</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> e.<span class="title function_">create</span>(o, g)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">clone</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> b = k.<span class="property">clone</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>);</span><br><span class="line">            b.<span class="property">_data</span> = <span class="variable language_">this</span>.<span class="property">_data</span>.<span class="title function_">clone</span>();</span><br><span class="line">            <span class="keyword">return</span> b</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">_minBufferSize</span>: <span class="number">0</span></span><br><span class="line">    &#125;);</span><br><span class="line">j.<span class="property">Hasher</span> = o.<span class="title function_">extend</span>(&#123;</span><br><span class="line">    <span class="attr">init</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">reset</span>()</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">reset</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        o.<span class="property">reset</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">_doReset</span>()</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">update</span>: <span class="keyword">function</span> (<span class="params">b</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">_append</span>(b);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">_process</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">finalize</span>: <span class="keyword">function</span> (<span class="params">b</span>) &#123;</span><br><span class="line">        b &amp;&amp; <span class="variable language_">this</span>.<span class="title function_">_append</span>(b);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">_doFinalize</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">_hash</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">clone</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> b = o.<span class="property">clone</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>);</span><br><span class="line">        b.<span class="property">_hash</span> = <span class="variable language_">this</span>.<span class="property">_hash</span>.<span class="title function_">clone</span>();</span><br><span class="line">        <span class="keyword">return</span> b</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">blockSize</span>: <span class="number">16</span>,</span><br><span class="line">    <span class="attr">_createHelper</span>: <span class="keyword">function</span> (<span class="params">b</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params">a, c</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> b.<span class="title function_">create</span>(c).<span class="title function_">finalize</span>(a)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">_createHmacHelper</span>: <span class="keyword">function</span> (<span class="params">b</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params">a, c</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> q.<span class="property">HMAC</span>.<span class="title function_">create</span>(b, c).<span class="title function_">finalize</span>(a)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">var</span> q = i.<span class="property">algo</span> = &#123;&#125;;</span><br><span class="line"><span class="keyword">return</span> i</span><br><span class="line">&#125;(<span class="title class_">Math</span>);</span><br><span class="line">(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line"><span class="keyword">var</span> n = <span class="title class_">CryptoJS</span></span><br><span class="line">    , l = n.<span class="property">lib</span>.<span class="property">WordArray</span>;</span><br><span class="line">n.<span class="property">enc</span>.<span class="property">Base64</span> = &#123;</span><br><span class="line">    <span class="attr">stringify</span>: <span class="keyword">function</span> (<span class="params">i</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> j = i.<span class="property">words</span></span><br><span class="line">            , k = i.<span class="property">sigBytes</span></span><br><span class="line">            , e = <span class="variable language_">this</span>.<span class="property">_map</span>;</span><br><span class="line">        i.<span class="title function_">clamp</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = [], d = <span class="number">0</span>; d &lt; k; d += <span class="number">3</span>)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> c = (j[d &gt;&gt;&gt; <span class="number">2</span>] &gt;&gt;&gt; <span class="number">24</span> - <span class="number">8</span> * (d % <span class="number">4</span>) &amp; <span class="number">255</span>) &lt;&lt; <span class="number">16</span> | (j[d + <span class="number">1</span> &gt;&gt;&gt; <span class="number">2</span>] &gt;&gt;&gt; <span class="number">24</span> - <span class="number">8</span> * ((d + <span class="number">1</span>) % <span class="number">4</span>) &amp; <span class="number">255</span>) &lt;&lt; <span class="number">8</span> | j[d + <span class="number">2</span> &gt;&gt;&gt; <span class="number">2</span>] &gt;&gt;&gt; <span class="number">24</span> - <span class="number">8</span> * ((d + <span class="number">2</span>) % <span class="number">4</span>) &amp; <span class="number">255</span>, a = <span class="number">0</span>; <span class="number">4</span> &gt; a &amp;&amp; d + <span class="number">0.75</span> * a &lt; k; a++)</span><br><span class="line">                i.<span class="title function_">push</span>(e.<span class="title function_">charAt</span>(c &gt;&gt;&gt; <span class="number">6</span> * (<span class="number">3</span> - a) &amp; <span class="number">63</span>));</span><br><span class="line">        <span class="keyword">if</span> (j = e.<span class="title function_">charAt</span>(<span class="number">64</span>))</span><br><span class="line">            <span class="keyword">for</span> (; i.<span class="property">length</span> % <span class="number">4</span>;)</span><br><span class="line">                i.<span class="title function_">push</span>(j);</span><br><span class="line">        <span class="keyword">return</span> i.<span class="title function_">join</span>(<span class="string">&quot;&quot;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">parse</span>: <span class="keyword">function</span> (<span class="params">i</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> i = i.<span class="title function_">replace</span>(<span class="regexp">/\s/g</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">            , j = i.<span class="property">length</span></span><br><span class="line">            , k = <span class="variable language_">this</span>.<span class="property">_map</span></span><br><span class="line">            , e = k.<span class="title function_">charAt</span>(<span class="number">64</span>);</span><br><span class="line">        e &amp;&amp; (e = i.<span class="title function_">indexOf</span>(e),</span><br><span class="line">            -<span class="number">1</span> != e &amp;&amp; (j = e));</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> e = [], d = <span class="number">0</span>, c = <span class="number">0</span>; c &lt; j; c++)</span><br><span class="line">            <span class="keyword">if</span> (c % <span class="number">4</span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> a = k.<span class="title function_">indexOf</span>(i.<span class="title function_">charAt</span>(c - <span class="number">1</span>)) &lt;&lt; <span class="number">2</span> * (c % <span class="number">4</span>)</span><br><span class="line">                    , f = k.<span class="title function_">indexOf</span>(i.<span class="title function_">charAt</span>(c)) &gt;&gt;&gt; <span class="number">6</span> - <span class="number">2</span> * (c % <span class="number">4</span>);</span><br><span class="line">                e[d &gt;&gt;&gt; <span class="number">2</span>] |= (a | f) &lt;&lt; <span class="number">24</span> - <span class="number">8</span> * (d % <span class="number">4</span>);</span><br><span class="line">                d++</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">return</span> l.<span class="title function_">create</span>(e, d)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">_map</span>: <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">)();</span><br><span class="line">(<span class="keyword">function</span> (<span class="params">n</span>) &#123;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">l</span>(<span class="params">a, c, b, d, f, g, h</span>) &#123;</span><br><span class="line">    a = a + (c &amp; b | ~c &amp; d) + f + h;</span><br><span class="line">    <span class="keyword">return</span> (a &lt;&lt; g | a &gt;&gt;&gt; <span class="number">32</span> - g) + c</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">i</span>(<span class="params">a, c, b, d, f, g, h</span>) &#123;</span><br><span class="line">    a = a + (c &amp; d | b &amp; ~d) + f + h;</span><br><span class="line">    <span class="keyword">return</span> (a &lt;&lt; g | a &gt;&gt;&gt; <span class="number">32</span> - g) + c</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">j</span>(<span class="params">a, c, b, d, f, g, h</span>) &#123;</span><br><span class="line">    a = a + (c ^ b ^ d) + f + h;</span><br><span class="line">    <span class="keyword">return</span> (a &lt;&lt; g | a &gt;&gt;&gt; <span class="number">32</span> - g) + c</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">k</span>(<span class="params">a, c, b, d, f, g, h</span>) &#123;</span><br><span class="line">    a = a + (b ^ (c | ~d)) + f + h;</span><br><span class="line">    <span class="keyword">return</span> (a &lt;&lt; g | a &gt;&gt;&gt; <span class="number">32</span> - g) + c</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> e = <span class="title class_">CryptoJS</span></span><br><span class="line">    , d = e.<span class="property">lib</span></span><br><span class="line">    , c = d.<span class="property">WordArray</span></span><br><span class="line">    , d = d.<span class="property">Hasher</span></span><br><span class="line">    , a = e.<span class="property">algo</span></span><br><span class="line">    , f = [];</span><br><span class="line">(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> a = <span class="number">0</span>; <span class="number">64</span> &gt; a; a++)</span><br><span class="line">        f[a] = <span class="number">4294967296</span> * n.<span class="title function_">abs</span>(n.<span class="title function_">sin</span>(a + <span class="number">1</span>)) | <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line">)();</span><br><span class="line">a = a.<span class="property">MD5</span> = d.<span class="title function_">extend</span>(&#123;</span><br><span class="line">    <span class="attr">_doReset</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_hash</span> = c.<span class="title function_">create</span>([<span class="number">1732584193</span>, <span class="number">4023233417</span>, <span class="number">2562383102</span>, <span class="number">271733878</span>])</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">_doProcessBlock</span>: <span class="keyword">function</span> (<span class="params">a, c</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> b = <span class="number">0</span>; <span class="number">16</span> &gt; b; b++) &#123;</span><br><span class="line">            <span class="keyword">var</span> d = c + b</span><br><span class="line">                , e = a[d];</span><br><span class="line">            a[d] = (e &lt;&lt; <span class="number">8</span> | e &gt;&gt;&gt; <span class="number">24</span>) &amp; <span class="number">16711935</span> | (e &lt;&lt; <span class="number">24</span> | e &gt;&gt;&gt; <span class="number">8</span>) &amp; <span class="number">4278255360</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> d = <span class="variable language_">this</span>.<span class="property">_hash</span>.<span class="property">words</span>, e = d[<span class="number">0</span>], g = d[<span class="number">1</span>], h = d[<span class="number">2</span>], m = d[<span class="number">3</span>], b = <span class="number">0</span>; <span class="number">64</span> &gt; b; b += <span class="number">4</span>)</span><br><span class="line">            <span class="number">16</span> &gt; b ? (e = <span class="title function_">l</span>(e, g, h, m, a[c + b], <span class="number">7</span>, f[b]),</span><br><span class="line">                m = <span class="title function_">l</span>(m, e, g, h, a[c + b + <span class="number">1</span>], <span class="number">12</span>, f[b + <span class="number">1</span>]),</span><br><span class="line">                h = <span class="title function_">l</span>(h, m, e, g, a[c + b + <span class="number">2</span>], <span class="number">17</span>, f[b + <span class="number">2</span>]),</span><br><span class="line">                g = <span class="title function_">l</span>(g, h, m, e, a[c + b + <span class="number">3</span>], <span class="number">22</span>, f[b + <span class="number">3</span>])) : <span class="number">32</span> &gt; b ? (e = <span class="title function_">i</span>(e, g, h, m, a[c + (b + <span class="number">1</span>) % <span class="number">16</span>], <span class="number">5</span>, f[b]),</span><br><span class="line">                    m = <span class="title function_">i</span>(m, e, g, h, a[c + (b + <span class="number">6</span>) % <span class="number">16</span>], <span class="number">9</span>, f[b + <span class="number">1</span>]),</span><br><span class="line">                    h = <span class="title function_">i</span>(h, m, e, g, a[c + (b + <span class="number">11</span>) % <span class="number">16</span>], <span class="number">14</span>, f[b + <span class="number">2</span>]),</span><br><span class="line">                    g = <span class="title function_">i</span>(g, h, m, e, a[c + b % <span class="number">16</span>], <span class="number">20</span>, f[b + <span class="number">3</span>])) : <span class="number">48</span> &gt; b ? (e = <span class="title function_">j</span>(e, g, h, m, a[c + (<span class="number">3</span> * b + <span class="number">5</span>) % <span class="number">16</span>], <span class="number">4</span>, f[b]),</span><br><span class="line">                        m = <span class="title function_">j</span>(m, e, g, h, a[c + (<span class="number">3</span> * b + <span class="number">8</span>) % <span class="number">16</span>], <span class="number">11</span>, f[b + <span class="number">1</span>]),</span><br><span class="line">                        h = <span class="title function_">j</span>(h, m, e, g, a[c + (<span class="number">3</span> * b + <span class="number">11</span>) % <span class="number">16</span>], <span class="number">16</span>, f[b + <span class="number">2</span>]),</span><br><span class="line">                        g = <span class="title function_">j</span>(g, h, m, e, a[c + (<span class="number">3</span> * b + <span class="number">14</span>) % <span class="number">16</span>], <span class="number">23</span>, f[b + <span class="number">3</span>])) : (e = <span class="title function_">k</span>(e, g, h, m, a[c + <span class="number">3</span> * b % <span class="number">16</span>], <span class="number">6</span>, f[b]),</span><br><span class="line">                            m = <span class="title function_">k</span>(m, e, g, h, a[c + (<span class="number">3</span> * b + <span class="number">7</span>) % <span class="number">16</span>], <span class="number">10</span>, f[b + <span class="number">1</span>]),</span><br><span class="line">                            h = <span class="title function_">k</span>(h, m, e, g, a[c + (<span class="number">3</span> * b + <span class="number">14</span>) % <span class="number">16</span>], <span class="number">15</span>, f[b + <span class="number">2</span>]),</span><br><span class="line">                            g = <span class="title function_">k</span>(g, h, m, e, a[c + (<span class="number">3</span> * b + <span class="number">5</span>) % <span class="number">16</span>], <span class="number">21</span>, f[b + <span class="number">3</span>]));</span><br><span class="line">        d[<span class="number">0</span>] = d[<span class="number">0</span>] + e | <span class="number">0</span>;</span><br><span class="line">        d[<span class="number">1</span>] = d[<span class="number">1</span>] + g | <span class="number">0</span>;</span><br><span class="line">        d[<span class="number">2</span>] = d[<span class="number">2</span>] + h | <span class="number">0</span>;</span><br><span class="line">        d[<span class="number">3</span>] = d[<span class="number">3</span>] + m | <span class="number">0</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">_doFinalize</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> a = <span class="variable language_">this</span>.<span class="property">_data</span></span><br><span class="line">            , c = a.<span class="property">words</span></span><br><span class="line">            , b = <span class="number">8</span> * <span class="variable language_">this</span>.<span class="property">_nDataBytes</span></span><br><span class="line">            , d = <span class="number">8</span> * a.<span class="property">sigBytes</span>;</span><br><span class="line">        c[d &gt;&gt;&gt; <span class="number">5</span>] |= <span class="number">128</span> &lt;&lt; <span class="number">24</span> - d % <span class="number">32</span>;</span><br><span class="line">        c[(d + <span class="number">64</span> &gt;&gt;&gt; <span class="number">9</span> &lt;&lt; <span class="number">4</span>) + <span class="number">14</span>] = (b &lt;&lt; <span class="number">8</span> | b &gt;&gt;&gt; <span class="number">24</span>) &amp; <span class="number">16711935</span> | (b &lt;&lt; <span class="number">24</span> | b &gt;&gt;&gt; <span class="number">8</span>) &amp; <span class="number">4278255360</span>;</span><br><span class="line">        a.<span class="property">sigBytes</span> = <span class="number">4</span> * (c.<span class="property">length</span> + <span class="number">1</span>);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">_process</span>();</span><br><span class="line">        a = <span class="variable language_">this</span>.<span class="property">_hash</span>.<span class="property">words</span>;</span><br><span class="line">        <span class="keyword">for</span> (c = <span class="number">0</span>; <span class="number">4</span> &gt; c; c++)</span><br><span class="line">            b = a[c],</span><br><span class="line">                a[c] = (b &lt;&lt; <span class="number">8</span> | b &gt;&gt;&gt; <span class="number">24</span>) &amp; <span class="number">16711935</span> | (b &lt;&lt; <span class="number">24</span> | b &gt;&gt;&gt; <span class="number">8</span>) &amp; <span class="number">4278255360</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">e.<span class="property">MD5</span> = d.<span class="title function_">_createHelper</span>(a);</span><br><span class="line">e.<span class="property">HmacMD5</span> = d.<span class="title function_">_createHmacHelper</span>(a)</span><br><span class="line">&#125;</span><br><span class="line">)(<span class="title class_">Math</span>);</span><br><span class="line">(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line"><span class="keyword">var</span> n = <span class="title class_">CryptoJS</span></span><br><span class="line">    , l = n.<span class="property">lib</span></span><br><span class="line">    , i = l.<span class="property">Base</span></span><br><span class="line">    , j = l.<span class="property">WordArray</span></span><br><span class="line">    , l = n.<span class="property">algo</span></span><br><span class="line">    , k = l.<span class="property">EvpKDF</span> = i.<span class="title function_">extend</span>(&#123;</span><br><span class="line">        <span class="attr">cfg</span>: i.<span class="title function_">extend</span>(&#123;</span><br><span class="line">            <span class="attr">keySize</span>: <span class="number">4</span>,</span><br><span class="line">            <span class="attr">hasher</span>: l.<span class="property">MD5</span>,</span><br><span class="line">            <span class="attr">iterations</span>: <span class="number">1</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="attr">init</span>: <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">cfg</span> = <span class="variable language_">this</span>.<span class="property">cfg</span>.<span class="title function_">extend</span>(e)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">compute</span>: <span class="keyword">function</span> (<span class="params">e, d</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> c = <span class="variable language_">this</span>.<span class="property">cfg</span>, a = c.<span class="property">hasher</span>.<span class="title function_">create</span>(), f = j.<span class="title function_">create</span>(), i = f.<span class="property">words</span>, k = c.<span class="property">keySize</span>, c = c.<span class="property">iterations</span>; i.<span class="property">length</span> &lt; k;) &#123;</span><br><span class="line">                b &amp;&amp; a.<span class="title function_">update</span>(b);</span><br><span class="line">                <span class="keyword">var</span> b = a.<span class="title function_">update</span>(e).<span class="title function_">finalize</span>(d);</span><br><span class="line">                a.<span class="title function_">reset</span>();</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">var</span> l = <span class="number">1</span>; l &lt; c; l++)</span><br><span class="line">                    b = a.<span class="title function_">finalize</span>(b),</span><br><span class="line">                        a.<span class="title function_">reset</span>();</span><br><span class="line">                f.<span class="title function_">concat</span>(b)</span><br><span class="line">            &#125;</span><br><span class="line">            f.<span class="property">sigBytes</span> = <span class="number">4</span> * k;</span><br><span class="line">            <span class="keyword">return</span> f</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">n.<span class="property">EvpKDF</span> = <span class="keyword">function</span> (<span class="params">e, d, c</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> k.<span class="title function_">create</span>(c).<span class="title function_">compute</span>(e, d)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">)();</span><br><span class="line"><span class="title class_">CryptoJS</span>.<span class="property">lib</span>.<span class="property">Cipher</span> || <span class="keyword">function</span> (<span class="params">n</span>) &#123;</span><br><span class="line"><span class="keyword">var</span> l = <span class="title class_">CryptoJS</span></span><br><span class="line">    , i = l.<span class="property">lib</span></span><br><span class="line">    , j = i.<span class="property">Base</span></span><br><span class="line">    , k = i.<span class="property">WordArray</span></span><br><span class="line">    , e = i.<span class="property">BufferedBlockAlgorithm</span></span><br><span class="line">    , d = l.<span class="property">enc</span>.<span class="property">Base64</span></span><br><span class="line">    , c = l.<span class="property">algo</span>.<span class="property">EvpKDF</span></span><br><span class="line">    , a = i.<span class="property">Cipher</span> = e.<span class="title function_">extend</span>(&#123;</span><br><span class="line">        <span class="attr">cfg</span>: j.<span class="title function_">extend</span>(),</span><br><span class="line">        <span class="attr">createEncryptor</span>: <span class="keyword">function</span> (<span class="params">a, b</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">create</span>(<span class="variable language_">this</span>.<span class="property">_ENC_XFORM_MODE</span>, a, b)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">createDecryptor</span>: <span class="keyword">function</span> (<span class="params">a, b</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">create</span>(<span class="variable language_">this</span>.<span class="property">_DEC_XFORM_MODE</span>, a, b)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">init</span>: <span class="keyword">function</span> (<span class="params">a, b, c</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">cfg</span> = <span class="variable language_">this</span>.<span class="property">cfg</span>.<span class="title function_">extend</span>(c);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_xformMode</span> = a;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_key</span> = b;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">reset</span>()</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">reset</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            e.<span class="property">reset</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">_doReset</span>()</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">process</span>: <span class="keyword">function</span> (<span class="params">a</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">_append</span>(a);</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">_process</span>()</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">finalize</span>: <span class="keyword">function</span> (<span class="params">a</span>) &#123;</span><br><span class="line">            a &amp;&amp; <span class="variable language_">this</span>.<span class="title function_">_append</span>(a);</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">_doFinalize</span>()</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">keySize</span>: <span class="number">4</span>,</span><br><span class="line">        <span class="attr">ivSize</span>: <span class="number">4</span>,</span><br><span class="line">        <span class="attr">_ENC_XFORM_MODE</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">_DEC_XFORM_MODE</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="attr">_createHelper</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params">a</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> &#123;</span><br><span class="line">                    <span class="attr">encrypt</span>: <span class="keyword">function</span> (<span class="params">b, c, d</span>) &#123;</span><br><span class="line">                        <span class="keyword">return</span> (<span class="string">&quot;string&quot;</span> == <span class="keyword">typeof</span> c ? r : p).<span class="title function_">encrypt</span>(a, b, c, d)</span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="attr">decrypt</span>: <span class="keyword">function</span> (<span class="params">b, c, d</span>) &#123;</span><br><span class="line">                        <span class="keyword">return</span> (<span class="string">&quot;string&quot;</span> == <span class="keyword">typeof</span> c ? r : p).<span class="title function_">decrypt</span>(a, b, c, d)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;()</span><br><span class="line">    &#125;);</span><br><span class="line">i.<span class="property">StreamCipher</span> = a.<span class="title function_">extend</span>(&#123;</span><br><span class="line">    <span class="attr">_doFinalize</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="title function_">_process</span>(!<span class="number">0</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">blockSize</span>: <span class="number">1</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">var</span> f = l.<span class="property">mode</span> = &#123;&#125;</span><br><span class="line">    , o = i.<span class="property">BlockCipherMode</span> = j.<span class="title function_">extend</span>(&#123;</span><br><span class="line">        <span class="attr">createEncryptor</span>: <span class="keyword">function</span> (<span class="params">a, b</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">Encryptor</span>.<span class="title function_">create</span>(a, b)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">createDecryptor</span>: <span class="keyword">function</span> (<span class="params">a, b</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">Decryptor</span>.<span class="title function_">create</span>(a, b)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">init</span>: <span class="keyword">function</span> (<span class="params">a, b</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_cipher</span> = a;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">_iv</span> = b</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    , f = f.<span class="property">CBC</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">function</span> <span class="title function_">a</span>(<span class="params">b, c, g</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> d = <span class="variable language_">this</span>.<span class="property">_iv</span>;</span><br><span class="line">            d ? <span class="variable language_">this</span>.<span class="property">_iv</span> = n : d = <span class="variable language_">this</span>.<span class="property">_prevBlock</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> h = <span class="number">0</span>; h &lt; g; h++)</span><br><span class="line">                b[c + h] ^= d[h]</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> b = o.<span class="title function_">extend</span>();</span><br><span class="line">        b.<span class="property">Encryptor</span> = b.<span class="title function_">extend</span>(&#123;</span><br><span class="line">            <span class="attr">processBlock</span>: <span class="keyword">function</span> (<span class="params">b, c</span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> d = <span class="variable language_">this</span>.<span class="property">_cipher</span></span><br><span class="line">                    , h = d.<span class="property">blockSize</span>;</span><br><span class="line">                a.<span class="title function_">call</span>(<span class="variable language_">this</span>, b, c, h);</span><br><span class="line">                d.<span class="title function_">encryptBlock</span>(b, c);</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">_prevBlock</span> = b.<span class="title function_">slice</span>(c, c + h)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        b.<span class="property">Decryptor</span> = b.<span class="title function_">extend</span>(&#123;</span><br><span class="line">            <span class="attr">processBlock</span>: <span class="keyword">function</span> (<span class="params">b, c</span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> d = <span class="variable language_">this</span>.<span class="property">_cipher</span></span><br><span class="line">                    , h = d.<span class="property">blockSize</span></span><br><span class="line">                    , f = b.<span class="title function_">slice</span>(c, c + h);</span><br><span class="line">                d.<span class="title function_">decryptBlock</span>(b, c);</span><br><span class="line">                a.<span class="title function_">call</span>(<span class="variable language_">this</span>, b, c, h);</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">_prevBlock</span> = f</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> b</span><br><span class="line">    &#125;()</span><br><span class="line">    , q = (l.<span class="property">pad</span> = &#123;&#125;).<span class="property">Pkcs7</span> = &#123;</span><br><span class="line">        <span class="attr">pad</span>: <span class="keyword">function</span> (<span class="params">a, b</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> c = <span class="number">4</span> * b, c = c - a.<span class="property">sigBytes</span> % c, d = c &lt;&lt; <span class="number">24</span> | c &lt;&lt; <span class="number">16</span> | c &lt;&lt; <span class="number">8</span> | c, f = [], e = <span class="number">0</span>; e &lt; c; e += <span class="number">4</span>)</span><br><span class="line">                f.<span class="title function_">push</span>(d);</span><br><span class="line">            c = k.<span class="title function_">create</span>(f, c);</span><br><span class="line">            a.<span class="title function_">concat</span>(c)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">unpad</span>: <span class="keyword">function</span> (<span class="params">a</span>) &#123;</span><br><span class="line">            a.<span class="property">sigBytes</span> -= a.<span class="property">words</span>[a.<span class="property">sigBytes</span> - <span class="number">1</span> &gt;&gt;&gt; <span class="number">2</span>] &amp; <span class="number">255</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">i.<span class="property">BlockCipher</span> = a.<span class="title function_">extend</span>(&#123;</span><br><span class="line">    <span class="attr">cfg</span>: a.<span class="property">cfg</span>.<span class="title function_">extend</span>(&#123;</span><br><span class="line">        <span class="attr">mode</span>: f,</span><br><span class="line">        <span class="attr">padding</span>: q</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="attr">reset</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        a.<span class="property">reset</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>);</span><br><span class="line">        <span class="keyword">var</span> b = <span class="variable language_">this</span>.<span class="property">cfg</span></span><br><span class="line">            , c = b.<span class="property">iv</span></span><br><span class="line">            , b = b.<span class="property">mode</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">_xformMode</span> == <span class="variable language_">this</span>.<span class="property">_ENC_XFORM_MODE</span>)</span><br><span class="line">            <span class="keyword">var</span> d = b.<span class="property">createEncryptor</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            d = b.<span class="property">createDecryptor</span>,</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">_minBufferSize</span> = <span class="number">1</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_mode</span> = d.<span class="title function_">call</span>(b, <span class="variable language_">this</span>, c &amp;&amp; c.<span class="property">words</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">_doProcessBlock</span>: <span class="keyword">function</span> (<span class="params">a, b</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_mode</span>.<span class="title function_">processBlock</span>(a, b)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">_doFinalize</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> a = <span class="variable language_">this</span>.<span class="property">cfg</span>.<span class="property">padding</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">_xformMode</span> == <span class="variable language_">this</span>.<span class="property">_ENC_XFORM_MODE</span>) &#123;</span><br><span class="line">            a.<span class="title function_">pad</span>(<span class="variable language_">this</span>.<span class="property">_data</span>, <span class="variable language_">this</span>.<span class="property">blockSize</span>);</span><br><span class="line">            <span class="keyword">var</span> b = <span class="variable language_">this</span>.<span class="title function_">_process</span>(!<span class="number">0</span>)</span><br><span class="line">        &#125; <span class="keyword">else</span></span><br><span class="line">            b = <span class="variable language_">this</span>.<span class="title function_">_process</span>(!<span class="number">0</span>),</span><br><span class="line">                a.<span class="title function_">unpad</span>(b);</span><br><span class="line">        <span class="keyword">return</span> b</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">blockSize</span>: <span class="number">4</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">var</span> b = i.<span class="property">CipherParams</span> = j.<span class="title function_">extend</span>(&#123;</span><br><span class="line">    <span class="attr">init</span>: <span class="keyword">function</span> (<span class="params">a</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">mixIn</span>(a)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">toString</span>: <span class="keyword">function</span> (<span class="params">a</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> (a || <span class="variable language_">this</span>.<span class="property">formatter</span>).<span class="title function_">stringify</span>(<span class="variable language_">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">    , f = (l.<span class="property">format</span> = &#123;&#125;).<span class="property">OpenSSL</span> = &#123;</span><br><span class="line">        <span class="attr">stringify</span>: <span class="keyword">function</span> (<span class="params">a</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> b = a.<span class="property">ciphertext</span></span><br><span class="line">                , a = a.<span class="property">salt</span></span><br><span class="line">                , b = (a ? k.<span class="title function_">create</span>([<span class="number">1398893684</span>, <span class="number">1701076831</span>]).<span class="title function_">concat</span>(a).<span class="title function_">concat</span>(b) : b).<span class="title function_">toString</span>(d);</span><br><span class="line">            <span class="keyword">return</span> b = b.<span class="title function_">replace</span>(<span class="regexp">/(.&#123;64&#125;)/g</span>, <span class="string">&quot;$1\n&quot;</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">parse</span>: <span class="keyword">function</span> (<span class="params">a</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> a = d.<span class="title function_">parse</span>(a)</span><br><span class="line">                , c = a.<span class="property">words</span>;</span><br><span class="line">            <span class="keyword">if</span> (<span class="number">1398893684</span> == c[<span class="number">0</span>] &amp;&amp; <span class="number">1701076831</span> == c[<span class="number">1</span>]) &#123;</span><br><span class="line">                <span class="keyword">var</span> f = k.<span class="title function_">create</span>(c.<span class="title function_">slice</span>(<span class="number">2</span>, <span class="number">4</span>));</span><br><span class="line">                c.<span class="title function_">splice</span>(<span class="number">0</span>, <span class="number">4</span>);</span><br><span class="line">                a.<span class="property">sigBytes</span> -= <span class="number">16</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> b.<span class="title function_">create</span>(&#123;</span><br><span class="line">                <span class="attr">ciphertext</span>: a,</span><br><span class="line">                <span class="attr">salt</span>: f</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    , p = i.<span class="property">SerializableCipher</span> = j.<span class="title function_">extend</span>(&#123;</span><br><span class="line">        <span class="attr">cfg</span>: j.<span class="title function_">extend</span>(&#123;</span><br><span class="line">            <span class="attr">format</span>: f</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="attr">encrypt</span>: <span class="keyword">function</span> (<span class="params">a, c, d, f</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> f = <span class="variable language_">this</span>.<span class="property">cfg</span>.<span class="title function_">extend</span>(f)</span><br><span class="line">                , e = a.<span class="title function_">createEncryptor</span>(d, f)</span><br><span class="line">                , c = e.<span class="title function_">finalize</span>(c)</span><br><span class="line">                , e = e.<span class="property">cfg</span>;</span><br><span class="line">            <span class="keyword">return</span> b.<span class="title function_">create</span>(&#123;</span><br><span class="line">                <span class="attr">ciphertext</span>: c,</span><br><span class="line">                <span class="attr">key</span>: d,</span><br><span class="line">                <span class="attr">iv</span>: e.<span class="property">iv</span>,</span><br><span class="line">                <span class="attr">algorithm</span>: a,</span><br><span class="line">                <span class="attr">mode</span>: e.<span class="property">mode</span>,</span><br><span class="line">                <span class="attr">padding</span>: e.<span class="property">padding</span>,</span><br><span class="line">                <span class="attr">blockSize</span>: a.<span class="property">blockSize</span>,</span><br><span class="line">                <span class="attr">formatter</span>: f.<span class="property">format</span></span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">decrypt</span>: <span class="keyword">function</span> (<span class="params">a, b, c, d</span>) &#123;</span><br><span class="line">            d = <span class="variable language_">this</span>.<span class="property">cfg</span>.<span class="title function_">extend</span>(d);</span><br><span class="line">            b = <span class="variable language_">this</span>.<span class="title function_">_parse</span>(b, d.<span class="property">format</span>);</span><br><span class="line">            <span class="keyword">return</span> a.<span class="title function_">createDecryptor</span>(c, d).<span class="title function_">finalize</span>(b.<span class="property">ciphertext</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">_parse</span>: <span class="keyword">function</span> (<span class="params">a, b</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;string&quot;</span> == <span class="keyword">typeof</span> a ? b.<span class="title function_">parse</span>(a) : a</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    , l = (l.<span class="property">kdf</span> = &#123;&#125;).<span class="property">OpenSSL</span> = &#123;</span><br><span class="line">        <span class="attr">compute</span>: <span class="keyword">function</span> (<span class="params">a, d, f, e</span>) &#123;</span><br><span class="line">            e || (e = k.<span class="title function_">random</span>(<span class="number">8</span>));</span><br><span class="line">            a = c.<span class="title function_">create</span>(&#123;</span><br><span class="line">                <span class="attr">keySize</span>: d + f</span><br><span class="line">            &#125;).<span class="title function_">compute</span>(a, e);</span><br><span class="line">            f = k.<span class="title function_">create</span>(a.<span class="property">words</span>.<span class="title function_">slice</span>(d), <span class="number">4</span> * f);</span><br><span class="line">            a.<span class="property">sigBytes</span> = <span class="number">4</span> * d;</span><br><span class="line">            <span class="keyword">return</span> b.<span class="title function_">create</span>(&#123;</span><br><span class="line">                <span class="attr">key</span>: a,</span><br><span class="line">                <span class="attr">iv</span>: f,</span><br><span class="line">                <span class="attr">salt</span>: e</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    , r = i.<span class="property">PasswordBasedCipher</span> = p.<span class="title function_">extend</span>(&#123;</span><br><span class="line">        <span class="attr">cfg</span>: p.<span class="property">cfg</span>.<span class="title function_">extend</span>(&#123;</span><br><span class="line">            <span class="attr">kdf</span>: l</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="attr">encrypt</span>: <span class="keyword">function</span> (<span class="params">a, b, c, d</span>) &#123;</span><br><span class="line">            d = <span class="variable language_">this</span>.<span class="property">cfg</span>.<span class="title function_">extend</span>(d);</span><br><span class="line">            c = d.<span class="property">kdf</span>.<span class="title function_">compute</span>(c, a.<span class="property">keySize</span>, a.<span class="property">ivSize</span>);</span><br><span class="line">            d.<span class="property">iv</span> = c.<span class="property">iv</span>;</span><br><span class="line">            a = p.<span class="property">encrypt</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>, a, b, c.<span class="property">key</span>, d);</span><br><span class="line">            a.<span class="title function_">mixIn</span>(c);</span><br><span class="line">            <span class="keyword">return</span> a</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">decrypt</span>: <span class="keyword">function</span> (<span class="params">a, b, c, d</span>) &#123;</span><br><span class="line">            d = <span class="variable language_">this</span>.<span class="property">cfg</span>.<span class="title function_">extend</span>(d);</span><br><span class="line">            b = <span class="variable language_">this</span>.<span class="title function_">_parse</span>(b, d.<span class="property">format</span>);</span><br><span class="line">            c = d.<span class="property">kdf</span>.<span class="title function_">compute</span>(c, a.<span class="property">keySize</span>, a.<span class="property">ivSize</span>, b.<span class="property">salt</span>);</span><br><span class="line">            d.<span class="property">iv</span> = c.<span class="property">iv</span>;</span><br><span class="line">            <span class="keyword">return</span> p.<span class="property">decrypt</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>, a, b, c.<span class="property">key</span>, d)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;();</span><br><span class="line">(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">n</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> d = <span class="variable language_">this</span>.<span class="property">_X</span></span><br><span class="line">        , c = <span class="variable language_">this</span>.<span class="property">_C</span>;</span><br><span class="line">    c[<span class="number">0</span>] = c[<span class="number">0</span>] + <span class="number">1295307597</span> + <span class="variable language_">this</span>.<span class="property">_b</span> | <span class="number">0</span>;</span><br><span class="line">    c[<span class="number">1</span>] = c[<span class="number">1</span>] + <span class="number">3545052371</span> + (<span class="number">1295307597</span> &gt; c[<span class="number">0</span>] &gt;&gt;&gt; <span class="number">0</span> ? <span class="number">1</span> : <span class="number">0</span>) | <span class="number">0</span>;</span><br><span class="line">    c[<span class="number">2</span>] = c[<span class="number">2</span>] + <span class="number">886263092</span> + (<span class="number">3545052371</span> &gt; c[<span class="number">1</span>] &gt;&gt;&gt; <span class="number">0</span> ? <span class="number">1</span> : <span class="number">0</span>) | <span class="number">0</span>;</span><br><span class="line">    c[<span class="number">3</span>] = c[<span class="number">3</span>] + <span class="number">1295307597</span> + (<span class="number">886263092</span> &gt; c[<span class="number">2</span>] &gt;&gt;&gt; <span class="number">0</span> ? <span class="number">1</span> : <span class="number">0</span>) | <span class="number">0</span>;</span><br><span class="line">    c[<span class="number">4</span>] = c[<span class="number">4</span>] + <span class="number">3545052371</span> + (<span class="number">1295307597</span> &gt; c[<span class="number">3</span>] &gt;&gt;&gt; <span class="number">0</span> ? <span class="number">1</span> : <span class="number">0</span>) | <span class="number">0</span>;</span><br><span class="line">    c[<span class="number">5</span>] = c[<span class="number">5</span>] + <span class="number">886263092</span> + (<span class="number">3545052371</span> &gt; c[<span class="number">4</span>] &gt;&gt;&gt; <span class="number">0</span> ? <span class="number">1</span> : <span class="number">0</span>) | <span class="number">0</span>;</span><br><span class="line">    c[<span class="number">6</span>] = c[<span class="number">6</span>] + <span class="number">1295307597</span> + (<span class="number">886263092</span> &gt; c[<span class="number">5</span>] &gt;&gt;&gt; <span class="number">0</span> ? <span class="number">1</span> : <span class="number">0</span>) | <span class="number">0</span>;</span><br><span class="line">    c[<span class="number">7</span>] = c[<span class="number">7</span>] + <span class="number">3545052371</span> + (<span class="number">1295307597</span> &gt; c[<span class="number">6</span>] &gt;&gt;&gt; <span class="number">0</span> ? <span class="number">1</span> : <span class="number">0</span>) | <span class="number">0</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_b</span> = <span class="number">3545052371</span> &gt; c[<span class="number">7</span>] &gt;&gt;&gt; <span class="number">0</span> ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> a = <span class="number">0</span>; <span class="number">8</span> &gt; a; a++) &#123;</span><br><span class="line">        <span class="keyword">var</span> f = d[a] + c[a]</span><br><span class="line">            , e = f &amp; <span class="number">65535</span></span><br><span class="line">            , i = f &gt;&gt;&gt; <span class="number">16</span>;</span><br><span class="line">        k[a] = ((e * e &gt;&gt;&gt; <span class="number">17</span>) + e * i &gt;&gt;&gt; <span class="number">15</span>) + i * i ^ ((f &amp; <span class="number">4294901760</span>) * f | <span class="number">0</span>) + ((f &amp; <span class="number">65535</span>) * f | <span class="number">0</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> c = k[<span class="number">0</span>]</span><br><span class="line">        , a = k[<span class="number">1</span>]</span><br><span class="line">        , f = k[<span class="number">2</span>]</span><br><span class="line">        , e = k[<span class="number">3</span>]</span><br><span class="line">        , i = k[<span class="number">4</span>]</span><br><span class="line">        , b = k[<span class="number">5</span>]</span><br><span class="line">        , j = k[<span class="number">6</span>]</span><br><span class="line">        , l = k[<span class="number">7</span>];</span><br><span class="line">    d[<span class="number">0</span>] = c + (l &lt;&lt; <span class="number">16</span> | l &gt;&gt;&gt; <span class="number">16</span>) + (j &lt;&lt; <span class="number">16</span> | j &gt;&gt;&gt; <span class="number">16</span>) | <span class="number">0</span>;</span><br><span class="line">    d[<span class="number">1</span>] = a + (c &lt;&lt; <span class="number">8</span> | c &gt;&gt;&gt; <span class="number">24</span>) + l | <span class="number">0</span>;</span><br><span class="line">    d[<span class="number">2</span>] = f + (a &lt;&lt; <span class="number">16</span> | a &gt;&gt;&gt; <span class="number">16</span>) + (c &lt;&lt; <span class="number">16</span> | c &gt;&gt;&gt; <span class="number">16</span>) | <span class="number">0</span>;</span><br><span class="line">    d[<span class="number">3</span>] = e + (f &lt;&lt; <span class="number">8</span> | f &gt;&gt;&gt; <span class="number">24</span>) + a | <span class="number">0</span>;</span><br><span class="line">    d[<span class="number">4</span>] = i + (e &lt;&lt; <span class="number">16</span> | e &gt;&gt;&gt; <span class="number">16</span>) + (f &lt;&lt; <span class="number">16</span> | f &gt;&gt;&gt; <span class="number">16</span>) | <span class="number">0</span>;</span><br><span class="line">    d[<span class="number">5</span>] = b + (i &lt;&lt; <span class="number">8</span> | i &gt;&gt;&gt; <span class="number">24</span>) + e | <span class="number">0</span>;</span><br><span class="line">    d[<span class="number">6</span>] = j + (b &lt;&lt; <span class="number">16</span> | b &gt;&gt;&gt; <span class="number">16</span>) + (i &lt;&lt; <span class="number">16</span> | i &gt;&gt;&gt; <span class="number">16</span>) | <span class="number">0</span>;</span><br><span class="line">    d[<span class="number">7</span>] = l + (j &lt;&lt; <span class="number">8</span> | j &gt;&gt;&gt; <span class="number">24</span>) + b | <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> l = <span class="title class_">CryptoJS</span></span><br><span class="line">    , i = l.<span class="property">lib</span>.<span class="property">StreamCipher</span></span><br><span class="line">    , j = []</span><br><span class="line">    , k = []</span><br><span class="line">    , e = l.<span class="property">algo</span>.<span class="property">Rabbit</span> = i.<span class="title function_">extend</span>(&#123;</span><br><span class="line">        <span class="attr">_doReset</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> d = <span class="variable language_">this</span>.<span class="property">_key</span>.<span class="property">words</span>, c = d[<span class="number">0</span>], a = d[<span class="number">1</span>], f = d[<span class="number">2</span>], e = d[<span class="number">3</span>], d = <span class="variable language_">this</span>.<span class="property">_X</span> = [c, e &lt;&lt; <span class="number">16</span> | f &gt;&gt;&gt; <span class="number">16</span>, a, c &lt;&lt; <span class="number">16</span> | e &gt;&gt;&gt; <span class="number">16</span>, f, a &lt;&lt; <span class="number">16</span> | c &gt;&gt;&gt; <span class="number">16</span>, e, f &lt;&lt; <span class="number">16</span> | a &gt;&gt;&gt; <span class="number">16</span>], c = <span class="variable language_">this</span>.<span class="property">_C</span> = [f &lt;&lt; <span class="number">16</span> | f &gt;&gt;&gt; <span class="number">16</span>, c &amp; <span class="number">4294901760</span> | a &amp; <span class="number">65535</span>, e &lt;&lt; <span class="number">16</span> | e &gt;&gt;&gt; <span class="number">16</span>, a &amp; <span class="number">4294901760</span> | f &amp; <span class="number">65535</span>, c &lt;&lt; <span class="number">16</span> | c &gt;&gt;&gt; <span class="number">16</span>, f &amp; <span class="number">4294901760</span> | e &amp; <span class="number">65535</span>, a &lt;&lt; <span class="number">16</span> | a &gt;&gt;&gt; <span class="number">16</span>, e &amp; <span class="number">4294901760</span> | c &amp; <span class="number">65535</span>], a = <span class="variable language_">this</span>.<span class="property">_b</span> = <span class="number">0</span>; <span class="number">4</span> &gt; a; a++)</span><br><span class="line">                n.<span class="title function_">call</span>(<span class="variable language_">this</span>);</span><br><span class="line">            <span class="keyword">for</span> (a = <span class="number">0</span>; <span class="number">8</span> &gt; a; a++)</span><br><span class="line">                c[a] ^= d[a + <span class="number">4</span> &amp; <span class="number">7</span>];</span><br><span class="line">            <span class="keyword">if</span> (d = <span class="variable language_">this</span>.<span class="property">cfg</span>.<span class="property">iv</span>) &#123;</span><br><span class="line">                a = d.<span class="property">words</span>;</span><br><span class="line">                d = a[<span class="number">0</span>];</span><br><span class="line">                a = a[<span class="number">1</span>];</span><br><span class="line">                d = (d &lt;&lt; <span class="number">8</span> | d &gt;&gt;&gt; <span class="number">24</span>) &amp; <span class="number">16711935</span> | (d &lt;&lt; <span class="number">24</span> | d &gt;&gt;&gt; <span class="number">8</span>) &amp; <span class="number">4278255360</span>;</span><br><span class="line">                a = (a &lt;&lt; <span class="number">8</span> | a &gt;&gt;&gt; <span class="number">24</span>) &amp; <span class="number">16711935</span> | (a &lt;&lt; <span class="number">24</span> | a &gt;&gt;&gt; <span class="number">8</span>) &amp; <span class="number">4278255360</span>;</span><br><span class="line">                f = d &gt;&gt;&gt; <span class="number">16</span> | a &amp; <span class="number">4294901760</span>;</span><br><span class="line">                e = a &lt;&lt; <span class="number">16</span> | d &amp; <span class="number">65535</span>;</span><br><span class="line">                c[<span class="number">0</span>] ^= d;</span><br><span class="line">                c[<span class="number">1</span>] ^= f;</span><br><span class="line">                c[<span class="number">2</span>] ^= a;</span><br><span class="line">                c[<span class="number">3</span>] ^= e;</span><br><span class="line">                c[<span class="number">4</span>] ^= d;</span><br><span class="line">                c[<span class="number">5</span>] ^= f;</span><br><span class="line">                c[<span class="number">6</span>] ^= a;</span><br><span class="line">                c[<span class="number">7</span>] ^= e;</span><br><span class="line">                <span class="keyword">for</span> (a = <span class="number">0</span>; <span class="number">4</span> &gt; a; a++)</span><br><span class="line">                    n.<span class="title function_">call</span>(<span class="variable language_">this</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">_doProcessBlock</span>: <span class="keyword">function</span> (<span class="params">d, c</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> a = <span class="variable language_">this</span>.<span class="property">_X</span>;</span><br><span class="line">            n.<span class="title function_">call</span>(<span class="variable language_">this</span>);</span><br><span class="line">            j[<span class="number">0</span>] = a[<span class="number">0</span>] ^ a[<span class="number">5</span>] &gt;&gt;&gt; <span class="number">16</span> ^ a[<span class="number">3</span>] &lt;&lt; <span class="number">16</span>;</span><br><span class="line">            j[<span class="number">1</span>] = a[<span class="number">2</span>] ^ a[<span class="number">7</span>] &gt;&gt;&gt; <span class="number">16</span> ^ a[<span class="number">5</span>] &lt;&lt; <span class="number">16</span>;</span><br><span class="line">            j[<span class="number">2</span>] = a[<span class="number">4</span>] ^ a[<span class="number">1</span>] &gt;&gt;&gt; <span class="number">16</span> ^ a[<span class="number">7</span>] &lt;&lt; <span class="number">16</span>;</span><br><span class="line">            j[<span class="number">3</span>] = a[<span class="number">6</span>] ^ a[<span class="number">3</span>] &gt;&gt;&gt; <span class="number">16</span> ^ a[<span class="number">1</span>] &lt;&lt; <span class="number">16</span>;</span><br><span class="line">            <span class="keyword">for</span> (a = <span class="number">0</span>; <span class="number">4</span> &gt; a; a++) &#123;</span><br><span class="line">                <span class="keyword">var</span> e = j[a]</span><br><span class="line">                    , e = (e &lt;&lt; <span class="number">8</span> | e &gt;&gt;&gt; <span class="number">24</span>) &amp; <span class="number">16711935</span> | (e &lt;&lt; <span class="number">24</span> | e &gt;&gt;&gt; <span class="number">8</span>) &amp; <span class="number">4278255360</span>;</span><br><span class="line">                d[c + a] ^= e</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">blockSize</span>: <span class="number">4</span>,</span><br><span class="line">        <span class="attr">ivSize</span>: <span class="number">2</span></span><br><span class="line">    &#125;);</span><br><span class="line">l.<span class="property">Rabbit</span> = i.<span class="title function_">_createHelper</span>(e)</span><br><span class="line">&#125;</span><br><span class="line">)();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">main</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> ciphertext = <span class="string">&quot;U2FsdGVkX1/+ydnDPowGbjjJXhZxm2MP2AgI&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 解密</span></span><br><span class="line">    <span class="keyword">const</span> bytes = <span class="title class_">CryptoJS</span>.<span class="property">Rabbit</span>.<span class="title function_">decrypt</span>(ciphertext, <span class="string">&#x27;&#x27;</span>, &#123;</span><br><span class="line">    <span class="attr">iv</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="attr">mode</span>: <span class="title class_">CryptoJS</span>.<span class="property">mode</span>.<span class="property">CBC</span>,</span><br><span class="line">    <span class="attr">padding</span>: <span class="title class_">CryptoJS</span>.<span class="property">pad</span>.<span class="property">Pkcs7</span></span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;flag&#123;&quot;</span> + <span class="title class_">CryptoJS</span>.<span class="property">enc</span>.<span class="property">Utf8</span>.<span class="title function_">stringify</span>(bytes) + <span class="string">&quot;&#125;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">main</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// flag&#123;Cute_Rabbit&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="3-2-ACTF新生赛2020-crypto-aes"><a href="#3-2-ACTF新生赛2020-crypto-aes" class="headerlink" title="3.2 [ACTF新生赛2020]crypto-aes"></a>3.2 [ACTF新生赛2020]crypto-aes</h2><h3 id="3-2-1-题目"><a href="#3-2-1-题目" class="headerlink" title="3.2.1 题目"></a>3.2.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Cryptodome.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> FLAG</span><br><span class="line"><span class="keyword">from</span> Cryptodome.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    key=os.urandom(<span class="number">2</span>)*<span class="number">16</span></span><br><span class="line">    iv=os.urandom(<span class="number">16</span>)</span><br><span class="line">    <span class="built_in">print</span>(bytes_to_long(key)^bytes_to_long(iv))</span><br><span class="line">    aes=AES.new(key,AES.MODE_CBC,iv)</span><br><span class="line">    enc_flag = aes.encrypt(FLAG)</span><br><span class="line">    <span class="built_in">print</span>(enc_flag)</span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br><span class="line"><span class="number">91144196586662942563895769614300232343026691029427747065707381728622849079757</span></span><br><span class="line"><span class="string">b&#x27;\x8c-\xcd\xde\xa7\xe9\x7f.b\x8aKs\xf1\xba\xc75\xc4d\x13\x07\xac\xa4&amp;\xd6\x91\xfe\xf3\x14\x10|\xf8p&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="3-2-2-解题思路"><a href="#3-2-2-解题思路" class="headerlink" title="3.2.2 解题思路"></a>3.2.2 解题思路</h3><p><strong>参数设置不当、高位泄露</strong></p>
<p>AES 32 字节密钥与 16 字节 IV 进行异或，高 16 字节泄露。且密钥只有 2 字节的熵，后面是重复 16 次。可以求出 key 和 iv。</p>
<h3 id="3-2-3-解题脚本"><a href="#3-2-3-解题脚本" class="headerlink" title="3.2.3 解题脚本"></a>3.2.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, long_to_bytes</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">aes_decrypt</span>(<span class="params">ct, key, iv</span>):</span><br><span class="line">    aes = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    flag = aes.decrypt(ct)</span><br><span class="line">    <span class="keyword">return</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    leak = <span class="number">91144196586662942563895769614300232343026691029427747065707381728622849079757</span></span><br><span class="line">    ciphertext = <span class="string">b&#x27;\x8c-\xcd\xde\xa7\xe9\x7f.b\x8aKs\xf1\xba\xc75\xc4d\x13\x07\xac\xa4&amp;\xd6\x91\xfe\xf3\x14\x10|\xf8p&#x27;</span></span><br><span class="line"></span><br><span class="line">    key = long_to_bytes(leak)[:<span class="number">16</span>]*<span class="number">2</span></span><br><span class="line">    iv = long_to_bytes(leak ^ bytes_to_long(key))</span><br><span class="line">    <span class="built_in">print</span>(aes_decrypt(ciphertext, key, iv))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># b&#x27;actf&#123;W0W_y0u_can_so1v3_AES_now!&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<br>

<h1 id="4-现代非对称密码"><a href="#4-现代非对称密码" class="headerlink" title="4. 现代非对称密码"></a>4. 现代非对称密码</h1><h2 id="4-1-RSA"><a href="#4-1-RSA" class="headerlink" title="4.1 RSA"></a>4.1 RSA</h2><h3 id="4-1-1-题目"><a href="#4-1-1-题目" class="headerlink" title="4.1.1 题目"></a>4.1.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">在一次 RSA 密钥对生成中，假设 p=<span class="number">473398607161</span>，q=<span class="number">4511491</span>，e=<span class="number">17</span></span><br><span class="line">求解出 d 作为 flag 提交</span><br></pre></td></tr></table></figure>

<h3 id="4-1-2-解题思路"><a href="#4-1-2-解题思路" class="headerlink" title="4.1.2 解题思路"></a>4.1.2 解题思路</h3><p><strong>标准 RSA 解密</strong></p>
<p>$ \begin{gathered}<br>\phi(N)&#x3D;(p-1)*(q-1) \<br>d&#x3D;e^{-1} \mod \phi(N)<br>\end{gathered} $</p>
<h3 id="4-1-3-解题脚本"><a href="#4-1-3-解题脚本" class="headerlink" title="4.1.3 解题脚本"></a>4.1.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">p_q_e_d</span>(<span class="params">p, q, e</span>):</span><br><span class="line">    phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">    d = inverse(e, phi)</span><br><span class="line">    <span class="keyword">return</span> d</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    p = <span class="number">473398607161</span></span><br><span class="line">    q = <span class="number">4511491</span></span><br><span class="line">    e = <span class="number">17</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;flag&#123;&#123;<span class="subst">&#123;p_q_e_d(p, q, e)&#125;</span>&#125;&#125;&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># flag&#123;125631357777427553&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="4-2-rsarsa"><a href="#4-2-rsarsa" class="headerlink" title="4.2 rsarsa"></a>4.2 rsarsa</h2><h3 id="4-2-1-题目"><a href="#4-2-1-题目" class="headerlink" title="4.2.1 题目"></a>4.2.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Math <span class="keyword">is</span> cool! Use the RSA algorithm to decode the secret message, c, p, q, <span class="keyword">and</span> e are parameters <span class="keyword">for</span> the RSA algorithm.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p =  <span class="number">9648423029010515676590551740010426534945737639235739800643989352039852507298491399561035009163427050370107570733633350911691280297777160200625281665378483</span></span><br><span class="line">q =  <span class="number">11874843837980297032092405848653656852760910154543380907650040190704283358909208578251063047732443992230647903887510065547947313543299303261986053486569407</span></span><br><span class="line">e =  <span class="number">65537</span></span><br><span class="line">c =  <span class="number">83208298995174604174773590298203639360540024871256126892889661345742403314929861939100492666605647316646576486526217457006376842280869728581726746401583705899941768214138742259689334840735633553053887641847651173776251820293087212885670180367406807406765923638973161375817392737747832762751690104423869019034</span></span><br><span class="line"></span><br><span class="line">Use RSA to find the secret message</span><br></pre></td></tr></table></figure>

<h3 id="4-2-2-解题思路"><a href="#4-2-2-解题思路" class="headerlink" title="4.2.2 解题思路"></a>4.2.2 解题思路</h3><p><strong>标准 RSA 解密</strong></p>
<h3 id="4-2-3-解题脚本"><a href="#4-2-3-解题脚本" class="headerlink" title="4.2.3 解题脚本"></a>4.2.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> prod</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> totient</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_OAEP</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse, long_to_bytes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">standard_rsa_decryption</span>(<span class="params">e, c, primes=<span class="literal">None</span>, n=<span class="literal">None</span>, phi=<span class="literal">None</span>, ct_format=<span class="string">&#x27;int&#x27;</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    标准 RSA 解密</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> phi:</span><br><span class="line">        <span class="keyword">if</span> n:</span><br><span class="line">            phi = totient(n)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            phi = prod(p - <span class="number">1</span> <span class="keyword">for</span> p <span class="keyword">in</span> primes)</span><br><span class="line">            n = prod(p <span class="keyword">for</span> p <span class="keyword">in</span> primes)</span><br><span class="line"></span><br><span class="line">    d = inverse(e, phi)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ct_format == <span class="string">&#x27;base64&#x27;</span>:</span><br><span class="line">        p, q = primes[<span class="number">0</span>], primes[<span class="number">1</span>]</span><br><span class="line">        key_info = RSA.construct((n, e, d, p, q))</span><br><span class="line">        key = RSA.importKey(key_info.exportKey())</span><br><span class="line">        key = PKCS1_OAEP.new(key)</span><br><span class="line">        m = key.decrypt(b64decode(c)).decode()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    p = <span class="number">9648423029010515676590551740010426534945737639235739800643989352039852507298491399561035009163427050370107570733633350911691280297777160200625281665378483</span></span><br><span class="line">    q = <span class="number">11874843837980297032092405848653656852760910154543380907650040190704283358909208578251063047732443992230647903887510065547947313543299303261986053486569407</span></span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line">    c = <span class="number">83208298995174604174773590298203639360540024871256126892889661345742403314929861939100492666605647316646576486526217457006376842280869728581726746401583705899941768214138742259689334840735633553053887641847651173776251820293087212885670180367406807406765923638973161375817392737747832762751690104423869019034</span></span><br><span class="line"></span><br><span class="line">    m = standard_rsa_decryption(e, c, [p, q])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;flag&#123;&#123;<span class="subst">&#123;m&#125;</span>&#125;&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># flag&#123;5577446633554466577768879988&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="4-3-RSA1"><a href="#4-3-RSA1" class="headerlink" title="4.3 RSA1"></a>4.3 RSA1</h2><h3 id="4-3-1-题目"><a href="#4-3-1-题目" class="headerlink" title="4.3.1 题目"></a>4.3.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">8637633767257008567099653486541091171320491509433615447539162437911244175885667806398411790524083553445158113502227745206205327690939504032994699902053229</span> </span><br><span class="line">q = <span class="number">12640674973996472769176047937170883420927050821480010581593137135372473880595613737337630629752577346147039284030082593490776630572584959954205336880228469</span> </span><br><span class="line">dp = <span class="number">6500795702216834621109042351193261530650043841056252930930949663358625016881832840728066026150264693076109354874099841380454881716097778307268116910582929</span> </span><br><span class="line">dq = <span class="number">783472263673553449019532580386470672380574033551303889137911760438881683674556098098256795673512201963002175438762767516968043599582527539160811120550041</span> </span><br><span class="line">c = <span class="number">24722305403887382073567316467649080662631552905960229399079107995602154418176056335800638887527614164073530437657085079676157350205351945222989351316076486573599576041978339872265925062764318536089007310270278526159678937431903862892400747915525118983959970607934142974736675784325993445942031372107342103852</span></span><br></pre></td></tr></table></figure>

<h3 id="4-3-2-解题思路"><a href="#4-3-2-解题思路" class="headerlink" title="4.3.2 解题思路"></a>4.3.2 解题思路</h3><p>$ dp、dq $ <strong>泄露</strong></p>
<p>已知 $ p、q、dp、dq、c $ 求明文 $ m $</p>
<h3 id="4-3-3-解题脚本"><a href="#4-3-3-解题脚本" class="headerlink" title="4.3.3 解题脚本"></a>4.3.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, GCD, inverse</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">p_q_dp_dq_c</span>(<span class="params">p, q, dp, dq, c</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    已知 p, q, dp, dq, c 求 d 和明文 m</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    n = p*q</span><br><span class="line">    _gcd = GCD(p - <span class="number">1</span>, q - <span class="number">1</span>)</span><br><span class="line">    d = ((dp - dq) // _gcd) * inverse((q - <span class="number">1</span>) // _gcd, (p - <span class="number">1</span>) // _gcd) * (q - <span class="number">1</span>) + dq</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    p = <span class="number">8637633767257008567099653486541091171320491509433615447539162437911244175885667806398411790524083553445158113502227745206205327690939504032994699902053229</span> </span><br><span class="line">    q = <span class="number">12640674973996472769176047937170883420927050821480010581593137135372473880595613737337630629752577346147039284030082593490776630572584959954205336880228469</span> </span><br><span class="line">    dp = <span class="number">6500795702216834621109042351193261530650043841056252930930949663358625016881832840728066026150264693076109354874099841380454881716097778307268116910582929</span> </span><br><span class="line">    dq = <span class="number">783472263673553449019532580386470672380574033551303889137911760438881683674556098098256795673512201963002175438762767516968043599582527539160811120550041</span> </span><br><span class="line">    c = <span class="number">24722305403887382073567316467649080662631552905960229399079107995602154418176056335800638887527614164073530437657085079676157350205351945222989351316076486573599576041978339872265925062764318536089007310270278526159678937431903862892400747915525118983959970607934142974736675784325993445942031372107342103852</span></span><br><span class="line"></span><br><span class="line">    plaintext = p_q_dp_dq_c(p, q, dp, dq, c)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(plaintext))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># b&#x27;noxCTF&#123;W31c0m3_70_Ch1n470wn&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="4-4-RSA3"><a href="#4-4-RSA3" class="headerlink" title="4.4 RSA3"></a>4.4 RSA3</h2><h3 id="4-4-1-题目"><a href="#4-4-1-题目" class="headerlink" title="4.4.1 题目"></a>4.4.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">c1=<span class="number">22322035275663237041646893770451933509324701913484303338076210603542612758956262869640822486470121149424485571361007421293675516338822195280313794991136048140918842471219840263536338886250492682739436410013436651161720725855484866690084788721349555662019879081501113222996123305533009325964377798892703161521852805956811219563883312896330156298621674684353919547558127920925706842808914762199011054955816534977675267395009575347820387073483928425066536361482774892370969520740304287456555508933372782327506569010772537497541764311429052216291198932092617792645253901478910801592878203564861118912045464959832566051361</span></span><br><span class="line">n=<span class="number">22708078815885011462462049064339185898712439277226831073457888403129378547350292420267016551819052430779004755846649044001024141485283286483130702616057274698473611149508798869706347501931583117632710700787228016480127677393649929530416598686027354216422565934459015161927613607902831542857977859612596282353679327773303727004407262197231586324599181983572622404590354084541788062262164510140605868122410388090174420147752408554129789760902300898046273909007852818474030770699647647363015102118956737673941354217692696044969695308506436573142565573487583507037356944848039864382339216266670673567488871508925311154801</span></span><br><span class="line">e1=<span class="number">11187289</span></span><br><span class="line">c2=<span class="number">18702010045187015556548691642394982835669262147230212731309938675226458555210425972429418449273410535387985931036711854265623905066805665751803269106880746769003478900791099590239513925449748814075904017471585572848473556490565450062664706449128415834787961947266259789785962922238701134079720414228414066193071495304612341052987455615930023536823801499269773357186087452747500840640419365011554421183037505653461286732740983702740822671148045619497667184586123657285604061875653909567822328914065337797733444640351518775487649819978262363617265797982843179630888729407238496650987720428708217115257989007867331698397</span></span><br><span class="line">e2=<span class="number">9647291</span></span><br></pre></td></tr></table></figure>

<h3 id="4-4-2-解题思路"><a href="#4-4-2-解题思路" class="headerlink" title="4.4.2 解题思路"></a>4.4.2 解题思路</h3><p><strong>RSA 的共模攻击</strong></p>
<p>$ m 、n $ 相同；$ e 、 c $ 不同，且 $ e_1 $ 和 $ e_2 $ 互质。</p>
<h3 id="4-4-3-解题脚本"><a href="#4-4-3-解题脚本" class="headerlink" title="4.4.3 解题脚本"></a>4.4.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcdext</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">common_modulus_attack</span>(<span class="params">e1, e2, c1, c2, n</span>):</span><br><span class="line">    _, r, s = gmpy2.gcdext(e1, e2)</span><br><span class="line">    m = <span class="built_in">pow</span>(c1, r, n) * <span class="built_in">pow</span>(c2, s, n) % n</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>: </span><br><span class="line">    e1 = <span class="number">11187289</span></span><br><span class="line">    e2 = <span class="number">9647291</span></span><br><span class="line">    n = <span class="number">22708078815885011462462049064339185898712439277226831073457888403129378547350292420267016551819052430779004755846649044001024141485283286483130702616057274698473611149508798869706347501931583117632710700787228016480127677393649929530416598686027354216422565934459015161927613607902831542857977859612596282353679327773303727004407262197231586324599181983572622404590354084541788062262164510140605868122410388090174420147752408554129789760902300898046273909007852818474030770699647647363015102118956737673941354217692696044969695308506436573142565573487583507037356944848039864382339216266670673567488871508925311154801</span></span><br><span class="line">    c1=<span class="number">22322035275663237041646893770451933509324701913484303338076210603542612758956262869640822486470121149424485571361007421293675516338822195280313794991136048140918842471219840263536338886250492682739436410013436651161720725855484866690084788721349555662019879081501113222996123305533009325964377798892703161521852805956811219563883312896330156298621674684353919547558127920925706842808914762199011054955816534977675267395009575347820387073483928425066536361482774892370969520740304287456555508933372782327506569010772537497541764311429052216291198932092617792645253901478910801592878203564861118912045464959832566051361</span></span><br><span class="line">    c2=<span class="number">18702010045187015556548691642394982835669262147230212731309938675226458555210425972429418449273410535387985931036711854265623905066805665751803269106880746769003478900791099590239513925449748814075904017471585572848473556490565450062664706449128415834787961947266259789785962922238701134079720414228414066193071495304612341052987455615930023536823801499269773357186087452747500840640419365011554421183037505653461286732740983702740822671148045619497667184586123657285604061875653909567822328914065337797733444640351518775487649819978262363617265797982843179630888729407238496650987720428708217115257989007867331698397</span> </span><br><span class="line"></span><br><span class="line">    m = common_modulus_attack(e1, e2, c1, c2, n)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># b&#x27;flag&#123;49d91077a1abcb14f1a9d546c80be9ef&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="4-5-RSA2"><a href="#4-5-RSA2" class="headerlink" title="4.5 RSA2"></a>4.5 RSA2</h2><h3 id="4-5-1-题目"><a href="#4-5-1-题目" class="headerlink" title="4.5.1 题目"></a>4.5.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">248254007851526241177721526698901802985832766176221609612258877371620580060433101538328030305219918697643619814200930679612109885533801335348445023751670478437073055544724280684733298051599167660303645183146161497485358633681492129668802402065797789905550489547645118787266601929429724133167768465309665906113</span></span><br><span class="line">dp = <span class="number">905074498052346904643025132879518330691925174573054004621877253318682675055421970943552016695528560364834446303196939207056642927148093290374440210503657</span></span><br><span class="line">c = <span class="number">140423670976252696807533673586209400575664282100684119784203527124521188996403826597436883766041879067494280957410201958935737360380801845453829293997433414188838725751796261702622028587211560353362847191060306578510511380965162133472698713063592621028959167072781482562673683090590521214218071160287665180751</span></span><br></pre></td></tr></table></figure>

<h3 id="4-5-2-解题思路"><a href="#4-5-2-解题思路" class="headerlink" title="4.5.2 解题思路"></a>4.5.2 解题思路</h3><p>$ dp、dq $ <strong>泄露</strong></p>
<p>已知 $ dp\ (dq)、n、e、c $，求明文 $ m $</p>
<h3 id="4-5-3-解题脚本"><a href="#4-5-3-解题脚本" class="headerlink" title="4.5.3 解题脚本"></a>4.5.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse, long_to_bytes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dp_n_e_c</span>(<span class="params">dp: <span class="built_in">int</span>, e: <span class="built_in">int</span>, n: <span class="built_in">int</span>, c: <span class="built_in">int</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    已知 dp (dq)、n、e、c，求明文 m</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 遍历可能的k值，寻找有效的p</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, e):</span><br><span class="line">        <span class="keyword">if</span> (dp * e - <span class="number">1</span>) % k: <span class="keyword">continue</span></span><br><span class="line">        p = ((dp * e - <span class="number">1</span>) // k) + <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> n % p: <span class="keyword">continue</span></span><br><span class="line">        q = n // p</span><br><span class="line">        d = inverse(e, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line">    n = <span class="number">248254007851526241177721526698901802985832766176221609612258877371620580060433101538328030305219918697643619814200930679612109885533801335348445023751670478437073055544724280684733298051599167660303645183146161497485358633681492129668802402065797789905550489547645118787266601929429724133167768465309665906113</span></span><br><span class="line">    dp = <span class="number">905074498052346904643025132879518330691925174573054004621877253318682675055421970943552016695528560364834446303196939207056642927148093290374440210503657</span></span><br><span class="line">    c = <span class="number">140423670976252696807533673586209400575664282100684119784203527124521188996403826597436883766041879067494280957410201958935737360380801845453829293997433414188838725751796261702622028587211560353362847191060306578510511380965162133472698713063592621028959167072781482562673683090590521214218071160287665180751</span></span><br><span class="line"></span><br><span class="line">    plaintext = dp_n_e_c(dp, e, n, c)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(plaintext))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># b&#x27;flag&#123;wow_leaking_dp_breaks_rsa?_98924743502&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="4-6-RSA"><a href="#4-6-RSA" class="headerlink" title="4.6 RSA"></a>4.6 RSA</h2><h3 id="4-6-1-题目"><a href="#4-6-1-题目" class="headerlink" title="4.6.1 题目"></a>4.6.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># flag.enc</span></span><br><span class="line"><span class="number">41</span> <span class="number">96</span> C0 <span class="number">59</span> 4A 5E <span class="number">00</span> 0A <span class="number">96</span> B8 <span class="number">78</span> B6 7C D7 <span class="number">24</span> <span class="number">79</span></span><br><span class="line">5B <span class="number">13</span> A8 F2 CA <span class="number">54</span> DA 06 D0 F1 9C <span class="number">28</span> BE <span class="number">68</span> 9B <span class="number">62</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># pub.key</span></span><br><span class="line">-----BEGIN PUBLIC KEY-----</span><br><span class="line">MDwwDQYJKoZIhvcNAQEBBQADKwAwKAIhAMAzLFxkrkcYL2wch21CM2kQVFpY9+<span class="number">7</span>+</span><br><span class="line">/AvKr1rzQczdAgMBAAE=</span><br><span class="line">-----END PUBLIC KEY-----</span><br></pre></td></tr></table></figure>

<h3 id="4-6-2-解题思路"><a href="#4-6-2-解题思路" class="headerlink" title="4.6.2 解题思路"></a>4.6.2 解题思路</h3><p>提取公钥 + 大素数分解 + 标准 RSA 解密</p>
<h3 id="4-6-3-解题脚本"><a href="#4-6-3-解题脚本" class="headerlink" title="4.6.3 解题脚本"></a>4.6.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> rsa</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> prod</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> totient</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_OAEP</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse, long_to_bytes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ExtractKey</span>:</span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">extract_public_key</span>(<span class="params">pem_str</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        提取 PEM 格式公钥中的 n（模数）和 e（公钥指数）</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        pubkey = rsa.PublicKey.load_pkcs1_openssl_pem(pem_str.encode())</span><br><span class="line">        <span class="keyword">return</span> pubkey.n, pubkey.e</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">extract_private_key</span>(<span class="params">pem_str</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        提取 PEM 格式私钥中的 n（模数）和 d（私钥指数）</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        privkey = rsa.PrivateKey.load_pkcs1(pem_str.encode())</span><br><span class="line">        <span class="keyword">return</span> privkey.n, privkey.d</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">queryFactors</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;查询整数 n 的质因数分解结果&quot;&quot;&quot;</span></span><br><span class="line">    response = requests.get(<span class="string">f&quot;http://factordb.com/api?query=<span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">int</span>(factor) <span class="keyword">for</span> factor, count <span class="keyword">in</span> response.json()[<span class="string">&quot;factors&quot;</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">int</span>(count))]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">standard_rsa_decryption</span>(<span class="params">e, c, primes=<span class="literal">None</span>, n=<span class="literal">None</span>, phi=<span class="literal">None</span>, ct_format=<span class="string">&#x27;int&#x27;</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    标准 RSA 解密</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> phi:</span><br><span class="line">        <span class="keyword">if</span> n:</span><br><span class="line">            phi = totient(n)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            phi = prod(p - <span class="number">1</span> <span class="keyword">for</span> p <span class="keyword">in</span> primes)</span><br><span class="line">            n = prod(p <span class="keyword">for</span> p <span class="keyword">in</span> primes)</span><br><span class="line"></span><br><span class="line">    d = inverse(e, phi)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ct_format == <span class="string">&#x27;base64&#x27;</span>:</span><br><span class="line">        p, q = primes[<span class="number">0</span>], primes[<span class="number">1</span>]</span><br><span class="line">        key_info = RSA.construct((n, e, d, p, q))</span><br><span class="line">        key = RSA.importKey(key_info.exportKey())</span><br><span class="line">        key = PKCS1_OAEP.new(key)</span><br><span class="line">        m = key.decrypt(b64decode(c)).decode()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    public_pem = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    -----BEGIN PUBLIC KEY-----</span></span><br><span class="line"><span class="string">    MDwwDQYJKoZIhvcNAQEBBQADKwAwKAIhAMAzLFxkrkcYL2wch21CM2kQVFpY9+7+</span></span><br><span class="line"><span class="string">    /AvKr1rzQczdAgMBAAE=</span></span><br><span class="line"><span class="string">    -----END PUBLIC KEY-----</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    n, e = ExtractKey.extract_public_key(public_pem)</span><br><span class="line">    p, q = queryFactors(n)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;flag.enc&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        c = <span class="built_in">int</span>.from_bytes(f.read(), <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">        m = standard_rsa_decryption(p, q, e, c)</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line">        <span class="comment"># flag&#123;decrypt_256&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="4-7-RSAROLL"><a href="#4-7-RSAROLL" class="headerlink" title="4.7 RSAROLL"></a>4.7 RSAROLL</h2><h3 id="4-7-1-题目"><a href="#4-7-1-题目" class="headerlink" title="4.7.1 题目"></a>4.7.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 题目.txt</span></span><br><span class="line">RSA roll！roll！roll！</span><br><span class="line">Only number <span class="keyword">and</span> a-z</span><br><span class="line">（don<span class="string">&#x27;t use editor which MS provide）</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># data.txt</span></span><br><span class="line"><span class="string">&#123;920139713,19&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">704796792</span></span><br><span class="line"><span class="string">752211152</span></span><br><span class="line"><span class="string">274704164</span></span><br><span class="line"><span class="string">18414022</span></span><br><span class="line"><span class="string">368270835</span></span><br><span class="line"><span class="string">483295235</span></span><br><span class="line"><span class="string">263072905</span></span><br><span class="line"><span class="string">459788476</span></span><br><span class="line"><span class="string">483295235</span></span><br><span class="line"><span class="string">459788476</span></span><br><span class="line"><span class="string">663551792</span></span><br><span class="line"><span class="string">475206804</span></span><br><span class="line"><span class="string">459788476</span></span><br><span class="line"><span class="string">428313374</span></span><br><span class="line"><span class="string">475206804</span></span><br><span class="line"><span class="string">459788476</span></span><br><span class="line"><span class="string">425392137</span></span><br><span class="line"><span class="string">704796792</span></span><br><span class="line"><span class="string">458265677</span></span><br><span class="line"><span class="string">341524652</span></span><br><span class="line"><span class="string">483295235</span></span><br><span class="line"><span class="string">534149509</span></span><br><span class="line"><span class="string">425392137</span></span><br><span class="line"><span class="string">428313374</span></span><br><span class="line"><span class="string">425392137</span></span><br><span class="line"><span class="string">341524652</span></span><br><span class="line"><span class="string">458265677</span></span><br><span class="line"><span class="string">263072905</span></span><br><span class="line"><span class="string">483295235</span></span><br><span class="line"><span class="string">828509797</span></span><br><span class="line"><span class="string">341524652</span></span><br><span class="line"><span class="string">425392137</span></span><br><span class="line"><span class="string">475206804</span></span><br><span class="line"><span class="string">428313374</span></span><br><span class="line"><span class="string">483295235</span></span><br><span class="line"><span class="string">475206804</span></span><br><span class="line"><span class="string">459788476</span></span><br><span class="line"><span class="string">306220148</span></span><br></pre></td></tr></table></figure>

<h3 id="4-7-2-解题思路"><a href="#4-7-2-解题思路" class="headerlink" title="4.7.2 解题思路"></a>4.7.2 解题思路</h3><p>前两个是 $ (n,e) $，后面是密文分块，按行依次解密。</p>
<h3 id="4-7-3-解题脚本"><a href="#4-7-3-解题脚本" class="headerlink" title="4.7.3 解题脚本"></a>4.7.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">p_q_e_d</span>(<span class="params">p, q, e</span>):</span><br><span class="line">    phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">    d = inverse(e, phi)</span><br><span class="line">    <span class="keyword">return</span> d</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    n = <span class="number">920139713</span></span><br><span class="line">    p = <span class="number">49891</span></span><br><span class="line">    q = <span class="number">18443</span></span><br><span class="line">    e = <span class="number">19</span></span><br><span class="line">    d = p_q_e_d(p, q, e)</span><br><span class="line">    </span><br><span class="line">    m = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;roll.txt&quot;</span>,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">            line = line.strip()</span><br><span class="line">            <span class="keyword">if</span> re.<span class="keyword">match</span>(<span class="string">r&#x27;^\d+$&#x27;</span>, line):</span><br><span class="line">                md = <span class="built_in">str</span>(<span class="built_in">pow</span>(<span class="built_in">int</span>(line), d, n))</span><br><span class="line">                m += <span class="built_in">chr</span>(<span class="built_in">int</span>(md))</span><br><span class="line">    <span class="built_in">print</span>(m)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># flag&#123;13212je2ue28fy71w8u87y31r78eu1e2&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="4-8-Dangerous-RSA"><a href="#4-8-Dangerous-RSA" class="headerlink" title="4.8 Dangerous RSA"></a>4.8 Dangerous RSA</h2><h3 id="4-8-1-题目"><a href="#4-8-1-题目" class="headerlink" title="4.8.1 题目"></a>4.8.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">littlE littlE RSA Big Big Dangerous</span><br><span class="line"></span><br><span class="line"><span class="comment"># problem</span></span><br><span class="line"><span class="comment">#n:  0x52d483c27cd806550fbe0e37a61af2e7cf5e0efb723dfc81174c918a27627779b21fa3c851e9e94188eaee3d5cd6f752406a43fbecb53e80836ff1e185d3ccd7782ea846c2e91a7b0808986666e0bdadbfb7bdd65670a589a4d2478e9adcafe97c6ee23614bcb2ecc23580f4d2e3cc1ecfec25c50da4bc754dde6c8bfd8d1fc16956c74d8e9196046a01dc9f3024e11461c294f29d7421140732fedacac97b8fe50999117d27943c953f18c4ff4f8c258d839764078d4b6ef6e8591e0ff5563b31a39e6374d0d41c8c46921c25e5904a817ef8e39e5c9b71225a83269693e0b7e3218fc5e5a1e8412ba16e588b3d6ac536dce39fcdfce81eec79979ea6872793L</span></span><br><span class="line"><span class="comment">#e:  0x3</span></span><br><span class="line"><span class="comment">#c:0x10652cdfaa6b63f6d7bd1109da08181e500e5643f5b240a9024bfa84d5f2cac9310562978347bb232d63e7289283871efab83d84ff5a7b64a94a79d34cfbd4ef121723ba1f663e514f83f6f01492b4e13e1bb4296d96ea5a353d3bf2edd2f449c03c4a3e995237985a596908adc741f32365</span></span><br><span class="line">so,how to get the message?</span><br></pre></td></tr></table></figure>

<h3 id="4-8-2-解题思路"><a href="#4-8-2-解题思路" class="headerlink" title="4.8.2 解题思路"></a>4.8.2 解题思路</h3><p><strong>RSA 低公钥指数攻击</strong></p>
<p>特点：$ e $ 很小，$ m $ 很小，$ n $ 很大</p>
<p>如果明文很小，$ e $ 次方后仍小于模数 $ n（m^e \lt n ）$，则直接对密文开 $ e $ 次方即可得到明文。</p>
<p>如果明文 $ e $ 次方结果比 $ n $ 大（$ m^e \gt n $），则有 $ C&#x3D;m^e+k \cdot n $，尝试爆破 $ k $，如果找到一个 $ k $ 能开 $ e $ 次方根，则找到明文。</p>
<h3 id="4-8-3-解题脚本"><a href="#4-8-3-解题脚本" class="headerlink" title="4.8.3 解题脚本"></a>4.8.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, GCD, inverse</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">low_public_exponent_attack</span>(<span class="params">n, c, e=<span class="literal">None</span>, lower=<span class="literal">None</span>, upper=<span class="literal">None</span>, phi=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    RSA 低公钥指数攻击</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> e <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="comment"># 小 e 且 m^e &lt; n，可直接开 e 次方根</span></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> itertools.count():</span><br><span class="line">            candidate = c + k * n</span><br><span class="line">            root, exact = iroot(candidate, e)</span><br><span class="line">            <span class="keyword">if</span> exact:</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">int</span>(root)</span><br><span class="line">    <span class="keyword">elif</span> phi <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> lower <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> upper <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="comment"># 若未知 e，则爆破 e，满足 gcd(e, φ) = 1 并计算 d</span></span><br><span class="line">        <span class="keyword">for</span> e_candidate <span class="keyword">in</span> <span class="built_in">range</span>(lower, upper):</span><br><span class="line">            <span class="keyword">if</span> GCD(e_candidate, phi) == <span class="number">1</span>:</span><br><span class="line">                d = inverse(e_candidate, phi)</span><br><span class="line">                m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">                <span class="keyword">if</span> <span class="string">b&#x27;flag&#x27;</span> <span class="keyword">in</span> long_to_bytes(m):</span><br><span class="line">                    <span class="keyword">return</span> m</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;参数不完整：请提供 e，或 (phi + low + high)&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    n = <span class="number">0x52d483c27cd806550fbe0e37a61af2e7cf5e0efb723dfc81174c918a27627779b21fa3c851e9e94188eaee3d5cd6f752406a43fbecb53e80836ff1e185d3ccd7782ea846c2e91a7b0808986666e0bdadbfb7bdd65670a589a4d2478e9adcafe97c6ee23614bcb2ecc23580f4d2e3cc1ecfec25c50da4bc754dde6c8bfd8d1fc16956c74d8e9196046a01dc9f3024e11461c294f29d7421140732fedacac97b8fe50999117d27943c953f18c4ff4f8c258d839764078d4b6ef6e8591e0ff5563b31a39e6374d0d41c8c46921c25e5904a817ef8e39e5c9b71225a83269693e0b7e3218fc5e5a1e8412ba16e588b3d6ac536dce39fcdfce81eec79979ea6872793</span></span><br><span class="line">    e = <span class="number">0x3</span></span><br><span class="line">    c = <span class="number">0x10652cdfaa6b63f6d7bd1109da08181e500e5643f5b240a9024bfa84d5f2cac9310562978347bb232d63e7289283871efab83d84ff5a7b64a94a79d34cfbd4ef121723ba1f663e514f83f6f01492b4e13e1bb4296d96ea5a353d3bf2edd2f449c03c4a3e995237985a596908adc741f32365</span></span><br><span class="line">    m = low_public_exponent_attack(n, c, e)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># b&#x27;flag&#123;25df8caf006ee5db94d48144c33b2c3b&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="4-9-HDCTF2019-basic-rsa"><a href="#4-9-HDCTF2019-basic-rsa" class="headerlink" title="4.9 [HDCTF2019]basic rsa"></a>4.9 [HDCTF2019]basic rsa</h2><h3 id="4-9-1-题目"><a href="#4-9-1-题目" class="headerlink" title="4.9.1 题目"></a>4.9.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> a2b_hex,b2a_hex</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;*****************&quot;</span></span><br><span class="line"></span><br><span class="line">p = <span class="number">262248800182277040650192055439906580479</span></span><br><span class="line">q = <span class="number">262854994239322828547925595487519915551</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">65533</span></span><br><span class="line">n = p*q</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(<span class="built_in">int</span>(b2a_hex(flag),<span class="number">16</span>),e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> c</span><br><span class="line"></span><br><span class="line"><span class="comment"># 27565231154623519221597938803435789010285480123476977081867877272451638645710</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="4-9-2-解题思路"><a href="#4-9-2-解题思路" class="headerlink" title="4.9.2 解题思路"></a>4.9.2 解题思路</h3><p><strong>标准 RSA 解密</strong></p>
<h3 id="4-9-3-解题脚本"><a href="#4-9-3-解题脚本" class="headerlink" title="4.9.3 解题脚本"></a>4.9.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> prod</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> totient</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_OAEP</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse, long_to_bytes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">standard_rsa_decryption</span>(<span class="params">e, c, primes=<span class="literal">None</span>, n=<span class="literal">None</span>, phi=<span class="literal">None</span>, ct_format=<span class="string">&#x27;int&#x27;</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    标准 RSA 解密</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> phi:</span><br><span class="line">        <span class="keyword">if</span> n:</span><br><span class="line">            phi = totient(n)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            phi = prod(p - <span class="number">1</span> <span class="keyword">for</span> p <span class="keyword">in</span> primes)</span><br><span class="line">            n = prod(p <span class="keyword">for</span> p <span class="keyword">in</span> primes)</span><br><span class="line"></span><br><span class="line">    d = inverse(e, phi)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ct_format == <span class="string">&#x27;base64&#x27;</span>:</span><br><span class="line">        p, q = primes[<span class="number">0</span>], primes[<span class="number">1</span>]</span><br><span class="line">        key_info = RSA.construct((n, e, d, p, q))</span><br><span class="line">        key = RSA.importKey(key_info.exportKey())</span><br><span class="line">        key = PKCS1_OAEP.new(key)</span><br><span class="line">        m = key.decrypt(b64decode(c)).decode()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    p = <span class="number">262248800182277040650192055439906580479</span></span><br><span class="line">    q = <span class="number">262854994239322828547925595487519915551</span></span><br><span class="line">    e = <span class="number">65533</span></span><br><span class="line">    c = <span class="number">27565231154623519221597938803435789010285480123476977081867877272451638645710</span></span><br><span class="line"></span><br><span class="line">    m = standard_rsa_decryption(e, c, [p, q])</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># b&#x27;flag&#123;B4by_Rs4&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="4-10-GUET-CTF2019-BabyRSA"><a href="#4-10-GUET-CTF2019-BabyRSA" class="headerlink" title="4.10 [GUET-CTF2019]BabyRSA"></a>4.10 [GUET-CTF2019]BabyRSA</h2><h3 id="4-10-1-题目"><a href="#4-10-1-题目" class="headerlink" title="4.10.1 题目"></a>4.10.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">p+q : <span class="number">0x1232fecb92adead91613e7d9ae5e36fe6bb765317d6ed38ad890b4073539a6231a6620584cea5730b5af83a3e80cf30141282c97be4400e33307573af6b25e2ea</span></span><br><span class="line">(p+<span class="number">1</span>)(q+<span class="number">1</span>) : <span class="number">0x5248becef1d925d45705a7302700d6a0ffe5877fddf9451a9c1181c4d82365806085fd86fbaab08b6fc66a967b2566d743c626547203b34ea3fdb1bc06dd3bb765fd8b919e3bd2cb15bc175c9498f9d9a0e216c2dde64d81255fa4c05a1ee619fc1fc505285a239e7bc655ec6605d9693078b800ee80931a7a0c84f33c851740</span></span><br><span class="line">e : <span class="number">0xe6b1bee47bd63f615c7d0a43c529d219</span></span><br><span class="line">d : <span class="number">0x2dde7fbaed477f6d62838d55b0d0964868cf6efb2c282a5f13e6008ce7317a24cb57aec49ef0d738919f47cdcd9677cd52ac2293ec5938aa198f962678b5cd0da344453f521a69b2ac03647cdd8339f4e38cec452d54e60698833d67f9315c02ddaa4c79ebaa902c605d7bda32ce970541b2d9a17d62b52df813b2fb0c5ab1a5</span></span><br><span class="line">enc_flag : <span class="number">0x50ae00623211ba6089ddfae21e204ab616f6c9d294e913550af3d66e85d0c0693ed53ed55c46d8cca1d7c2ad44839030df26b70f22a8567171a759b76fe5f07b3c5a6ec89117ed0a36c0950956b9cde880c575737f779143f921d745ac3bb0e379c05d9a3cc6bf0bea8aa91e4d5e752c7eb46b2e023edbc07d24a7c460a34a9a</span></span><br></pre></td></tr></table></figure>

<h3 id="4-10-2-解题思路"><a href="#4-10-2-解题思路" class="headerlink" title="4.10.2 解题思路"></a>4.10.2 解题思路</h3><p>已知 $ p+q $ 和 $ (p+1) \cdot (q+1) $ 可求 $ n $，标准 RSA 解密</p>
<h3 id="4-10-3-解题脚本"><a href="#4-10-3-解题脚本" class="headerlink" title="4.10.3 解题脚本"></a>4.10.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    d = <span class="number">0x2dde7fbaed477f6d62838d55b0d0964868cf6efb2c282a5f13e6008ce7317a24cb57aec49ef0d738919f47cdcd9677cd52ac2293ec5938aa198f962678b5cd0da344453f521a69b2ac03647cdd8339f4e38cec452d54e60698833d67f9315c02ddaa4c79ebaa902c605d7bda32ce970541b2d9a17d62b52df813b2fb0c5ab1a5</span></span><br><span class="line">    e = <span class="number">0xe6b1bee47bd63f615c7d0a43c529d219</span></span><br><span class="line">    c = <span class="number">0x50ae00623211ba6089ddfae21e204ab616f6c9d294e913550af3d66e85d0c0693ed53ed55c46d8cca1d7c2ad44839030df26b70f22a8567171a759b76fe5f07b3c5a6ec89117ed0a36c0950956b9cde880c575737f779143f921d745ac3bb0e379c05d9a3cc6bf0bea8aa91e4d5e752c7eb46b2e023edbc07d24a7c460a34a9a</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># n = p*q = (p+1)(q+1) - (p+q) - 1</span></span><br><span class="line">    Add = <span class="number">0x1232fecb92adead91613e7d9ae5e36fe6bb765317d6ed38ad890b4073539a6231a6620584cea5730b5af83a3e80cf30141282c97be4400e33307573af6b25e2ea</span></span><br><span class="line">    Mul = <span class="number">0x5248becef1d925d45705a7302700d6a0ffe5877fddf9451a9c1181c4d82365806085fd86fbaab08b6fc66a967b2566d743c626547203b34ea3fdb1bc06dd3bb765fd8b919e3bd2cb15bc175c9498f9d9a0e216c2dde64d81255fa4c05a1ee619fc1fc505285a239e7bc655ec6605d9693078b800ee80931a7a0c84f33c851740</span></span><br><span class="line">    n = Mul - Add - <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># b&#x27;flag&#123;cc7490e-78ab-11e9-b422-8ba97e5da1fd&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="4-11-rsa2"><a href="#4-11-rsa2" class="headerlink" title="4.11 rsa2"></a>4.11 rsa2</h2><h3 id="4-11-1-题目"><a href="#4-11-1-题目" class="headerlink" title="4.11.1 题目"></a>4.11.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">N = <span class="number">101991809777553253470276751399264740131157682329252673501792154507006158434432009141995367241962525705950046253400188884658262496534706438791515071885860897552736656899566915731297225817250639873643376310103992170646906557242832893914902053581087502512787303322747780420210884852166586717636559058152544979471</span></span><br><span class="line">e = <span class="number">46731919563265721307105180410302518676676135509737992912625092976849075262192092549323082367518264378630543338219025744820916471913696072050291990620486581719410354385121760761374229374847695148230596005409978383369740305816082770283909611956355972181848077519920922059268376958811713365106925235218265173085</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">flag = <span class="string">&quot;flag&#123;&quot;</span> + hashlib.md5(<span class="built_in">hex</span>(d)).hexdigest() + <span class="string">&quot;&#125;&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="4-11-2-解题思路"><a href="#4-11-2-解题思路" class="headerlink" title="4.11.2 解题思路"></a>4.11.2 解题思路</h3><p>大素数分解 $ n $，已知 $ n、e $ 求 $ d $</p>
<h3 id="4-11-3-解题脚本"><a href="#4-11-3-解题脚本" class="headerlink" title="4.11.3 解题脚本"></a>4.11.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">queryFactors</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;查询整数n的质因数分解结果&quot;&quot;&quot;</span></span><br><span class="line">    response = requests.get(<span class="string">f&quot;http://factordb.com/api?query=<span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">int</span>(factor) <span class="keyword">for</span> factor, count <span class="keyword">in</span> response.json()[<span class="string">&quot;factors&quot;</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">int</span>(count))]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    N = <span class="number">101991809777553253470276751399264740131157682329252673501792154507006158434432009141995367241962525705950046253400188884658262496534706438791515071885860897552736656899566915731297225817250639873643376310103992170646906557242832893914902053581087502512787303322747780420210884852166586717636559058152544979471</span></span><br><span class="line">    e = <span class="number">46731919563265721307105180410302518676676135509737992912625092976849075262192092549323082367518264378630543338219025744820916471913696072050291990620486581719410354385121760761374229374847695148230596005409978383369740305816082770283909611956355972181848077519920922059268376958811713365106925235218265173085</span></span><br><span class="line">    p, q = queryFactors(N)</span><br><span class="line">    d = inverse(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">hex</span>(d))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;flag&#123;&#123;<span class="subst">&#123;hashlib.md5(<span class="string">b&#x27;0x13b8f87d588e2aa4a27296cf2898f56ab4c8deb5a1222ec080e23afecaf7f975L&#x27;</span>).hexdigest()&#125;</span>&#125;&#125;&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># flag&#123;47bf28da384590448e0b0d23909a25a4&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="4-12-RSA5"><a href="#4-12-RSA5" class="headerlink" title="4.12 RSA5"></a>4.12 RSA5</h2><h3 id="4-12-1-题目"><a href="#4-12-1-题目" class="headerlink" title="4.12.1 题目"></a>4.12.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">m = xxxxxxxx</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">========== n c ==========</span><br><span class="line">n = <span class="number">20474918894051778533305262345601880928088284471121823754049725354072477155873778848055073843345820697886641086842612486541250183965966001591342031562953561793332341641334302847996108417466360688139866505179689516589305636902137210185624650854906780037204412206309949199080005576922775773722438863762117750429327585792093447423980002401200613302943834212820909269713876683465817369158585822294675056978970612202885426436071950214538262921077409076160417436699836138801162621314845608796870206834704116707763169847387223307828908570944984416973019427529790029089766264949078038669523465243837675263858062854739083634207</span></span><br><span class="line">c = <span class="number">974463908243330865728978769213595400782053398596897741316275722596415018912929508637393850919224969271766388710025195039896961956062895570062146947736340342927974992616678893372744261954172873490878805483241196345881721164078651156067119957816422768524442025688079462656755605982104174001635345874022133045402344010045961111720151990412034477755851802769069309069018738541854130183692204758761427121279982002993939745343695671900015296790637464880337375511536424796890996526681200633086841036320395847725935744757993013352804650575068136129295591306569213300156333650910795946800820067494143364885842896291126137320</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">20918819960648891349438263046954902210959146407860980742165930253781318759285692492511475263234242002509419079545644051755251311392635763412553499744506421566074721268822337321637265942226790343839856182100575539845358877493718334237585821263388181126545189723429262149630651289446553402190531135520836104217160268349688525168375213462570213612845898989694324269410202496871688649978370284661017399056903931840656757330859626183773396574056413017367606446540199973155630466239453637232936904063706551160650295031273385619470740593510267285957905801566362502262757750629162937373721291789527659531499435235261620309759</span></span><br><span class="line">c = <span class="number">15819636201971185538694880505120469332582151856714070824521803121848292387556864177196229718923770810072104155432038682511434979353089791861087415144087855679134383396897817458726543883093567600325204596156649305930352575274039425470836355002691145864435755333821133969266951545158052745938252574301327696822347115053614052423028835532509220641378760800693351542633860702225772638930501021571415907348128269681224178300248272689705308911282208685459668200507057183420662959113956077584781737983254788703048275698921427029884282557468334399677849962342196140864403989162117738206246183665814938783122909930082802031855</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">25033254625906757272369609119214202033162128625171246436639570615263949157363273213121556825878737923265290579551873824374870957467163989542063489416636713654642486717219231225074115269684119428086352535471683359486248203644461465935500517901513233739152882943010177276545128308412934555830087776128355125932914846459470221102007666912211992310538890654396487111705385730502843589727289829692152177134753098649781412247065660637826282055169991824099110916576856188876975621376606634258927784025787142263367152947108720757222446686415627479703666031871635656314282727051189190889008763055811680040315277078928068816491</span></span><br><span class="line">c = <span class="number">4185308529416874005831230781014092407198451385955677399668501833902623478395669279404883990725184332709152443372583701076198786635291739356770857286702107156730020004358955622511061410661058982622055199736820808203841446796305284394651714430918690389486920560834672316158146453183789412140939029029324756035358081754426645160033262924330248675216108270980157049705488620263485129480952814764002865280019185127662449318324279383277766416258142275143923532168798413011028271543085249029048997452212503111742302302065401051458066585395360468447460658672952851643547193822775218387853623453638025492389122204507555908862</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">21206968097314131007183427944486801953583151151443627943113736996776787181111063957960698092696800555044199156765677935373149598221184792286812213294617749834607696302116136745662816658117055427803315230042700695125718401646810484873064775005221089174056824724922160855810527236751389605017579545235876864998419873065217294820244730785120525126565815560229001887622837549118168081685183371092395128598125004730268910276024806808565802081366898904032509920453785997056150497645234925528883879419642189109649009132381586673390027614766605038951015853086721168018787523459264932165046816881682774229243688581614306480751</span></span><br><span class="line">c = <span class="number">4521038011044758441891128468467233088493885750850588985708519911154778090597136126150289041893454126674468141393472662337350361712212694867311622970440707727941113263832357173141775855227973742571088974593476302084111770625764222838366277559560887042948859892138551472680654517814916609279748365580610712259856677740518477086531592233107175470068291903607505799432931989663707477017904611426213770238397005743730386080031955694158466558475599751940245039167629126576784024482348452868313417471542956778285567779435940267140679906686531862467627238401003459101637191297209422470388121802536569761414457618258343550613</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">22822039733049388110936778173014765663663303811791283234361230649775805923902173438553927805407463106104699773994158375704033093471761387799852168337898526980521753614307899669015931387819927421875316304591521901592823814417756447695701045846773508629371397013053684553042185725059996791532391626429712416994990889693732805181947970071429309599614973772736556299404246424791660679253884940021728846906344198854779191951739719342908761330661910477119933428550774242910420952496929605686154799487839923424336353747442153571678064520763149793294360787821751703543288696726923909670396821551053048035619499706391118145067</span></span><br><span class="line">c = <span class="number">15406498580761780108625891878008526815145372096234083936681442225155097299264808624358826686906535594853622687379268969468433072388149786607395396424104318820879443743112358706546753935215756078345959375299650718555759698887852318017597503074317356745122514481807843745626429797861463012940172797612589031686718185390345389295851075279278516147076602270178540690147808314172798987497259330037810328523464851895621851859027823681655934104713689539848047163088666896473665500158179046196538210778897730209572708430067658411755959866033531700460551556380993982706171848970460224304996455600503982223448904878212849412357</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">21574139855341432908474064784318462018475296809327285532337706940126942575349507668289214078026102682252713757703081553093108823214063791518482289846780197329821139507974763780260290309600884920811959842925540583967085670848765317877441480914852329276375776405689784571404635852204097622600656222714808541872252335877037561388406257181715278766652824786376262249274960467193961956690974853679795249158751078422296580367506219719738762159965958877806187461070689071290948181949561254144310776943334859775121650186245846031720507944987838489723127897223416802436021278671237227993686791944711422345000479751187704426369</span></span><br><span class="line">c = <span class="number">20366856150710305124583065375297661819795242238376485264951185336996083744604593418983336285185491197426018595031444652123288461491879021096028203694136683203441692987069563513026001861435722117985559909692670907347563594578265880806540396777223906955491026286843168637367593400342814725694366078337030937104035993569672959361347287894143027186846856772983058328919716702982222142848848117768499996617588305301483085428547267337070998767412540225911508196842253134355901263861121500650240296746702967594224401650220168780537141654489215019142122284308116284129004257364769474080721001708734051264841350424152506027932</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">25360227412666612490102161131174584819240931803196448481224305250583841439581008528535930814167338381983764991296575637231916547647970573758269411168219302370541684789125112505021148506809643081950237623703181025696585998044695691322012183660424636496897073045557400768745943787342548267386564625462143150176113656264450210023925571945961405709276631990731602198104287528528055650050486159837612279600415259486306154947514005408907590083747758953115486124865486720633820559135063440942528031402951958557630833503775112010715604278114325528993771081233535247118481765852273252404963430792898948219539473312462979849137</span></span><br><span class="line">c = <span class="number">19892772524651452341027595619482734356243435671592398172680379981502759695784087900669089919987705675899945658648623800090272599154590123082189645021800958076861518397325439521139995652026377132368232502108620033400051346127757698623886142621793423225749240286511666556091787851683978017506983310073524398287279737680091787333547538239920607761080988243639547570818363788673249582783015475682109984715293163137324439862838574460108793714172603672477766831356411304446881998674779501188163600664488032943639694828698984739492200699684462748922883550002652913518229322945040819064133350314536378694523704793396169065179</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">22726855244632356029159691753451822163331519237547639938779517751496498713174588935566576167329576494790219360727877166074136496129927296296996970048082870488804456564986667129388136556137013346228118981936899510687589585286517151323048293150257036847475424044378109168179412287889340596394755257704938006162677656581509375471102546261355748251869048003600520034656264521931808651038524134185732929570384705918563982065684145766427962502261522481994191989820110575981906998431553107525542001187655703534683231777988419268338249547641335718393312295800044734534761692799403469497954062897856299031257454735945867491191</span></span><br><span class="line">c = <span class="number">6040119795175856407541082360023532204614723858688636724822712717572759793960246341800308149739809871234313049629732934797569781053000686185666374833978403290525072598774001731350244744590772795701065129561898116576499984185920661271123665356132719193665474235596884239108030605882777868856122378222681140570519180321286976947154042272622411303981011302586225630859892731724640574658125478287115198406253847367979883768000812605395482952698689604477719478947595442185921480652637868335673233200662100621025061500895729605305665864693122952557361871523165300206070325660353095592778037767395360329231331322823610060006</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">23297333791443053297363000786835336095252290818461950054542658327484507406594632785712767459958917943095522594228205423428207345128899745800927319147257669773812669542782839237744305180098276578841929496345963997512244219376701787616046235397139381894837435562662591060768476997333538748065294033141610502252325292801816812268934171361934399951548627267791401089703937389012586581080223313060159456238857080740699528666411303029934807011214953984169785844714159627792016926490955282697877141614638806397689306795328344778478692084754216753425842557818899467945102646776342655167655384224860504086083147841252232760941</span></span><br><span class="line">c = <span class="number">5418120301208378713115889465579964257871814114515046096090960159737859076829258516920361577853903925954198406843757303687557848302302200229295916902430205737843601806700738234756698575708612424928480440868739120075888681672062206529156566421276611107802917418993625029690627196813830326369874249777619239603300605876865967515719079797115910578653562787899019310139945904958024882417833736304894765433489476234575356755275147256577387022873348906900149634940747104513850154118106991137072643308620284663108283052245750945228995387803432128842152251549292698947407663643895853432650029352092018372834457054271102816934</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">28873667904715682722987234293493200306976947898711255064125115933666968678742598858722431426218914462903521596341771131695619382266194233561677824357379805303885993804266436810606263022097900266975250431575654686915049693091467864820512767070713267708993899899011156106766178906700336111712803362113039613548672937053397875663144794018087017731949087794894903737682383916173267421403408140967713071026001874733487295007501068871044649170615709891451856792232315526696220161842742664778581287321318748202431466508948902745314372299799561625186955234673012098210919745879882268512656931714326782335211089576897310591491</span></span><br><span class="line">c = <span class="number">9919880463786836684987957979091527477471444996392375244075527841865509160181666543016317634963512437510324198702416322841377489417029572388474450075801462996825244657530286107428186354172836716502817609070590929769261932324275353289939302536440310628698349244872064005700644520223727670950787924296004296883032978941200883362653993351638545860207179022472492671256630427228461852668118035317021428675954874947015197745916918197725121122236369382741533983023462255913924692806249387449016629865823316402366017657844166919846683497851842388058283856219900535567427103603869955066193425501385255322097901531402103883869</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">22324685947539653722499932469409607533065419157347813961958075689047690465266404384199483683908594787312445528159635527833904475801890381455653807265501217328757871352731293000303438205315816792663917579066674842307743845261771032363928568844669895768092515658328756229245837025261744260614860746997931503548788509983868038349720225305730985576293675269073709022350700836510054067641753713212999954307022524495885583361707378513742162566339010134354907863733205921845038918224463903789841881400814074587261720283879760122070901466517118265422863420376921536734845502100251460872499122236686832189549698020737176683019</span></span><br><span class="line">c = <span class="number">1491527050203294989882829248560395184804977277747126143103957219164624187528441047837351263580440686474767380464005540264627910126483129930668344095814547592115061057843470131498075060420395111008619027199037019925701236660166563068245683975787762804359520164701691690916482591026138582705558246869496162759780878437137960823000043988227303003876410503121370163303711603359430764539337597866862508451528158285103251810058741879687875218384160282506172706613359477657215420734816049393339593755489218588796607060261897905233453268671411610631047340459487937479511933450369462213795738933019001471803157607791738538467</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">27646746423759020111007828653264027999257847645666129907789026054594393648800236117046769112762641778865620892443423100189619327585811384883515424918752749559627553637785037359639801125213256163008431942593727931931898199727552768626775618479833029101249692573716030706695702510982283555740851047022672485743432464647772882314215176114732257497240284164016914018689044557218920300262234652840632406067273375269301008409860193180822366735877288205783314326102263756503786736122321348320031950012144905869556204017430593656052867939493633163499580242224763404338807022510136217187779084917996171602737036564991036724299</span></span><br><span class="line">c = <span class="number">21991524128957260536043771284854920393105808126700128222125856775506885721971193109361315961129190814674647136464887087893990660894961612838205086401018885457667488911898654270235561980111174603323721280911197488286585269356849579263043456316319476495888696219344219866516861187654180509247881251251278919346267129904739277386289240394384575124331135655943513831009934023397457082184699737734388823763306805326430395849935770213817533387235486307008892410920611669932693018165569417445885810825749609388627231235840912644654685819620931663346297596334834498661789016450371769203650109994771872404185770230172934013971</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">20545487405816928731738988374475012686827933709789784391855706835136270270933401203019329136937650878386117187776530639342572123237188053978622697282521473917978282830432161153221216194169879669541998840691383025487220850872075436064308499924958517979727954402965612196081404341651517326364041519250125036424822634354268773895465698920883439222996581226358595873993976604699830613932320720554130011671297944433515047180565484495191003887599891289037982010216357831078328159028953222056918189365840711588671093333013117454034313622855082795813122338562446223041211192277089225078324682108033843023903550172891959673551</span></span><br><span class="line">c = <span class="number">14227439188191029461250476692790539654619199888487319429114414557975376308688908028140817157205579804059783807641305577385724758530138514972962209062230576107406142402603484375626077345190883094097636019771377866339531511965136650567412363889183159616188449263752475328663245311059988337996047359263288837436305588848044572937759424466586870280512424336807064729894515840552404756879590698797046333336445465120445087587621743906624279621779634772378802959109714400516183718323267273824736540168545946444437586299214110424738159957388350785999348535171553569373088251552712391288365295267665691357719616011613628772175</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">27359727711584277234897157724055852794019216845229798938655814269460046384353568138598567755392559653460949444557879120040796798142218939251844762461270251672399546774067275348291003962551964648742053215424620256999345448398805278592777049668281558312871773979931343097806878701114056030041506690476954254006592555275342579529625231194321357904668512121539514880704046969974898412095675082585315458267591016734924646294357666924293908418345508902112711075232047998775303603175363964055048589769318562104883659754974955561725694779754279606726358588862479198815999276839234952142017210593887371950645418417355912567987</span></span><br><span class="line">c = <span class="number">3788529784248255027081674540877016372807848222776887920453488878247137930578296797437647922494510483767651150492933356093288965943741570268943861987024276610712717409139946409513963043114463933146088430004237747163422802959250296602570649363016151581364006795894226599584708072582696996740518887606785460775851029814280359385763091078902301957226484620428513604630585131511167015763190591225884202772840456563643159507805711004113901417503751181050823638207803533111429510911616160851391754754434764819568054850823810901159821297849790005646102129354035735350124476838786661542089045509656910348676742844957008857457</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">27545937603751737248785220891735796468973329738076209144079921449967292572349424539010502287564030116831261268197384650511043068738911429169730640135947800885987171539267214611907687570587001933829208655100828045651391618089603288456570334500533178695238407684702251252671579371018651675054368606282524673369983034682330578308769886456335818733827237294570476853673552685361689144261552895758266522393004116017849397346259119221063821663280935820440671825601452417487330105280889520007917979115568067161590058277418371493228631232457972494285014767469893647892888681433965857496916110704944758070268626897045014782837</span></span><br><span class="line">c = <span class="number">14069112970608895732417039977542732665796601893762401500878786871680645798754783315693511261740059725171342404186571066972546332813667711135661176659424619936101038903439144294886379322591635766682645179888058617577572409307484708171144488708410543462972008179994594087473935638026612679389759756811490524127195628741262871304427908481214992471182859308828778119005750928935764927967212343526503410515793717201360360437981322576798056276657140363332700714732224848346808963992302409037706094588964170239521193589470070839790404597252990818583717869140229811712295005710540476356743378906642267045723633874011649259842</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">25746162075697911560263181791216433062574178572424600336856278176112733054431463253903433128232709054141607100891177804285813783247735063753406524678030561284491481221681954564804141454666928657549670266775659862814924386584148785453647316864935942772919140563506305666207816897601862713092809234429096584753263707828899780979223118181009293655563146526792388913462557306433664296966331469906428665127438829399703002867800269947855869262036714256550075520193125987011945192273531732276641728008406855871598678936585324782438668746810516660152018244253008092470066555687277138937298747951929576231036251316270602513451</span></span><br><span class="line">c = <span class="number">17344284860275489477491525819922855326792275128719709401292545608122859829827462088390044612234967551682879954301458425842831995513832410355328065562098763660326163262033200347338773439095709944202252494552172589503915965931524326523663289777583152664722241920800537867331030623906674081852296232306336271542832728410803631170229642717524942332390842467035143631504401140727083270732464237443915263865880580308776111219718961746378842924644142127243573824972533819479079381023103585862099063382129757560124074676150622288706094110075567706403442920696472627797607697962873026112240527498308535903232663939028587036724</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">23288486934117120315036919418588136227028485494137930196323715336208849327833965693894670567217971727921243839129969128783853015760155446770590696037582684845937132790047363216362087277861336964760890214059732779383020349204803205725870225429985939570141508220041286857810048164696707018663758416807708910671477407366098883430811861933014973409390179948577712579749352299440310543689035651465399867908428885541237776143404376333442949397063249223702355051571790555151203866821867908531733788784978667478707672984539512431549558672467752712004519300318999208102076732501412589104904734983789895358753664077486894529499</span></span><br><span class="line">c = <span class="number">10738254418114076548071448844964046468141621740603214384986354189105236977071001429271560636428075970459890958274941762528116445171161040040833357876134689749846940052619392750394683504816081193432350669452446113285638982551762586656329109007214019944975816434827768882704630460001209452239162896576191876324662333153835533956600295255158377025198426950944040643235430211011063586032467724329735785947372051759042138171054165854842472990583800899984893232549092766400510300083585513014171220423103452292891496141806956300396540682381668367564569427813092064053993103537635994311143010708814851867239706492577203899024</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">19591441383958529435598729113936346657001352578357909347657257239777540424811749817783061233235817916560689138344041497732749011519736303038986277394036718790971374656832741054547056417771501234494768509780369075443550907847298246275717420562375114406055733620258777905222169702036494045086017381084272496162770259955811174440490126514747876661317750649488774992348005044389081101686016446219264069971370646319546429782904810063020324704138495608761532563310699753322444871060383693044481932265801505819646998535192083036872551683405766123968487907648980900712118052346174533513978009131757167547595857552370586353973</span></span><br><span class="line">c = <span class="number">3834917098887202931981968704659119341624432294759361919553937551053499607440333234018189141970246302299385742548278589896033282894981200353270637127213483172182529890495903425649116755901631101665876301799865612717750360089085179142750664603454193642053016384714515855868368723508922271767190285521137785688075622832924829248362774476456232826885801046969384519549385428259591566716890844604696258783639390854153039329480726205147199247183621535172450825979047132495439603840806501254997167051142427157381799890725323765558803808030109468048682252028720241357478614704610089120810367192414352034177484688502364022887</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">19254242571588430171308191757871261075358521158624745702744057556054652332495961196795369630484782930292003238730267396462491733557715379956969694238267908985251699834707734400775311452868924330866502429576951934279223234676654749272932769107390976321208605516299532560054081301829440688796904635446986081691156842271268059970762004259219036753174909942343204432795076377432107630203621754552804124408792358220071862369443201584155711893388877350138023238624566616551246804054720492816226651467017802504094070614892556444425915920269485861799532473383304622064493223627552558344088839860178294589481899206318863310603</span></span><br><span class="line">c = <span class="number">6790553533991297205804561991225493105312398825187682250780197510784765226429663284220400480563039341938599783346724051076211265663468643826430109013245014035811178295081939958687087477312867720289964506097819762095244479129359998867671811819738196687884696680463458661374310994610760009474264115750204920875527434486437536623589684519411519100170291423367424938566820315486507444202022408003879118465761273916755290898112991525546114191064022991329724370064632569903856189236177894007766690782630247443895358893983735822824243487181851098787271270256780891094405121947631088729917398317652320497765101790132679171889</span></span><br><span class="line"></span><br><span class="line">n = <span class="number">26809700251171279102974962949184411136459372267620535198421449833298448092580497485301953796619185339316064387798092220298630428207556482805739803420279056191194360049651767412572609187680508073074653291350998253938793269214230457117194434853888765303403385824786231859450351212449404870776320297419712486574804794325602760347306432927281716160368830187944940128907971027838510079519466846176106565164730963988892400240063089397720414921398936399927948235195085202171264728816184532651138221862240969655185596628285814057082448321749567943946273776184657698104465062749244327092588237927996419620170254423837876806659</span></span><br><span class="line">c = <span class="number">386213556608434013769864727123879412041991271528990528548507451210692618986652870424632219424601677524265011043146748309774067894985069288067952546139416819404039688454756044862784630882833496090822568580572859029800646671301748901528132153712913301179254879877441322285914544974519727307311002330350534857867516466612474769753577858660075830592891403551867246057397839688329172530177187042229028685862036140779065771061933528137423019407311473581832405899089709251747002788032002094495379614686544672969073249309703482556386024622814731015767810042969813752548617464974915714425595351940266077021672409858645427346</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="4-12-2-解题思路"><a href="#4-12-2-解题思路" class="headerlink" title="4.12.2 解题思路"></a>4.12.2 解题思路</h3><p><strong>模不互素</strong>：存在两个或更多模数 $ n $ 且其中至少一对 $ n_i $ 和 $ n_j $ 不互质。</p>
<h3 id="4-12-3-解题脚本"><a href="#4-12-3-解题脚本" class="headerlink" title="4.12.3 解题脚本"></a>4.12.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> prod</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> totient</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_OAEP</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse, long_to_bytes, GCD</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">standard_rsa_decryption</span>(<span class="params">e, c, primes=<span class="literal">None</span>, n=<span class="literal">None</span>, phi=<span class="literal">None</span>, ct_format=<span class="string">&#x27;int&#x27;</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    标准 RSA 解密</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> phi:</span><br><span class="line">        <span class="keyword">if</span> n:</span><br><span class="line">            phi = totient(n)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            phi = prod(p - <span class="number">1</span> <span class="keyword">for</span> p <span class="keyword">in</span> primes)</span><br><span class="line">            n = prod(p <span class="keyword">for</span> p <span class="keyword">in</span> primes)</span><br><span class="line"></span><br><span class="line">    d = inverse(e, phi)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ct_format == <span class="string">&#x27;base64&#x27;</span>:</span><br><span class="line">        p, q = primes[<span class="number">0</span>], primes[<span class="number">1</span>]</span><br><span class="line">        key_info = RSA.construct((n, e, d, p, q))</span><br><span class="line">        key = RSA.importKey(key_info.exportKey())</span><br><span class="line">        key = PKCS1_OAEP.new(key)</span><br><span class="line">        m = key.decrypt(b64decode(c)).decode()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">non_coprime_moduli</span>(<span class="params">n_list</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    模不互素</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    result = []</span><br><span class="line">    </span><br><span class="line">    n = <span class="built_in">len</span>(n_list)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i + <span class="number">1</span>, n):  <span class="comment"># j 从 i+1 开始，避免重复检查</span></span><br><span class="line">            current_gcd = GCD(n_list[i], n_list[j])</span><br><span class="line">            <span class="keyword">if</span> current_gcd != <span class="number">1</span>:</span><br><span class="line">                result.append((n_list[i], n_list[j], current_gcd))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> result:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;找到不互质的模数对：&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> i, j, gcd_val <span class="keyword">in</span> result:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;模数 <span class="subst">&#123;i&#125;</span> 和模数 <span class="subst">&#123;j&#125;</span>, GCD = <span class="subst">&#123;gcd_val&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;所有模数对均互质&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;1.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        content = f.read()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 使用正则表达式匹配所有 n=xxx 和 c=xxx 对</span></span><br><span class="line">    pattern = <span class="string">r&#x27;n\s*=\s*(\S+)\s*c\s*=\s*(\S+)&#x27;</span></span><br><span class="line">    pairs = re.findall(pattern, content, re.DOTALL)</span><br><span class="line">    </span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line">    cn_list = &#123;<span class="built_in">int</span>(n): <span class="built_in">int</span>(c) <span class="keyword">for</span> n, c <span class="keyword">in</span> pairs&#125;</span><br><span class="line">    pairs = non_coprime_moduli(<span class="built_in">list</span>(cn_list.keys()))</span><br><span class="line">    </span><br><span class="line">    p, n = pairs[<span class="number">0</span>][<span class="number">2</span>], pairs[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    q = n // p</span><br><span class="line">    c = cn_list[n]</span><br><span class="line">    m = standard_rsa_decryption(e, cn_list[n], [p, q])</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># b&#x27;flag&#123;abdcbe5fd94e23b3de429223ab9c2fdf&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="4-13-NCTF2019-childRSA"><a href="#4-13-NCTF2019-childRSA" class="headerlink" title="4.13 [NCTF2019]childRSA"></a>4.13 [NCTF2019]childRSA</h2><h3 id="4-13-1-题目"><a href="#4-13-1-题目" class="headerlink" title="4.13.1 题目"></a>4.13.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> choice</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> isPrime, sieve_base <span class="keyword">as</span> primes</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getPrime</span>(<span class="params">bits</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        n = <span class="number">2</span></span><br><span class="line">        <span class="keyword">while</span> n.bit_length() &lt; bits:</span><br><span class="line">            n *= choice(primes)</span><br><span class="line">        <span class="keyword">if</span> isPrime(n + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">return</span> n + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">m = <span class="built_in">int</span>.from_bytes(flag.encode(), <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">p, q = [getPrime(<span class="number">2048</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>)]</span><br><span class="line">n = p * q</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># n = 32849718197337581823002243717057659218502519004386996660885100592872201948834155543125924395614928962750579667346279456710633774501407292473006312537723894221717638059058796679686953564471994009285384798450493756900459225040360430847240975678450171551048783818642467506711424027848778367427338647282428667393241157151675410661015044633282064056800913282016363415202171926089293431012379261585078566301060173689328363696699811123592090204578098276704877408688525618732848817623879899628629300385790344366046641825507767709276622692835393219811283244303899850483748651722336996164724553364097066493953127153066970594638491950199605713033004684970381605908909693802373826516622872100822213645899846325022476318425889580091613323747640467299866189070780620292627043349618839126919699862580579994887507733838561768581933029077488033326056066378869170169389819542928899483936705521710423905128732013121538495096959944889076705471928490092476616709838980562233255542325528398956185421193665359897664110835645928646616337700617883946369110702443135980068553511927115723157704586595844927607636003501038871748639417378062348085980873502535098755568810971926925447913858894180171498580131088992227637341857123607600275137768132347158657063692388249513</span></span><br><span class="line"><span class="comment"># c = 26308018356739853895382240109968894175166731283702927002165268998773708335216338997058314157717147131083296551313334042509806229853341488461087009955203854253313827608275460592785607739091992591431080342664081962030557042784864074533380701014585315663218783130162376176094773010478159362434331787279303302718098735574605469803801873109982473258207444342330633191849040553550708886593340770753064322410889048135425025715982196600650740987076486540674090923181664281515197679745907830107684777248532278645343716263686014941081417914622724906314960249945105011301731247324601620886782967217339340393853616450077105125391982689986178342417223392217085276465471102737594719932347242482670320801063191869471318313514407997326350065187904154229557706351355052446027159972546737213451422978211055778164578782156428466626894026103053360431281644645515155471301826844754338802352846095293421718249819728205538534652212984831283642472071669494851823123552827380737798609829706225744376667082534026874483482483127491533474306552210039386256062116345785870668331513725792053302188276682550672663353937781055621860101624242216671635824311412793495965628876036344731733142759495348248970313655381407241457118743532311394697763283681852908564387282605279108</span></span><br></pre></td></tr></table></figure>

<h3 id="4-13-2-解题思路"><a href="#4-13-2-解题思路" class="headerlink" title="4.13.2 解题思路"></a>4.13.2 解题思路</h3><p><strong>Smooth 光滑攻击：Pollard’s p−1 攻击</strong></p>
<p>已知 $ a $ 与 $ p $ 互质，且 $ p $ 为素数，根据费马小定理有：</p>
<p>$$<br>a^{p-1} \equiv 1 \pmod{p}<br>$$<br>设 $ p - 1 &#x3D; m_1 \cdot m_2 \cdot m_3 \cdots m_n $，且 $ \max(m_1, m_2, m_3, \ldots, m_n) \le B $，则有：</p>
<p>$$<br>p - 1 \mid B!<br>$$<br>进一步推出：</p>
<p>$$<br> a^{B!} \equiv 1 \pmod{p}<br>$$</p>
<p>即：</p>
<p>$$<br> a^{B!} - 1 &#x3D; k p<br>$$</p>
<p>又因为 $ N &#x3D; p \cdot q $，所以：</p>
<p>$$<br> \gcd(a^{B!} - 1,\ N) &#x3D; p<br>$$</p>
<h3 id="4-13-3-解题脚本"><a href="#4-13-3-解题脚本" class="headerlink" title="4.13.3 解题脚本"></a>4.13.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> prod</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> totient</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_OAEP</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse, GCD, long_to_bytes, sieve_base <span class="keyword">as</span> primes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">standard_rsa_decryption</span>(<span class="params">e, c, primes=<span class="literal">None</span>, n=<span class="literal">None</span>, phi=<span class="literal">None</span>, ct_format=<span class="string">&#x27;int&#x27;</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    标准 RSA 解密</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> phi:</span><br><span class="line">        <span class="keyword">if</span> n:</span><br><span class="line">            phi = totient(n)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            phi = prod(p - <span class="number">1</span> <span class="keyword">for</span> p <span class="keyword">in</span> primes)</span><br><span class="line">            n = prod(p <span class="keyword">for</span> p <span class="keyword">in</span> primes)</span><br><span class="line"></span><br><span class="line">    d = inverse(e, phi)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ct_format == <span class="string">&#x27;base64&#x27;</span>:</span><br><span class="line">        p, q = primes[<span class="number">0</span>], primes[<span class="number">1</span>]</span><br><span class="line">        key_info = RSA.construct((n, e, d, p, q))</span><br><span class="line">        key = RSA.importKey(key_info.exportKey())</span><br><span class="line">        key = PKCS1_OAEP.new(key)</span><br><span class="line">        m = key.decrypt(b64decode(c)).decode()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Pollards_p_1</span>(<span class="params">N, B=<span class="number">2</span></span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    Pollard&#x27;s p−1 攻击</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    a = <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="literal">True</span>):</span><br><span class="line">        a = <span class="built_in">pow</span>(a, B, N)        <span class="comment"># 递推计算 a^B!</span></span><br><span class="line">        p = GCD(a - <span class="number">1</span>, N)       <span class="comment"># 尝试计算 p</span></span><br><span class="line">        <span class="keyword">if</span> p != <span class="number">1</span> <span class="keyword">and</span> p != B:</span><br><span class="line">            <span class="keyword">return</span> p</span><br><span class="line">        B += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line">    n = <span class="number">32849718197337581823002243717057659218502519004386996660885100592872201948834155543125924395614928962750579667346279456710633774501407292473006312537723894221717638059058796679686953564471994009285384798450493756900459225040360430847240975678450171551048783818642467506711424027848778367427338647282428667393241157151675410661015044633282064056800913282016363415202171926089293431012379261585078566301060173689328363696699811123592090204578098276704877408688525618732848817623879899628629300385790344366046641825507767709276622692835393219811283244303899850483748651722336996164724553364097066493953127153066970594638491950199605713033004684970381605908909693802373826516622872100822213645899846325022476318425889580091613323747640467299866189070780620292627043349618839126919699862580579994887507733838561768581933029077488033326056066378869170169389819542928899483936705521710423905128732013121538495096959944889076705471928490092476616709838980562233255542325528398956185421193665359897664110835645928646616337700617883946369110702443135980068553511927115723157704586595844927607636003501038871748639417378062348085980873502535098755568810971926925447913858894180171498580131088992227637341857123607600275137768132347158657063692388249513</span></span><br><span class="line">    c = <span class="number">26308018356739853895382240109968894175166731283702927002165268998773708335216338997058314157717147131083296551313334042509806229853341488461087009955203854253313827608275460592785607739091992591431080342664081962030557042784864074533380701014585315663218783130162376176094773010478159362434331787279303302718098735574605469803801873109982473258207444342330633191849040553550708886593340770753064322410889048135425025715982196600650740987076486540674090923181664281515197679745907830107684777248532278645343716263686014941081417914622724906314960249945105011301731247324601620886782967217339340393853616450077105125391982689986178342417223392217085276465471102737594719932347242482670320801063191869471318313514407997326350065187904154229557706351355052446027159972546737213451422978211055778164578782156428466626894026103053360431281644645515155471301826844754338802352846095293421718249819728205538534652212984831283642472071669494851823123552827380737798609829706225744376667082534026874483482483127491533474306552210039386256062116345785870668331513725792053302188276682550672663353937781055621860101624242216671635824311412793495965628876036344731733142759495348248970313655381407241457118743532311394697763283681852908564387282605279108</span></span><br><span class="line">    </span><br><span class="line">    p = Pollards_p_1(n, prod(primes))</span><br><span class="line">    q = n // p</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(standard_rsa_decryption(e, c, [p, q])))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># b&#x27;NCTF&#123;Th3r3_ar3_1ns3cure_RSA_m0duli_7hat_at_f1rst_gl4nce_appe4r_t0_be_s3cur3&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="4-14-HDCTF2019-bbbbbbrsa"><a href="#4-14-HDCTF2019-bbbbbbrsa" class="headerlink" title="4.14 [HDCTF2019]bbbbbbrsa"></a>4.14 [HDCTF2019]bbbbbbrsa</h2><h3 id="4-14-1-题目"><a href="#4-14-1-题目" class="headerlink" title="4.14.1 题目"></a>4.14.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode <span class="keyword">as</span> b32encode</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert,gcd,iroot</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> a2b_hex,b2a_hex</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;******************************&quot;</span></span><br><span class="line"></span><br><span class="line">nbit = <span class="number">128</span></span><br><span class="line"></span><br><span class="line">p = getPrime(nbit)</span><br><span class="line">q = getPrime(nbit)</span><br><span class="line">n = p*q</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> p</span><br><span class="line"><span class="built_in">print</span> n</span><br><span class="line"></span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">e = random.randint(<span class="number">50000</span>,<span class="number">70000</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">	<span class="keyword">if</span> gcd(e,phi) == <span class="number">1</span>:</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		e -= <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(<span class="built_in">int</span>(b2a_hex(flag),<span class="number">16</span>),e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> b32encode(<span class="built_in">str</span>(c))[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2373740699529364991763589324200093466206785561836101840381622237225512234632</span></span><br><span class="line"><span class="comment"># p = 177077389675257695042507998165006460849</span></span><br><span class="line"><span class="comment"># n = 37421829509887796274897162249367329400988647145613325367337968063341372726061</span></span><br><span class="line"><span class="comment"># c = ==gMzYDNzIjMxUTNyIzNzIjMyYTM4MDM0gTMwEjNzgTM2UTN4cjNwIjN2QzM5ADMwIDNyMTO4UzM2cTM5kDN2MTOyUTO5YDM0czM3MjM</span></span><br></pre></td></tr></table></figure>

<h3 id="4-14-2-解题思路"><a href="#4-14-2-解题思路" class="headerlink" title="4.14.2 解题思路"></a>4.14.2 解题思路</h3><p><strong>RSA 低公钥指数攻击</strong>：爆破小指数 $e$</p>
<h3 id="4-14-3-解题脚本"><a href="#4-14-3-解题脚本" class="headerlink" title="4.14.3 解题脚本"></a>4.14.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, GCD, inverse</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">low_public_exponent_attack</span>(<span class="params">n, c, e=<span class="literal">None</span>, lower=<span class="literal">None</span>, upper=<span class="literal">None</span>, phi=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    RSA 低公钥指数攻击</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> e <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="comment"># 小 e 且 m^e &lt; n，可直接开 e 次方根</span></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> itertools.count():</span><br><span class="line">            candidate = c + k * n</span><br><span class="line">            root, exact = iroot(candidate, e)</span><br><span class="line">            <span class="keyword">if</span> exact:</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">int</span>(root)</span><br><span class="line">    <span class="keyword">elif</span> phi <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> lower <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> upper <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="comment"># 若未知 e，则爆破 e，满足 gcd(e, φ) = 1 并计算 d</span></span><br><span class="line">        <span class="keyword">for</span> e_candidate <span class="keyword">in</span> <span class="built_in">range</span>(lower, upper):</span><br><span class="line">            <span class="keyword">if</span> GCD(e_candidate, phi) == <span class="number">1</span>:</span><br><span class="line">                d = inverse(e_candidate, phi)</span><br><span class="line">                m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">                <span class="keyword">if</span> <span class="string">b&#x27;flag&#x27;</span> <span class="keyword">in</span> long_to_bytes(m):</span><br><span class="line">                    <span class="keyword">return</span> m</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;参数不完整：请提供 e，或 (phi + low + high)&quot;</span>)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    p = <span class="number">177077389675257695042507998165006460849</span></span><br><span class="line">    n = <span class="number">37421829509887796274897162249367329400988647145613325367337968063341372726061</span></span><br><span class="line">    c = <span class="string">b&#x27;==gMzYDNzIjMxUTNyIzNzIjMyYTM4MDM0gTMwEjNzgTM2UTN4cjNwIjN2QzM5ADMwIDNyMTO4UzM2cTM5kDN2MTOyUTO5YDM0czM3MjM&#x27;</span></span><br><span class="line">    q = n // p</span><br><span class="line"></span><br><span class="line">    ct = <span class="built_in">int</span>(b64decode(c[::-<span class="number">1</span>]))</span><br><span class="line">    m = low_public_exponent_attack(n, ct, lower=<span class="number">50000</span>, upper=<span class="number">70000</span>, phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># b&#x27;flag&#123;rs4_1s_s1mpl3!#&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="4-15-BJDCTF2020-RSA4"><a href="#4-15-BJDCTF2020-RSA4" class="headerlink" title="4.15 [BJDCTF2020]RSA4"></a>4.15 [BJDCTF2020]RSA4</h2><h3 id="4-15-1-题目"><a href="#4-15-1-题目" class="headerlink" title="4.15.1 题目"></a>4.15.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">N = <span class="number">331310324212000030020214312244232222400142410423413104441140203003243002104333214202031202212403400220031202142322434104143104244241214204444443323000244130122022422310201104411044030113302323014101331214303223312402430402404413033243132101010422240133122211400434023222214231402403403200012221023341333340042343122302113410210110221233241303024431330001303404020104442443120130000334110042432010203401440404010003442001223042211442001413004</span> </span><br><span class="line">c = <span class="number">310020004234033304244200421414413320341301002123030311202340222410301423440312412440240244110200112141140201224032402232131204213012303204422003300004011434102141321223311243242010014140422411342304322201241112402132203101131221223004022003120002110230023341143201404311340311134230140231412201333333142402423134333211302102413111111424430032440123340034044314223400401224111323000242234420441240411021023100222003123214343030122032301042243</span></span><br><span class="line"></span><br><span class="line">N = <span class="number">302240000040421410144422133334143140011011044322223144412002220243001141141114123223331331304421113021231204322233120121444434210041232214144413244434424302311222143224402302432102242132244032010020113224011121043232143221203424243134044314022212024343100042342002432331144300214212414033414120004344211330224020301223033334324244031204240122301242232011303211220044222411134403012132420311110302442344021122101224411230002203344140143044114</span> </span><br><span class="line">c = <span class="number">112200203404013430330214124004404423210041321043000303233141423344144222343401042200334033203124030011440014210112103234440312134032123400444344144233020130110134042102220302002413321102022414130443041144240310121020100310104334204234412411424420321211112232031121330310333414423433343322024400121200333330432223421433344122023012440013041401423202210124024431040013414313121123433424113113414422043330422002314144111134142044333404112240344</span></span><br><span class="line"></span><br><span class="line">N = <span class="number">332200324410041111434222123043121331442103233332422341041340412034230003314420311333101344231212130200312041044324431141033004333110021013020140020011222012300020041342040004002220210223122111314112124333211132230332124022423141214031303144444134403024420111423244424030030003340213032121303213343020401304243330001314023030121034113334404440421242240113103203013341231330004332040302440011324004130324034323430143102401440130242321424020323</span> </span><br><span class="line">c = <span class="number">10013444120141130322433204124002242224332334011124210012440241402342100410331131441303242011002101323040403311120421304422222200324402244243322422444414043342130111111330022213203030324422101133032212042042243101434342203204121042113212104212423330331134311311114143200011240002111312122234340003403312040401043021433112031334324322123304112340014030132021432101130211241134422413442312013042141212003102211300321404043012124332013240431242</span></span><br></pre></td></tr></table></figure>

<h3 id="4-15-2-解题思路"><a href="#4-15-2-解题思路" class="headerlink" title="4.15.2 解题思路"></a>4.15.2 解题思路</h3><p><strong>低加密指数广播攻击（Håstad’s Broadcast Attack）：</strong>$ m、e $ 相同，$ e &#x3D; 3 $，多组加密的 $ n $ 和 $ c $</p>
<p><strong>进制转换</strong>（五进制改为十进制）</p>
<h3 id="4-15-3-解题脚本"><a href="#4-15-3-解题脚本" class="headerlink" title="4.15.3 解题脚本"></a>4.15.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot, mpz</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse, long_to_bytes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Håstad_broadcast_attack</span>(<span class="params">ciphertexts, n, e=<span class="number">3</span></span>):</span><br><span class="line">    N = reduce(<span class="keyword">lambda</span> x, y: x * y, (i <span class="keyword">for</span> i <span class="keyword">in</span> n))</span><br><span class="line">    result = <span class="number">0</span></span><br><span class="line">    data = <span class="built_in">zip</span>(ciphertexts, n)</span><br><span class="line">    <span class="keyword">for</span> ci, ni <span class="keyword">in</span> data:</span><br><span class="line">        Ni = N // ni</span><br><span class="line">        di = inverse(Ni, ni)</span><br><span class="line">        result += ci * Ni * di</span><br><span class="line">    <span class="keyword">return</span> iroot(mpz(result % N), e)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    N1 = <span class="built_in">int</span>(<span class="string">&#x27;331310324212000030020214312244232222400142410423413104441140203003243002104333214202031202212403400220031202142322434104143104244241214204444443323000244130122022422310201104411044030113302323014101331214303223312402430402404413033243132101010422240133122211400434023222214231402403403200012221023341333340042343122302113410210110221233241303024431330001303404020104442443120130000334110042432010203401440404010003442001223042211442001413004&#x27;</span>,<span class="number">5</span>)</span><br><span class="line">    c1 = <span class="built_in">int</span>(<span class="string">&#x27;310020004234033304244200421414413320341301002123030311202340222410301423440312412440240244110200112141140201224032402232131204213012303204422003300004011434102141321223311243242010014140422411342304322201241112402132203101131221223004022003120002110230023341143201404311340311134230140231412201333333142402423134333211302102413111111424430032440123340034044314223400401224111323000242234420441240411021023100222003123214343030122032301042243&#x27;</span>,<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">    N2 = <span class="built_in">int</span>(<span class="string">&#x27;302240000040421410144422133334143140011011044322223144412002220243001141141114123223331331304421113021231204322233120121444434210041232214144413244434424302311222143224402302432102242132244032010020113224011121043232143221203424243134044314022212024343100042342002432331144300214212414033414120004344211330224020301223033334324244031204240122301242232011303211220044222411134403012132420311110302442344021122101224411230002203344140143044114&#x27;</span>,<span class="number">5</span>)</span><br><span class="line">    c2 = <span class="built_in">int</span>(<span class="string">&#x27;112200203404013430330214124004404423210041321043000303233141423344144222343401042200334033203124030011440014210112103234440312134032123400444344144233020130110134042102220302002413321102022414130443041144240310121020100310104334204234412411424420321211112232031121330310333414423433343322024400121200333330432223421433344122023012440013041401423202210124024431040013414313121123433424113113414422043330422002314144111134142044333404112240344&#x27;</span>,<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">    N3 = <span class="built_in">int</span>(<span class="string">&#x27;332200324410041111434222123043121331442103233332422341041340412034230003314420311333101344231212130200312041044324431141033004333110021013020140020011222012300020041342040004002220210223122111314112124333211132230332124022423141214031303144444134403024420111423244424030030003340213032121303213343020401304243330001314023030121034113334404440421242240113103203013341231330004332040302440011324004130324034323430143102401440130242321424020323&#x27;</span>,<span class="number">5</span>)</span><br><span class="line">    c3 = <span class="built_in">int</span>(<span class="string">&#x27;10013444120141130322433204124002242224332334011124210012440241402342100410331131441303242011002101323040403311120421304422222200324402244243322422444414043342130111111330022213203030324422101133032212042042243101434342203204121042113212104212423330331134311311114143200011240002111312122234340003403312040401043021433112031334324322123304112340014030132021432101130211241134422413442312013042141212003102211300321404043012124332013240431242&#x27;</span>,<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">    M = Håstad_broadcast_attack([c1, c2, c3], [N1, N2, N3])</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(M))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># b&#x27;noxCTF&#123;D4mn_y0u_h4s74d_wh47_4_b100dy_b4s74rd!&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="4-16-BJDCTF2020-rsa-output"><a href="#4-16-BJDCTF2020-rsa-output" class="headerlink" title="4.16 [BJDCTF2020]rsa_output"></a>4.16 [BJDCTF2020]rsa_output</h2><h3 id="4-16-1-题目"><a href="#4-16-1-题目" class="headerlink" title="4.16.1 题目"></a>4.16.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="number">21058339337354287847534107544613605305015441090508924094198816691219103399526800112802416383088995253908857460266726925615826895303377801614829364034624475195859997943146305588315939130777450485196290766249612340054354622516207681542973756257677388091926549655162490873849955783768663029138647079874278240867932127196686258800146911620730706734103611833179733264096475286491988063990431085380499075005629807702406676707841324660971173253100956362528346684752959937473852630145893796056675793646430793578265418255919376323796044588559726703858429311784705245069845938316802681575653653770883615525735690306674635167111</span>,<span class="number">2767</span>&#125;</span><br><span class="line"></span><br><span class="line">&#123;<span class="number">21058339337354287847534107544613605305015441090508924094198816691219103399526800112802416383088995253908857460266726925615826895303377801614829364034624475195859997943146305588315939130777450485196290766249612340054354622516207681542973756257677388091926549655162490873849955783768663029138647079874278240867932127196686258800146911620730706734103611833179733264096475286491988063990431085380499075005629807702406676707841324660971173253100956362528346684752959937473852630145893796056675793646430793578265418255919376323796044588559726703858429311784705245069845938316802681575653653770883615525735690306674635167111</span>,<span class="number">3659</span>&#125;</span><br><span class="line"></span><br><span class="line">message1=<span class="number">20152490165522401747723193966902181151098731763998057421967155300933719378216342043730801302534978403741086887969040721959533190058342762057359432663717825826365444996915469039056428416166173920958243044831404924113442512617599426876141184212121677500371236937127571802891321706587610393639446868836987170301813018218408886968263882123084155607494076330256934285171370758586535415136162861138898728910585138378884530819857478609791126971308624318454905992919405355751492789110009313138417265126117273710813843923143381276204802515910527468883224274829962479636527422350190210717694762908096944600267033351813929448599</span></span><br><span class="line"></span><br><span class="line">message2=<span class="number">11298697323140988812057735324285908480504721454145796535014418738959035245600679947297874517818928181509081545027056523790022598233918011261011973196386395689371526774785582326121959186195586069851592467637819366624044133661016373360885158956955263645614345881350494012328275215821306955212788282617812686548883151066866149060363482958708364726982908798340182288702101023393839781427386537230459436512613047311585875068008210818996941460156589314135010438362447522428206884944952639826677247819066812706835773107059567082822312300721049827013660418610265189288840247186598145741724084351633508492707755206886202876227</span></span><br></pre></td></tr></table></figure>

<h3 id="4-16-2-解题思路"><a href="#4-16-2-解题思路" class="headerlink" title="4.16.2 解题思路"></a>4.16.2 解题思路</h3><p><strong>共模攻击</strong>：若干次加密，$ e $ 不同，$ N $ 相同，$ m $ 相同</p>
<h3 id="4-16-3-解题脚本"><a href="#4-16-3-解题脚本" class="headerlink" title="4.16.3 解题脚本"></a>4.16.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcdext</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">common_modulus_attack</span>(<span class="params">e1, e2, c1, c2, n</span>):</span><br><span class="line">    _, r, s = gcdext(e1, e2)</span><br><span class="line">    m = <span class="built_in">pow</span>(c1, r, n) * <span class="built_in">pow</span>(c2, s, n) % n</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    n = <span class="number">21058339337354287847534107544613605305015441090508924094198816691219103399526800112802416383088995253908857460266726925615826895303377801614829364034624475195859997943146305588315939130777450485196290766249612340054354622516207681542973756257677388091926549655162490873849955783768663029138647079874278240867932127196686258800146911620730706734103611833179733264096475286491988063990431085380499075005629807702406676707841324660971173253100956362528346684752959937473852630145893796056675793646430793578265418255919376323796044588559726703858429311784705245069845938316802681575653653770883615525735690306674635167111</span></span><br><span class="line">    e1 = <span class="number">2767</span></span><br><span class="line">    e2 = <span class="number">3659</span></span><br><span class="line">    c1 = <span class="number">20152490165522401747723193966902181151098731763998057421967155300933719378216342043730801302534978403741086887969040721959533190058342762057359432663717825826365444996915469039056428416166173920958243044831404924113442512617599426876141184212121677500371236937127571802891321706587610393639446868836987170301813018218408886968263882123084155607494076330256934285171370758586535415136162861138898728910585138378884530819857478609791126971308624318454905992919405355751492789110009313138417265126117273710813843923143381276204802515910527468883224274829962479636527422350190210717694762908096944600267033351813929448599</span></span><br><span class="line">    c2 = <span class="number">11298697323140988812057735324285908480504721454145796535014418738959035245600679947297874517818928181509081545027056523790022598233918011261011973196386395689371526774785582326121959186195586069851592467637819366624044133661016373360885158956955263645614345881350494012328275215821306955212788282617812686548883151066866149060363482958708364726982908798340182288702101023393839781427386537230459436512613047311585875068008210818996941460156589314135010438362447522428206884944952639826677247819066812706835773107059567082822312300721049827013660418610265189288840247186598145741724084351633508492707755206886202876227</span></span><br><span class="line"></span><br><span class="line">    m = common_modulus_attack(e1, e2, c1, c2, n)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># b&#x27;BJD&#123;r3a_C0mmoN_moD@_4ttack&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="4-17-BJDCTF2020-RSA"><a href="#4-17-BJDCTF2020-RSA" class="headerlink" title="4.17 [BJDCTF2020]RSA"></a>4.17 [BJDCTF2020]RSA</h2><h3 id="4-17-1-题目"><a href="#4-17-1-题目" class="headerlink" title="4.17.1 题目"></a>4.17.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime,bytes_to_long</span><br><span class="line"></span><br><span class="line">flag=<span class="built_in">open</span>(<span class="string">&quot;flag&quot;</span>,<span class="string">&quot;rb&quot;</span>).read()</span><br><span class="line"></span><br><span class="line">p=getPrime(<span class="number">1024</span>)</span><br><span class="line">q=getPrime(<span class="number">1024</span>)</span><br><span class="line"><span class="keyword">assert</span>(e&lt;<span class="number">100000</span>)</span><br><span class="line">n=p*q</span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span> c,n</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">pow</span>(<span class="number">294</span>,e,n)</span><br><span class="line"></span><br><span class="line">p=getPrime(<span class="number">1024</span>)</span><br><span class="line">n=p*q</span><br><span class="line">m=bytes_to_long(<span class="string">&quot;BJD&quot;</span>*<span class="number">32</span>)</span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span> c,n</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">output:</span></span><br><span class="line"><span class="string">12641635617803746150332232646354596292707861480200207537199141183624438303757120570096741248020236666965755798009656547738616399025300123043766255518596149348930444599820675230046423373053051631932557230849083426859490183732303751744004874183062594856870318614289991675980063548316499486908923209627563871554875612702079100567018698992935818206109087568166097392314105717555482926141030505639571708876213167112187962584484065321545727594135175369233925922507794999607323536976824183162923385005669930403448853465141405846835919842908469787547341752365471892495204307644586161393228776042015534147913888338316244169120  13508774104460209743306714034546704137247627344981133461801953479736017021401725818808462898375994767375627749494839671944543822403059978073813122441407612530658168942987820256786583006947001711749230193542370570950705530167921702835627122401475251039000775017381633900222474727396823708695063136246115652622259769634591309421761269548260984426148824641285010730983215377509255011298737827621611158032976420011662547854515610597955628898073569684158225678333474543920326532893446849808112837476684390030976472053905069855522297850688026960701186543428139843783907624317274796926248829543413464754127208843070331063037</span></span><br><span class="line"><span class="string">381631268825806469518166370387352035475775677163615730759454343913563615970881967332407709901235637718936184198930226303761876517101208677107311006065728014220477966000620964056616058676999878976943319063836649085085377577273214792371548775204594097887078898598463892440141577974544939268247818937936607013100808169758675042264568547764031628431414727922168580998494695800403043312406643527637667466318473669542326169218665366423043579003388486634167642663495896607282155808331902351188500197960905672207046579647052764579411814305689137519860880916467272056778641442758940135016400808740387144508156358067955215018</span></span><br><span class="line"><span class="string">979153370552535153498477459720877329811204688208387543826122582132404214848454954722487086658061408795223805022202997613522014736983452121073860054851302343517756732701026667062765906277626879215457936330799698812755973057557620930172778859116538571207100424990838508255127616637334499680058645411786925302368790414768248611809358160197554369255458675450109457987698749584630551177577492043403656419968285163536823819817573531356497236154342689914525321673807925458651854768512396355389740863270148775362744448115581639629326362342160548500035000156097215446881251055505465713854173913142040976382500435185442521721  12806210903061368369054309575159360374022344774547459345216907128193957592938071815865954073287532545947370671838372144806539753829484356064919357285623305209600680570975224639214396805124350862772159272362778768036844634760917612708721787320159318432456050806227784435091161119982613987303255995543165395426658059462110056431392517548717447898084915167661172362984251201688639469652283452307712821398857016487590794996544468826705600332208535201443322267298747117528882985955375246424812616478327182399461709978893464093245135530135430007842223389360212803439850867615121148050034887767584693608776323252233254261047</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="4-17-2-解题思路"><a href="#4-17-2-解题思路" class="headerlink" title="4.17.2 解题思路"></a>4.17.2 解题思路</h3><p><strong>模不互素</strong>：存在两个或更多模数 $ n $ 且其中至少一对 $ n_i $ 和 $ n_j $ 不互质</p>
<p><strong>RSA 低公钥指数攻击</strong>：爆破小指数 $ e $</p>
<h3 id="4-17-3-解题脚本"><a href="#4-17-3-解题脚本" class="headerlink" title="4.17.3 解题脚本"></a>4.17.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> prod</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> totient</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_OAEP</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, GCD, inverse</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">standard_rsa_decryption</span>(<span class="params">e, c, primes=<span class="literal">None</span>, n=<span class="literal">None</span>, phi=<span class="literal">None</span>, ct_format=<span class="string">&#x27;int&#x27;</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    标准 RSA 解密</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> phi:</span><br><span class="line">        <span class="keyword">if</span> n:</span><br><span class="line">            phi = totient(n)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            phi = prod(p - <span class="number">1</span> <span class="keyword">for</span> p <span class="keyword">in</span> primes)</span><br><span class="line">            n = prod(p <span class="keyword">for</span> p <span class="keyword">in</span> primes)</span><br><span class="line"></span><br><span class="line">    d = inverse(e, phi)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ct_format == <span class="string">&#x27;base64&#x27;</span>:</span><br><span class="line">        p, q = primes[<span class="number">0</span>], primes[<span class="number">1</span>]</span><br><span class="line">        key_info = RSA.construct((n, e, d, p, q))</span><br><span class="line">        key = RSA.importKey(key_info.exportKey())</span><br><span class="line">        key = PKCS1_OAEP.new(key)</span><br><span class="line">        m = key.decrypt(b64decode(c)).decode()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">non_coprime_moduli</span>(<span class="params">n_list</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    模不互素</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    result = []</span><br><span class="line">    </span><br><span class="line">    n = <span class="built_in">len</span>(n_list)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i + <span class="number">1</span>, n):  <span class="comment"># j 从 i+1 开始，避免重复检查</span></span><br><span class="line">            current_gcd = GCD(n_list[i], n_list[j])</span><br><span class="line">            <span class="keyword">if</span> current_gcd != <span class="number">1</span>:</span><br><span class="line">                result.append((n_list[i], n_list[j], current_gcd))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> result:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;找到不互质的模数对：&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> i, j, gcd_val <span class="keyword">in</span> result:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;模数 <span class="subst">&#123;i&#125;</span> 和模数 <span class="subst">&#123;j&#125;</span>, GCD = <span class="subst">&#123;gcd_val&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;所有模数对均互质&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    c = <span class="number">12641635617803746150332232646354596292707861480200207537199141183624438303757120570096741248020236666965755798009656547738616399025300123043766255518596149348930444599820675230046423373053051631932557230849083426859490183732303751744004874183062594856870318614289991675980063548316499486908923209627563871554875612702079100567018698992935818206109087568166097392314105717555482926141030505639571708876213167112187962584484065321545727594135175369233925922507794999607323536976824183162923385005669930403448853465141405846835919842908469787547341752365471892495204307644586161393228776042015534147913888338316244169120</span>  </span><br><span class="line">    n1 = <span class="number">13508774104460209743306714034546704137247627344981133461801953479736017021401725818808462898375994767375627749494839671944543822403059978073813122441407612530658168942987820256786583006947001711749230193542370570950705530167921702835627122401475251039000775017381633900222474727396823708695063136246115652622259769634591309421761269548260984426148824641285010730983215377509255011298737827621611158032976420011662547854515610597955628898073569684158225678333474543920326532893446849808112837476684390030976472053905069855522297850688026960701186543428139843783907624317274796926248829543413464754127208843070331063037</span></span><br><span class="line">    c_294 = <span class="number">381631268825806469518166370387352035475775677163615730759454343913563615970881967332407709901235637718936184198930226303761876517101208677107311006065728014220477966000620964056616058676999878976943319063836649085085377577273214792371548775204594097887078898598463892440141577974544939268247818937936607013100808169758675042264568547764031628431414727922168580998494695800403043312406643527637667466318473669542326169218665366423043579003388486634167642663495896607282155808331902351188500197960905672207046579647052764579411814305689137519860880916467272056778641442758940135016400808740387144508156358067955215018</span></span><br><span class="line">    c2 = <span class="number">979153370552535153498477459720877329811204688208387543826122582132404214848454954722487086658061408795223805022202997613522014736983452121073860054851302343517756732701026667062765906277626879215457936330799698812755973057557620930172778859116538571207100424990838508255127616637334499680058645411786925302368790414768248611809358160197554369255458675450109457987698749584630551177577492043403656419968285163536823819817573531356497236154342689914525321673807925458651854768512396355389740863270148775362744448115581639629326362342160548500035000156097215446881251055505465713854173913142040976382500435185442521721</span>  </span><br><span class="line">    n2 = <span class="number">12806210903061368369054309575159360374022344774547459345216907128193957592938071815865954073287532545947370671838372144806539753829484356064919357285623305209600680570975224639214396805124350862772159272362778768036844634760917612708721787320159318432456050806227784435091161119982613987303255995543165395426658059462110056431392517548717447898084915167661172362984251201688639469652283452307712821398857016487590794996544468826705600332208535201443322267298747117528882985955375246424812616478327182399461709978893464093245135530135430007842223389360212803439850867615121148050034887767584693608776323252233254261047</span></span><br><span class="line">    q = non_coprime_moduli([n1, n2])[<span class="number">0</span>][-<span class="number">1</span>]</span><br><span class="line">    p1 = n1 // q</span><br><span class="line">    p2 = n2 // q</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> e <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100000</span>):</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">pow</span>(<span class="number">294</span>, e, n1) == c_294):</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(standard_rsa_decryption(e, c, [p1, q])))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># b&#x27;BJD&#123;p_is_common_divisor&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="4-18-WUSTCTF2020-babyrsa"><a href="#4-18-WUSTCTF2020-babyrsa" class="headerlink" title="4.18 [WUSTCTF2020]babyrsa"></a>4.18 [WUSTCTF2020]babyrsa</h2><h3 id="4-18-1-题目"><a href="#4-18-1-题目" class="headerlink" title="4.18.1 题目"></a>4.18.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">c = <span class="number">28767758880940662779934612526152562406674613203406706867456395986985664083182</span></span><br><span class="line">n = <span class="number">73069886771625642807435783661014062604264768481735145873508846925735521695159</span></span><br><span class="line">e = <span class="number">65537</span></span><br></pre></td></tr></table></figure>

<h3 id="4-18-2-解题思路"><a href="#4-18-2-解题思路" class="headerlink" title="4.18.2 解题思路"></a>4.18.2 解题思路</h3><p><strong>大素数分解</strong></p>
<h3 id="4-18-3-解题脚本"><a href="#4-18-3-解题脚本" class="headerlink" title="4.18.3 解题脚本"></a>4.18.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> prod</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> totient</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_OAEP</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse, long_to_bytes</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">queryFactors</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;查询整数n的质因数分解结果&quot;&quot;&quot;</span></span><br><span class="line">    response = requests.get(<span class="string">f&quot;http://factordb.com/api?query=<span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">int</span>(factor) <span class="keyword">for</span> factor, count <span class="keyword">in</span> response.json()[<span class="string">&quot;factors&quot;</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">int</span>(count))]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">standard_rsa_decryption</span>(<span class="params">e, c, primes=<span class="literal">None</span>, n=<span class="literal">None</span>, phi=<span class="literal">None</span>, ct_format=<span class="string">&#x27;int&#x27;</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    标准 RSA 解密</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> phi:</span><br><span class="line">        <span class="keyword">if</span> n:</span><br><span class="line">            phi = totient(n)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            phi = prod(p - <span class="number">1</span> <span class="keyword">for</span> p <span class="keyword">in</span> primes)</span><br><span class="line">            n = prod(p <span class="keyword">for</span> p <span class="keyword">in</span> primes)</span><br><span class="line"></span><br><span class="line">    d = inverse(e, phi)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ct_format == <span class="string">&#x27;base64&#x27;</span>:</span><br><span class="line">        p, q = primes[<span class="number">0</span>], primes[<span class="number">1</span>]</span><br><span class="line">        key_info = RSA.construct((n, e, d, p, q))</span><br><span class="line">        key = RSA.importKey(key_info.exportKey())</span><br><span class="line">        key = PKCS1_OAEP.new(key)</span><br><span class="line">        m = key.decrypt(b64decode(c)).decode()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    c = <span class="number">28767758880940662779934612526152562406674613203406706867456395986985664083182</span></span><br><span class="line">    n = <span class="number">73069886771625642807435783661014062604264768481735145873508846925735521695159</span></span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line">    p, q = queryFactors(n)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(standard_rsa_decryption(e, c, [p, q])))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># b&#x27;wctf2020&#123;just_@_piece_0f_cak3&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="4-19-ACTF新生赛2020-crypto-rsa3"><a href="#4-19-ACTF新生赛2020-crypto-rsa3" class="headerlink" title="4.19 [ACTF新生赛2020]crypto-rsa3"></a>4.19 [ACTF新生赛2020]crypto-rsa3</h2><h3 id="4-19-1-题目"><a href="#4-19-1-题目" class="headerlink" title="4.19.1 题目"></a>4.19.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> FLAG</span><br><span class="line"><span class="keyword">from</span> Cryptodome.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = <span class="built_in">int</span>(gmpy2.next_prime(p))</span><br><span class="line">n = p*q</span><br><span class="line">m = bytes_to_long(FLAG)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line"><span class="number">177606504836499246970959030226871608885969321778211051080524634084516973331441644993898029573612290095853069264036530459253652875586267946877831055147546910227100566496658148381834683037366134553848011903251252726474047661274223137727688689535823533046778793131902143444408735610821167838717488859902242863683</span></span><br><span class="line"><span class="number">1457390378511382354771000540945361168984775052693073641682375071407490851289703070905749525830483035988737117653971428424612332020925926617395558868160380601912498299922825914229510166957910451841730028919883807634489834128830801407228447221775264711349928156290102782374379406719292116047581560530382210049</span></span><br></pre></td></tr></table></figure>

<h3 id="4-19-2-解题思路"><a href="#4-19-2-解题思路" class="headerlink" title="4.19.2 解题思路"></a>4.19.2 解题思路</h3><p><strong>p、q 参数设置不当（近似攻击）</strong></p>
<p>$ p $ 和 $ q $ 相邻，$ n^\frac{1}{2} $ 近似等于 $ p $，向下遍历求出 $ p $</p>
<h3 id="4-19-3-解题脚本"><a href="#4-19-3-解题脚本" class="headerlink" title="4.19.3 解题脚本"></a>4.19.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, inverse</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">p_q_approximation</span>(<span class="params">n, e, c</span>):</span><br><span class="line">    p = iroot(n,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">while</span> n % p != <span class="number">0</span> :</span><br><span class="line">        p -= <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    q = n // p</span><br><span class="line">    d = inverse(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    n = <span class="number">177606504836499246970959030226871608885969321778211051080524634084516973331441644993898029573612290095853069264036530459253652875586267946877831055147546910227100566496658148381834683037366134553848011903251252726474047661274223137727688689535823533046778793131902143444408735610821167838717488859902242863683</span></span><br><span class="line">    c = <span class="number">1457390378511382354771000540945361168984775052693073641682375071407490851289703070905749525830483035988737117653971428424612332020925926617395558868160380601912498299922825914229510166957910451841730028919883807634489834128830801407228447221775264711349928156290102782374379406719292116047581560530382210049</span></span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line">    m = p_q_approximation(n, e, c)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># b&#x27;actf&#123;p_and_q_should_not_be_so_close_in_value&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="4-20-GWCTF-2019-BabyRSA"><a href="#4-20-GWCTF-2019-BabyRSA" class="headerlink" title="4.20 [GWCTF 2019]BabyRSA"></a>4.20 [GWCTF 2019]BabyRSA</h2><h3 id="4-20-1-题目"><a href="#4-20-1-题目" class="headerlink" title="4.20.1 题目"></a>4.20.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;GWHT&#123;******&#125;&#x27;</span></span><br><span class="line">secret = <span class="string">&#x27;******&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span>(<span class="built_in">len</span>(flag) == <span class="number">38</span>)</span><br><span class="line"></span><br><span class="line">half = <span class="built_in">len</span>(flag) / <span class="number">2</span></span><br><span class="line"></span><br><span class="line">flag1 = flag[:half]</span><br><span class="line">flag2 = flag[half:]</span><br><span class="line"></span><br><span class="line">secret_num = getPrime(<span class="number">1024</span>) * bytes_to_long(secret)</span><br><span class="line"></span><br><span class="line">p = sympy.nextprime(secret_num)</span><br><span class="line">q = sympy.nextprime(p)</span><br><span class="line"></span><br><span class="line">N = p * q</span><br><span class="line"></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line">F1 = bytes_to_long(flag1)</span><br><span class="line">F2 = bytes_to_long(flag2)</span><br><span class="line"></span><br><span class="line">c1 = F1 + F2</span><br><span class="line">c2 = <span class="built_in">pow</span>(F1, <span class="number">3</span>) + <span class="built_in">pow</span>(F2, <span class="number">3</span>)</span><br><span class="line"><span class="keyword">assert</span>(c2 &lt; N)</span><br><span class="line"></span><br><span class="line">m1 = <span class="built_in">pow</span>(c1, e, N)</span><br><span class="line">m2 = <span class="built_in">pow</span>(c2, e, N)</span><br><span class="line"></span><br><span class="line">output = <span class="built_in">open</span>(<span class="string">&#x27;secret&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">output.write(<span class="string">&#x27;N=&#x27;</span> + <span class="built_in">str</span>(N) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">output.write(<span class="string">&#x27;m1=&#x27;</span> + <span class="built_in">str</span>(m1) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">output.write(<span class="string">&#x27;m2=&#x27;</span> + <span class="built_in">str</span>(m2) + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">output.close()</span><br><span class="line"></span><br><span class="line">N=<span class="number">636585149594574746909030160182690866222909256464847291783000651837227921337237899651287943597773270944384034858925295744880727101606841413640006527614873110651410155893776548737823152943797884729130149758279127430044739254000426610922834573094957082589539445610828279428814524313491262061930512829074466232633130599104490893572093943832740301809630847541592548921200288222432789208650949937638303429456468889100192613859073752923812454212239908948930178355331390933536771065791817643978763045030833712326162883810638120029378337092938662174119747687899484603628344079493556601422498405360731958162719296160584042671057160241284852522913676264596201906163</span></span><br><span class="line">m1=<span class="number">90009974341452243216986938028371257528604943208941176518717463554774967878152694586469377765296113165659498726012712288670458884373971419842750929287658640266219686646956929872115782173093979742958745121671928568709468526098715927189829600497283118051641107305128852697032053368115181216069626606165503465125725204875578701237789292966211824002761481815276666236869005129138862782476859103086726091860497614883282949955023222414333243193268564781621699870412557822404381213804026685831221430728290755597819259339616650158674713248841654338515199405532003173732520457813901170264713085107077001478083341339002069870585378257051150217511755761491021553239</span></span><br><span class="line">m2=<span class="number">487443985757405173426628188375657117604235507936967522993257972108872283698305238454465723214226871414276788912058186197039821242912736742824080627680971802511206914394672159240206910735850651999316100014691067295708138639363203596244693995562780286637116394738250774129759021080197323724805414668042318806010652814405078769738548913675466181551005527065309515364950610137206393257148357659666687091662749848560225453826362271704292692847596339533229088038820532086109421158575841077601268713175097874083536249006018948789413238783922845633494023608865256071962856581229890043896939025613600564283391329331452199062858930374565991634191495137939574539546</span></span><br></pre></td></tr></table></figure>

<h3 id="4-20-2-解题思路"><a href="#4-20-2-解题思路" class="headerlink" title="4.20.2 解题思路"></a>4.20.2 解题思路</h3><p><strong>p、q 参数设置不当（近似攻击）：</strong>$ p $ 和 $ q $ 相邻，$ n^\frac{1}{2} $ 近似等于 $ p $，向下遍历求出 $ p $，进而求出 $ c_1 、 c_2 $。</p>
<p>已知 $ F_1 + F_2 $ 和 $ F_1^3 + F_2^3 $ 可求 $ F_1 、 F_2 $，证明：</p>
<p>$$<br>\begin{gathered}<br>F_1^3+F_2^3&#x3D;(F_1+F_2)(F_1^2-F_1F_2+F_2^2)<br>\<br>将\ F_1+F_2&#x3D;S\ 代入，得：T&#x3D;S\cdot(F_1^2-F_1F_2+F_2^2)<br>\<br>\because F_1^2+F_2^2&#x3D;(F_1+F_2)^2-2F_1F_2&#x3D;S^2-2F_1F_2<br>\<br>\therefore T&#x3D;S\cdot[(S^2-2F_1F_2)-F_1F_2]&#x3D;S\cdot(S^2-3F_1F_2)&#x3D;S^3-3S\cdot F_1F_2<br>\<br>\because S\neq0 \quad \therefore F_1F_2&#x3D;\frac{S^3-T}{3S}<br>\<br>已知\ F_1 + F_2 &#x3D; S\ 和\ F_1 F_2 &#x3D; \frac{S^3-T}{3S}&#x3D;P<br>\<br>F_1\ 和\ F_2\ 是一元二次方程的根：x^2 - Sx + P &#x3D; 0<br>\<br>根据求根公式：x &#x3D; \frac{S \pm \sqrt{S^2 - 4P}}{2}<br>\<br>得：F_1, F_2 &#x3D; \frac{S \pm \sqrt{\frac{4T - S^3}{3S}}}{2}<br>\end{gathered}<br>$$</p>
<h3 id="4-20-3-解题脚本"><a href="#4-20-3-解题脚本" class="headerlink" title="4.20.3 解题脚本"></a>4.20.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, inverse</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot, isqrt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">p_q_approximation</span>(<span class="params">n, e, c</span>):</span><br><span class="line">    p = iroot(n,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">while</span> n % p != <span class="number">0</span> :</span><br><span class="line">        p -= <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    q = n // p</span><br><span class="line">    d = inverse(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">    m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_f1_f2</span>(<span class="params">S, T</span>):</span><br><span class="line">    P = (S**<span class="number">3</span> - T) // (<span class="number">3</span> * S)</span><br><span class="line">    delta = S**<span class="number">2</span> - <span class="number">4</span> * P</span><br><span class="line">    sqrt_d = isqrt(delta)</span><br><span class="line">    x1 = (S + sqrt_d) // <span class="number">2</span></span><br><span class="line">    x2 = (S - sqrt_d) // <span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> x1, x2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    n = <span class="number">636585149594574746909030160182690866222909256464847291783000651837227921337237899651287943597773270944384034858925295744880727101606841413640006527614873110651410155893776548737823152943797884729130149758279127430044739254000426610922834573094957082589539445610828279428814524313491262061930512829074466232633130599104490893572093943832740301809630847541592548921200288222432789208650949937638303429456468889100192613859073752923812454212239908948930178355331390933536771065791817643978763045030833712326162883810638120029378337092938662174119747687899484603628344079493556601422498405360731958162719296160584042671057160241284852522913676264596201906163</span></span><br><span class="line">    m1 = <span class="number">90009974341452243216986938028371257528604943208941176518717463554774967878152694586469377765296113165659498726012712288670458884373971419842750929287658640266219686646956929872115782173093979742958745121671928568709468526098715927189829600497283118051641107305128852697032053368115181216069626606165503465125725204875578701237789292966211824002761481815276666236869005129138862782476859103086726091860497614883282949955023222414333243193268564781621699870412557822404381213804026685831221430728290755597819259339616650158674713248841654338515199405532003173732520457813901170264713085107077001478083341339002069870585378257051150217511755761491021553239</span></span><br><span class="line">    m2 = <span class="number">487443985757405173426628188375657117604235507936967522993257972108872283698305238454465723214226871414276788912058186197039821242912736742824080627680971802511206914394672159240206910735850651999316100014691067295708138639363203596244693995562780286637116394738250774129759021080197323724805414668042318806010652814405078769738548913675466181551005527065309515364950610137206393257148357659666687091662749848560225453826362271704292692847596339533229088038820532086109421158575841077601268713175097874083536249006018948789413238783922845633494023608865256071962856581229890043896939025613600564283391329331452199062858930374565991634191495137939574539546</span></span><br><span class="line">    e = <span class="number">0x10001</span></span><br><span class="line">    c1 = p_q_approximation(n, e, m1)</span><br><span class="line">    c2 = p_q_approximation(n, e, m2)</span><br><span class="line">    f1, f2 = solve_f1_f2(c1, c2)</span><br><span class="line">    flag = long_to_bytes(f1) + long_to_bytes(f2)</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># b&#x27;GWHT&#123;f709e0e2cfe7e530ca8972959a1033b2&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="4-21-SameMod"><a href="#4-21-SameMod" class="headerlink" title="4.21 SameMod"></a>4.21 SameMod</h2><h3 id="4-21-1-题目"><a href="#4-21-1-题目" class="headerlink" title="4.21.1 题目"></a>4.21.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="number">6266565720726907265997241358331585417095726146341989755538017122981360742813498401533594757088796536341941659691259323065631249</span>,<span class="number">773</span>&#125;</span><br><span class="line">&#123;<span class="number">6266565720726907265997241358331585417095726146341989755538017122981360742813498401533594757088796536341941659691259323065631249</span>,<span class="number">839</span>&#125;</span><br><span class="line"></span><br><span class="line">message1=<span class="number">3453520592723443935451151545245025864232388871721682326408915024349804062041976702364728660682912396903968193981131553111537349</span></span><br><span class="line">message2=<span class="number">5672818026816293344070119332536629619457163570036305296869053532293105379690793386019065754465292867769521736414170803238309535</span></span><br></pre></td></tr></table></figure>

<h3 id="4-21-2-解题思路"><a href="#4-21-2-解题思路" class="headerlink" title="4.21.2 解题思路"></a>4.21.2 解题思路</h3><p><strong>共模攻击</strong></p>
<p>ASCII 码解码得 flag</p>
<h3 id="4-21-3-解题脚本"><a href="#4-21-3-解题脚本" class="headerlink" title="4.21.3 解题脚本"></a>4.21.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcdext, mpz</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">common_modulus_attack</span>(<span class="params">e1, e2, c1, c2, n</span>):</span><br><span class="line">    _, r, s = gcdext(e1, e2)</span><br><span class="line">    m = <span class="built_in">pow</span>(c1, r, n) * <span class="built_in">pow</span>(c2, s, n) % n</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ascii_decode</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    解码连续拼接的 ASCII 数字字符串或整数为可读字符串。</span></span><br><span class="line"><span class="string">    支持字符串、整数、或整数列表作为输入。</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    result = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(data, (<span class="built_in">int</span>, mpz)):</span><br><span class="line">        data = <span class="built_in">str</span>(data)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(data, <span class="built_in">str</span>):</span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> i &lt; <span class="built_in">len</span>(data):</span><br><span class="line">            <span class="keyword">for</span> step <span class="keyword">in</span> (<span class="number">3</span>, <span class="number">2</span>):  <span class="comment"># 尝试取3位再取2位</span></span><br><span class="line">                chunk = data[i:i+step]</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(chunk) == step <span class="keyword">and</span> chunk.isdigit():</span><br><span class="line">                    val = <span class="built_in">int</span>(chunk)</span><br><span class="line">                    <span class="keyword">if</span> <span class="number">32</span> &lt;= val &lt;= <span class="number">126</span>:</span><br><span class="line">                        result += <span class="built_in">chr</span>(val)</span><br><span class="line">                        i += step</span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">isinstance</span>(data, <span class="built_in">list</span>):</span><br><span class="line">        result = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> data <span class="keyword">if</span> <span class="built_in">isinstance</span>(x, <span class="built_in">int</span>) <span class="keyword">and</span> <span class="number">32</span> &lt;= x &lt;= <span class="number">126</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    n = <span class="number">6266565720726907265997241358331585417095726146341989755538017122981360742813498401533594757088796536341941659691259323065631249</span></span><br><span class="line">    e1 = <span class="number">773</span></span><br><span class="line">    e2 = <span class="number">839</span></span><br><span class="line">    message1 = <span class="number">3453520592723443935451151545245025864232388871721682326408915024349804062041976702364728660682912396903968193981131553111537349</span></span><br><span class="line">    message2 = <span class="number">5672818026816293344070119332536629619457163570036305296869053532293105379690793386019065754465292867769521736414170803238309535</span></span><br><span class="line"></span><br><span class="line">    m = common_modulus_attack(e1, e2, message1, message2, n)</span><br><span class="line">    <span class="built_in">print</span>(ascii_decode(m))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># flag&#123;whenwethinkitispossible&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="4-22-AFCTF2018-你能看出这是什么加密么"><a href="#4-22-AFCTF2018-你能看出这是什么加密么" class="headerlink" title="4.22 [AFCTF2018]你能看出这是什么加密么"></a>4.22 [AFCTF2018]你能看出这是什么加密么</h2><h3 id="4-22-1-题目"><a href="#4-22-1-题目" class="headerlink" title="4.22.1 题目"></a>4.22.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">p=<span class="number">0x928fb6aa9d813b6c3270131818a7c54edb18e3806942b88670106c1821e0326364194a8c49392849432b37632f0abe3f3c52e909b939c91c50e41a7b8cd00c67d6743b4f</span></span><br><span class="line"></span><br><span class="line">q=<span class="number">0xec301417ccdffa679a8dcc4027dd0d75baf9d441625ed8930472165717f4732884c33f25d4ee6a6c9ae6c44aedad039b0b72cf42cab7f80d32b74061</span></span><br><span class="line"></span><br><span class="line">e=<span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line">c=<span class="number">0x70c9133e1647e95c3cb99bd998a9028b5bf492929725a9e8e6d2e277fa0f37205580b196e5f121a2e83bc80a8204c99f5036a07c8cf6f96c420369b4161d2654a7eccbdaf583204b645e137b3bd15c5ce865298416fd5831cba0d947113ed5be5426b708b89451934d11f9aed9085b48b729449e461ff0863552149b965e22b6</span>   </span><br></pre></td></tr></table></figure>

<h3 id="4-22-2-解题思路"><a href="#4-22-2-解题思路" class="headerlink" title="4.22.2 解题思路"></a>4.22.2 解题思路</h3><p><strong>标准 RSA 解密</strong></p>
<h3 id="4-22-3-解题脚本"><a href="#4-22-3-解题脚本" class="headerlink" title="4.22.3 解题脚本"></a>4.22.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> prod</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> totient</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_OAEP</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse, long_to_bytes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">standard_rsa_decryption</span>(<span class="params">e, c, primes=<span class="literal">None</span>, n=<span class="literal">None</span>, phi=<span class="literal">None</span>, ct_format=<span class="string">&#x27;int&#x27;</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    标准 RSA 解密</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> phi:</span><br><span class="line">        <span class="keyword">if</span> n:</span><br><span class="line">            phi = totient(n)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            phi = prod(p - <span class="number">1</span> <span class="keyword">for</span> p <span class="keyword">in</span> primes)</span><br><span class="line">            n = prod(p <span class="keyword">for</span> p <span class="keyword">in</span> primes)</span><br><span class="line"></span><br><span class="line">    d = inverse(e, phi)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ct_format == <span class="string">&#x27;base64&#x27;</span>:</span><br><span class="line">        p, q = primes[<span class="number">0</span>], primes[<span class="number">1</span>]</span><br><span class="line">        key_info = RSA.construct((n, e, d, p, q))</span><br><span class="line">        key = RSA.importKey(key_info.exportKey())</span><br><span class="line">        key = PKCS1_OAEP.new(key)</span><br><span class="line">        m = key.decrypt(b64decode(c)).decode()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    p = <span class="number">0x928fb6aa9d813b6c3270131818a7c54edb18e3806942b88670106c1821e0326364194a8c49392849432b37632f0abe3f3c52e909b939c91c50e41a7b8cd00c67d6743b4f</span></span><br><span class="line">    q = <span class="number">0xec301417ccdffa679a8dcc4027dd0d75baf9d441625ed8930472165717f4732884c33f25d4ee6a6c9ae6c44aedad039b0b72cf42cab7f80d32b74061</span></span><br><span class="line">    e = <span class="number">0x10001</span></span><br><span class="line">    c = <span class="number">0x70c9133e1647e95c3cb99bd998a9028b5bf492929725a9e8e6d2e277fa0f37205580b196e5f121a2e83bc80a8204c99f5036a07c8cf6f96c420369b4161d2654a7eccbdaf583204b645e137b3bd15c5ce865298416fd5831cba0d947113ed5be5426b708b89451934d11f9aed9085b48b729449e461ff0863552149b965e22b6</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(standard_rsa_decryption(e, c, [p, q])))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># b&#x27;afctf&#123;R54_|5_$0_$imp13&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="4-23-NCTF2019-babyRSA"><a href="#4-23-NCTF2019-babyRSA" class="headerlink" title="4.23 [NCTF2019]babyRSA"></a>4.23 [NCTF2019]babyRSA</h2><h3 id="4-23-1-题目"><a href="#4-23-1-题目" class="headerlink" title="4.23.1 题目"></a>4.23.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">nextPrime</span>(<span class="params">n</span>):</span><br><span class="line">    n += <span class="number">2</span> <span class="keyword">if</span> n &amp; <span class="number">1</span> <span class="keyword">else</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> isPrime(n):</span><br><span class="line">        n += <span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> n</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = nextPrime(p)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">d = inverse(e, (p-<span class="number">1</span>) * (q-<span class="number">1</span>))</span><br><span class="line">c = <span class="built_in">pow</span>(bytes_to_long(flag.encode()), e, n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># d = 19275778946037899718035455438175509175723911466127462154506916564101519923603308900331427601983476886255849200332374081996442976307058597390881168155862238533018621944733299208108185814179466844504468163200369996564265921022888670062554504758512453217434777820468049494313818291727050400752551716550403647148197148884408264686846693842118387217753516963449753809860354047619256787869400297858568139700396567519469825398575103885487624463424429913017729585620877168171603444111464692841379661112075123399343270610272287865200880398193573260848268633461983435015031227070217852728240847398084414687146397303110709214913</span></span><br><span class="line"><span class="comment"># c = 5382723168073828110696168558294206681757991149022777821127563301413483223874527233300721180839298617076705685041174247415826157096583055069337393987892262764211225227035880754417457056723909135525244957935906902665679777101130111392780237502928656225705262431431953003520093932924375902111280077255205118217436744112064069429678632923259898627997145803892753989255615273140300021040654505901442787810653626524305706316663169341797205752938755590056568986738227803487467274114398257187962140796551136220532809687606867385639367743705527511680719955380746377631156468689844150878381460560990755652899449340045313521804</span></span><br></pre></td></tr></table></figure>

<h3 id="4-23-2-解题思路"><a href="#4-23-2-解题思路" class="headerlink" title="4.23.2 解题思路"></a>4.23.2 解题思路</h3><p><strong>p、q 参数设置不当（近似攻击）</strong></p>
<p><strong>已知 $ e $、$ d $、$ \phi(n) $ 或 $ n $ 的范围，求 n：</strong><br>$$<br>\begin{gathered}<br>\because ed \equiv 1 \pmod {\phi(n)} \<br>\therefore ed&#x3D;k \cdot \phi(n)+1<br>\end{gathered}<br>$$<br>$ ed-1 $ 长度为 2064 位，范围在 $2^{2063} \leq ed-1 \lt 2^{2064}$、并且 $\phi(n)$ 长度为 2048 位，范围在 $ 2^{2047} \leq \phi(n) \lt 2^{2048} $ 可爆破 $ k $（范围在$ \left\lceil\frac{2^{2063}}{2^{2048}}\right\rceil&#x3D;\left\lceil2^{15}\right\rceil \lt k \lt \left\lceil\frac{2^{2064}}{2^{2047}}\right\rceil&#x3D;\left\lceil2^{17}\right\rceil $）。</p>
<h3 id="4-23-3-解题脚本"><a href="#4-23-3-解题脚本" class="headerlink" title="4.23.3 解题脚本"></a>4.23.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot, next_prime</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> prevprime</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line">    d = <span class="number">19275778946037899718035455438175509175723911466127462154506916564101519923603308900331427601983476886255849200332374081996442976307058597390881168155862238533018621944733299208108185814179466844504468163200369996564265921022888670062554504758512453217434777820468049494313818291727050400752551716550403647148197148884408264686846693842118387217753516963449753809860354047619256787869400297858568139700396567519469825398575103885487624463424429913017729585620877168171603444111464692841379661112075123399343270610272287865200880398193573260848268633461983435015031227070217852728240847398084414687146397303110709214913</span></span><br><span class="line">    c = <span class="number">5382723168073828110696168558294206681757991149022777821127563301413483223874527233300721180839298617076705685041174247415826157096583055069337393987892262764211225227035880754417457056723909135525244957935906902665679777101130111392780237502928656225705262431431953003520093932924375902111280077255205118217436744112064069429678632923259898627997145803892753989255615273140300021040654505901442787810653626524305706316663169341797205752938755590056568986738227803487467274114398257187962140796551136220532809687606867385639367743705527511680719955380746377631156468689844150878381460560990755652899449340045313521804</span></span><br><span class="line">    ed = e*d - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">len</span>(<span class="built_in">bin</span>(ed)[<span class="number">2</span>:]))</span><br><span class="line">    <span class="comment"># 2064</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">15</span>), <span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">17</span>)):</span><br><span class="line">        <span class="keyword">if</span> ed % k == <span class="number">0</span>:</span><br><span class="line">            p = prevprime(iroot(ed // k, <span class="number">2</span>)[<span class="number">0</span>])</span><br><span class="line">            q = next_prime(p)</span><br><span class="line">        </span><br><span class="line">            <span class="keyword">if</span> ed // k == (q-<span class="number">1</span>)*(p-<span class="number">1</span>):</span><br><span class="line">                <span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c, d, p*q)))</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">                <span class="comment"># b&#x27;NCTF&#123;70u2_nn47h_14_v3ry_gOO0000000d&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="4-24-AFCTF2018-可怜的RSA"><a href="#4-24-AFCTF2018-可怜的RSA" class="headerlink" title="4.24 [AFCTF2018]可怜的RSA"></a>4.24 [AFCTF2018]可怜的RSA</h2><h3 id="4-24-1-题目"><a href="#4-24-1-题目" class="headerlink" title="4.24.1 题目"></a>4.24.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># flag.enc</span></span><br><span class="line">GVd1d3viIXFfcHapEYuo5fAvIiUS83adrtMW/MgPwxVBSl46joFCQ1plcnlDGfL19K/3PvChV6n5QGohzfVyz2Z5GdTlaknxvHDUGf5HCukokyPwK/1EYU7NzrhGE7J5jPdi0Aj7xi/Odxy0hGMgpaBLd/nL3N8O6i9pc4Gg3O8soOlciBG/<span class="number">6</span>/xdfN3SzSStMYIN8nfZZMSq3xDDvz4YB7TcTBh4ik4wYhuC77gmT+HWOv5gLTNQ3EkZs5N3EAopy11zHNYU80yv1jtFGcluNPyXYttU5qU33jcp0Wuznac+t+AZHeSQy5vk8DyWorSGMiS+J4KNqSVlDs12EqXEqqJ0uA==</span><br><span class="line"></span><br><span class="line"><span class="comment"># public.key</span></span><br><span class="line">-----BEGIN PUBLIC KEY-----</span><br><span class="line">MIIBJDANBgkqhkiG9w0BAQEFAAOCAREAMIIBDAKCAQMlsYv184kJfRcjeGa7Uc/<span class="number">4</span></span><br><span class="line">3pIkU3SevEA7CZXJfA44bUbBYcrf93xphg2uR5HCFM+Eh6qqnybpIKl3g0kGA4rv</span><br><span class="line">tcMIJ9/PP8npdpVE+U4Hzf4IcgOaOmJiEWZ4smH7LWudMlOekqFTs2dWKbqzlC59</span><br><span class="line">NeMPfu9avxxQ15fQzIjhvcz9GhLqb373XDcn298ueA80KK6Pek+3qJ8YSjZQMrFT</span><br><span class="line">+EJehFdQ6yt6vALcFc4CB1B6qVCGO7hICngCjdYpeZRNbGM/r6ED5Nsozof1oMbt</span><br><span class="line">Si8mZEJ/Vlx3gathkUVtlxx/+jlScjdM7AFV5fkRidt0LkwosDoPoRz/sDFz0qTM</span><br><span class="line">5q5TAgMBAAE=</span><br><span class="line">-----END PUBLIC KEY-----</span><br></pre></td></tr></table></figure>

<h3 id="4-24-2-解题思路"><a href="#4-24-2-解题思路" class="headerlink" title="4.24.2 解题思路"></a>4.24.2 解题思路</h3><p>提取公钥 + 大素数分解 + 标准 RSA 解密</p>
<h3 id="4-24-3-解题脚本"><a href="#4-24-3-解题脚本" class="headerlink" title="4.24.3 解题脚本"></a>4.24.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> rsa</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> prod</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> totient</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_OAEP</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ExtractKey</span>:</span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">extract_public_key</span>(<span class="params">pem_str</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        提取 PEM 格式公钥中的 n（模数）和 e（公钥指数）</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        pubkey = rsa.PublicKey.load_pkcs1_openssl_pem(pem_str.encode())</span><br><span class="line">        <span class="keyword">return</span> pubkey.n, pubkey.e</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">extract_private_key</span>(<span class="params">pem_str</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        提取 PEM 格式私钥中的 n（模数）和 d（私钥指数）</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        privkey = rsa.PrivateKey.load_pkcs1(pem_str.encode())</span><br><span class="line">        <span class="keyword">return</span> privkey.n, privkey.d</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">queryFactors</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;查询整数n的质因数分解结果&quot;&quot;&quot;</span></span><br><span class="line">    response = requests.get(<span class="string">f&quot;http://factordb.com/api?query=<span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">int</span>(factor) <span class="keyword">for</span> factor, count <span class="keyword">in</span> response.json()[<span class="string">&quot;factors&quot;</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">int</span>(count))]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">standard_rsa_decryption</span>(<span class="params">e, c, primes=<span class="literal">None</span>, n=<span class="literal">None</span>, phi=<span class="literal">None</span>, ct_format=<span class="string">&#x27;int&#x27;</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    标准 RSA 解密</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> phi:</span><br><span class="line">        <span class="keyword">if</span> n:</span><br><span class="line">            phi = totient(n)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            phi = prod(p - <span class="number">1</span> <span class="keyword">for</span> p <span class="keyword">in</span> primes)</span><br><span class="line">            n = prod(p <span class="keyword">for</span> p <span class="keyword">in</span> primes)</span><br><span class="line"></span><br><span class="line">    d = inverse(e, phi)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ct_format == <span class="string">&#x27;base64&#x27;</span>:</span><br><span class="line">        p, q = primes[<span class="number">0</span>], primes[<span class="number">1</span>]</span><br><span class="line">        key_info = RSA.construct((n, e, d, p, q))</span><br><span class="line">        key = RSA.importKey(key_info.exportKey())</span><br><span class="line">        key = PKCS1_OAEP.new(key)</span><br><span class="line">        m = key.decrypt(b64decode(c)).decode()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    public_pem = <span class="string">&quot;&quot;&quot;-----BEGIN PUBLIC KEY-----</span></span><br><span class="line"><span class="string">    MIIBJDANBgkqhkiG9w0BAQEFAAOCAREAMIIBDAKCAQMlsYv184kJfRcjeGa7Uc/4</span></span><br><span class="line"><span class="string">    3pIkU3SevEA7CZXJfA44bUbBYcrf93xphg2uR5HCFM+Eh6qqnybpIKl3g0kGA4rv</span></span><br><span class="line"><span class="string">    tcMIJ9/PP8npdpVE+U4Hzf4IcgOaOmJiEWZ4smH7LWudMlOekqFTs2dWKbqzlC59</span></span><br><span class="line"><span class="string">    NeMPfu9avxxQ15fQzIjhvcz9GhLqb373XDcn298ueA80KK6Pek+3qJ8YSjZQMrFT</span></span><br><span class="line"><span class="string">    +EJehFdQ6yt6vALcFc4CB1B6qVCGO7hICngCjdYpeZRNbGM/r6ED5Nsozof1oMbt</span></span><br><span class="line"><span class="string">    Si8mZEJ/Vlx3gathkUVtlxx/+jlScjdM7AFV5fkRidt0LkwosDoPoRz/sDFz0qTM</span></span><br><span class="line"><span class="string">    5q5TAgMBAAE=</span></span><br><span class="line"><span class="string">    -----END PUBLIC KEY-----&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    n, e = ExtractKey.extract_public_key(public_pem)</span><br><span class="line">    p, q = queryFactors(n)</span><br><span class="line"></span><br><span class="line">    ct = <span class="string">b&#x27;GVd1d3viIXFfcHapEYuo5fAvIiUS83adrtMW/MgPwxVBSl46joFCQ1plcnlDGfL19K/3PvChV6n5QGohzfVyz2Z5GdTlaknxvHDUGf5HCukokyPwK/1EYU7NzrhGE7J5jPdi0Aj7xi/Odxy0hGMgpaBLd/nL3N8O6i9pc4Gg3O8soOlciBG/6/xdfN3SzSStMYIN8nfZZMSq3xDDvz4YB7TcTBh4ik4wYhuC77gmT+HWOv5gLTNQ3EkZs5N3EAopy11zHNYU80yv1jtFGcluNPyXYttU5qU33jcp0Wuznac+t+AZHeSQy5vk8DyWorSGMiS+J4KNqSVlDs12EqXEqqJ0uA==&#x27;</span></span><br><span class="line">    m = standard_rsa_decryption(e, ct, [p, q], ct_format=<span class="string">&#x27;base64&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(m)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># afctf&#123;R54_|5_$0_B0rin9&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="4-25-网鼎杯-2020-青龙组-you-raise-me-up"><a href="#4-25-网鼎杯-2020-青龙组-you-raise-me-up" class="headerlink" title="4.25 [网鼎杯 2020 青龙组]you_raise_me_up"></a>4.25 [网鼎杯 2020 青龙组]you_raise_me_up</h2><h3 id="4-25-1-题目"><a href="#4-25-1-题目" class="headerlink" title="4.25.1 题目"></a>4.25.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">n = <span class="number">2</span> ** <span class="number">512</span></span><br><span class="line">m = random.randint(<span class="number">2</span>, n-<span class="number">1</span>) | <span class="number">1</span></span><br><span class="line">c = <span class="built_in">pow</span>(m, bytes_to_long(flag), n)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;m = &#x27;</span> + <span class="built_in">str</span>(m)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;c = &#x27;</span> + <span class="built_in">str</span>(c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># m = 391190709124527428959489662565274039318305952172936859403855079581402770986890308469084735451207885386318986881041563704825943945069343345307381099559075</span></span><br><span class="line"><span class="comment"># c = 6665851394203214245856789450723658632520816791621796775909766895233000234023642878786025644953797995373211308485605397024123180085924117610802485972584499</span></span><br></pre></td></tr></table></figure>

<h3 id="4-25-2-解题思路"><a href="#4-25-2-解题思路" class="headerlink" title="4.25.2 解题思路"></a>4.25.2 解题思路</h3><p>已知较小 $ m、n、c $ 求 $ e $</p>
<h3 id="4-25-3-解题脚本"><a href="#4-25-3-解题脚本" class="headerlink" title="4.25.3 解题脚本"></a>4.25.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> sympy.ntheory <span class="keyword">import</span> discrete_log</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">m_n_c</span>(<span class="params">m, n, c</span>):</span><br><span class="line">    <span class="keyword">return</span> discrete_log(n, c, m)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    n = <span class="number">2</span> ** <span class="number">512</span></span><br><span class="line">    m = <span class="number">391190709124527428959489662565274039318305952172936859403855079581402770986890308469084735451207885386318986881041563704825943945069343345307381099559075</span></span><br><span class="line">    c = <span class="number">6665851394203214245856789450723658632520816791621796775909766895233000234023642878786025644953797995373211308485605397024123180085924117610802485972584499</span></span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(m_n_c(m, n, c)))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># b&#x27;flag&#123;5f95ca93-1594-762d-ed0b-a9139692cb4a&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="4-26-RSA-what"><a href="#4-26-RSA-what" class="headerlink" title="4.26 RSA &amp; what"></a>4.26 RSA &amp; what</h2><h3 id="4-26-1-题目"><a href="#4-26-1-题目" class="headerlink" title="4.26.1 题目"></a>4.26.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># README.txt</span></span><br><span class="line">素数生成算法太麻烦了，有没有取巧的方法呢？</span><br><span class="line">诶，这里好像有个不错的想法哟。</span><br><span class="line">看起来节约了不少时间呢，嘿嘿嘿……</span><br><span class="line">顺便问问，应该大家都知道base64吧，用来编码还是很方便的呢！</span><br><span class="line"></span><br><span class="line"><span class="comment"># HUB1</span></span><br><span class="line"><span class="number">785095419718268286866508214304816985447077293766819398728046411166917810820484759314291028976498223661229395009474063173705162627037610993539617751905443039278227583504604808251931083818909467613277587874545761074364427549966555519371913859875313577282243053150056274667798049694695703660313532933165449312949725581708965417273055582216295994587600975970124811496270080896977076946000102701030260990598181466447208054713391526313700681341093922240317428173599031624125155188216489476825606191521182034969120343287691181300399683515414809262700457525876691808180257730351707673660380698973884642306898810000633684878715402823143549139850732982897459698089649561190746850698130299458080255582312696873149210028240898137822888492559957665067936573356367589784593119016624072433872744537432005911668494455733330689385141214653091888017782049043434862620306783436169856564175929871100669913438980899219579329897753233450934770193915434791427728636586218049874617231705308003720066269312729135764175698611068808404054125581540114956463603240222497919384691718744014002554201602395969312999994159599536026359879060218056496345745457493919771337601177449899066579857630036350871090452649830775029695488575574985078428560054253180863725364147</span></span><br><span class="line"><span class="number">1697</span></span><br><span class="line"></span><br><span class="line"><span class="number">412629526163150748619328091306742267675740578011800062477174189782151273970783531227579758540364970485350157944321579108232221072397135934034064481497887079641131808838242743811511451355024436983050572020925065644355566434625618133203024215941534926113892937988520918939061441606915556516246057349589921494351383160036280826024605351878408056180907759973804117263002554923041750587548819746346813966673034182913325507826219961923932100526305289894965216608254252188398580139545189681875824089456195044984585824938384521905334289906422454152976834867304693292466676355760173232407753256256317546190171995276258924613533179898467683358934751999655196790168438343198229183747091108262988777659858609744709324571850262293294975336628234767258858873839342596887193772615000676401522431518310648303975593582965021189182246986957349253156736526071639973844039068996404290548474640668851856078201093335425412842295604919065487301340901573809617549185106072798799159726375235125260509158832996701927878713084753334549129580912412168594170659605421750204835970231909591063407612779337478065175988365401590396247576709343727196106058477166945670117868989025903023998142850338956985816131805349549059377047477131270847579095628384569645636821650</span></span><br><span class="line"><span class="number">494644347943710545224678831941589086572700792465459558770782213550069709458568349686998660541810166872034041584767487150140111151788221460027897193248273461607411027815984883969396220626358625041781558277804930212654296704055890683796941327712758797770820006623289146990000114915293539639766846910274034245607746230740851938158390562286057002223177609606376329007676845450142537930798148258428701466415483232670659815791064681384406494388237742330786225557303988025468036820082959712050733095860546860468575857084616069132051094882919253745234762029759124776348047587755897123575123506976140900565238840752841856713613368250071926171873213897914794115466890719123299469964019450899291410760762179836946570945555295288184698184555018368687708432612286248476073758067175481771199066581572870175460016017100414479346437034291784837132240891321931601494414908927713208448927221095745802380014441841139882391378410438764884597938773868771896252329517440068673532468372840830510218585255432000690265226016573313570977945083879214961394087065558376158826938257664840570952233832852869328785568175434516247720356520242602299510374317488182738732700078879665745909603766482100138001417023680647717824323143388857817595766172152883484274718248</span></span><br><span class="line"><span class="number">152942283599728307168144137370127212672611894072038732126041098102628831053000986759260271210671922070555948023688596575415822984026159010574404359474670428678518262175033880513984372909748992727828381694416776740981021730545374002974037896534944567124543272737618380646771071804878796585983783360553761828325817820260204820004421979881871027255562690952334900616675606524933557440263648233514757200263521499508373975003431306847453046714027687108396945719803444444954079308404947126216395526551292104722047878178373207886033071857277857997932255251315982837892164421298202073945919187779856785892717251746704537315003771369737854896595170485152591013676942418134278534037654467840633528916812275267230155352077736583130992587670941654695382287023971261529987384520843829695778029311786431227409189019205818351911572757145556993606643464336196802350204616056286497246016800105003143046120608673496196758720552776772796609670537056331996894322779267635281472481559819839042424017171718303214059720568484939239370144038161541354254182769979771948759413102933987773401644506930205164891773826513161783736386604783484446345744957119469799231796368324927570694496679453313927562345656690240414624431304646248599226046524702364131095964335</span></span><br><span class="line"><span class="number">79717988936247951265489157583697956031893477858854186991051529161879478488281744062318600470906120960002282886511477294555606503083169449335174864424180701080203993329996226566203834693869525797695969610065991941396723959032680019082506816443041598300477625793433080664346470586416385854692124426348587211026568667694805849554780794033764714016521711467557284846737236374990121316809833819996821592832639024026411520407330206281265390130763948165694574512140518775603040182029818771866749548761938870605590174330887949847420877829240131490902432602005681085180807294176837646062568094875766945890382971790015490163385088144673549085079635083262975154206269679142412897438231719704933258660779310737302680265445437771977749959110744959368586293082016067927548564967400845992380076107522755566531760628823374519718763740378295585535591752887339222947397184116326706799921515431185636740825707782742373783475781052674257292910213843986132987466810027275052416774693363446184518901899202502828670309452622347532932678874990809930682575738653876289384151496807194146308614368821006660626870989784697045160231069428458961107751207771093777394616856305293335603892178327520756554333365975114235981173451368131680404850832773147333013716920</span></span><br><span class="line"><span class="number">123111353650401158556639983459870663057297871992927053886971224773529636525110628183715748795987525113177540092814119928708272290370336537110381023134637759740716140969662183269370676630325583385284994943164692397459103195434968057377474610500216801375394703781249039351368816958227409657934091741509357152328382960684515093945552479461382281913961956745154260686029997827565075768703774895750561575155143606297116391666385705899138085693913246313778033627210312268959737394553510894720099165193981333775907531107232556909478156441457899797515694348816961762796703443502856101079430585547997496001098926600499728389113862894833789669213630332988693669889340482430613291490613803204484751470676686041002772556117213612152322606737150858116122936539131795111263513114569794532805886643087299918196635113037777138666914296986040549274559835214505300618256105508764026461518876579387159881983544667258537064954616097750399839661065797883103731694314852301848272092388637114950059216922969842082648527035538090054093890365647676119748995243416337805666557501345234056968476142608491830438065401219751688687373709390057521910942736632126729711606256158399963682990881473178216060827021373776598901281958527655543318413664277921492723185984</span></span><br><span class="line"><span class="number">36869806815936046911848195817405817350259890871483063184373728397968909458432625046025376290214729914038387534731762237978339011724858818860181178811639468996206294711495853807311240013786226884265118119546377272154555615363105236192878292703331473547623021744317034819416624562896226194523639793573028006666236271812390759036235867495803255905843636447252225413871038762657801345647584493917576263471587347202664391908570140389126903204602391093990827188675090199750617303773574821926387194478875191828814971296674530519321530805302667925998711835019806761133078403281404889374663875077339168901297819436499920958268483684335998301056068380228873524800383911402490807139268964095165069610454677558808756444381542173782815227920906224931028457073652453777424387873533280455944646592996920617956675786286711447540353883400282402551158169958389450168079568459656526911857835375748015814860506707921852997096156275804955989964215077733621769938075413007804223217091604613132253046399456747595300404564172224333936405545921819654435437072133387523533568472443532200069133022979195685683508297337961701169394794966256415112246587706103819620428258245999539040721929317130088874161577093962579487428358736401687123174207198251449851429295</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># HUB2</span></span><br><span class="line"><span class="number">785095419718268286866508214304816985447077293766819398728046411166917810820484759314291028976498223661229395009474063173705162627037610993539617751905443039278227583504604808251931083818909467613277587874545761074364427549966555519371913859875313577282243053150056274667798049694695703660313532933165449312949725581708965417273055582216295994587600975970124811496270080896977076946000102701030260990598181466447208054713391526313700681341093922240317428173599031624125155188216489476825606191521182034969120343287691181300399683515414809262700457525876691808180257730351707673660380698973884642306898810000633684878715402823143549139850732982897459698089649561190746850698130299458080255582312696873149210028240898137822888492559957665067936573356367589784593119016624072433872744537432005911668494455733330689385141214653091888017782049043434862620306783436169856564175929871100669913438980899219579329897753233450934770193915434791427728636586218049874617231705308003720066269312729135764175698611068808404054125581540114956463603240222497919384691718744014002554201602395969312999994159599536026359879060218056496345745457493919771337601177449899066579857630036350871090452649830775029695488575574985078428560054253180863725364147</span></span><br><span class="line"><span class="number">599</span></span><br><span class="line"></span><br><span class="line"><span class="number">592169079372093727306100216011395857825646323934289480976073629037543922902098120901138454462177159996376654176248238979132528728327590301098966139983157980612320563496546128644967731000716697705104079039156276714872147463350811303393260622707024952543509891692246246277965823414460326811240048060543656588688604452353899779068825120910282167004715339763187734797180326976132213325054697165320479166356562518029805927741656605174809726397565772271562066078076105491745903986597877400370206718954975288721072048333678609055008135809089304229015364348490924974097403734627265297637171818849461766523691595241613878709865506436588268999163342945070495338153600520537498539457396582804692959296612715752573140296135784933206146091436617979599749774330699946637591406356289409716084034451049094715202196203486088368791744107629271647320273259836915312794297246589501008666299165717722507702866033454215783240025504356157664454861755286285777763585177751796252655008206383024707883077513745863312079349790275094080707502392866946325796914450602264462588722052297430827681750827349094323968337670311272933785838850649376115667223821665435911506351891489985627506615492005617098615432522564204152887767244129985681083657783356557756654335186</span></span><br><span class="line"><span class="number">373940646416832740878733255707567753033716583448402000789202767511920210382830343955553654111486728333980557319799362514960627879016797491389812007768832730979916230647641872759001906846747977631675704310179448857128160385701185892914523053669366534408863734305635222625590986006420486092550427301086984563126480814987024980594613542978310129247678826691418335300577577527951623696426435497835228167084738007750914270251001921329521479047662848650808989996085600197309361410863238526802127877523767262921515150984998560136647154865791163316503073285223966216441025637452229043510097323724381056976302288136843260163922706692913035222445496716008888946581535004546355744211680390731257309941902587303353139951102244865270295414474488798335404630458489706639805186573874814586736746232358849677477533671968344154242963289415569487579895910660999043578737461300406937828924818002658292769882181668784501439254131996848948120781562158861495883827848139425862249576454689133681009549361314460818658995959098228995702202268649635363105549975932395335076521137604288520082040121286614922986554652700056148966514178935952363036963217619879899671383604638416567950421350546204434902113156720006282720889591288850271076074941927715678306057176</span></span><br><span class="line"><span class="number">527630926460622936571385649841758214453416849039412401087443444317101857090904711485538107058823056085840539073345920792871368232355475394571098380596835468509997340505604333730547799560998822989747473780307779717715522787724471724766494090783971030594671013168209717686720448579582618378459567979027822271918653169622428153856198907810040224340270362413432495029672123261375400927159831537760709974778708160583252613784358234858583174544777979242887938827573604837766801998381379999076416444683891078093889686055482709838668356120916040352123019019255084513769603803814947774554028717814638951416291274696771515474086351482107953150253616922787262398450376249126999644026382478413080973933173079111305142716133389111399235545279259017424722601848670061556859163943895466553927946412523750166582734005733378328468250568944945912238495877929717101722314678120172228493787964904072583905721074766711732215815561012960394537195757832959268603775112932862105945720853959285187521763557915356428113876893276879775603217718981852114599706699524551973934242045743122744146361596971245034059345915315495232135483464496114770357536576200511490922413208178149869347802988786513451486411409887164516065062084917556120712465074206435831498113605</span></span><br><span class="line"><span class="number">8786437178698940322877889807009957616777351844979869726962356553244050911283984280960665761649310895230455072977431415102053987735969326553978994853162483051544656873294555116009995592043183070208706258164840540599577072097104139505857517663273929851202628854185356185647194933800084230503413037858893307713037149307477830536758283681093517617820169181420796105338681582230788318108428132051793761014952837330456262272828627355701464740578197966332613127307037255647286823496355917642353327912440019621838870388091824748629637425759125214639885130163183752378908729773517053259212525494555880921052679512582051516604297098204363525081039382358483926727008679327719083138865969291911863630382097160230960738043575559330264018212774424527719153248563876760067931499029384228993253862501939337758514377472011933279273181144830381169849387893799390755052093069179605579485710343655570028592595882436632426527654452895431758715126580164902410286422637215098476316042367916779431052267545769495994723721129943616294879642305545894912914632980455031755879087401575310699765408473606166727137934224515998416625122213056208800095077933103150699272650116151674702438463062734472714004926103668378506804002740045547964716693536349447660850580</span></span><br><span class="line"><span class="number">205314962204511500352858372254132533167549960825498949618514841570703199264867431580754674275990554478140637041427842111391746883257447120035947621456863890934062044010795443059281736346976175772415034838334682726635263432655537852942177334888025283748611576171534251461847349566505628290587224150869640386437623371249743165260396675220683302142805646368906930575140628610003919131999295855501215111393294818218799982703289304596989070475000081175510085432290264502023736899104746316830742226946395027029820825791831870857382647221322734605026210073093918331247494307555600335550942340526536281372036612138713881098866303169425501998978400008829873080965592009371176208668290074288903681417933657472279670688597862835627506340169978450918788539270346340385928840299573889292189531738082166408734046381423516467694328971385421907314814283489322619386570046183556572383980777277173349209330683424343658179781015072259378576130442222984963071166207642585589822061597282467850868050737957726423713761694231879497037175627546427449730638216214828463003483408928375620315193290871300316930139260521382533279767663839278693750409419493280753368451508802658272220767624766390639285308433607255253282702383762149755935518922075584637512494819</span></span><br><span class="line"><span class="number">271453634732502613378948161256470991260052778799128789839624515809143527363206813219580098196957510291648493698144497567392065251244844074992734669490296293997386198359280316655904691639367482203210051809125904410431506925238374843856343243276508280641059690938930957474434518308646618959004216831130099873532714372402117796666560677624822509159287675432413016478948594640872091688482149004426363946048517480052906306290126242866034249478040406351940088231081456109195799442996799641647167552689564613346415247906852055588498305665928450828756152103096629274760601528737639415361467941349982213641454967962723875032638267311935042334584913897338553953961877439389588793074211502597238465542889335363559052368180212013206172712561221352833891640659020253527584706465205486408990762759230842192028381048563437724528409174790022752557512795782713125166158329880702730769957185428522011430144840232256419113631679343171680631630775266488738173707357123139368825087043785842169049943237537188129367275730984789479909103397937113837824575137021012333461552176687570010445744268373840742899299977372834041925102853718964831225250407279578465008537542659673685686242773379131904890865110699190451534445434533919127658976874721029586168106207</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># RSA.py</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, getPrime</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> powmod</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">2048</span>)</span><br><span class="line">q = getPrime(<span class="number">2048</span>)</span><br><span class="line">N = p*q</span><br><span class="line">Phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_enc_key</span>(<span class="params">N,Phi</span>):</span><br><span class="line">    e = getPrime(N)</span><br><span class="line">    <span class="keyword">if</span> Phi % e == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> get_enc_key(N, Phi)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> e</span><br><span class="line">e1 = get_enc_key(randint(<span class="number">10</span>, <span class="number">12</span>), Phi)</span><br><span class="line">e2 = get_enc_key(randint(<span class="number">10</span>, <span class="number">12</span>), Phi)</span><br><span class="line"></span><br><span class="line">fr = <span class="built_in">open</span>(<span class="string">r&quot;./base64&quot;</span>, <span class="string">&quot;rb&quot;</span>)<span class="comment">#flag is in this file</span></span><br><span class="line">f1 = <span class="built_in">open</span>(<span class="string">r&quot;./HUB1&quot;</span>, <span class="string">&quot;wb&quot;</span>)</span><br><span class="line">f2 = <span class="built_in">open</span>(<span class="string">r&quot;./HUB2&quot;</span>, <span class="string">&quot;wb&quot;</span>)</span><br><span class="line">base64 = fr.read(<span class="number">255</span>)</span><br><span class="line">f1.write(<span class="string">&quot;%d\n%d\n&quot;</span> % (N, e1))</span><br><span class="line">f2.write(<span class="string">&quot;%d\n%d\n&quot;</span> % (N, e2))</span><br><span class="line"><span class="keyword">while</span> <span class="built_in">len</span>(base64)&gt;<span class="number">0</span>:</span><br><span class="line">    pt = bytes_to_long(base64)</span><br><span class="line">    ct1 = powmod(pt, e1, N)</span><br><span class="line">    ct2 = powmod(pt, e2, N)</span><br><span class="line">    f1.write(<span class="string">&quot;\n%d&quot;</span> % ct1)</span><br><span class="line">    f2.write(<span class="string">&quot;\n%d&quot;</span> % ct2)</span><br><span class="line">    base64 = fr.read(<span class="number">255</span>)</span><br><span class="line">fr.close()</span><br><span class="line">f1.close()</span><br><span class="line">f2.close()</span><br></pre></td></tr></table></figure>

<h3 id="4-26-2-解题思路"><a href="#4-26-2-解题思路" class="headerlink" title="4.26.2 解题思路"></a>4.26.2 解题思路</h3><p>共模攻击 + Base64 隐写</p>
<h3 id="4-26-3-解题脚本"><a href="#4-26-3-解题脚本" class="headerlink" title="4.26.3 解题脚本"></a>4.26.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">common_modulus_attack</span>(<span class="params">e1, e2, c1, c2, n</span>):</span><br><span class="line">    _, r, s = gmpy2.gcdext(e1, e2)</span><br><span class="line">    m = <span class="built_in">pow</span>(c1, r, n) * <span class="built_in">pow</span>(c2, s, n) % n</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Base64Steganography</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># Base64 字符集，用于定位字符索引</span></span><br><span class="line">        <span class="variable language_">self</span>.base64_chars = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">text_to_binary</span>(<span class="params">self, text</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;将文本转为二进制字符串&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(<span class="string">f&quot;<span class="subst">&#123;<span class="built_in">ord</span>(c):08b&#125;</span>&quot;</span> <span class="keyword">for</span> c <span class="keyword">in</span> text)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">binary_to_text</span>(<span class="params">self, binary_str</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;将二进制字符串转为文本&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(<span class="built_in">int</span>(binary_str[i:i+<span class="number">8</span>], <span class="number">2</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(binary_str), <span class="number">8</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">read_base64_lines</span>(<span class="params">self, content: <span class="built_in">bytes</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        读取并解析 Base64 明文，按行分割</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> content.strip().split(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encode</span>(<span class="params">self, plaintext: <span class="built_in">bytes</span>, secret_text: <span class="built_in">str</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        将秘密信息编码进 Base64 明文中</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        binary_secret = <span class="variable language_">self</span>.text_to_binary(secret_text)</span><br><span class="line">        result_lines = []</span><br><span class="line"></span><br><span class="line">        lines = <span class="variable language_">self</span>.read_base64_lines(plaintext)</span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">            line = line.rstrip(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line">            encoded = base64.b64encode(line)</span><br><span class="line">            pad_count = encoded.count(<span class="string">b&#x27;=&#x27;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> pad_count <span class="keyword">and</span> binary_secret:</span><br><span class="line">                usable_bits = <span class="built_in">min</span>(pad_count * <span class="number">2</span>, <span class="built_in">len</span>(binary_secret))</span><br><span class="line">                bits = binary_secret[:usable_bits]</span><br><span class="line">                binary_secret = binary_secret[usable_bits:]</span><br><span class="line"></span><br><span class="line">                offset = <span class="built_in">int</span>(bits, <span class="number">2</span>)</span><br><span class="line">                pos = <span class="built_in">len</span>(encoded) - pad_count - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">                old_char = encoded[pos:pos+<span class="number">1</span>]</span><br><span class="line">                old_index = <span class="variable language_">self</span>.base64_chars.index(old_char.decode())</span><br><span class="line">                new_index = (old_index + offset) % <span class="number">64</span></span><br><span class="line">                new_char = <span class="variable language_">self</span>.base64_chars[new_index].encode()</span><br><span class="line"></span><br><span class="line">                encoded = encoded[:pos] + new_char + encoded[pos+<span class="number">1</span>:]</span><br><span class="line"></span><br><span class="line">            result_lines.append(encoded)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">b&#x27;\n&#x27;</span>.join(result_lines)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decode</span>(<span class="params">self, stego_text: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        从 Base64 明文中提取秘密信息</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        binary_secret = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        lines = <span class="variable language_">self</span>.read_base64_lines(stego_text)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">            stego = line.strip()</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                decoded = base64.b64decode(stego)</span><br><span class="line">                original = base64.b64encode(decoded)</span><br><span class="line">            <span class="keyword">except</span> Exception:</span><br><span class="line">                <span class="keyword">continue</span>  <span class="comment"># 忽略非法行</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> stego.rstrip(<span class="string">b&#x27;=&#x27;</span>):</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            stego_char = stego.rstrip(<span class="string">b&#x27;=&#x27;</span>)[-<span class="number">1</span>:]</span><br><span class="line">            orig_char = original.rstrip(<span class="string">b&#x27;=&#x27;</span>)[-<span class="number">1</span>:]</span><br><span class="line"></span><br><span class="line">            s_idx = <span class="variable language_">self</span>.base64_chars.index(stego_char.decode())</span><br><span class="line">            o_idx = <span class="variable language_">self</span>.base64_chars.index(orig_char.decode())</span><br><span class="line">            offset = (s_idx - o_idx) % <span class="number">64</span></span><br><span class="line"></span><br><span class="line">            pad_count = stego.count(<span class="string">b&#x27;=&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> pad_count:</span><br><span class="line">                binary_secret += <span class="string">f&quot;<span class="subst">&#123;offset:<span class="number">0</span>&#123;pad_count * <span class="number">2</span>&#125;</span>b&#125;&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.binary_to_text(binary_secret)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    N = <span class="number">785095419718268286866508214304816985447077293766819398728046411166917810820484759314291028976498223661229395009474063173705162627037610993539617751905443039278227583504604808251931083818909467613277587874545761074364427549966555519371913859875313577282243053150056274667798049694695703660313532933165449312949725581708965417273055582216295994587600975970124811496270080896977076946000102701030260990598181466447208054713391526313700681341093922240317428173599031624125155188216489476825606191521182034969120343287691181300399683515414809262700457525876691808180257730351707673660380698973884642306898810000633684878715402823143549139850732982897459698089649561190746850698130299458080255582312696873149210028240898137822888492559957665067936573356367589784593119016624072433872744537432005911668494455733330689385141214653091888017782049043434862620306783436169856564175929871100669913438980899219579329897753233450934770193915434791427728636586218049874617231705308003720066269312729135764175698611068808404054125581540114956463603240222497919384691718744014002554201602395969312999994159599536026359879060218056496345745457493919771337601177449899066579857630036350871090452649830775029695488575574985078428560054253180863725364147</span></span><br><span class="line">    e1 = <span class="number">1697</span></span><br><span class="line">    e2 = <span class="number">599</span></span><br><span class="line">    ct1 = [</span><br><span class="line">        <span class="number">412629526163150748619328091306742267675740578011800062477174189782151273970783531227579758540364970485350157944321579108232221072397135934034064481497887079641131808838242743811511451355024436983050572020925065644355566434625618133203024215941534926113892937988520918939061441606915556516246057349589921494351383160036280826024605351878408056180907759973804117263002554923041750587548819746346813966673034182913325507826219961923932100526305289894965216608254252188398580139545189681875824089456195044984585824938384521905334289906422454152976834867304693292466676355760173232407753256256317546190171995276258924613533179898467683358934751999655196790168438343198229183747091108262988777659858609744709324571850262293294975336628234767258858873839342596887193772615000676401522431518310648303975593582965021189182246986957349253156736526071639973844039068996404290548474640668851856078201093335425412842295604919065487301340901573809617549185106072798799159726375235125260509158832996701927878713084753334549129580912412168594170659605421750204835970231909591063407612779337478065175988365401590396247576709343727196106058477166945670117868989025903023998142850338956985816131805349549059377047477131270847579095628384569645636821650</span>,</span><br><span class="line">        <span class="number">494644347943710545224678831941589086572700792465459558770782213550069709458568349686998660541810166872034041584767487150140111151788221460027897193248273461607411027815984883969396220626358625041781558277804930212654296704055890683796941327712758797770820006623289146990000114915293539639766846910274034245607746230740851938158390562286057002223177609606376329007676845450142537930798148258428701466415483232670659815791064681384406494388237742330786225557303988025468036820082959712050733095860546860468575857084616069132051094882919253745234762029759124776348047587755897123575123506976140900565238840752841856713613368250071926171873213897914794115466890719123299469964019450899291410760762179836946570945555295288184698184555018368687708432612286248476073758067175481771199066581572870175460016017100414479346437034291784837132240891321931601494414908927713208448927221095745802380014441841139882391378410438764884597938773868771896252329517440068673532468372840830510218585255432000690265226016573313570977945083879214961394087065558376158826938257664840570952233832852869328785568175434516247720356520242602299510374317488182738732700078879665745909603766482100138001417023680647717824323143388857817595766172152883484274718248</span>,</span><br><span class="line">        <span class="number">152942283599728307168144137370127212672611894072038732126041098102628831053000986759260271210671922070555948023688596575415822984026159010574404359474670428678518262175033880513984372909748992727828381694416776740981021730545374002974037896534944567124543272737618380646771071804878796585983783360553761828325817820260204820004421979881871027255562690952334900616675606524933557440263648233514757200263521499508373975003431306847453046714027687108396945719803444444954079308404947126216395526551292104722047878178373207886033071857277857997932255251315982837892164421298202073945919187779856785892717251746704537315003771369737854896595170485152591013676942418134278534037654467840633528916812275267230155352077736583130992587670941654695382287023971261529987384520843829695778029311786431227409189019205818351911572757145556993606643464336196802350204616056286497246016800105003143046120608673496196758720552776772796609670537056331996894322779267635281472481559819839042424017171718303214059720568484939239370144038161541354254182769979771948759413102933987773401644506930205164891773826513161783736386604783484446345744957119469799231796368324927570694496679453313927562345656690240414624431304646248599226046524702364131095964335</span>,</span><br><span class="line">        <span class="number">79717988936247951265489157583697956031893477858854186991051529161879478488281744062318600470906120960002282886511477294555606503083169449335174864424180701080203993329996226566203834693869525797695969610065991941396723959032680019082506816443041598300477625793433080664346470586416385854692124426348587211026568667694805849554780794033764714016521711467557284846737236374990121316809833819996821592832639024026411520407330206281265390130763948165694574512140518775603040182029818771866749548761938870605590174330887949847420877829240131490902432602005681085180807294176837646062568094875766945890382971790015490163385088144673549085079635083262975154206269679142412897438231719704933258660779310737302680265445437771977749959110744959368586293082016067927548564967400845992380076107522755566531760628823374519718763740378295585535591752887339222947397184116326706799921515431185636740825707782742373783475781052674257292910213843986132987466810027275052416774693363446184518901899202502828670309452622347532932678874990809930682575738653876289384151496807194146308614368821006660626870989784697045160231069428458961107751207771093777394616856305293335603892178327520756554333365975114235981173451368131680404850832773147333013716920</span>,</span><br><span class="line">        <span class="number">123111353650401158556639983459870663057297871992927053886971224773529636525110628183715748795987525113177540092814119928708272290370336537110381023134637759740716140969662183269370676630325583385284994943164692397459103195434968057377474610500216801375394703781249039351368816958227409657934091741509357152328382960684515093945552479461382281913961956745154260686029997827565075768703774895750561575155143606297116391666385705899138085693913246313778033627210312268959737394553510894720099165193981333775907531107232556909478156441457899797515694348816961762796703443502856101079430585547997496001098926600499728389113862894833789669213630332988693669889340482430613291490613803204484751470676686041002772556117213612152322606737150858116122936539131795111263513114569794532805886643087299918196635113037777138666914296986040549274559835214505300618256105508764026461518876579387159881983544667258537064954616097750399839661065797883103731694314852301848272092388637114950059216922969842082648527035538090054093890365647676119748995243416337805666557501345234056968476142608491830438065401219751688687373709390057521910942736632126729711606256158399963682990881473178216060827021373776598901281958527655543318413664277921492723185984</span>,</span><br><span class="line">        <span class="number">36869806815936046911848195817405817350259890871483063184373728397968909458432625046025376290214729914038387534731762237978339011724858818860181178811639468996206294711495853807311240013786226884265118119546377272154555615363105236192878292703331473547623021744317034819416624562896226194523639793573028006666236271812390759036235867495803255905843636447252225413871038762657801345647584493917576263471587347202664391908570140389126903204602391093990827188675090199750617303773574821926387194478875191828814971296674530519321530805302667925998711835019806761133078403281404889374663875077339168901297819436499920958268483684335998301056068380228873524800383911402490807139268964095165069610454677558808756444381542173782815227920906224931028457073652453777424387873533280455944646592996920617956675786286711447540353883400282402551158169958389450168079568459656526911857835375748015814860506707921852997096156275804955989964215077733621769938075413007804223217091604613132253046399456747595300404564172224333936405545921819654435437072133387523533568472443532200069133022979195685683508297337961701169394794966256415112246587706103819620428258245999539040721929317130088874161577093962579487428358736401687123174207198251449851429295</span></span><br><span class="line">    ]</span><br><span class="line">    ct2 = [</span><br><span class="line">        <span class="number">592169079372093727306100216011395857825646323934289480976073629037543922902098120901138454462177159996376654176248238979132528728327590301098966139983157980612320563496546128644967731000716697705104079039156276714872147463350811303393260622707024952543509891692246246277965823414460326811240048060543656588688604452353899779068825120910282167004715339763187734797180326976132213325054697165320479166356562518029805927741656605174809726397565772271562066078076105491745903986597877400370206718954975288721072048333678609055008135809089304229015364348490924974097403734627265297637171818849461766523691595241613878709865506436588268999163342945070495338153600520537498539457396582804692959296612715752573140296135784933206146091436617979599749774330699946637591406356289409716084034451049094715202196203486088368791744107629271647320273259836915312794297246589501008666299165717722507702866033454215783240025504356157664454861755286285777763585177751796252655008206383024707883077513745863312079349790275094080707502392866946325796914450602264462588722052297430827681750827349094323968337670311272933785838850649376115667223821665435911506351891489985627506615492005617098615432522564204152887767244129985681083657783356557756654335186</span>,</span><br><span class="line">        <span class="number">373940646416832740878733255707567753033716583448402000789202767511920210382830343955553654111486728333980557319799362514960627879016797491389812007768832730979916230647641872759001906846747977631675704310179448857128160385701185892914523053669366534408863734305635222625590986006420486092550427301086984563126480814987024980594613542978310129247678826691418335300577577527951623696426435497835228167084738007750914270251001921329521479047662848650808989996085600197309361410863238526802127877523767262921515150984998560136647154865791163316503073285223966216441025637452229043510097323724381056976302288136843260163922706692913035222445496716008888946581535004546355744211680390731257309941902587303353139951102244865270295414474488798335404630458489706639805186573874814586736746232358849677477533671968344154242963289415569487579895910660999043578737461300406937828924818002658292769882181668784501439254131996848948120781562158861495883827848139425862249576454689133681009549361314460818658995959098228995702202268649635363105549975932395335076521137604288520082040121286614922986554652700056148966514178935952363036963217619879899671383604638416567950421350546204434902113156720006282720889591288850271076074941927715678306057176</span>,</span><br><span class="line">        <span class="number">527630926460622936571385649841758214453416849039412401087443444317101857090904711485538107058823056085840539073345920792871368232355475394571098380596835468509997340505604333730547799560998822989747473780307779717715522787724471724766494090783971030594671013168209717686720448579582618378459567979027822271918653169622428153856198907810040224340270362413432495029672123261375400927159831537760709974778708160583252613784358234858583174544777979242887938827573604837766801998381379999076416444683891078093889686055482709838668356120916040352123019019255084513769603803814947774554028717814638951416291274696771515474086351482107953150253616922787262398450376249126999644026382478413080973933173079111305142716133389111399235545279259017424722601848670061556859163943895466553927946412523750166582734005733378328468250568944945912238495877929717101722314678120172228493787964904072583905721074766711732215815561012960394537195757832959268603775112932862105945720853959285187521763557915356428113876893276879775603217718981852114599706699524551973934242045743122744146361596971245034059345915315495232135483464496114770357536576200511490922413208178149869347802988786513451486411409887164516065062084917556120712465074206435831498113605</span>,</span><br><span class="line">        <span class="number">8786437178698940322877889807009957616777351844979869726962356553244050911283984280960665761649310895230455072977431415102053987735969326553978994853162483051544656873294555116009995592043183070208706258164840540599577072097104139505857517663273929851202628854185356185647194933800084230503413037858893307713037149307477830536758283681093517617820169181420796105338681582230788318108428132051793761014952837330456262272828627355701464740578197966332613127307037255647286823496355917642353327912440019621838870388091824748629637425759125214639885130163183752378908729773517053259212525494555880921052679512582051516604297098204363525081039382358483926727008679327719083138865969291911863630382097160230960738043575559330264018212774424527719153248563876760067931499029384228993253862501939337758514377472011933279273181144830381169849387893799390755052093069179605579485710343655570028592595882436632426527654452895431758715126580164902410286422637215098476316042367916779431052267545769495994723721129943616294879642305545894912914632980455031755879087401575310699765408473606166727137934224515998416625122213056208800095077933103150699272650116151674702438463062734472714004926103668378506804002740045547964716693536349447660850580</span>,</span><br><span class="line">        <span class="number">205314962204511500352858372254132533167549960825498949618514841570703199264867431580754674275990554478140637041427842111391746883257447120035947621456863890934062044010795443059281736346976175772415034838334682726635263432655537852942177334888025283748611576171534251461847349566505628290587224150869640386437623371249743165260396675220683302142805646368906930575140628610003919131999295855501215111393294818218799982703289304596989070475000081175510085432290264502023736899104746316830742226946395027029820825791831870857382647221322734605026210073093918331247494307555600335550942340526536281372036612138713881098866303169425501998978400008829873080965592009371176208668290074288903681417933657472279670688597862835627506340169978450918788539270346340385928840299573889292189531738082166408734046381423516467694328971385421907314814283489322619386570046183556572383980777277173349209330683424343658179781015072259378576130442222984963071166207642585589822061597282467850868050737957726423713761694231879497037175627546427449730638216214828463003483408928375620315193290871300316930139260521382533279767663839278693750409419493280753368451508802658272220767624766390639285308433607255253282702383762149755935518922075584637512494819</span>,</span><br><span class="line">        <span class="number">271453634732502613378948161256470991260052778799128789839624515809143527363206813219580098196957510291648493698144497567392065251244844074992734669490296293997386198359280316655904691639367482203210051809125904410431506925238374843856343243276508280641059690938930957474434518308646618959004216831130099873532714372402117796666560677624822509159287675432413016478948594640872091688482149004426363946048517480052906306290126242866034249478040406351940088231081456109195799442996799641647167552689564613346415247906852055588498305665928450828756152103096629274760601528737639415361467941349982213641454967962723875032638267311935042334584913897338553953961877439389588793074211502597238465542889335363559052368180212013206172712561221352833891640659020253527584706465205486408990762759230842192028381048563437724528409174790022752557512795782713125166158329880702730769957185428522011430144840232256419113631679343171680631630775266488738173707357123139368825087043785842169049943237537188129367275730984789479909103397937113837824575137021012333461552176687570010445744268373840742899299977372834041925102853718964831225250407279578465008537542659673685686242773379131904890865110699190451534445434533919127658976874721029586168106207</span></span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    m = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ct1)):</span><br><span class="line">        m += (long_to_bytes(common_modulus_attack(e1, e2, ct1[i], ct2[i], N)))</span><br><span class="line">    pt = Base64Steganography().decode(m)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;flag&#123;&#123;<span class="subst">&#123;pt&#125;</span>&#125;&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># flag&#123;7c86d8f7d6de33a87f7f9d6b005ce640&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="4-27-NPUCTF2020-EzRSA"><a href="#4-27-NPUCTF2020-EzRSA" class="headerlink" title="4.27 [NPUCTF2020]EzRSA"></a>4.27 [NPUCTF2020]EzRSA</h2><h3 id="4-27-1-题目"><a href="#4-27-1-题目" class="headerlink" title="4.27.1 题目"></a>4.27.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> lcm , powmod , invert , gcd , mpz</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> nextprime</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line">gift = lcm(p - <span class="number">1</span> , q - <span class="number">1</span>)</span><br><span class="line">e = <span class="number">54722</span></span><br><span class="line">flag = <span class="string">b&#x27;NPUCTF&#123;******************&#125;&#x27;</span></span><br><span class="line">m = <span class="built_in">int</span>.from_bytes(flag , <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">c = powmod(m , e , n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n: &#x27;</span> , n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;gift: &#x27;</span> , gift)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c: &#x27;</span> , c)</span><br><span class="line"></span><br><span class="line"><span class="comment">#n:  17083941230213489700426636484487738282426471494607098847295335339638177583685457921198569105417734668692072727759139358207667248703952436680183153327606147421932365889983347282046439156176685765143620637107347870401946946501620531665573668068349080410807996582297505889946205052879002028936125315312256470583622913646319779125559691270916064588684997382451412747432722966919513413709987353038375477178385125453567111965259721484997156799355617642131569095810304077131053588483057244340742751804935494087687363416921314041547093118565767609667033859583125275322077617576783247853718516166743858265291135353895239981121</span></span><br><span class="line"><span class="comment">#gift:  2135492653776686212553329560560967285303308936825887355911916917454772197960682240149821138177216833586509090969892419775958406087994054585022894165950768427741545736247918410255804894522085720642952579638418483800243368312702566458196708508543635051350999572787188236243275631609875253617015664414032058822919469443284453403064076232765024248435543326597418851751586308514540124571309152787559712950209357825576896132278045112177910266019741013995106579484868768251084453338417115483515132869594712162052362083414163954681306259137057581036657441897428432575924018950961141822554251369262248368899977337886190114104</span></span><br><span class="line"><span class="comment">#c:  3738960639194737957667684143565005503596276451617922474669745529299929395507971435311181578387223323429323286927370576955078618335757508161263585164126047545413028829873269342924092339298957635079736446851837414357757312525158356579607212496060244403765822636515347192211817658170822313646743520831977673861869637519843133863288550058359429455052676323196728280408508614527953057214779165450356577820378810467527006377296194102671360302059901897977339728292345132827184227155061326328585640019916328847372295754472832318258636054663091475801235050657401857262960415898483713074139212596685365780269667500271108538319</span></span><br></pre></td></tr></table></figure>

<h3 id="4-27-2-解题思路"><a href="#4-27-2-解题思路" class="headerlink" title="4.27.2 解题思路"></a>4.27.2 解题思路</h3><p><strong>$ \phi(n) $ 与 $ e $ 不互素</strong></p>
<p>最大公约数和最小公倍数关系：$ \text{lcm}(a , b) \times \text{gcd}(a, b)&#x3D;a \cdot b $，因为 $ n $ 长度为 2048 位，$ \phi(n) $ 长度 $ \leq n $，最小公倍数长度为 2045 位，所以最大公约数长度为 2-3 位，可爆破。</p>
<h3 id="4-27-3-解题脚本"><a href="#4-27-3-解题脚本" class="headerlink" title="4.27.3 解题脚本"></a>4.27.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse, long_to_bytes, GCD</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">e_phi_not_coprime</span>(<span class="params">phi, e, n, c</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    phi(n) 与 e 不互素</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    _gcd = GCD(e, phi)</span><br><span class="line">    d = inverse(e//_gcd, phi)</span><br><span class="line">    m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">    <span class="keyword">return</span> iroot(m, _gcd)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    e = <span class="number">54722</span></span><br><span class="line">    n = <span class="number">17083941230213489700426636484487738282426471494607098847295335339638177583685457921198569105417734668692072727759139358207667248703952436680183153327606147421932365889983347282046439156176685765143620637107347870401946946501620531665573668068349080410807996582297505889946205052879002028936125315312256470583622913646319779125559691270916064588684997382451412747432722966919513413709987353038375477178385125453567111965259721484997156799355617642131569095810304077131053588483057244340742751804935494087687363416921314041547093118565767609667033859583125275322077617576783247853718516166743858265291135353895239981121</span></span><br><span class="line">    gift = <span class="number">2135492653776686212553329560560967285303308936825887355911916917454772197960682240149821138177216833586509090969892419775958406087994054585022894165950768427741545736247918410255804894522085720642952579638418483800243368312702566458196708508543635051350999572787188236243275631609875253617015664414032058822919469443284453403064076232765024248435543326597418851751586308514540124571309152787559712950209357825576896132278045112177910266019741013995106579484868768251084453338417115483515132869594712162052362083414163954681306259137057581036657441897428432575924018950961141822554251369262248368899977337886190114104</span></span><br><span class="line">    c = <span class="number">3738960639194737957667684143565005503596276451617922474669745529299929395507971435311181578387223323429323286927370576955078618335757508161263585164126047545413028829873269342924092339298957635079736446851837414357757312525158356579607212496060244403765822636515347192211817658170822313646743520831977673861869637519843133863288550058359429455052676323196728280408508614527953057214779165450356577820378810467527006377296194102671360302059901897977339728292345132827184227155061326328585640019916328847372295754472832318258636054663091475801235050657401857262960415898483713074139212596685365780269667500271108538319</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> g <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="number">8</span>):</span><br><span class="line">        phi = gift * g</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            m = e_phi_not_coprime(phi, e, n, c)</span><br><span class="line">            <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># b&#x27;NPUCTF&#123;diff1cult_rsa_1s_e@sy&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="4-28-MRCTF2020-babyRSA"><a href="#4-28-MRCTF2020-babyRSA" class="headerlink" title="4.28 [MRCTF2020]babyRSA"></a>4.28 [MRCTF2020]babyRSA</h2><h3 id="4-28-1-题目"><a href="#4-28-1-题目" class="headerlink" title="4.28.1 题目"></a>4.28.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcd, invert</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, isPrime, getRandomNBitInteger, bytes_to_long, long_to_bytes</span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">flag = <span class="string">b&quot;MRCTF&#123;xxxx&#125;&quot;</span></span><br><span class="line">base = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GCD</span>(<span class="params">A</span>):</span><br><span class="line">    B = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(A)):</span><br><span class="line">        B = gcd(A[i-<span class="number">1</span>], A[i])</span><br><span class="line">    <span class="keyword">return</span> B</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_p</span>():</span><br><span class="line">    P = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">17</span>)]</span><br><span class="line">    P[<span class="number">0</span>] = getPrime(<span class="number">128</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">17</span>):</span><br><span class="line">        P[i] = sympy.nextprime(P[i-<span class="number">1</span>])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;P_p :&quot;</span>, P[<span class="number">9</span>])</span><br><span class="line">    n = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">17</span>):</span><br><span class="line">        n *= P[i]</span><br><span class="line">    p = getPrime(<span class="number">1024</span>)</span><br><span class="line">    factor = <span class="built_in">pow</span>(p, base, n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;P_factor :&quot;</span>, factor)</span><br><span class="line">    <span class="keyword">return</span> sympy.nextprime(p)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_q</span>():</span><br><span class="line">    sub_Q = getPrime(<span class="number">1024</span>)</span><br><span class="line">    Q_1 = getPrime(<span class="number">1024</span>)</span><br><span class="line">    Q_2 = getPrime(<span class="number">1024</span>)</span><br><span class="line">    Q = sub_Q ** Q_2 % Q_1</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Q_1: &quot;</span>, Q_1)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Q_2: &quot;</span>, Q_2)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;sub_Q: &quot;</span>, sub_Q)</span><br><span class="line">    <span class="keyword">return</span> sympy.nextprime(Q)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    _E = base</span><br><span class="line">    _P = gen_p()</span><br><span class="line">    _Q = gen_q()</span><br><span class="line">    <span class="keyword">assert</span> (gcd(_E, (_P - <span class="number">1</span>) * (_Q - <span class="number">1</span>)) == <span class="number">1</span>)</span><br><span class="line">    _M = bytes_to_long(flag)</span><br><span class="line">    _C = <span class="built_in">pow</span>(_M, _E, _P * _Q)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Ciphertext = &quot;</span>, _C)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">P_p : 206027926847308612719677572554991143421</span></span><br><span class="line"><span class="string">P_factor : 213671742765908980787116579976289600595864704574134469173111790965233629909513884704158446946409910475727584342641848597858942209151114627306286393390259700239698869487469080881267182803062488043469138252786381822646126962323295676431679988602406971858136496624861228526070581338082202663895710929460596143281673761666804565161435963957655012011051936180536581488499059517946308650135300428672486819645279969693519039407892941672784362868653243632727928279698588177694171797254644864554162848696210763681197279758130811723700154618280764123396312330032986093579531909363210692564988076206283296967165522152288770019720928264542910922693728918198338839</span></span><br><span class="line"><span class="string">Q_1:  103766439849465588084625049495793857634556517064563488433148224524638105971161051763127718438062862548184814747601299494052813662851459740127499557785398714481909461631996020048315790167967699932967974484481209879664173009585231469785141628982021847883945871201430155071257803163523612863113967495969578605521</span></span><br><span class="line"><span class="string">Q_2:  151010734276916939790591461278981486442548035032350797306496105136358723586953123484087860176438629843688462671681777513652947555325607414858514566053513243083627810686084890261120641161987614435114887565491866120507844566210561620503961205851409386041194326728437073995372322433035153519757017396063066469743</span></span><br><span class="line"><span class="string">sub_Q:  168992529793593315757895995101430241994953638330919314800130536809801824971112039572562389449584350643924391984800978193707795909956472992631004290479273525116959461856227262232600089176950810729475058260332177626961286009876630340945093629959302803189668904123890991069113826241497783666995751391361028949651</span></span><br><span class="line"><span class="string">Ciphertext =  1709187240516367141460862187749451047644094885791761673574674330840842792189795049968394122216854491757922647656430908587059997070488674220330847871811836724541907666983042376216411561826640060734307013458794925025684062804589439843027290282034999617915124231838524593607080377300985152179828199569474241678651559771763395596697140206072537688129790126472053987391538280007082203006348029125729650207661362371936196789562658458778312533505938858959644541233578654340925901963957980047639114170033936570060250438906130591377904182111622236567507022711176457301476543461600524993045300728432815672077399879668276471832</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="4-28-2-解题思路"><a href="#4-28-2-解题思路" class="headerlink" title="4.28.2 解题思路"></a>4.28.2 解题思路</h3><p>计算多因数欧拉函数 + 标准 RSA 解密</p>
<h3 id="4-28-3-解题脚本"><a href="#4-28-3-解题脚本" class="headerlink" title="4.28.3 解题脚本"></a>4.28.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> prod</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_OAEP</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> totient, nextprime, prevprime</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse, long_to_bytes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">euler_totient_from_factors</span>(<span class="params">prime_factors</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    根据质因数列表计算欧拉函数 φ(n)</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> prime_factors:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>  <span class="comment"># 处理 n=1 的情况</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 统计每个质因数的指数</span></span><br><span class="line">    factors_count = Counter(prime_factors)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 计算 n</span></span><br><span class="line">    n = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> p, k <span class="keyword">in</span> factors_count.items():</span><br><span class="line">        n *= p ** k</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 计算 φ(n) = n × ∏(1 - 1/p)</span></span><br><span class="line">    phi = n</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> factors_count:</span><br><span class="line">        phi = phi // p * (p - <span class="number">1</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> phi</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">standard_rsa_decryption</span>(<span class="params">e, c, primes=<span class="literal">None</span>, n=<span class="literal">None</span>, phi=<span class="literal">None</span>, ct_format=<span class="string">&#x27;int&#x27;</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    标准 RSA 解密</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> phi:</span><br><span class="line">        <span class="keyword">if</span> n:</span><br><span class="line">            phi = totient(n)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            phi = prod(p - <span class="number">1</span> <span class="keyword">for</span> p <span class="keyword">in</span> primes)</span><br><span class="line">            n = prod(p <span class="keyword">for</span> p <span class="keyword">in</span> primes)</span><br><span class="line"></span><br><span class="line">    d = inverse(e, phi)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ct_format == <span class="string">&#x27;base64&#x27;</span>:</span><br><span class="line">        p, q = primes[<span class="number">0</span>], primes[<span class="number">1</span>]</span><br><span class="line">        key_info = RSA.construct((n, e, d, p, q))</span><br><span class="line">        key = RSA.importKey(key_info.exportKey())</span><br><span class="line">        key = PKCS1_OAEP.new(key)</span><br><span class="line">        m = key.decrypt(b64decode(c)).decode()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line">    P_p = <span class="number">206027926847308612719677572554991143421</span></span><br><span class="line">    P_factor = <span class="number">213671742765908980787116579976289600595864704574134469173111790965233629909513884704158446946409910475727584342641848597858942209151114627306286393390259700239698869487469080881267182803062488043469138252786381822646126962323295676431679988602406971858136496624861228526070581338082202663895710929460596143281673761666804565161435963957655012011051936180536581488499059517946308650135300428672486819645279969693519039407892941672784362868653243632727928279698588177694171797254644864554162848696210763681197279758130811723700154618280764123396312330032986093579531909363210692564988076206283296967165522152288770019720928264542910922693728918198338839</span></span><br><span class="line">    Q_1 = <span class="number">103766439849465588084625049495793857634556517064563488433148224524638105971161051763127718438062862548184814747601299494052813662851459740127499557785398714481909461631996020048315790167967699932967974484481209879664173009585231469785141628982021847883945871201430155071257803163523612863113967495969578605521</span></span><br><span class="line">    Q_2 = <span class="number">151010734276916939790591461278981486442548035032350797306496105136358723586953123484087860176438629843688462671681777513652947555325607414858514566053513243083627810686084890261120641161987614435114887565491866120507844566210561620503961205851409386041194326728437073995372322433035153519757017396063066469743</span></span><br><span class="line">    sub_Q = <span class="number">168992529793593315757895995101430241994953638330919314800130536809801824971112039572562389449584350643924391984800978193707795909956472992631004290479273525116959461856227262232600089176950810729475058260332177626961286009876630340945093629959302803189668904123890991069113826241497783666995751391361028949651</span></span><br><span class="line">    Ciphertext = <span class="number">1709187240516367141460862187749451047644094885791761673574674330840842792189795049968394122216854491757922647656430908587059997070488674220330847871811836724541907666983042376216411561826640060734307013458794925025684062804589439843027290282034999617915124231838524593607080377300985152179828199569474241678651559771763395596697140206072537688129790126472053987391538280007082203006348029125729650207661362371936196789562658458778312533505938858959644541233578654340925901963957980047639114170033936570060250438906130591377904182111622236567507022711176457301476543461600524993045300728432815672077399879668276471832</span></span><br><span class="line"></span><br><span class="line">    P_list = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">17</span>)]</span><br><span class="line">    P_list[<span class="number">9</span>] = P_p</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>, <span class="number">17</span>):</span><br><span class="line">        P_list[i] = nextprime(P_list[i-<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">        P_list[i] = prevprime(P_list[i+<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">    n = prod(P_list)</span><br><span class="line">    phi = euler_totient_from_factors(P_list)</span><br><span class="line">    d_p = inverse(e, phi)</span><br><span class="line">    p = nextprime(<span class="built_in">pow</span>(P_factor, d_p, n))</span><br><span class="line">    <span class="built_in">print</span>(p)</span><br><span class="line"></span><br><span class="line">    Q = <span class="built_in">pow</span>(sub_Q, Q_2, Q_1)</span><br><span class="line">    q = nextprime(Q)</span><br><span class="line">    <span class="built_in">print</span>(q)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(standard_rsa_decryption(e, Ciphertext, [p, q])))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># b&#x27;MRCTF&#123;sti11_@_b@by_qu3st10n&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="4-29-WUSTCTF2020-情书"><a href="#4-29-WUSTCTF2020-情书" class="headerlink" title="4.29 [WUSTCTF2020]情书"></a>4.29 [WUSTCTF2020]情书</h2><h3 id="4-29-1-题目"><a href="#4-29-1-题目" class="headerlink" title="4.29.1 题目"></a>4.29.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Premise: Enumerate the alphabet by <span class="number">0</span>、<span class="number">1</span>、<span class="number">2</span>、.....  、<span class="number">25</span></span><br><span class="line">Using the RSA system </span><br><span class="line">Encryption:0156 0821 <span class="number">1616</span> 0041 0140 <span class="number">2130</span> <span class="number">1616</span> 0793</span><br><span class="line">Public Key:<span class="number">2537</span> <span class="keyword">and</span> <span class="number">13</span></span><br><span class="line">Private Key:<span class="number">2537</span> <span class="keyword">and</span> <span class="number">937</span></span><br><span class="line"></span><br><span class="line">flag: wctf2020&#123;Decryption&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-29-2-解题思路"><a href="#4-29-2-解题思路" class="headerlink" title="4.29.2 解题思路"></a>4.29.2 解题思路</h3><p>标准 RSA 解密 + 自定义码表替换</p>
<h3 id="4-29-3-解题脚本"><a href="#4-29-3-解题脚本" class="headerlink" title="4.29.3 解题脚本"></a>4.29.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    n = <span class="number">2537</span></span><br><span class="line">    d = <span class="number">937</span></span><br><span class="line">    ct_list = <span class="string">&#x27;0156 0821 1616 0041 0140 2130 1616 0793&#x27;</span>.split()</span><br><span class="line">    pt = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(<span class="built_in">pow</span>(<span class="built_in">int</span>(ct), d, n) + <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)) <span class="keyword">for</span> ct <span class="keyword">in</span> ct_list)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;flag&#123;&#123;<span class="subst">&#123;pt&#125;</span>&#125;&#125;&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># flag&#123;iloveyou&#125;</span></span><br></pre></td></tr></table></figure>



<h2 id="4-30-WUSTCTF2020-dp-leaking-1s-very-d-angerous"><a href="#4-30-WUSTCTF2020-dp-leaking-1s-very-d-angerous" class="headerlink" title="4.30 [WUSTCTF2020]dp_leaking_1s_very_d@angerous"></a>4.30 [WUSTCTF2020]dp_leaking_1s_very_d@angerous</h2><h3 id="4-30-1-题目"><a href="#4-30-1-题目" class="headerlink" title="4.30.1 题目"></a>4.30.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">156808343598578774957375696815188980682166740609302831099696492068246337198792510898818496239166339015207305102101431634283168544492984586566799996471150252382144148257236707247267506165670877506370253127695314163987084076462560095456635833650720606337852199362362120808707925913897956527780930423574343287847</span></span><br><span class="line">c = <span class="number">108542078809057774666748066235473292495343753790443966020636060807418393737258696352569345621488958094856305865603100885838672591764072157183336139243588435583104423268921439473113244493821692560960443688048994557463526099985303667243623711454841573922233051289561865599722004107134302070301237345400354257869</span></span><br><span class="line">dp = <span class="number">734763139918837027274765680404546851353356952885439663987181004382601658386317353877499122276686150509151221546249750373865024485652349719427182780275825</span></span><br></pre></td></tr></table></figure>

<h3 id="4-30-2-解题思路"><a href="#4-30-2-解题思路" class="headerlink" title="4.30.2 解题思路"></a>4.30.2 解题思路</h3><p><strong>$ dp、dq $ 泄露</strong></p>
<p>已知 $ dp、n、e、c $，求 $ m $</p>
<h3 id="4-30-3-解题脚本"><a href="#4-30-3-解题脚本" class="headerlink" title="4.30.3 解题脚本"></a>4.30.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse, long_to_bytes</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dp_n_e_c</span>(<span class="params">dp: <span class="built_in">int</span>, e: <span class="built_in">int</span>, n: <span class="built_in">int</span>, c: <span class="built_in">int</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    已知 dp (dq)、n、e、c，求明文 m</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 遍历可能的k值，寻找有效的p</span></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, e):</span><br><span class="line">        <span class="keyword">if</span> (dp * e - <span class="number">1</span>) % k: <span class="keyword">continue</span></span><br><span class="line">        p = ((dp * e - <span class="number">1</span>) // k) + <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> n % p: <span class="keyword">continue</span></span><br><span class="line">        q = n // p</span><br><span class="line">        d = inverse(e, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line">    n = <span class="number">156808343598578774957375696815188980682166740609302831099696492068246337198792510898818496239166339015207305102101431634283168544492984586566799996471150252382144148257236707247267506165670877506370253127695314163987084076462560095456635833650720606337852199362362120808707925913897956527780930423574343287847</span></span><br><span class="line">    c = <span class="number">108542078809057774666748066235473292495343753790443966020636060807418393737258696352569345621488958094856305865603100885838672591764072157183336139243588435583104423268921439473113244493821692560960443688048994557463526099985303667243623711454841573922233051289561865599722004107134302070301237345400354257869</span></span><br><span class="line">    dp = <span class="number">734763139918837027274765680404546851353356952885439663987181004382601658386317353877499122276686150509151221546249750373865024485652349719427182780275825</span></span><br><span class="line"></span><br><span class="line">    m = dp_n_e_c(dp, e, n, c)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># b&#x27;wctf2020&#123;dp_leaking_1s_very_d@angerous&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="4-31-MRCTF2020-Easy-RSA"><a href="#4-31-MRCTF2020-Easy-RSA" class="headerlink" title="4.31 [MRCTF2020]Easy_RSA"></a>4.31 [MRCTF2020]Easy_RSA</h2><h3 id="4-31-1-题目"><a href="#4-31-1-题目" class="headerlink" title="4.31.1 题目"></a>4.31.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gcd, invert</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, isPrime, getRandomNBitInteger, bytes_to_long, long_to_bytes</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> zlib <span class="keyword">import</span> *</span><br><span class="line">flag = <span class="string">b&quot;MRCTF&#123;XXXX&#125;&quot;</span></span><br><span class="line">base = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_prime</span>(<span class="params">N</span>):</span><br><span class="line">    A = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        A = getPrime(N)</span><br><span class="line">        <span class="keyword">if</span> A % <span class="number">8</span> == <span class="number">5</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> A</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_p</span>():</span><br><span class="line">    p = getPrime(<span class="number">1024</span>)</span><br><span class="line">    q = getPrime(<span class="number">1024</span>)</span><br><span class="line">    <span class="keyword">assert</span> (p &lt; q)</span><br><span class="line">    n = p * q</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;P_n = &quot;</span>, n)</span><br><span class="line">    F_n = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;P_F_n = &quot;</span>, F_n)</span><br><span class="line">    factor2 = <span class="number">2021</span> * p + <span class="number">2020</span> * q</span><br><span class="line">    <span class="keyword">if</span> factor2 &lt; <span class="number">0</span>:</span><br><span class="line">        factor2 = (-<span class="number">1</span>) * factor2</span><br><span class="line">    <span class="keyword">return</span> sympy.nextprime(factor2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_q</span>():</span><br><span class="line">    p = getPrime(<span class="number">1024</span>)</span><br><span class="line">    q = getPrime(<span class="number">1024</span>)</span><br><span class="line">    <span class="keyword">assert</span> (p &lt; q)</span><br><span class="line">    n = p * q</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Q_n = &quot;</span>, n)</span><br><span class="line">    e = getRandomNBitInteger(<span class="number">53</span>)</span><br><span class="line">    F_n = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">while</span> gcd(e, F_n) != <span class="number">1</span>:</span><br><span class="line">        e = getRandomNBitInteger(<span class="number">53</span>)</span><br><span class="line">    d = invert(e, F_n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Q_E_D = &quot;</span>, e * d)</span><br><span class="line">    factor2 = <span class="number">2021</span> * p - <span class="number">2020</span> * q</span><br><span class="line">    <span class="keyword">if</span> factor2 &lt; <span class="number">0</span>:</span><br><span class="line">        factor2 = (-<span class="number">1</span>) * factor2</span><br><span class="line">    <span class="keyword">return</span> sympy.nextprime(factor2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    _E = base</span><br><span class="line">    _P = gen_p()</span><br><span class="line">    _Q = gen_q()</span><br><span class="line">    <span class="keyword">assert</span> (gcd(_E, (_P - <span class="number">1</span>) * (_Q - <span class="number">1</span>)) == <span class="number">1</span>)</span><br><span class="line">    _M = bytes_to_long(flag)</span><br><span class="line">    _C = <span class="built_in">pow</span>(_M, _E, _P * _Q)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Ciphertext = &quot;</span>, _C)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">P_n =  14057332139537395701238463644827948204030576528558543283405966933509944444681257521108769303999679955371474546213196051386802936343092965202519504111238572269823072199039812208100301939365080328518578704076769147484922508482686658959347725753762078590928561862163337382463252361958145933210306431342748775024336556028267742021320891681762543660468484018686865891073110757394154024833552558863671537491089957038648328973790692356014778420333896705595252711514117478072828880198506187667924020260600124717243067420876363980538994101929437978668709128652587073901337310278665778299513763593234951137512120572797739181693</span></span><br><span class="line"><span class="string">P_F_n =  14057332139537395701238463644827948204030576528558543283405966933509944444681257521108769303999679955371474546213196051386802936343092965202519504111238572269823072199039812208100301939365080328518578704076769147484922508482686658959347725753762078590928561862163337382463252361958145933210306431342748775024099427363967321110127562039879018616082926935567951378185280882426903064598376668106616694623540074057210432790309571018778281723710994930151635857933293394780142192586806292968028305922173313521186946635709194350912242693822450297748434301924950358561859804256788098033426537956252964976682327991427626735740</span></span><br><span class="line"><span class="string">Q_n =  20714298338160449749545360743688018842877274054540852096459485283936802341271363766157976112525034004319938054034934880860956966585051684483662535780621673316774842614701726445870630109196016676725183412879870463432277629916669130494040403733295593655306104176367902352484367520262917943100467697540593925707162162616635533550262718808746254599456286578409187895171015796991910123804529825519519278388910483133813330902530160448972926096083990208243274548561238253002789474920730760001104048093295680593033327818821255300893423412192265814418546134015557579236219461780344469127987669565138930308525189944897421753947</span></span><br><span class="line"><span class="string">Q_E_D =  100772079222298134586116156850742817855408127716962891929259868746672572602333918958075582671752493618259518286336122772703330183037221105058298653490794337885098499073583821832532798309513538383175233429533467348390389323225198805294950484802068148590902907221150968539067980432831310376368202773212266320112670699737501054831646286585142281419237572222713975646843555024731855688573834108711874406149540078253774349708158063055754932812675786123700768288048445326199880983717504538825498103789304873682191053050366806825802602658674268440844577955499368404019114913934477160428428662847012289516655310680119638600315228284298935201</span></span><br><span class="line"><span class="string">Ciphertext =  40855937355228438525361161524441274634175356845950884889338630813182607485910094677909779126550263304194796000904384775495000943424070396334435810126536165332565417336797036611773382728344687175253081047586602838685027428292621557914514629024324794275772522013126464926990620140406412999485728750385876868115091735425577555027394033416643032644774339644654011686716639760512353355719065795222201167219831780961308225780478482467294410828543488412258764446494815238766185728454416691898859462532083437213793104823759147317613637881419787581920745151430394526712790608442960106537539121880514269830696341737507717448946962021</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="4-31-2-解题思路"><a href="#4-31-2-解题思路" class="headerlink" title="4.31.2 解题思路"></a>4.31.2 解题思路</h3><p>求 $ P $：已知 $ n 、 \phi(n) $，求 $p、q$</p>
<p>求 $ Q $：已知 $e 、 d 、 n$，求 $p 、 q$</p>
<p>标准 RSA 解密</p>
<h3 id="4-31-3-解题脚本"><a href="#4-31-3-解题脚本" class="headerlink" title="4.31.3 解题脚本"></a>4.31.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> prod</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_OAEP</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> totient, nextprime</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse, long_to_bytes, GCD</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">standard_rsa_decryption</span>(<span class="params">e, c, primes=<span class="literal">None</span>, n=<span class="literal">None</span>, phi=<span class="literal">None</span>, ct_format=<span class="string">&#x27;int&#x27;</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    标准 RSA 解密</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> phi:</span><br><span class="line">        <span class="keyword">if</span> n:</span><br><span class="line">            phi = totient(n)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            phi = prod(p - <span class="number">1</span> <span class="keyword">for</span> p <span class="keyword">in</span> primes)</span><br><span class="line">            n = prod(p <span class="keyword">for</span> p <span class="keyword">in</span> primes)</span><br><span class="line"></span><br><span class="line">    d = inverse(e, phi)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ct_format == <span class="string">&#x27;base64&#x27;</span>:</span><br><span class="line">        p, q = primes[<span class="number">0</span>], primes[<span class="number">1</span>]</span><br><span class="line">        key_info = RSA.construct((n, e, d, p, q))</span><br><span class="line">        key = RSA.importKey(key_info.exportKey())</span><br><span class="line">        key = PKCS1_OAEP.new(key)</span><br><span class="line">        m = key.decrypt(b64decode(c)).decode()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">phi_n</span>(<span class="params">n, phi</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    已知 n、phi(n)，求 p 和 q</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 计算 p + q</span></span><br><span class="line">    s = n - phi + <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 计算判别式</span></span><br><span class="line">    discriminant = s * s - <span class="number">4</span> * n</span><br><span class="line">    sqrt_d = iroot(discriminant, <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> sqrt_d[<span class="number">1</span>]:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span>  <span class="comment"># 不是完全平方数，无整数解</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># x^2 - (p + q)x + n = 0</span></span><br><span class="line">    sqrt_d = <span class="built_in">int</span>(sqrt_d[<span class="number">0</span>])</span><br><span class="line">    p = (s - sqrt_d) // <span class="number">2</span></span><br><span class="line">    q = (s + sqrt_d) // <span class="number">2</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 验证是否满足条件</span></span><br><span class="line">    <span class="keyword">if</span> p * q == n:</span><br><span class="line">        <span class="keyword">return</span> (p, q)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">n_e_d</span>(<span class="params">n, ed</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    已知 d, e, n 恢复质数因子 p 和 q</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        k = ed - <span class="number">1</span></span><br><span class="line">        g = random.randint(<span class="number">2</span>, n - <span class="number">1</span>)  <span class="comment"># 避免0和1</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 分解k为2^r * t</span></span><br><span class="line">        t = k</span><br><span class="line">        <span class="keyword">while</span> t % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">            t //= <span class="number">2</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 寻找非平凡平方根</span></span><br><span class="line">        y = <span class="built_in">pow</span>(g, t, n)</span><br><span class="line">        <span class="keyword">if</span> y == <span class="number">1</span> <span class="keyword">or</span> y == n - <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">            </span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(k.bit_length()):  <span class="comment"># 最多尝试r次</span></span><br><span class="line">            prev_y = y</span><br><span class="line">            y = <span class="built_in">pow</span>(y, <span class="number">2</span>, n)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> y == <span class="number">1</span>:</span><br><span class="line">                p = GCD(prev_y - <span class="number">1</span>, n)</span><br><span class="line">                <span class="keyword">if</span> p != <span class="number">1</span> <span class="keyword">and</span> p != n:</span><br><span class="line">                    q = n // p</span><br><span class="line">                    <span class="keyword">return</span> (p, q)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">                </span><br><span class="line">            <span class="keyword">if</span> y == n - <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line">    P_n = <span class="number">14057332139537395701238463644827948204030576528558543283405966933509944444681257521108769303999679955371474546213196051386802936343092965202519504111238572269823072199039812208100301939365080328518578704076769147484922508482686658959347725753762078590928561862163337382463252361958145933210306431342748775024336556028267742021320891681762543660468484018686865891073110757394154024833552558863671537491089957038648328973790692356014778420333896705595252711514117478072828880198506187667924020260600124717243067420876363980538994101929437978668709128652587073901337310278665778299513763593234951137512120572797739181693</span></span><br><span class="line">    P_F_n = <span class="number">14057332139537395701238463644827948204030576528558543283405966933509944444681257521108769303999679955371474546213196051386802936343092965202519504111238572269823072199039812208100301939365080328518578704076769147484922508482686658959347725753762078590928561862163337382463252361958145933210306431342748775024099427363967321110127562039879018616082926935567951378185280882426903064598376668106616694623540074057210432790309571018778281723710994930151635857933293394780142192586806292968028305922173313521186946635709194350912242693822450297748434301924950358561859804256788098033426537956252964976682327991427626735740</span></span><br><span class="line">    Q_n = <span class="number">20714298338160449749545360743688018842877274054540852096459485283936802341271363766157976112525034004319938054034934880860956966585051684483662535780621673316774842614701726445870630109196016676725183412879870463432277629916669130494040403733295593655306104176367902352484367520262917943100467697540593925707162162616635533550262718808746254599456286578409187895171015796991910123804529825519519278388910483133813330902530160448972926096083990208243274548561238253002789474920730760001104048093295680593033327818821255300893423412192265814418546134015557579236219461780344469127987669565138930308525189944897421753947</span></span><br><span class="line">    Q_E_D = <span class="number">100772079222298134586116156850742817855408127716962891929259868746672572602333918958075582671752493618259518286336122772703330183037221105058298653490794337885098499073583821832532798309513538383175233429533467348390389323225198805294950484802068148590902907221150968539067980432831310376368202773212266320112670699737501054831646286585142281419237572222713975646843555024731855688573834108711874406149540078253774349708158063055754932812675786123700768288048445326199880983717504538825498103789304873682191053050366806825802602658674268440844577955499368404019114913934477160428428662847012289516655310680119638600315228284298935201</span></span><br><span class="line">    Ciphertext = <span class="number">40855937355228438525361161524441274634175356845950884889338630813182607485910094677909779126550263304194796000904384775495000943424070396334435810126536165332565417336797036611773382728344687175253081047586602838685027428292621557914514629024324794275772522013126464926990620140406412999485728750385876868115091735425577555027394033416643032644774339644654011686716639760512353355719065795222201167219831780961308225780478482467294410828543488412258764446494815238766185728454416691898859462532083437213793104823759147317613637881419787581920745151430394526712790608442960106537539121880514269830696341737507717448946962021</span></span><br><span class="line"></span><br><span class="line">    p, q = phi_n(P_n, P_F_n)</span><br><span class="line">    P = nextprime(<span class="built_in">abs</span>(<span class="number">2021</span> * p + <span class="number">2020</span> * q))</span><br><span class="line"></span><br><span class="line">    p, q = n_e_d(Q_n, Q_E_D)</span><br><span class="line">    Q = nextprime(<span class="built_in">abs</span>(<span class="number">2021</span> * p - <span class="number">2020</span> * q))</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(standard_rsa_decryption(e, Ciphertext, [P, Q])))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># b&#x27;MRCTF&#123;Ju3t_@_31mp13_que3t10n&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="4-32-HDCTF2019-together"><a href="#4-32-HDCTF2019-together" class="headerlink" title="4.32 [HDCTF2019]together"></a>4.32 [HDCTF2019]together</h2><h3 id="4-32-1-题目"><a href="#4-32-1-题目" class="headerlink" title="4.32.1 题目"></a>4.32.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pubkey1.pem</span></span><br><span class="line">-----BEGIN PUBLIC KEY-----</span><br><span class="line">MIIBITANBgkqhkiG9w0BAQEFAAOCAQ4AMIIBCQKCAQB1qLiqKtKVDprtS+NGGN++</span><br><span class="line">q7jLqDJoXMlPRRczMBAGJIRsz5Dzwtt1ulr0s5yu8RdaufiYeU6sYIKk92b3yygL</span><br><span class="line">FvaYCzjdqBF2EyTWGVE7PL5lh3rPUfxwQFqDR8EhIH5x+Ob8rjlkftIjHTBt1ThJ</span><br><span class="line">JXvDBumXpQKGcBIknRaR9dwR1q8GU58/gIk5ND3eCTAadhrhLByWkHbFArxalx4Q</span><br><span class="line">q8s2ZUe8lDc/N6V93EOFjbKbqqqtDmhniF6jdXQDAIwWTpx6+jmzxlCJoVHd2MBs</span><br><span class="line">ZCcQhvklWtuKz4IYL4+iUpMKGHlhY1vCqFx2EzD4XIljFLP9rk7+<span class="number">9</span>+CoyTuIVL/D</span><br><span class="line">AgMACR0=</span><br><span class="line">-----END PUBLIC KEY-----</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># pubkey2.pem</span></span><br><span class="line">-----BEGIN PUBLIC KEY-----</span><br><span class="line">MIIBIDANBgkqhkiG9w0BAQEFAAOCAQ0AMIIBCAKCAQB1qLiqKtKVDprtS+NGGN++</span><br><span class="line">q7jLqDJoXMlPRRczMBAGJIRsz5Dzwtt1ulr0s5yu8RdaufiYeU6sYIKk92b3yygL</span><br><span class="line">FvaYCzjdqBF2EyTWGVE7PL5lh3rPUfxwQFqDR8EhIH5x+Ob8rjlkftIjHTBt1ThJ</span><br><span class="line">JXvDBumXpQKGcBIknRaR9dwR1q8GU58/gIk5ND3eCTAadhrhLByWkHbFArxalx4Q</span><br><span class="line">q8s2ZUe8lDc/N6V93EOFjbKbqqqtDmhniF6jdXQDAIwWTpx6+jmzxlCJoVHd2MBs</span><br><span class="line">ZCcQhvklWtuKz4IYL4+iUpMKGHlhY1vCqFx2EzD4XIljFLP9rk7+<span class="number">9</span>+CoyTuIVL/D</span><br><span class="line">AgJbJQ==</span><br><span class="line">-----END PUBLIC KEY-----</span><br><span class="line"></span><br><span class="line"><span class="comment"># myflag1</span></span><br><span class="line">R3Noy6r3WLItytAmb4FmHEygoilucEEZbO9ZYXx5JN03HNpBLDx7fXd2fl+UL5+11RCs/y0qlTGURWWDtG66eNLzGwNpAKiVj6I7RtUJl2Pcm3NvFeAFwI9UsVREyh7zIV6sI9ZP8l/2GVDorLAz5ULW+f0OINGhJmZm8FL/aDnlfTElhQ87LPicWpXYoMtyr6WrxjK6Ontn8BqCt0EjQ7TeXZhxIH9VTPWjDmFdmOqaqdVIT+LZemTgLNESwM5nn4g5S3aFDFwj1YiDYl0/+8etvKfOrfoKOwR0CxsRHagwdUUTES8EcHLmMGCxCkDZn3SzmmA6Nb3lgLeSgG8P1A==</span><br><span class="line"></span><br><span class="line"><span class="comment"># myflag2</span></span><br><span class="line">O+rRCXI3aTB6P1rYIOPUdalUp6ujpwEq4I20CoWA+HIL8xxGtqY6N5gpr0guZv9ZgOEAMFnBxOqMdVNnB9GgnhmXtt1ZWydPqIcHvlfwpd/Lyd0XSjXnjaz3P3vOQvR71cD/uXyBA0XPzmnTIMgEhuGJVFm8min0L/2qI7wg/Z7w1+4mOmi655JIXeCiG23ukDv6l9bZuqfGvWCa1KKXWDP31nLbp0ZN2obUs6jEAa1qVTaX6M4My+sks+0VvHATrAUuCrmMwVEivqIJ/nS6ymGVERN6Ohnzyr168knEBKOVj0FAOx3YLfppMM+XbOGHeqdKJRLpMvqFXDMGQInT3w==</span><br></pre></td></tr></table></figure>

<h3 id="4-32-2-解题思路"><a href="#4-32-2-解题思路" class="headerlink" title="4.32.2 解题思路"></a>4.32.2 解题思路</h3><p>提取公钥 + 共模攻击</p>
<h3 id="4-32-3-解题脚本"><a href="#4-32-3-解题脚本" class="headerlink" title="4.32.3 解题脚本"></a>4.32.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> rsa</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ExtractKey</span>:</span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">extract_public_key</span>(<span class="params">pem_str</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        提取 PEM 格式公钥中的 n（模数）和 e（公钥指数）</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        pubkey = rsa.PublicKey.load_pkcs1_openssl_pem(pem_str.encode())</span><br><span class="line">        <span class="keyword">return</span> pubkey.n, pubkey.e</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">extract_private_key</span>(<span class="params">pem_str</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        提取 PEM 格式私钥中的 n（模数）和 d（私钥指数）</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        privkey = rsa.PrivateKey.load_pkcs1(pem_str.encode())</span><br><span class="line">        <span class="keyword">return</span> privkey.n, privkey.d</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">common_modulus_attack</span>(<span class="params">e1, e2, c1, c2, n</span>):</span><br><span class="line">    _, r, s = gmpy2.gcdext(e1, e2)</span><br><span class="line">    m = <span class="built_in">pow</span>(c1, r, n) * <span class="built_in">pow</span>(c2, s, n) % n</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    pubkey1 = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    -----BEGIN PUBLIC KEY-----</span></span><br><span class="line"><span class="string">    MIIBITANBgkqhkiG9w0BAQEFAAOCAQ4AMIIBCQKCAQB1qLiqKtKVDprtS+NGGN++</span></span><br><span class="line"><span class="string">    q7jLqDJoXMlPRRczMBAGJIRsz5Dzwtt1ulr0s5yu8RdaufiYeU6sYIKk92b3yygL</span></span><br><span class="line"><span class="string">    FvaYCzjdqBF2EyTWGVE7PL5lh3rPUfxwQFqDR8EhIH5x+Ob8rjlkftIjHTBt1ThJ</span></span><br><span class="line"><span class="string">    JXvDBumXpQKGcBIknRaR9dwR1q8GU58/gIk5ND3eCTAadhrhLByWkHbFArxalx4Q</span></span><br><span class="line"><span class="string">    q8s2ZUe8lDc/N6V93EOFjbKbqqqtDmhniF6jdXQDAIwWTpx6+jmzxlCJoVHd2MBs</span></span><br><span class="line"><span class="string">    ZCcQhvklWtuKz4IYL4+iUpMKGHlhY1vCqFx2EzD4XIljFLP9rk7+9+CoyTuIVL/D</span></span><br><span class="line"><span class="string">    AgMACR0=</span></span><br><span class="line"><span class="string">    -----END PUBLIC KEY-----</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    pubkey2 = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    -----BEGIN PUBLIC KEY-----</span></span><br><span class="line"><span class="string">    MIIBIDANBgkqhkiG9w0BAQEFAAOCAQ0AMIIBCAKCAQB1qLiqKtKVDprtS+NGGN++</span></span><br><span class="line"><span class="string">    q7jLqDJoXMlPRRczMBAGJIRsz5Dzwtt1ulr0s5yu8RdaufiYeU6sYIKk92b3yygL</span></span><br><span class="line"><span class="string">    FvaYCzjdqBF2EyTWGVE7PL5lh3rPUfxwQFqDR8EhIH5x+Ob8rjlkftIjHTBt1ThJ</span></span><br><span class="line"><span class="string">    JXvDBumXpQKGcBIknRaR9dwR1q8GU58/gIk5ND3eCTAadhrhLByWkHbFArxalx4Q</span></span><br><span class="line"><span class="string">    q8s2ZUe8lDc/N6V93EOFjbKbqqqtDmhniF6jdXQDAIwWTpx6+jmzxlCJoVHd2MBs</span></span><br><span class="line"><span class="string">    ZCcQhvklWtuKz4IYL4+iUpMKGHlhY1vCqFx2EzD4XIljFLP9rk7+9+CoyTuIVL/D</span></span><br><span class="line"><span class="string">    AgJbJQ==</span></span><br><span class="line"><span class="string">    -----END PUBLIC KEY-----</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    n, e1 = ExtractKey.extract_public_key(pubkey1)</span><br><span class="line">    n, e2 = ExtractKey.extract_public_key(pubkey2)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;myflag1&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        c1 = <span class="built_in">int</span>.from_bytes(b64decode(f.read()))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;myflag2&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        c2 = <span class="built_in">int</span>.from_bytes(b64decode(f.read()))</span><br><span class="line"></span><br><span class="line">    m = common_modulus_attack(e1, e2, c1, c2, n)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># b&#x27;flag&#123;23re_SDxF_y78hu_5rFgS&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="4-33-INSHack2017-rsa16m"><a href="#4-33-INSHack2017-rsa16m" class="headerlink" title="4.33 [INSHack2017]rsa16m"></a>4.33 [INSHack2017]rsa16m</h2><h3 id="4-33-1-题目"><a href="#4-33-1-题目" class="headerlink" title="4.33.1 题目"></a>4.33.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Challenge description:</span></span><br><span class="line"></span><br><span class="line">When you need really secure communications, you use RSA <span class="keyword">with</span> a <span class="number">4096</span> bit key. &lt;br&gt;</span><br><span class="line">I want really really really secure communications to transmit the nuclear launch codes (yeah IoT <span class="keyword">is</span> everywhere man) so I used RSA <span class="keyword">with</span> a <span class="number">16777216</span> bit key. Surely russians will <span class="keyword">not</span> be able to factor that one ! &lt;br&gt;</span><br><span class="line">File md5 : 1049a0c83a2e34760363b4ad9778753f</span><br></pre></td></tr></table></figure>

<p>附件： <a href="https://dstbp.com/data/attachments/posts/buuctf/rsa16m.zip">rsa_16m.zip</a> </p>
<h3 id="4-33-2-解题思路"><a href="#4-33-2-解题思路" class="headerlink" title="4.33.2 解题思路"></a>4.33.2 解题思路</h3><p><strong>RSA 低公钥指数攻击</strong></p>
<h3 id="4-33-3-解题脚本"><a href="#4-33-3-解题脚本" class="headerlink" title="4.33.3 解题脚本"></a>4.33.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, GCD, inverse</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">low_public_exponent_attack</span>(<span class="params">n, c, e=<span class="literal">None</span>, lower=<span class="literal">None</span>, upper=<span class="literal">None</span>, phi=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    RSA 低公钥指数攻击</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> e <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="comment"># 小 e 且 m^e &lt; n，可直接开 e 次方根</span></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> itertools.count():</span><br><span class="line">            candidate = c + k * n</span><br><span class="line">            root, exact = iroot(candidate, e)</span><br><span class="line">            <span class="keyword">if</span> exact:</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">int</span>(root)</span><br><span class="line">    <span class="keyword">elif</span> phi <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> lower <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> upper <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="comment"># 若未知 e，则爆破 e，满足 gcd(e, φ) = 1 并计算 d</span></span><br><span class="line">        <span class="keyword">for</span> e_candidate <span class="keyword">in</span> <span class="built_in">range</span>(lower, upper):</span><br><span class="line">            <span class="keyword">if</span> GCD(e_candidate, phi) == <span class="number">1</span>:</span><br><span class="line">                d = inverse(e_candidate, phi)</span><br><span class="line">                m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">                <span class="keyword">if</span> <span class="string">b&#x27;flag&#x27;</span> <span class="keyword">in</span> long_to_bytes(m):</span><br><span class="line">                    <span class="keyword">return</span> m</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;参数不完整：请提供 e，或 (phi + low + high)&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    nec = &#123;&#125;</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&quot;rsa_16m&quot;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">            line = line.strip()  <span class="comment"># 去除首尾空格和换行符</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> line:</span><br><span class="line">                <span class="keyword">continue</span>  <span class="comment"># 跳过空行</span></span><br><span class="line">            <span class="comment"># 分割键和值</span></span><br><span class="line">            key, value = line.split(<span class="string">&#x27;=&#x27;</span>, <span class="number">1</span>)</span><br><span class="line">            key = key.strip()</span><br><span class="line">            value = value.strip()</span><br><span class="line">            <span class="comment"># 转换为整数并存储</span></span><br><span class="line">            <span class="keyword">if</span> key <span class="keyword">in</span> [<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;c&#x27;</span>]:</span><br><span class="line">                nec[key] = <span class="built_in">int</span>(value, <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">    n = nec[<span class="string">&#x27;n&#x27;</span>]</span><br><span class="line">    e = nec[<span class="string">&#x27;e&#x27;</span>]</span><br><span class="line">    c = nec[<span class="string">&#x27;c&#x27;</span>]</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(low_public_exponent_attack(n, c, e)))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># b&#x27;INSA&#123;(I)NSA_W0uld_bE_pr0uD&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="4-34-坏蛋是雷宾"><a href="#4-34-坏蛋是雷宾" class="headerlink" title="4.34 坏蛋是雷宾"></a>4.34 坏蛋是雷宾</h2><h3 id="4-34-1-题目"><a href="#4-34-1-题目" class="headerlink" title="4.34.1 题目"></a>4.34.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">老牌刺客之王混进了女王的住所。一天，女王得到了一个匿名举报，说她的侍卫里有一个刺客，叫做Rabin，而他的信息就在一份文件里，文件中有附带一个Pk，是<span class="number">523798549</span>，密文是<span class="number">162853095</span>，校验码二进制值是<span class="number">110001</span>，根据说明是放在明文后一起加密的，明文与密文长度相同。加密算法和这位老牌刺客同名。快拯救女王，答案是求得的明文，进行<span class="number">32</span>位md5小写哈希字符串，提交即可。 </span><br></pre></td></tr></table></figure>

<h3 id="4-34-2-解题思路"><a href="#4-34-2-解题思路" class="headerlink" title="4.34.2 解题思路"></a>4.34.2 解题思路</h3><p><strong>RSA 低公钥指数攻击</strong>：特例 $ e&#x3D;2 $ 的 Rabin 算法</p>
<p><strong>奇偶校验</strong></p>
<h3 id="4-34-3-解题脚本"><a href="#4-34-3-解题脚本" class="headerlink" title="4.34.3 解题脚本"></a>4.34.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Union</span></span><br><span class="line"><span class="keyword">from</span> gmssl <span class="keyword">import</span> sm3</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> factorint</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> isPrime, inverse</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hash_data</span>(<span class="params">data: <span class="type">Union</span>[<span class="built_in">bytes</span>, <span class="built_in">str</span>], algorithm: <span class="built_in">str</span>, output_type: <span class="built_in">str</span> = <span class="string">&quot;hex&quot;</span>, hash_length: <span class="built_in">int</span> = <span class="literal">None</span>, hex_case: <span class="built_in">str</span> = <span class="string">&quot;lower&quot;</span></span>) -&gt; <span class="built_in">tuple</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    计算数据的哈希值，支持多种算法和输出类型</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 统一转换为字节类型（兼容字符串输入）</span></span><br><span class="line">    data_bytes = data.encode(<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">if</span> <span class="built_in">isinstance</span>(data, <span class="built_in">str</span>) <span class="keyword">else</span> data</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 计算哈希值及长度</span></span><br><span class="line">    <span class="keyword">match</span> algorithm.lower():</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;sha256&quot;</span> | <span class="string">&quot;md5&quot;</span> | <span class="string">&quot;sha1&quot;</span>:</span><br><span class="line">            hasher = hashlib.new(algorithm, data_bytes)</span><br><span class="line">            digest = hasher.digest()</span><br><span class="line">            original_length = hasher.digest_size</span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;sm3&quot;</span>:</span><br><span class="line">            hex_digest = sm3.sm3_hash(<span class="built_in">list</span>(data_bytes))  <span class="comment"># gmssl返回十六进制字符串</span></span><br><span class="line">            digest = <span class="built_in">bytes</span>.fromhex(hex_digest)           <span class="comment"># 转换为字节</span></span><br><span class="line">            original_length = <span class="number">32</span>                         <span class="comment"># SM3固定32字节</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> _:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f&quot;不支持的算法: <span class="subst">&#123;algorithm&#125;</span>（支持：sha256/md5/sha1/sm3）&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 长度控制</span></span><br><span class="line">    <span class="keyword">if</span> hash_length <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(hash_length, <span class="built_in">int</span>) <span class="keyword">or</span> hash_length &lt;= <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;hash_length必须是正整数&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> hash_length &gt; original_length:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f&quot;长度超出限制（最大<span class="subst">&#123;original_length&#125;</span>字节）&quot;</span>)</span><br><span class="line">        digest = digest[:hash_length]  <span class="comment"># 截断字节串</span></span><br><span class="line">        actual_length = hash_length</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        actual_length = original_length  <span class="comment"># 不截断时使用原始长度</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 转换输出类型</span></span><br><span class="line">    <span class="keyword">match</span> output_type.lower():</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;bytes&quot;</span>:</span><br><span class="line">            result = digest</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;hex&quot;</span>:</span><br><span class="line">            hex_str = digest.<span class="built_in">hex</span>()</span><br><span class="line">            <span class="comment"># 十六进制大小写转换</span></span><br><span class="line">            result = hex_str.upper() <span class="keyword">if</span> hex_case.lower() == <span class="string">&quot;upper&quot;</span> <span class="keyword">else</span> hex_str.lower()</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;int&quot;</span>:</span><br><span class="line">            result = <span class="built_in">int</span>.from_bytes(digest, byteorder=<span class="string">&quot;big&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> _:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f&quot;不支持的输出类型: <span class="subst">&#123;output_type&#125;</span>（支持：bytes/hex/int）&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result, actual_length</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LowPublicExponentAttackRabin</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, p=<span class="literal">None</span>, q=<span class="literal">None</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        初始化 Rabin 算法</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> p <span class="keyword">and</span> q:</span><br><span class="line">            <span class="comment"># 验证素数合法性（Rabin要求p ≡ 3 mod 4且q ≡ 3 mod 4）</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> (isPrime(p) <span class="keyword">and</span> isPrime(q) <span class="keyword">and</span> p % <span class="number">4</span> == <span class="number">3</span> <span class="keyword">and</span> q % <span class="number">4</span> == <span class="number">3</span>):</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">&quot;p和q必须是形如4k+3的素数&quot;</span>)</span><br><span class="line">            <span class="variable language_">self</span>.p = p</span><br><span class="line">            <span class="variable language_">self</span>.q = q</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># 自动生成符合条件的素数（简化版，实际应用需更大素数）</span></span><br><span class="line">            <span class="variable language_">self</span>.p = <span class="variable language_">self</span>._generate_prime()</span><br><span class="line">            <span class="variable language_">self</span>.q = <span class="variable language_">self</span>._generate_prime()</span><br><span class="line">        </span><br><span class="line">        <span class="variable language_">self</span>.n = <span class="variable language_">self</span>.p * <span class="variable language_">self</span>.q  <span class="comment"># 公钥n = p*q</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_generate_prime</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;生成形如4k+3的素数（示例用小素数，实际需调整）&quot;&quot;&quot;</span></span><br><span class="line">        candidate = <span class="number">7</span>  <span class="comment"># 最小的4k+3素数是3，此处从7开始</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="keyword">if</span> isPrime(candidate) <span class="keyword">and</span> candidate % <span class="number">4</span> == <span class="number">3</span>:</span><br><span class="line">                <span class="keyword">return</span> candidate</span><br><span class="line">            candidate += <span class="number">4</span>  <span class="comment"># 只检查4k+3形式的数</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self, plaintext</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;加密：c = m² mod n&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(plaintext, <span class="built_in">int</span>):</span><br><span class="line">            <span class="keyword">raise</span> TypeError(<span class="string">&quot;明文必须是整数&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> plaintext &lt; <span class="number">0</span> <span class="keyword">or</span> plaintext &gt;= <span class="variable language_">self</span>.n:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f&quot;明文必须在[0, <span class="subst">&#123;self.n&#125;</span>)范围内&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">pow</span>(plaintext, <span class="number">2</span>, <span class="variable language_">self</span>.n)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">self, ciphertext</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;解密：返回4个可能的明文&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(ciphertext, <span class="built_in">int</span>):</span><br><span class="line">            <span class="keyword">raise</span> TypeError(<span class="string">&quot;密文必须是整数&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 计算模p和模q的平方根</span></span><br><span class="line">        m_p1 = <span class="built_in">pow</span>(ciphertext, (<span class="variable language_">self</span>.p + <span class="number">1</span>) // <span class="number">4</span>, <span class="variable language_">self</span>.p)</span><br><span class="line">        m_p2 = (-m_p1) % <span class="variable language_">self</span>.p</span><br><span class="line">        m_q1 = <span class="built_in">pow</span>(ciphertext, (<span class="variable language_">self</span>.q + <span class="number">1</span>) // <span class="number">4</span>, <span class="variable language_">self</span>.q)</span><br><span class="line">        m_q2 = (-m_q1) % <span class="variable language_">self</span>.q</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 中国剩余定理合并结果</span></span><br><span class="line">        inv_q_p = inverse(<span class="variable language_">self</span>.q, <span class="variable language_">self</span>.p)  <span class="comment"># q在模p下的逆</span></span><br><span class="line">        inv_p_q = inverse(<span class="variable language_">self</span>.p, <span class="variable language_">self</span>.q)  <span class="comment"># p在模q下的逆</span></span><br><span class="line"></span><br><span class="line">        m1 = (<span class="variable language_">self</span>.q * inv_q_p * m_p1 + <span class="variable language_">self</span>.p * inv_p_q * m_q1) % <span class="variable language_">self</span>.n</span><br><span class="line">        m2 = (<span class="variable language_">self</span>.q * inv_q_p * m_p1 + <span class="variable language_">self</span>.p * inv_p_q * m_q2) % <span class="variable language_">self</span>.n</span><br><span class="line">        m3 = (<span class="variable language_">self</span>.q * inv_q_p * m_p2 + <span class="variable language_">self</span>.p * inv_p_q * m_q1) % <span class="variable language_">self</span>.n</span><br><span class="line">        m4 = (<span class="variable language_">self</span>.q * inv_q_p * m_p2 + <span class="variable language_">self</span>.p * inv_p_q * m_q2) % <span class="variable language_">self</span>.n</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> (m1, m2, m3, m4)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parity_check</span>(<span class="params">number, number_base=<span class="number">10</span>, check_binary=<span class="string">&#x27;0&#x27;</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    判断 number 的二进制末尾6位是否等于 check_binary。</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 处理 number：统一转为整数</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(number, <span class="built_in">str</span>):</span><br><span class="line">        num = <span class="built_in">int</span>(number, base=number_base)</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">isinstance</span>(number, <span class="built_in">int</span>):</span><br><span class="line">        num = number</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;number 必须为 str 或 int&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 处理 check_binary：转为二进制字符串，保留前导零</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(check_binary, <span class="built_in">str</span>):</span><br><span class="line">        check_str = check_binary.zfill(<span class="number">6</span>)</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">isinstance</span>(check_binary, <span class="built_in">int</span>):</span><br><span class="line">        check_str = <span class="built_in">bin</span>(check_binary)[<span class="number">2</span>:].zfill(<span class="number">6</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;check_binary 必须为 str 或 int&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 获取 number 的二进制末尾6位</span></span><br><span class="line">    bin_last6 = <span class="built_in">bin</span>(num)[-<span class="number">6</span>:].zfill(<span class="number">6</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> bin_last6 == check_str</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    n = <span class="number">523798549</span></span><br><span class="line">    ct = <span class="number">162853095</span></span><br><span class="line">    check_code = <span class="number">0b110001</span></span><br><span class="line">    p, q = factorint(n)</span><br><span class="line">    rabin = LowPublicExponentAttackRabin(p, q)</span><br><span class="line">    pt = rabin.decrypt(ct)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> num <span class="keyword">in</span> pt:</span><br><span class="line">        <span class="keyword">if</span> parity_check(num, <span class="number">10</span>, <span class="number">0b110001</span>):</span><br><span class="line">            plaintext = <span class="built_in">int</span>(<span class="built_in">bin</span>(num)[<span class="number">2</span>:-<span class="number">6</span>], <span class="number">2</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;flag&#123;&#123;<span class="subst">&#123;hash_data(<span class="built_in">str</span>(plaintext), <span class="string">&quot;md5&quot;</span>)[<span class="number">0</span>]&#125;</span>&#125;&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># flag&#123;ca5cec442b2734735406d78c88e90f35&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="4-35-INSHack2019-Yet-Another-RSA-Challenge-Part-1"><a href="#4-35-INSHack2019-Yet-Another-RSA-Challenge-Part-1" class="headerlink" title="4.35 [INSHack2019]Yet Another RSA Challenge - Part 1"></a>4.35 [INSHack2019]Yet Another RSA Challenge - Part 1</h2><h3 id="4-35-1-题目"><a href="#4-35-1-题目" class="headerlink" title="4.35.1 题目"></a>4.35.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line">p = subprocess.check_output(<span class="string">&#x27;openssl prime -generate -bits 2048 -hex&#x27;</span>)</span><br><span class="line">q = subprocess.check_output(<span class="string">&#x27;openssl prime -generate -bits 2048 -hex&#x27;</span>)</span><br><span class="line">flag = <span class="built_in">int</span>(<span class="string">&#x27;INSA&#123;REDACTED&#125;&#x27;</span>.encode(<span class="string">&#x27;hex&#x27;</span>), <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">N = <span class="built_in">int</span>(p,<span class="number">16</span>) * <span class="built_in">int</span>(q,<span class="number">16</span>)</span><br><span class="line"><span class="built_in">print</span> N</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;0x&#x27;</span>+p.replace(<span class="string">&#x27;9F&#x27;</span>,<span class="string">&#x27;FC&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">pow</span>(flag,<span class="number">65537</span>,N)</span><br><span class="line"></span><br><span class="line"><span class="number">719579745653303119025873098043848913976880838286635817351790189702008424828505522253331968992725441130409959387942238566082746772468987336980704680915524591881919460709921709513741059003955050088052599067720107149755856317364317707629467090624585752920523062378696431510814381603360130752588995217840721808871896469275562085215852034302374902524921137398710508865248881286824902780186249148613287250056380811479959269915786545911048030947364841177976623684660771594747297272818410589981294227084173316280447729440036251406684111603371364957690353449585185893322538541593242187738587675489180722498945337715511212885934126635221601469699184812336984707723198731876940991485904637481371763302337637617744175461566445514603405016576604569057507997291470369704260553992902776099599438704680775883984720946337235834374667842758010444010254965664863296455406931885650448386682827401907759661117637294838753325610213809162253020362015045242003388829769019579522792182295457962911430276020610658073659629786668639126004851910536565721128484604554703970965744790413684836096724064390486888113608024265771815004188203124405817878645103282802994701531113849607969243815078720289912255827700390198089699808626116357304202660642601149742427766381</span></span><br><span class="line"><span class="number">0xDCC5A0BD3A1FC0BEB0DA1C2E8CF6B474481B7C12849B76E03C4C946724DB577D2825D6AA193DB559BC9DBABE1DDE8B5E7805E48749EF002F622F7CDBD7853B200E2A027E87E331AFCFD066ED9900F1E5F5E5196A451A6F9E329EB889D773F08E5FBF45AACB818FD186DD74626180294DCC31805A88D1B71DE5BFEF3ED01F12678D906A833A78EDCE9BDAF22BBE45C0BFB7A82AFE42C1C3B8581C83BF43DFE31BFD81527E507686956458905CC9A660604552A060109DC81D01F229A264AB67C6D7168721AB36DE769CEAFB97F238050193EC942078DDF5329A387F46253A4411A9C8BB71F9AEB11AC9623E41C14FCD2739D76E69283E57DDB11FC531B4611EE3</span></span><br><span class="line"><span class="number">596380963583874022971492302071822444225514552231574984926542429117396590795270181084030717066220888052607057994262255729890598322976783889090993129161030148064314476199052180347747135088933481343974996843632511300255010825580875930722684714290535684951679115573751200980708359500292172387447570080875531002842462002727646367063816531958020271149645805755077133231395881833164790825731218786554806777097126212126561056170733032553159740167058242065879953688453169613384659653035659118823444582576657499974059388261153064772228570460351169216103620379299362366574826080703907036316546232196313193923841110510170689800892941998845140534954264505413254429240789223724066502818922164419890197058252325607667959185100118251170368909192832882776642565026481260424714348087206462283972676596101498123547647078981435969530082351104111747783346230914935599764345176602456069568419879060577771404946743580809330315332836749661503035076868102720709045692483171306425207758972682717326821412843569770615848397477633761506670219845039890098105484693890695897858251238713238301401843678654564558196040100908796513657968507381392735855990706254646471937809011610992016368630851454275478216664521360246605400986428230407975530880206404171034278692756</span></span><br></pre></td></tr></table></figure>

<h3 id="4-35-2-解题思路"><a href="#4-35-2-解题思路" class="headerlink" title="4.35.2 解题思路"></a>4.35.2 解题思路</h3><p>$ p $ 参数泄露（注意：有的 <code>FC</code> 不需要替换，需要爆破所有可能）</p>
<h3 id="4-35-3-解题脚本"><a href="#4-35-3-解题脚本" class="headerlink" title="4.35.3 解题脚本"></a>4.35.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> prod</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> totient</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_OAEP</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse, long_to_bytes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">standard_rsa_decryption</span>(<span class="params">e, c, primes=<span class="literal">None</span>, n=<span class="literal">None</span>, phi=<span class="literal">None</span>, ct_format=<span class="string">&#x27;int&#x27;</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    标准 RSA 解密</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> phi:</span><br><span class="line">        <span class="keyword">if</span> n:</span><br><span class="line">            phi = totient(n)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            phi = prod(p - <span class="number">1</span> <span class="keyword">for</span> p <span class="keyword">in</span> primes)</span><br><span class="line">            n = prod(p <span class="keyword">for</span> p <span class="keyword">in</span> primes)</span><br><span class="line"></span><br><span class="line">    d = inverse(e, phi)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ct_format == <span class="string">&#x27;base64&#x27;</span>:</span><br><span class="line">        p, q = primes[<span class="number">0</span>], primes[<span class="number">1</span>]</span><br><span class="line">        key_info = RSA.construct((n, e, d, p, q))</span><br><span class="line">        key = RSA.importKey(key_info.exportKey())</span><br><span class="line">        key = PKCS1_OAEP.new(key)</span><br><span class="line">        m = key.decrypt(b64decode(c)).decode()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line">    n = <span class="number">719579745653303119025873098043848913976880838286635817351790189702008424828505522253331968992725441130409959387942238566082746772468987336980704680915524591881919460709921709513741059003955050088052599067720107149755856317364317707629467090624585752920523062378696431510814381603360130752588995217840721808871896469275562085215852034302374902524921137398710508865248881286824902780186249148613287250056380811479959269915786545911048030947364841177976623684660771594747297272818410589981294227084173316280447729440036251406684111603371364957690353449585185893322538541593242187738587675489180722498945337715511212885934126635221601469699184812336984707723198731876940991485904637481371763302337637617744175461566445514603405016576604569057507997291470369704260553992902776099599438704680775883984720946337235834374667842758010444010254965664863296455406931885650448386682827401907759661117637294838753325610213809162253020362015045242003388829769019579522792182295457962911430276020610658073659629786668639126004851910536565721128484604554703970965744790413684836096724064390486888113608024265771815004188203124405817878645103282802994701531113849607969243815078720289912255827700390198089699808626116357304202660642601149742427766381</span></span><br><span class="line">    p_leak = <span class="number">0xDCC5A0BD3A1FC0BEB0DA1C2E8CF6B474481B7C12849B76E03C4C946724DB577D2825D6AA193DB559BC9DBABE1DDE8B5E7805E48749EF002F622F7CDBD7853B200E2A027E87E331AFCFD066ED9900F1E5F5E5196A451A6F9E329EB889D773F08E5FBF45AACB818FD186DD74626180294DCC31805A88D1B71DE5BFEF3ED01F12678D906A833A78EDCE9BDAF22BBE45C0BFB7A82AFE42C1C3B8581C83BF43DFE31BFD81527E507686956458905CC9A660604552A060109DC81D01F229A264AB67C6D7168721AB36DE769CEAFB97F238050193EC942078DDF5329A387F46253A4411A9C8BB71F9AEB11AC9623E41C14FCD2739D76E69283E57DDB11FC531B4611EE3</span></span><br><span class="line">    c = <span class="number">596380963583874022971492302071822444225514552231574984926542429117396590795270181084030717066220888052607057994262255729890598322976783889090993129161030148064314476199052180347747135088933481343974996843632511300255010825580875930722684714290535684951679115573751200980708359500292172387447570080875531002842462002727646367063816531958020271149645805755077133231395881833164790825731218786554806777097126212126561056170733032553159740167058242065879953688453169613384659653035659118823444582576657499974059388261153064772228570460351169216103620379299362366574826080703907036316546232196313193923841110510170689800892941998845140534954264505413254429240789223724066502818922164419890197058252325607667959185100118251170368909192832882776642565026481260424714348087206462283972676596101498123547647078981435969530082351104111747783346230914935599764345176602456069568419879060577771404946743580809330315332836749661503035076868102720709045692483171306425207758972682717326821412843569770615848397477633761506670219845039890098105484693890695897858251238713238301401843678654564558196040100908796513657968507381392735855990706254646471937809011610992016368630851454275478216664521360246605400986428230407975530880206404171034278692756</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 生成所有可能的替换组合</span></span><br><span class="line">    hex_str = <span class="built_in">hex</span>(p_leak)[<span class="number">2</span>:].upper()</span><br><span class="line">    fc_indices = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(hex_str)-<span class="number">1</span>) <span class="keyword">if</span> hex_str[i:i+<span class="number">2</span>] == <span class="string">&#x27;FC&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> replace_mask <span class="keyword">in</span> product([<span class="literal">False</span>, <span class="literal">True</span>], repeat=<span class="built_in">len</span>(fc_indices)):</span><br><span class="line">        <span class="comment"># 根据替换掩码生成新的十六进制</span></span><br><span class="line">        chars = <span class="built_in">list</span>(hex_str)</span><br><span class="line">        <span class="keyword">for</span> do_replace, idx <span class="keyword">in</span> <span class="built_in">zip</span>(replace_mask, fc_indices):</span><br><span class="line">            <span class="keyword">if</span> do_replace:</span><br><span class="line">                chars[idx:idx+<span class="number">2</span>] = [<span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;F&#x27;</span>]</span><br><span class="line">        </span><br><span class="line">        p = <span class="built_in">int</span>(<span class="string">&#x27;&#x27;</span>.join(chars), <span class="number">16</span>)</span><br><span class="line">        <span class="keyword">if</span> n % p == <span class="number">0</span>:</span><br><span class="line">            q = n // p</span><br><span class="line">            <span class="built_in">print</span>(long_to_bytes(standard_rsa_decryption(e, c, [p, q])))</span><br><span class="line"></span><br><span class="line">            <span class="comment"># b&#x27;INSA&#123;I_w1ll_us3_OTp_n3xT_T1M3&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="4-36-RoarCTF2019-RSA"><a href="#4-36-RoarCTF2019-RSA" class="headerlink" title="4.36 [RoarCTF2019]RSA"></a>4.36 [RoarCTF2019]RSA</h2><h3 id="4-36-1-题目"><a href="#4-36-1-题目" class="headerlink" title="4.36.1 题目"></a>4.36.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">A=(((y%x)**<span class="number">5</span>)%(x%y))**<span class="number">2019</span>+y**<span class="number">316</span>+(y+<span class="number">1</span>)/x</span><br><span class="line">p=next_prime(z*x*y)</span><br><span class="line">q=next_prime(z)</span><br><span class="line">A =  <span class="number">2683349182678714524247469512793476009861014781004924905484127480308161377768192868061561886577048646432382128960881487463427414176114486885830693959404989743229103516924432512724195654425703453612710310587164417035878308390676612592848750287387318129424195208623440294647817367740878211949147526287091298307480502897462279102572556822231669438279317474828479089719046386411971105448723910594710418093977044179949800373224354729179833393219827789389078869290217569511230868967647963089430594258815146362187250855166897553056073744582946148472068334167445499314471518357535261186318756327890016183228412253724</span></span><br><span class="line">n =  <span class="number">117930806043507374325982291823027285148807239117987369609583515353889814856088099671454394340816761242974462268435911765045576377767711593100416932019831889059333166946263184861287975722954992219766493089630810876984781113645362450398009234556085330943125568377741065242183073882558834603430862598066786475299918395341014877416901185392905676043795425126968745185649565106322336954427505104906770493155723995382318346714944184577894150229037758434597242564815299174950147754426950251419204917376517360505024549691723683358170823416757973059354784142601436519500811159036795034676360028928301979780528294114933347127</span></span><br><span class="line">c =  <span class="number">41971850275428383625653350824107291609587853887037624239544762751558838294718672159979929266922528917912189124713273673948051464226519605803745171340724343705832198554680196798623263806617998072496026019940476324971696928551159371970207365741517064295956376809297272541800647747885170905737868568000101029143923792003486793278197051326716680212726111099439262589341050943913401067673851885114314709706016622157285023272496793595281054074260451116213815934843317894898883215362289599366101018081513215120728297131352439066930452281829446586562062242527329672575620261776042653626411730955819001674118193293313612128</span></span><br></pre></td></tr></table></figure>

<h3 id="4-36-2-解题思路"><a href="#4-36-2-解题思路" class="headerlink" title="4.36.2 解题思路"></a>4.36.2 解题思路</h3><p>$ A $ 长度为 $ 2015 \lt 2019 $，所以 $  \left( (y \bmod x)^5 \bmod (x \bmod y) \right)^{2019} $ 值只能为 1 或 0，并且 $ \frac{y+1}{x} $ 结果要求为整数。$A$ 近似 $ y^{316} $，可解 $ x $ 和 $ y $。</p>
<p><strong>p、q 参数设置不当（近似攻击）</strong></p>
<h3 id="4-36-3-解题脚本"><a href="#4-36-3-解题脚本" class="headerlink" title="4.36.3 解题脚本"></a>4.36.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse, long_to_bytes, isPrime</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">p_q_approximation</span>(<span class="params">n, n1, e, c</span>):</span><br><span class="line">    p = iroot(n1, <span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">while</span> n % p != <span class="number">0</span> :</span><br><span class="line">        p += <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    q = n // p</span><br><span class="line">    d = inverse(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line">    A = <span class="number">2683349182678714524247469512793476009861014781004924905484127480308161377768192868061561886577048646432382128960881487463427414176114486885830693959404989743229103516924432512724195654425703453612710310587164417035878308390676612592848750287387318129424195208623440294647817367740878211949147526287091298307480502897462279102572556822231669438279317474828479089719046386411971105448723910594710418093977044179949800373224354729179833393219827789389078869290217569511230868967647963089430594258815146362187250855166897553056073744582946148472068334167445499314471518357535261186318756327890016183228412253724</span></span><br><span class="line">    n = <span class="number">117930806043507374325982291823027285148807239117987369609583515353889814856088099671454394340816761242974462268435911765045576377767711593100416932019831889059333166946263184861287975722954992219766493089630810876984781113645362450398009234556085330943125568377741065242183073882558834603430862598066786475299918395341014877416901185392905676043795425126968745185649565106322336954427505104906770493155723995382318346714944184577894150229037758434597242564815299174950147754426950251419204917376517360505024549691723683358170823416757973059354784142601436519500811159036795034676360028928301979780528294114933347127</span></span><br><span class="line">    c = <span class="number">41971850275428383625653350824107291609587853887037624239544762751558838294718672159979929266922528917912189124713273673948051464226519605803745171340724343705832198554680196798623263806617998072496026019940476324971696928551159371970207365741517064295956376809297272541800647747885170905737868568000101029143923792003486793278197051326716680212726111099439262589341050943913401067673851885114314709706016622157285023272496793595281054074260451116213815934843317894898883215362289599366101018081513215120728297131352439066930452281829446586562062242527329672575620261776042653626411730955819001674118193293313612128</span></span><br><span class="line"></span><br><span class="line">    y = iroot(A, <span class="number">316</span>)[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">if</span> (y+<span class="number">1</span>) % ((A-<span class="number">1</span>) - y**<span class="number">316</span>) == <span class="number">0</span>:</span><br><span class="line">        x = (y+<span class="number">1</span>) // ((A-<span class="number">1</span>) - y**<span class="number">316</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        x = (y+<span class="number">1</span>) // (A - y**<span class="number">316</span>)</span><br><span class="line">    </span><br><span class="line">    m = p_q_approximation(n, n // x // y, e, c)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># b&#x27;RoarCTF&#123;wm-l1l1ll1l1l1l111ll&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<br>

<h1 id="5-哈希与消息认证"><a href="#5-哈希与消息认证" class="headerlink" title="5. 哈希与消息认证"></a>5. 哈希与消息认证</h1><h2 id="5-1-MD5"><a href="#5-1-MD5" class="headerlink" title="5.1 MD5"></a>5.1 MD5</h2><h3 id="5-1-1-题目"><a href="#5-1-1-题目" class="headerlink" title="5.1.1 题目"></a>5.1.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">e00cf25ad42683b3df678c61f42c6bda</span><br></pre></td></tr></table></figure>

<h3 id="5-1-2-解题思路"><a href="#5-1-2-解题思路" class="headerlink" title="5.1.2 解题思路"></a>5.1.2 解题思路</h3><p>MD5 在线查询</p>
<h3 id="5-1-3-解题脚本"><a href="#5-1-3-解题脚本" class="headerlink" title="5.1.3 解题脚本"></a>5.1.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https://www.cmd5.com/default.aspx</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag&#123;admin1&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="5-2-丢失的MD5"><a href="#5-2-丢失的MD5" class="headerlink" title="5.2 丢失的MD5"></a>5.2 丢失的MD5</h2><h3 id="5-2-1-题目"><a href="#5-2-1-题目" class="headerlink" title="5.2.1 题目"></a>5.2.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib   </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">            m=hashlib.md5()</span><br><span class="line">            m.update(<span class="string">&#x27;TASC&#x27;</span>+<span class="built_in">chr</span>(i)+<span class="string">&#x27;O3RJMV&#x27;</span>+<span class="built_in">chr</span>(j)+<span class="string">&#x27;WDJKX&#x27;</span>+<span class="built_in">chr</span>(k)+<span class="string">&#x27;ZM&#x27;</span>)</span><br><span class="line">            des=m.hexdigest()</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;e9032&#x27;</span> <span class="keyword">in</span> des <span class="keyword">and</span> <span class="string">&#x27;da&#x27;</span> <span class="keyword">in</span> des <span class="keyword">and</span> <span class="string">&#x27;911513&#x27;</span> <span class="keyword">in</span> des:</span><br><span class="line">                <span class="built_in">print</span> des</span><br></pre></td></tr></table></figure>

<h3 id="5-2-2-解题思路"><a href="#5-2-2-解题思路" class="headerlink" title="5.2.2 解题思路"></a>5.2.2 解题思路</h3><p><strong>MD5 爆破</strong></p>
<p>针对特定 MD5 哈希值的爆破。遍历 ASCII 字符（32-126）寻找符合特定子串条件的 MD5 哈希值。</p>
<h3 id="5-2-3-解题脚本"><a href="#5-2-3-解题脚本" class="headerlink" title="5.2.3 解题脚本"></a>5.2.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Union</span></span><br><span class="line"><span class="keyword">from</span> gmssl <span class="keyword">import</span> sm3</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hash_data</span>(<span class="params">data: <span class="type">Union</span>[<span class="built_in">bytes</span>, <span class="built_in">str</span>], algorithm: <span class="built_in">str</span>, output_type: <span class="built_in">str</span> = <span class="string">&quot;hex&quot;</span>, hash_length: <span class="built_in">int</span> = <span class="literal">None</span>, hex_case: <span class="built_in">str</span> = <span class="string">&quot;lower&quot;</span></span>) -&gt; <span class="built_in">tuple</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    计算数据的哈希值，支持多种算法和输出类型</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 统一转换为字节类型（兼容字符串输入）</span></span><br><span class="line">    data_bytes = data.encode(<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">if</span> <span class="built_in">isinstance</span>(data, <span class="built_in">str</span>) <span class="keyword">else</span> data</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 计算哈希值及长度</span></span><br><span class="line">    <span class="keyword">match</span> algorithm.lower():</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;sha256&quot;</span> | <span class="string">&quot;md5&quot;</span> | <span class="string">&quot;sha1&quot;</span>:</span><br><span class="line">            hasher = hashlib.new(algorithm, data_bytes)</span><br><span class="line">            digest = hasher.digest()</span><br><span class="line">            original_length = hasher.digest_size</span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;sm3&quot;</span>:</span><br><span class="line">            hex_digest = sm3.sm3_hash(<span class="built_in">list</span>(data_bytes))  <span class="comment"># gmssl返回十六进制字符串</span></span><br><span class="line">            digest = <span class="built_in">bytes</span>.fromhex(hex_digest)           <span class="comment"># 转换为字节</span></span><br><span class="line">            original_length = <span class="number">32</span>                         <span class="comment"># SM3固定32字节</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> _:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f&quot;不支持的算法: <span class="subst">&#123;algorithm&#125;</span>（支持：sha256/md5/sha1/sm3）&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 长度控制</span></span><br><span class="line">    <span class="keyword">if</span> hash_length <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(hash_length, <span class="built_in">int</span>) <span class="keyword">or</span> hash_length &lt;= <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;hash_length必须是正整数&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> hash_length &gt; original_length:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f&quot;长度超出限制（最大<span class="subst">&#123;original_length&#125;</span>字节）&quot;</span>)</span><br><span class="line">        digest = digest[:hash_length]  <span class="comment"># 截断字节串</span></span><br><span class="line">        actual_length = hash_length</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        actual_length = original_length  <span class="comment"># 不截断时使用原始长度</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 转换输出类型</span></span><br><span class="line">    <span class="keyword">match</span> output_type.lower():</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;bytes&quot;</span>:</span><br><span class="line">            result = digest</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;hex&quot;</span>:</span><br><span class="line">            hex_str = digest.<span class="built_in">hex</span>()</span><br><span class="line">            <span class="comment"># 十六进制大小写转换</span></span><br><span class="line">            result = hex_str.upper() <span class="keyword">if</span> hex_case.lower() == <span class="string">&quot;upper&quot;</span> <span class="keyword">else</span> hex_str.lower()</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;int&quot;</span>:</span><br><span class="line">            result = <span class="built_in">int</span>.from_bytes(digest, byteorder=<span class="string">&quot;big&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> _:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f&quot;不支持的输出类型: <span class="subst">&#123;output_type&#125;</span>（支持：bytes/hex/int）&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result, actual_length</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">                m = <span class="string">&#x27;TASC&#x27;</span>+<span class="built_in">chr</span>(i)+<span class="string">&#x27;O3RJMV&#x27;</span>+<span class="built_in">chr</span>(j)+<span class="string">&#x27;WDJKX&#x27;</span>+<span class="built_in">chr</span>(k)+<span class="string">&#x27;ZM&#x27;</span></span><br><span class="line">                des, _ = hash_data(m, <span class="string">&#x27;md5&#x27;</span>)</span><br><span class="line">                <span class="keyword">if</span> <span class="string">&#x27;e9032&#x27;</span> <span class="keyword">in</span> des <span class="keyword">and</span> <span class="string">&#x27;da&#x27;</span> <span class="keyword">in</span> des <span class="keyword">and</span> <span class="string">&#x27;911513&#x27;</span> <span class="keyword">in</span> des:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&#x27;flag&#123;&#123;<span class="subst">&#123;m&#125;</span>&#125;&#125;&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">                    <span class="comment"># flag&#123;TASCJO3RJMVKWDJKXLZM&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="5-3-Windows系统密码"><a href="#5-3-Windows系统密码" class="headerlink" title="5.3 Windows系统密码"></a>5.3 Windows系统密码</h2><h3 id="5-3-1-题目"><a href="#5-3-1-题目" class="headerlink" title="5.3.1 题目"></a>5.3.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Administrator:<span class="number">500</span>:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">ctf:<span class="number">1002</span>:06af9108f2e1fecf144e2e8adef09efd:a7fcb22a88038f35a8f39d503e7f0062:::</span><br><span class="line">Guest:<span class="number">501</span>:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">SUPPORT_388945a0:<span class="number">1001</span>:aad3b435b51404eeaad3b435b51404ee:bef14eee40dffbc345eeb3f58e290d56:::</span><br></pre></td></tr></table></figure>

<h3 id="5-3-2-解题思路"><a href="#5-3-2-解题思路" class="headerlink" title="5.3.2 解题思路"></a>5.3.2 解题思路</h3><p>MD5 在线查询</p>
<h3 id="5-3-3-解题脚本"><a href="#5-3-3-解题脚本" class="headerlink" title="5.3.3 解题脚本"></a>5.3.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https://www.cmd5.com/default.aspx</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag&#123;good-luck&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="5-4-权限获得第一步"><a href="#5-4-权限获得第一步" class="headerlink" title="5.4 权限获得第一步"></a>5.4 权限获得第一步</h2><h3 id="5-4-1-题目"><a href="#5-4-1-题目" class="headerlink" title="5.4.1 题目"></a>5.4.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Administrator:<span class="number">500</span>:806EDC27AA52E314AAD3B435B51404EE:F4AD50F57683D4260DFD48AA351A17A8:::</span><br></pre></td></tr></table></figure>

<h3 id="5-4-2-解题思路"><a href="#5-4-2-解题思路" class="headerlink" title="5.4.2 解题思路"></a>5.4.2 解题思路</h3><p>MD5 在线查询</p>
<h3 id="5-4-3-解题脚本"><a href="#5-4-3-解题脚本" class="headerlink" title="5.4.3 解题脚本"></a>5.4.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">https://www.cmd5.com/default.aspx</span><br><span class="line"></span><br><span class="line"><span class="comment"># F4AD50F57683D4260DFD48AA351A17A8 -&gt; 3617656</span></span><br><span class="line">flag&#123;<span class="number">3617656</span>&#125;</span><br></pre></td></tr></table></figure>

<br>

<h2 id="5-5-还原大师"><a href="#5-5-还原大师" class="headerlink" title="5.5 还原大师"></a>5.5 还原大师</h2><h3 id="5-5-1-题目"><a href="#5-5-1-题目" class="headerlink" title="5.5.1 题目"></a>5.5.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">我们得到了一串神秘字符串：TASC?O3RJMV?WDJKX?ZM,问号部分是未知大写字母，为了确定这个神秘字符串，我们通过了其他途径获得了这个字串的<span class="number">32</span>位MD5码。但是我们获得它的<span class="number">32</span>位MD5码也是残缺不全，E903???4DAB????08?????<span class="number">51</span>?<span class="number">80</span>??8A?,请猜出神秘字符串的原本模样，并且提交这个字串的<span class="number">32</span>位MD5码作为答案。</span><br></pre></td></tr></table></figure>

<h3 id="5-5-2-解题思路"><a href="#5-5-2-解题思路" class="headerlink" title="5.5.2 解题思路"></a>5.5.2 解题思路</h3><p><strong>MD5 爆破</strong></p>
<p>针对特定 MD5 哈希值的爆破。遍历 ASCII 字符（32-126）寻找符合特定子串条件的 MD5 哈希值。</p>
<h3 id="5-5-3-解题脚本"><a href="#5-5-3-解题脚本" class="headerlink" title="5.5.3 解题脚本"></a>5.5.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Union</span></span><br><span class="line"><span class="keyword">from</span> gmssl <span class="keyword">import</span> sm3</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hash_data</span>(<span class="params">data: <span class="type">Union</span>[<span class="built_in">bytes</span>, <span class="built_in">str</span>], algorithm: <span class="built_in">str</span>, output_type: <span class="built_in">str</span> = <span class="string">&quot;hex&quot;</span>, hash_length: <span class="built_in">int</span> = <span class="literal">None</span>, hex_case: <span class="built_in">str</span> = <span class="string">&quot;lower&quot;</span></span>) -&gt; <span class="built_in">tuple</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    计算数据的哈希值，支持多种算法和输出类型</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 统一转换为字节类型（兼容字符串输入）</span></span><br><span class="line">    data_bytes = data.encode(<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">if</span> <span class="built_in">isinstance</span>(data, <span class="built_in">str</span>) <span class="keyword">else</span> data</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 计算哈希值及长度</span></span><br><span class="line">    <span class="keyword">match</span> algorithm.lower():</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;sha256&quot;</span> | <span class="string">&quot;md5&quot;</span> | <span class="string">&quot;sha1&quot;</span>:</span><br><span class="line">            hasher = hashlib.new(algorithm, data_bytes)</span><br><span class="line">            digest = hasher.digest()</span><br><span class="line">            original_length = hasher.digest_size</span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;sm3&quot;</span>:</span><br><span class="line">            hex_digest = sm3.sm3_hash(<span class="built_in">list</span>(data_bytes))  <span class="comment"># gmssl返回十六进制字符串</span></span><br><span class="line">            digest = <span class="built_in">bytes</span>.fromhex(hex_digest)           <span class="comment"># 转换为字节</span></span><br><span class="line">            original_length = <span class="number">32</span>                         <span class="comment"># SM3固定32字节</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> _:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f&quot;不支持的算法: <span class="subst">&#123;algorithm&#125;</span>（支持：sha256/md5/sha1/sm3）&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 长度控制</span></span><br><span class="line">    <span class="keyword">if</span> hash_length <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(hash_length, <span class="built_in">int</span>) <span class="keyword">or</span> hash_length &lt;= <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;hash_length必须是正整数&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> hash_length &gt; original_length:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f&quot;长度超出限制（最大<span class="subst">&#123;original_length&#125;</span>字节）&quot;</span>)</span><br><span class="line">        digest = digest[:hash_length]  <span class="comment"># 截断字节串</span></span><br><span class="line">        actual_length = hash_length</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        actual_length = original_length  <span class="comment"># 不截断时使用原始长度</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 转换输出类型</span></span><br><span class="line">    <span class="keyword">match</span> output_type.lower():</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;bytes&quot;</span>:</span><br><span class="line">            result = digest</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;hex&quot;</span>:</span><br><span class="line">            hex_str = digest.<span class="built_in">hex</span>()</span><br><span class="line">            <span class="comment"># 十六进制大小写转换</span></span><br><span class="line">            result = hex_str.upper() <span class="keyword">if</span> hex_case.lower() == <span class="string">&quot;upper&quot;</span> <span class="keyword">else</span> hex_str.lower()</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;int&quot;</span>:</span><br><span class="line">            result = <span class="built_in">int</span>.from_bytes(digest, byteorder=<span class="string">&quot;big&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> _:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f&quot;不支持的输出类型: <span class="subst">&#123;output_type&#125;</span>（支持：bytes/hex/int）&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result, actual_length</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">                m = <span class="string">&#x27;TASC&#x27;</span>+<span class="built_in">chr</span>(i)+<span class="string">&#x27;O3RJMV&#x27;</span>+<span class="built_in">chr</span>(j)+<span class="string">&#x27;WDJKX&#x27;</span>+<span class="built_in">chr</span>(k)+<span class="string">&#x27;ZM&#x27;</span></span><br><span class="line">                des, _ = hash_data(m, <span class="string">&#x27;md5&#x27;</span>)</span><br><span class="line">                <span class="keyword">if</span> <span class="string">&#x27;e9032&#x27;</span> <span class="keyword">in</span> des <span class="keyword">and</span> <span class="string">&#x27;da&#x27;</span> <span class="keyword">in</span> des <span class="keyword">and</span> <span class="string">&#x27;911513&#x27;</span> <span class="keyword">in</span> des:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&#x27;flag&#123;&#123;<span class="subst">&#123;des.upper()&#125;</span>&#125;&#125;&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">                    <span class="comment"># flag&#123;e9032994dabac08080091151380478a2&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h1 id="6-应用密码学"><a href="#6-应用密码学" class="headerlink" title="6. 应用密码学"></a>6. 应用密码学</h1><br>

<h1 id="7-自定义构造题"><a href="#7-自定义构造题" class="headerlink" title="7. 自定义构造题"></a>7. 自定义构造题</h1><h2 id="7-1-Alice与Bob"><a href="#7-1-Alice与Bob" class="headerlink" title="7.1 Alice与Bob"></a>7.1 Alice与Bob</h2><h3 id="7-1-1-题目"><a href="#7-1-1-题目" class="headerlink" title="7.1.1 题目"></a>7.1.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">密码学历史中，有两位知名的杰出人物，Alice和Bob。他们的爱情经过置换和轮加密也难以混淆，即使是没有身份认证也可以知根知底。就像在数学王国中的素数一样，孤傲又热情。下面是一个大整数:<span class="number">98554799767</span>,请分解为两个素数，分解后，小的放前面，大的放后面，合成一个新的数字，进行md5的<span class="number">32</span>位小写哈希，提交答案。</span><br></pre></td></tr></table></figure>

<h3 id="7-1-2-解题思路"><a href="#7-1-2-解题思路" class="headerlink" title="7.1.2 解题思路"></a>7.1.2 解题思路</h3><p>按照题目步骤写脚本。</p>
<h3 id="7-1-3-解题脚本"><a href="#7-1-3-解题脚本" class="headerlink" title="7.1.3 解题脚本"></a>7.1.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> gmssl <span class="keyword">import</span> sm3</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Optional</span>, <span class="type">Union</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">queryFactors</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;查询整数n的质因数分解结果&quot;&quot;&quot;</span></span><br><span class="line">    response = requests.get(<span class="string">f&quot;http://factordb.com/api?query=<span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">int</span>(factor) <span class="keyword">for</span> factor, count <span class="keyword">in</span> response.json()[<span class="string">&quot;factors&quot;</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">int</span>(count))]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hash_data</span>(<span class="params">data: <span class="type">Union</span>[<span class="built_in">bytes</span>, <span class="built_in">str</span>], algorithm: <span class="built_in">str</span>, output_type: <span class="built_in">str</span> = <span class="string">&quot;hex&quot;</span>, hash_length: <span class="built_in">int</span> = <span class="literal">None</span>, hex_case: <span class="built_in">str</span> = <span class="string">&quot;lower&quot;</span></span>) -&gt; <span class="built_in">tuple</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    计算数据的哈希值，支持多种算法和输出类型</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 统一转换为字节类型（兼容字符串输入）</span></span><br><span class="line">    data_bytes = data.encode(<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">if</span> <span class="built_in">isinstance</span>(data, <span class="built_in">str</span>) <span class="keyword">else</span> data</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 计算哈希值及长度</span></span><br><span class="line">    <span class="keyword">match</span> algorithm.lower():</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;sha256&quot;</span> | <span class="string">&quot;md5&quot;</span> | <span class="string">&quot;sha1&quot;</span>:</span><br><span class="line">            hasher = hashlib.new(algorithm, data_bytes)</span><br><span class="line">            digest = hasher.digest()</span><br><span class="line">            original_length = hasher.digest_size</span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;sm3&quot;</span>:</span><br><span class="line">            hex_digest = sm3.sm3_hash(<span class="built_in">list</span>(data_bytes))  <span class="comment"># gmssl返回十六进制字符串</span></span><br><span class="line">            digest = <span class="built_in">bytes</span>.fromhex(hex_digest)           <span class="comment"># 转换为字节</span></span><br><span class="line">            original_length = <span class="number">32</span>                             <span class="comment"># SM3固定32字节</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">case</span> _:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f&quot;不支持的算法: <span class="subst">&#123;algorithm&#125;</span>（支持：sha256/md5/sha1/sm3）&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 长度控制</span></span><br><span class="line">    <span class="keyword">if</span> hash_length <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(hash_length, <span class="built_in">int</span>) <span class="keyword">or</span> hash_length &lt;= <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;hash_length必须是正整数&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> hash_length &gt; original_length:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f&quot;长度超出限制（最大<span class="subst">&#123;original_length&#125;</span>字节）&quot;</span>)</span><br><span class="line">        digest = digest[:hash_length]  <span class="comment"># 截断字节串</span></span><br><span class="line">        actual_length = hash_length</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        actual_length = original_length  <span class="comment"># 不截断时使用原始长度</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 转换输出类型</span></span><br><span class="line">    <span class="keyword">match</span> output_type.lower():</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;bytes&quot;</span>:</span><br><span class="line">            result = digest</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;hex&quot;</span>:</span><br><span class="line">            hex_str = digest.<span class="built_in">hex</span>()</span><br><span class="line">            <span class="comment"># 十六进制大小写转换</span></span><br><span class="line">            result = hex_str.upper() <span class="keyword">if</span> hex_case.lower() == <span class="string">&quot;upper&quot;</span> <span class="keyword">else</span> hex_str.lower()</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;int&quot;</span>:</span><br><span class="line">            result = <span class="built_in">int</span>.from_bytes(digest, byteorder=<span class="string">&quot;big&quot;</span>)</span><br><span class="line">        <span class="keyword">case</span> _:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">f&quot;不支持的输出类型: <span class="subst">&#123;output_type&#125;</span>（支持：bytes/hex/int）&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result, actual_length</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    n=<span class="number">98554799767</span></span><br><span class="line">    p = <span class="built_in">sorted</span>(queryFactors(n))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;flag&#123;&#123;<span class="subst">&#123;hash_data(<span class="built_in">str</span>(p[<span class="number">0</span>]) + <span class="built_in">str</span>(p[<span class="number">1</span>]), <span class="string">&#x27;md5&#x27;</span>, hash_length=<span class="number">16</span>)[<span class="number">0</span>]&#125;</span>&#125;&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># flag&#123;d450209323a847c8d01c6be47c81811a&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="7-2-达芬奇密码"><a href="#7-2-达芬奇密码" class="headerlink" title="7.2 达芬奇密码"></a>7.2 达芬奇密码</h2><h3 id="7-2-1-题目"><a href="#7-2-1-题目" class="headerlink" title="7.2.1 题目"></a>7.2.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">达芬奇一直是一个有争议的画家，科学家。。。小明为了研究他，从网上找到了名画蒙娜丽莎，一天深夜，小明突然从蒙娜丽莎背后的天空中看到了一串神秘的数字。顺带告诉小明达芬奇家窗台上有一串数字是关键。小明千里迢迢找到了这串数字，请将这个送分题做出来，亲，包邮哦（答案是一串<span class="number">32</span>位十进制数字） </span><br><span class="line"></span><br><span class="line">达芬奇隐藏在蒙娜丽莎中的数字列:<span class="number">1</span> <span class="number">233</span> <span class="number">3</span> <span class="number">2584</span> <span class="number">1346269</span> <span class="number">144</span> <span class="number">5</span> <span class="number">196418</span> <span class="number">21</span> <span class="number">1597</span> <span class="number">610</span> <span class="number">377</span> <span class="number">10946</span> <span class="number">89</span> <span class="number">514229</span> <span class="number">987</span> <span class="number">8</span> <span class="number">55</span> <span class="number">6765</span> <span class="number">2178309</span> <span class="number">121393</span> <span class="number">317811</span> <span class="number">46368</span> <span class="number">4181</span> <span class="number">1</span> <span class="number">832040</span> <span class="number">2</span> <span class="number">28657</span> <span class="number">75025</span> <span class="number">34</span> <span class="number">13</span> <span class="number">17711</span> </span><br><span class="line">记录在达芬奇窗台口的神秘数字串:<span class="number">36968853882116725547342176952286</span></span><br></pre></td></tr></table></figure>

<h3 id="7-2-2-解题思路"><a href="#7-2-2-解题思路" class="headerlink" title="7.2.2 解题思路"></a>7.2.2 解题思路</h3><p><strong>斐波拉契数列</strong></p>
<p>数字列与数字串长度相同。依次取出数字列中的每个数字，查找其在斐波那契数列中的索引值，然后将密文中对应索引位置的字符移动到该索引指定的新位置，实现还原。</p>
<h3 id="7-2-3-解题脚本"><a href="#7-2-3-解题脚本" class="headerlink" title="7.2.3 解题脚本"></a>7.2.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fibonacci</span>(<span class="params">length: <span class="built_in">int</span></span>) -&gt; <span class="built_in">list</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;生成指定长度的斐波那契数列&quot;&quot;&quot;</span></span><br><span class="line">    sequence = [<span class="number">0</span>, <span class="number">1</span>][:<span class="built_in">max</span>(<span class="number">0</span>, length)]</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, length):</span><br><span class="line">        sequence.append(sequence[-<span class="number">1</span>] + sequence[-<span class="number">2</span>])</span><br><span class="line">    <span class="keyword">return</span> sequence[<span class="number">1</span>:]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    ct = deque(<span class="string">&quot;36968853882116725547342176952286&quot;</span>)</span><br><span class="line">    hint = [<span class="number">1</span>, <span class="number">233</span>, <span class="number">3</span>, <span class="number">2584</span>, <span class="number">1346269</span>, <span class="number">144</span>, <span class="number">5</span>, <span class="number">196418</span>, <span class="number">21</span>, <span class="number">1597</span>, <span class="number">610</span>, <span class="number">377</span>, <span class="number">10946</span>, <span class="number">89</span>, <span class="number">514229</span>, <span class="number">987</span>, <span class="number">8</span>, <span class="number">55</span>, <span class="number">6765</span>, <span class="number">2178309</span>, <span class="number">121393</span>, <span class="number">317811</span>, <span class="number">46368</span>, <span class="number">4181</span>, <span class="number">1</span>, <span class="number">832040</span>, <span class="number">2</span>, <span class="number">28657</span>, <span class="number">75025</span>, <span class="number">34</span>, <span class="number">13</span>, <span class="number">17711</span>]</span><br><span class="line">    fb = fibonacci(<span class="number">50</span>)</span><br><span class="line">    flag = [<span class="string">&quot;*&quot;</span>] * <span class="built_in">len</span>(ct)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> hint:</span><br><span class="line">        flag[fb.index(i)] = ct.popleft()</span><br><span class="line">        fb[fb.index(i)] = <span class="string">&#x27;*&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;flag&#123;&#123;<span class="subst">&#123;<span class="string">&#x27;&#x27;</span>.join(flag)&#125;</span>&#125;&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># flag&#123;37995588256861228614165223347687&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="7-3-BJDCTF2020-easyrsa"><a href="#7-3-BJDCTF2020-easyrsa" class="headerlink" title="7.3 [BJDCTF2020]easyrsa"></a>7.3 [BJDCTF2020]easyrsa</h2><h3 id="7-3-1-题目"><a href="#7-3-1-题目" class="headerlink" title="7.3.1 题目"></a>7.3.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime,bytes_to_long</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> Derivative</span><br><span class="line"><span class="keyword">from</span> fractions <span class="keyword">import</span> Fraction</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p=getPrime(<span class="number">1024</span>)</span><br><span class="line">q=getPrime(<span class="number">1024</span>)</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">n=p*q</span><br><span class="line">z=Fraction(<span class="number">1</span>,Derivative(arctan(p),p))-Fraction(<span class="number">1</span>,Derivative(arth(q),q))</span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(c,z,n)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">output:</span></span><br><span class="line"><span class="string">7922547866857761459807491502654216283012776177789511549350672958101810281348402284098310147796549430689253803510994877420135537268549410652654479620858691324110367182025648788407041599943091386227543182157746202947099572389676084392706406084307657000104665696654409155006313203957292885743791715198781974205578654792123191584957665293208390453748369182333152809882312453359706147808198922916762773721726681588977103877454119043744889164529383188077499194932909643918696646876907327364751380953182517883134591810800848971719184808713694342985458103006676013451912221080252735948993692674899399826084848622145815461035</span></span><br><span class="line"><span class="string">32115748677623209667471622872185275070257924766015020072805267359839059393284316595882933372289732127274076434587519333300142473010344694803885168557548801202495933226215437763329280242113556524498457559562872900811602056944423967403777623306961880757613246328729616643032628964072931272085866928045973799374711846825157781056965164178505232524245809179235607571567174228822561697888645968559343608375331988097157145264357626738141646556353500994924115875748198318036296898604097000938272195903056733565880150540275369239637793975923329598716003350308259321436752579291000355560431542229699759955141152914708362494482</span></span><br><span class="line"><span class="string">15310745161336895413406690009324766200789179248896951942047235448901612351128459309145825547569298479821101249094161867207686537607047447968708758990950136380924747359052570549594098569970632854351825950729752563502284849263730127586382522703959893392329333760927637353052250274195821469023401443841395096410231843592101426591882573405934188675124326997277775238287928403743324297705151732524641213516306585297722190780088180705070359469719869343939106529204798285957516860774384001892777525916167743272419958572055332232056095979448155082465977781482598371994798871917514767508394730447974770329967681767625495394441</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="7-3-2-解题思路"><a href="#7-3-2-解题思路" class="headerlink" title="7.3.2 解题思路"></a>7.3.2 解题思路</h3><p><strong>三角函数</strong></p>
<p>化简：$ \frac{1}{\frac{d}{dp} \arctan(p)} - \frac{1}{\frac{d}{dq} \operatorname{arth}(q)} $</p>
<p>对于 $\arctan(p)$，求导函数得：$\frac{d}{dp} \arctan(p)&#x3D;\frac{1}{1+p^2}$；对于 $\operatorname{arth}(q)$（即 $\tanh^{-1}(q)$），求导函数得：$ \frac{d}{dp} \operatorname{arth}(q)&#x3D;\frac{1}{1-q^2} $。可得：$ z&#x3D;p^2+q^2 $。</p>
<p>已知 $p^2+q^2$ 和 $p \cdot q$ 可求 $ p 、 q $。</p>
<h3 id="7-3-3-解题脚本"><a href="#7-3-3-解题脚本" class="headerlink" title="7.3.3 解题脚本"></a>7.3.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse, long_to_bytes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">p_q_e_c</span>(<span class="params">p, q, e, c</span>):</span><br><span class="line">    N = p*q</span><br><span class="line">    d = inverse(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">    m = <span class="built_in">pow</span>(c, d, N)</span><br><span class="line">    <span class="keyword">return</span> long_to_bytes(m)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line">    c = <span class="number">7922547866857761459807491502654216283012776177789511549350672958101810281348402284098310147796549430689253803510994877420135537268549410652654479620858691324110367182025648788407041599943091386227543182157746202947099572389676084392706406084307657000104665696654409155006313203957292885743791715198781974205578654792123191584957665293208390453748369182333152809882312453359706147808198922916762773721726681588977103877454119043744889164529383188077499194932909643918696646876907327364751380953182517883134591810800848971719184808713694342985458103006676013451912221080252735948993692674899399826084848622145815461035</span></span><br><span class="line">    z = <span class="number">32115748677623209667471622872185275070257924766015020072805267359839059393284316595882933372289732127274076434587519333300142473010344694803885168557548801202495933226215437763329280242113556524498457559562872900811602056944423967403777623306961880757613246328729616643032628964072931272085866928045973799374711846825157781056965164178505232524245809179235607571567174228822561697888645968559343608375331988097157145264357626738141646556353500994924115875748198318036296898604097000938272195903056733565880150540275369239637793975923329598716003350308259321436752579291000355560431542229699759955141152914708362494482</span></span><br><span class="line">    n = <span class="number">15310745161336895413406690009324766200789179248896951942047235448901612351128459309145825547569298479821101249094161867207686537607047447968708758990950136380924747359052570549594098569970632854351825950729752563502284849263730127586382522703959893392329333760927637353052250274195821469023401443841395096410231843592101426591882573405934188675124326997277775238287928403743324297705151732524641213516306585297722190780088180705070359469719869343939106529204798285957516860774384001892777525916167743272419958572055332232056095979448155082465977781482598371994798871917514767508394730447974770329967681767625495394441</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 计算 p+q</span></span><br><span class="line">    s = math.isqrt(z + <span class="number">2</span> * n)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 解二次方程 x² - sx + m = 0</span></span><br><span class="line">    discriminant = s * s - <span class="number">4</span> * n</span><br><span class="line">    sqrt_d = math.isqrt(discriminant)</span><br><span class="line">    p = (s + sqrt_d) // <span class="number">2</span></span><br><span class="line">    q = (s - sqrt_d) // <span class="number">2</span></span><br><span class="line">    <span class="built_in">print</span>(p_q_e_c(p, q, e, c))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># b&#x27;BJD&#123;Advanced_mathematics_is_too_hard!!!&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="7-4-网鼎杯-2020-青龙组-boom"><a href="#7-4-网鼎杯-2020-青龙组-boom" class="headerlink" title="7.4 [网鼎杯 2020 青龙组]boom"></a>7.4 [网鼎杯 2020 青龙组]boom</h2><h3 id="7-4-1-题目"><a href="#7-4-1-题目" class="headerlink" title="7.4.1 题目"></a>7.4.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> __cdecl main(<span class="built_in">int</span> argc, const char **argv, const char **envp)</span><br><span class="line">&#123;</span><br><span class="line">  size_t v3; // eax</span><br><span class="line">  char Str[<span class="number">50</span>]; // [esp+24h] [ebp-128h] BYREF</span><br><span class="line">  unsigned __int8 v6[<span class="number">50</span>]; // [esp+56h] [ebp-F6h] BYREF</span><br><span class="line">  _DWORD v7[<span class="number">16</span>]; // [esp+88h] [ebp-C4h]</span><br><span class="line">  unsigned <span class="built_in">int</span> v8[<span class="number">22</span>]; // [esp+C8h] [ebp-84h] BYREF</span><br><span class="line">  __int64 v9; // [esp+120h] [ebp-2Ch] BYREF</span><br><span class="line">  <span class="built_in">int</span> v10; // [esp+12Ch] [ebp-20h] BYREF</span><br><span class="line">  <span class="built_in">int</span> v11; // [esp+130h] [ebp-1Ch] BYREF</span><br><span class="line">  <span class="built_in">int</span> v12; // [esp+134h] [ebp-18h] BYREF</span><br><span class="line">  <span class="built_in">int</span> v13; // [esp+138h] [ebp-14h]</span><br><span class="line">  <span class="built_in">int</span> i; // [esp+13Ch] [ebp-10h]</span><br><span class="line"></span><br><span class="line">  __main();</span><br><span class="line">  menu();</span><br><span class="line">  system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">  system(<span class="string">&quot;cls&quot;</span>);</span><br><span class="line">  v7[<span class="number">0</span>] = <span class="number">70</span>;</span><br><span class="line">  v7[<span class="number">1</span>] = <span class="number">229</span>;</span><br><span class="line">  v7[<span class="number">2</span>] = <span class="number">239</span>;</span><br><span class="line">  v7[<span class="number">3</span>] = <span class="number">230</span>;</span><br><span class="line">  v7[<span class="number">4</span>] = <span class="number">22</span>;</span><br><span class="line">  v7[<span class="number">5</span>] = <span class="number">90</span>;</span><br><span class="line">  v7[<span class="number">6</span>] = <span class="number">90</span>;</span><br><span class="line">  v7[<span class="number">7</span>] = <span class="number">251</span>;</span><br><span class="line">  v7[<span class="number">8</span>] = <span class="number">54</span>;</span><br><span class="line">  v7[<span class="number">9</span>] = <span class="number">18</span>;</span><br><span class="line">  v7[<span class="number">10</span>] = <span class="number">23</span>;</span><br><span class="line">  v7[<span class="number">11</span>] = <span class="number">68</span>;</span><br><span class="line">  v7[<span class="number">12</span>] = <span class="number">106</span>;</span><br><span class="line">  v7[<span class="number">13</span>] = <span class="number">45</span>;</span><br><span class="line">  v7[<span class="number">14</span>] = <span class="number">189</span>;</span><br><span class="line">  v7[<span class="number">15</span>] = <span class="number">1</span>;</span><br><span class="line">  puts(<span class="string">&quot;first:this string md5:46e5efe6165a5afb361217446a2dbd01&quot;</span>);</span><br><span class="line">  scanf(<span class="string">&quot;%s&quot;</span>, Str);</span><br><span class="line">  MD5Init(v8);</span><br><span class="line">  v3 = strlen(Str);</span><br><span class="line">  MD5Update((<span class="built_in">int</span>)v8, Str, v3);</span><br><span class="line">  MD5Final(v8, v6);</span><br><span class="line">  v13 = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">15</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v6[i] != v7[i] )</span><br><span class="line">    &#123;</span><br><span class="line">      v13 = <span class="number">0</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v13 != <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    printf(<span class="string">&quot;Game over&quot;</span>);</span><br><span class="line">    system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">    exit(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  puts(<span class="string">&quot;Great next level&quot;</span>);</span><br><span class="line">  system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">  system(<span class="string">&quot;cls&quot;</span>);</span><br><span class="line">  puts(<span class="string">&quot;This time:Here are have some formulas&quot;</span>);</span><br><span class="line">  puts(<span class="string">&quot;3x-y+z=185&quot;</span>);</span><br><span class="line">  puts(<span class="string">&quot;2x+3y-z=321&quot;</span>);</span><br><span class="line">  puts(<span class="string">&quot;x+y+z=173&quot;</span>);</span><br><span class="line">  printf(<span class="string">&quot;input: x = &quot;</span>);</span><br><span class="line">  scanf(<span class="string">&quot;%d&quot;</span>, &amp;v12);</span><br><span class="line">  printf(<span class="string">&quot;input: y = &quot;</span>);</span><br><span class="line">  scanf(<span class="string">&quot;%d&quot;</span>, &amp;v11);</span><br><span class="line">  printf(<span class="string">&quot;input : z = &quot;</span>);</span><br><span class="line">  scanf(<span class="string">&quot;%d&quot;</span>, &amp;v10);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">3</span> * v12 - v11 + v10 != <span class="number">185</span> || <span class="number">2</span> * v12 + <span class="number">3</span> * v11 - v10 != <span class="number">321</span> || v11 + v12 + v10 != <span class="number">173</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    printf(<span class="string">&quot;Game over&quot;</span>);</span><br><span class="line">    exit(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  printf(<span class="string">&quot;Great last level coming...&quot;</span>);</span><br><span class="line">  printf(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">  system(<span class="string">&quot;cls&quot;</span>);</span><br><span class="line">  puts(<span class="string">&quot;Last time: Kill it&quot;</span>);</span><br><span class="line">  puts(<span class="string">&quot;x*x+x-7943722218936282=0&quot;</span>);</span><br><span class="line">  printf(<span class="string">&quot;input x: &quot;</span>);</span><br><span class="line">  scanf(<span class="string">&quot;%lld&quot;</span>, &amp;v9);</span><br><span class="line">  <span class="keyword">if</span> ( v9 * (v9 + <span class="number">1</span>) != 0x1C38C5F50DD7DALL )</span><br><span class="line">  &#123;</span><br><span class="line">    printf(<span class="string">&quot;Game over&quot;</span>);</span><br><span class="line">    exit(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  puts(<span class="string">&quot;Great This is your FLAG&quot;</span>);</span><br><span class="line">  printf(<span class="string">&quot;flag&#123;%s_%d%d%d_%lld&#125;&quot;</span>, Str, v12, v11, v10, v9);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="7-4-2-解题思路"><a href="#7-4-2-解题思路" class="headerlink" title="7.4.2 解题思路"></a>7.4.2 解题思路</h3><p>使用 IDA 反汇编 boom.exe，分析代码，flag 由三部分组成。</p>
<p>MD5 爆破 + 解三元一次方程组 + 解一元二次方程</p>
<h3 id="7-4-3-解题脚本"><a href="#7-4-3-解题脚本" class="headerlink" title="7.4.3 解题脚本"></a>7.4.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># https://www.cmd5.com/default.aspx</span></span><br><span class="line"><span class="comment"># 46e5efe6165a5afb361217446a2dbd01 -&gt; en5oy</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> symbols, solve, Eq</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment"># 定义未知数</span></span><br><span class="line">    x, y, z = symbols(<span class="string">&#x27;x y z&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 定义方程组</span></span><br><span class="line">    equations = [</span><br><span class="line">        Eq(x + y + z, <span class="number">173</span>),</span><br><span class="line">        Eq(<span class="number">2</span>*x + <span class="number">3</span>*y - z, <span class="number">321</span>),</span><br><span class="line">        Eq(<span class="number">3</span>*x - y + z, <span class="number">185</span>)</span><br><span class="line">    ]</span><br><span class="line">    sol1 = solve(equations, (x, y, z), <span class="built_in">dict</span>=<span class="literal">True</span>)</span><br><span class="line">    <span class="built_in">print</span>(sol1)</span><br><span class="line"></span><br><span class="line">    a = symbols(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 定义方程：x² + x - 7943722218936282 = 0</span></span><br><span class="line">    equation = Eq(a**<span class="number">2</span> + a - <span class="number">7943722218936282</span>, <span class="number">0</span>)</span><br><span class="line">    sol2 = solve(equation, a)</span><br><span class="line">    <span class="built_in">print</span>(sol2)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;flag&#123;&#x27;</span> + <span class="string">f&#x27;en5oy_<span class="subst">&#123;sol1[<span class="number">0</span>][x]&#125;</span><span class="subst">&#123;sol1[<span class="number">0</span>][y]&#125;</span><span class="subst">&#123;sol1[<span class="number">0</span>][z]&#125;</span>_<span class="subst">&#123;sol2[<span class="number">1</span>]&#125;</span>&#x27;</span> + <span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># flag&#123;en5oy_746831_89127561&#125;</span></span><br></pre></td></tr></table></figure>



<h2 id="7-5-RoarCTF2019-babyRSA"><a href="#7-5-RoarCTF2019-babyRSA" class="headerlink" title="7.5 [RoarCTF2019]babyRSA"></a>7.5 [RoarCTF2019]babyRSA</h2><h3 id="7-5-1-题目"><a href="#7-5-1-题目" class="headerlink" title="7.5.1 题目"></a>7.5.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">myGetPrime</span>():</span><br><span class="line">    A= getPrime(<span class="number">513</span>)</span><br><span class="line">    <span class="built_in">print</span>(A)</span><br><span class="line">    B=A-random.randint(<span class="number">1e3</span>,<span class="number">1e5</span>)</span><br><span class="line">    <span class="built_in">print</span>(B)</span><br><span class="line">    <span class="keyword">return</span> sympy.nextPrime((B!)%A)</span><br><span class="line">p=myGetPrime()</span><br><span class="line"><span class="comment">#A1=21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467234407</span></span><br><span class="line"><span class="comment">#B1=21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467140596</span></span><br><span class="line"></span><br><span class="line">q=myGetPrime()</span><br><span class="line"><span class="comment">#A2=16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858418927</span></span><br><span class="line"><span class="comment">#B2=16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858351026</span></span><br><span class="line"></span><br><span class="line">r=myGetPrime()</span><br><span class="line"></span><br><span class="line">n=p*q*r</span><br><span class="line"><span class="comment">#n=85492663786275292159831603391083876175149354309327673008716627650718160585639723100793347534649628330416631255660901307533909900431413447524262332232659153047067908693481947121069070451562822417357656432171870951184673132554213690123308042697361969986360375060954702920656364144154145812838558365334172935931441424096270206140691814662318562696925767991937369782627908408239087358033165410020690152067715711112732252038588432896758405898709010342467882264362733</span></span><br><span class="line">c=<span class="built_in">pow</span>(flag,e,n)</span><br><span class="line"><span class="comment">#e=0x1001</span></span><br><span class="line"><span class="comment">#c=75700883021669577739329316795450706204502635802310731477156998834710820770245219468703245302009998932067080383977560299708060476222089630209972629755965140317526034680452483360917378812244365884527186056341888615564335560765053550155758362271622330017433403027261127561225585912484777829588501213961110690451987625502701331485141639684356427316905122995759825241133872734362716041819819948645662803292418802204430874521342108413623635150475963121220095236776428</span></span><br><span class="line"><span class="comment">#so,what is the flag?</span></span><br></pre></td></tr></table></figure>

<h3 id="7-5-2-解题思路"><a href="#7-5-2-解题思路" class="headerlink" title="7.5.2 解题思路"></a>7.5.2 解题思路</h3><p><strong>威尔逊定理：</strong>$ (A-1)! \equiv -1 \pmod A $</p>
<p>分析代码：$p &#x3D; (B_1!) % A_1 \quad q &#x3D; (B_2!)%A_2 \quad B_1 \lt A_1 \quad  B_2 \lt A_2$<br>$$<br>\begin{gathered}<br>\because B! \cdot (B+1) \cdot (B+2) \cdot (B+3) \cdots (A-1)\  % \ A&#x3D;−1\ \ %\ A<br>\<br>\therefore B!\ %\ A  &#x3D; [-(B+1) \cdot (B+2) \cdot (B+3) \cdots (A-1)]^{-1} \pmod A<br>\end{gathered}<br>$$<br>求出逆元可得 $ p、q 、r $。</p>
<h3 id="7-5-3-解题脚本"><a href="#7-5-3-解题脚本" class="headerlink" title="7.5.3 解题脚本"></a>7.5.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_OAEP</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse, long_to_bytes</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> totient, nextprime</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> prod</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">product_b_to_a</span>(<span class="params">A, B</span>):</span><br><span class="line">    ans = <span class="number">1</span></span><br><span class="line">    temp = <span class="built_in">pow</span>(-<span class="number">1</span>, <span class="number">1</span>, A)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(B+<span class="number">1</span>, A):</span><br><span class="line">        ans = (ans * inverse(i, A)) % A</span><br><span class="line">    <span class="keyword">return</span> (ans * temp) % A</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">standard_rsa_decryption</span>(<span class="params">e, c, primes=<span class="literal">None</span>, n=<span class="literal">None</span>, phi=<span class="literal">None</span>, ct_format=<span class="string">&#x27;int&#x27;</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    标准 RSA 解密</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> phi:</span><br><span class="line">        <span class="keyword">if</span> n:</span><br><span class="line">            phi = totient(n)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            phi = prod(p - <span class="number">1</span> <span class="keyword">for</span> p <span class="keyword">in</span> primes)</span><br><span class="line">            n = prod(p <span class="keyword">for</span> p <span class="keyword">in</span> primes)</span><br><span class="line"></span><br><span class="line">    d = inverse(e, phi)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ct_format == <span class="string">&#x27;base64&#x27;</span>:</span><br><span class="line">        p, q = primes[<span class="number">0</span>], primes[<span class="number">1</span>]</span><br><span class="line">        key_info = RSA.construct((n, e, d, p, q))</span><br><span class="line">        key = RSA.importKey(key_info.exportKey())</span><br><span class="line">        key = PKCS1_OAEP.new(key)</span><br><span class="line">        m = key.decrypt(b64decode(c)).decode()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    A1 = <span class="number">21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467234407</span></span><br><span class="line">    B1 = <span class="number">21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467140596</span></span><br><span class="line">    A2 = <span class="number">16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858418927</span></span><br><span class="line">    B2 = <span class="number">16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858351026</span></span><br><span class="line">    n = <span class="number">85492663786275292159831603391083876175149354309327673008716627650718160585639723100793347534649628330416631255660901307533909900431413447524262332232659153047067908693481947121069070451562822417357656432171870951184673132554213690123308042697361969986360375060954702920656364144154145812838558365334172935931441424096270206140691814662318562696925767991937369782627908408239087358033165410020690152067715711112732252038588432896758405898709010342467882264362733</span></span><br><span class="line">    e = <span class="number">0x1001</span></span><br><span class="line">    c = <span class="number">75700883021669577739329316795450706204502635802310731477156998834710820770245219468703245302009998932067080383977560299708060476222089630209972629755965140317526034680452483360917378812244365884527186056341888615564335560765053550155758362271622330017433403027261127561225585912484777829588501213961110690451987625502701331485141639684356427316905122995759825241133872734362716041819819948645662803292418802204430874521342108413623635150475963121220095236776428</span></span><br><span class="line"></span><br><span class="line">    p = nextprime(product_b_to_a(A1, B1))</span><br><span class="line">    q = nextprime(product_b_to_a(A2, B2))</span><br><span class="line">    r = n // p // q</span><br><span class="line"></span><br><span class="line">    pt = standard_rsa_decryption(e, c, [p, q, r])</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(pt))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># b&#x27;RoarCTF&#123;wm-CongrAtu1ation4-1t4-ju4t-A-bAby-R4A&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="7-6-WUSTCTF2020-大数计算"><a href="#7-6-WUSTCTF2020-大数计算" class="headerlink" title="7.6 [WUSTCTF2020]大数计算"></a>7.6 [WUSTCTF2020]大数计算</h2><h3 id="7-6-1-题目"><a href="#7-6-1-题目" class="headerlink" title="7.6.1 题目"></a>7.6.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">flag等于 wctf2020&#123;Part1-Part2-Part3-Part4&#125; 每一Part都为数的十六进制形式（不需要0x)，并用 <span class="string">&#x27;-&#x27;</span> 连接</span><br><span class="line">Part1 = <span class="number">2020</span>*<span class="number">2019</span>*<span class="number">2018</span>* ... *<span class="number">3</span>*<span class="number">2</span>*<span class="number">1</span> 的前<span class="number">8</span>位</span><br><span class="line">Part2 = <span class="number">520</span>^<span class="number">1314</span> + <span class="number">2333</span>^<span class="number">666</span> 的前<span class="number">8</span>位</span><br><span class="line">Part3 = 宇宙终极问题的答案 x,y,z绝对值和的前<span class="number">8</span>位</span><br><span class="line">Part4 = 见图片附件，计算结果乘上<span class="number">1314</span></span><br></pre></td></tr></table></figure>

<center><img src=https://dstbp.com/data/imgs/posts/buuctf/WUSTCTF2020大数计算.jpg width="400"></center>

<h3 id="7-6-2-解题思路"><a href="#7-6-2-解题思路" class="headerlink" title="7.6.2 解题思路"></a>7.6.2 解题思路</h3><p>按照要求写脚本。</p>
<h3 id="7-6-3-解题脚本"><a href="#7-6-3-解题脚本" class="headerlink" title="7.6.3 解题脚本"></a>7.6.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> symbols, integrate</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> factorial</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    part1 = <span class="built_in">str</span>(factorial(<span class="number">2020</span>))[:<span class="number">8</span>]</span><br><span class="line">    part2 = <span class="built_in">str</span>(<span class="number">520</span>**<span class="number">1314</span> + <span class="number">2333</span>**<span class="number">666</span>)[:<span class="number">8</span>]</span><br><span class="line">    part3 = <span class="built_in">str</span>(<span class="built_in">sum</span>(<span class="built_in">map</span>(<span class="built_in">abs</span>, [-<span class="number">80538738812075974</span>, <span class="number">80435758145817515</span>, <span class="number">12602123297335631</span>])))[:<span class="number">8</span>]</span><br><span class="line"></span><br><span class="line">    x = symbols(<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">    part4 = <span class="built_in">str</span>((integrate(<span class="number">2</span> * x, (x, <span class="number">0</span>, <span class="number">22</span>)) + <span class="number">36</span>) * <span class="number">1314</span>)</span><br><span class="line"></span><br><span class="line">    flag = <span class="string">f&quot;wctf2020&#123;&#123;<span class="subst">&#123;<span class="built_in">int</span>(part1):x&#125;</span>-<span class="subst">&#123;<span class="built_in">int</span>(part2):x&#125;</span>-<span class="subst">&#123;<span class="built_in">int</span>(part3):x&#125;</span>-<span class="subst">&#123;<span class="built_in">int</span>(part4):x&#125;</span>&#125;&#125;&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># wctf2020&#123;24d231f-403cfd3-108db5e-a6d10&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="7-7-救世捷径"><a href="#7-7-救世捷径" class="headerlink" title="7.7 救世捷径"></a>7.7 救世捷径</h2><h3 id="7-7-1-题目"><a href="#7-7-1-题目" class="headerlink" title="7.7.1 题目"></a>7.7.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">一个名叫CPU的神秘大陆有<span class="number">26</span>个国家，有些国家之间会有一条无向路，每条路径都有不同的长度和一段神秘代码，救世主尼奥要从国家<span class="number">1</span>出发，赶往国家<span class="number">26</span>拯救大陆，请你帮助救世主选择最短路径，而走过的路的神秘代码连接起来便是flag。 以下是数行数据，每行第一个，第二个数字代表这条路的两个端点国家，第三个数字代表路途长度，最后一个字符串便是神秘代码。路在附件中~ 帮助救世主尼奥吧，他快被吓尿了。。。</span><br><span class="line"></span><br><span class="line"><span class="number">1</span> <span class="number">2</span> <span class="number">100</span> FLAG&#123;</span><br><span class="line"><span class="number">2</span> <span class="number">3</span> <span class="number">87</span> AFQWE</span><br><span class="line"><span class="number">2</span> <span class="number">4</span> <span class="number">57</span> ETKLS</span><br><span class="line"><span class="number">2</span> <span class="number">5</span> <span class="number">50</span> WEIVK</span><br><span class="line"><span class="number">2</span> <span class="number">6</span> <span class="number">51</span> AWEIW</span><br><span class="line"><span class="number">3</span> <span class="number">7</span> <span class="number">94</span> QIECJF</span><br><span class="line"><span class="number">3</span> <span class="number">8</span> <span class="number">78</span> QSXKE</span><br><span class="line"><span class="number">3</span> <span class="number">9</span> <span class="number">85</span> QWEIH</span><br><span class="line"><span class="number">4</span> <span class="number">13</span> <span class="number">54</span> WQOJF</span><br><span class="line"><span class="number">4</span> <span class="number">14</span> <span class="number">47</span> KDNVE</span><br><span class="line"><span class="number">4</span> <span class="number">15</span> <span class="number">98</span> QISNV</span><br><span class="line"><span class="number">5</span> <span class="number">10</span> <span class="number">43</span> AEWJV</span><br><span class="line"><span class="number">5</span> <span class="number">11</span> <span class="number">32</span> QWKXF</span><br><span class="line"><span class="number">5</span> <span class="number">12</span> <span class="number">44</span> ASJVL</span><br><span class="line"><span class="number">6</span> <span class="number">16</span> <span class="number">59</span> ASJXJ</span><br><span class="line"><span class="number">6</span> <span class="number">17</span> <span class="number">92</span> QJXNV</span><br><span class="line"><span class="number">6</span> <span class="number">18</span> <span class="number">39</span> SCJJF</span><br><span class="line"><span class="number">6</span> <span class="number">23</span> <span class="number">99</span> SJVHF</span><br><span class="line"><span class="number">7</span> <span class="number">19</span> <span class="number">99</span> WJCNF</span><br><span class="line"><span class="number">8</span> <span class="number">20</span> <span class="number">96</span> SKCNG</span><br><span class="line"><span class="number">9</span> <span class="number">20</span> <span class="number">86</span> SJXHF</span><br><span class="line"><span class="number">10</span> <span class="number">21</span> <span class="number">60</span> SJJCH</span><br><span class="line"><span class="number">11</span> <span class="number">21</span> <span class="number">57</span> SJHGG</span><br><span class="line"><span class="number">12</span> <span class="number">22</span> <span class="number">47</span> SJCHF</span><br><span class="line"><span class="number">14</span> <span class="number">10</span> <span class="number">55</span> EJFHG</span><br><span class="line"><span class="number">16</span> <span class="number">17</span> <span class="number">59</span> ASJVH</span><br><span class="line"><span class="number">18</span> <span class="number">12</span> <span class="number">53</span> SJFHG</span><br><span class="line"><span class="number">18</span> <span class="number">24</span> <span class="number">93</span> SHFVG</span><br><span class="line"><span class="number">21</span> <span class="number">22</span> <span class="number">33</span> SJFHB</span><br><span class="line"><span class="number">19</span> <span class="number">25</span> <span class="number">88</span> ASHHF</span><br><span class="line"><span class="number">20</span> <span class="number">25</span> <span class="number">96</span> SJVHG</span><br><span class="line"><span class="number">22</span> <span class="number">25</span> <span class="number">23</span> SJVHJ</span><br><span class="line"><span class="number">25</span> <span class="number">26</span> <span class="number">75</span> SDEV&#125;</span><br></pre></td></tr></table></figure>

<h3 id="7-7-2-解题思路"><a href="#7-7-2-解题思路" class="headerlink" title="7.7.2 解题思路"></a>7.7.2 解题思路</h3><p>最短路径问题：Dijkstra 算法</p>
<h3 id="7-7-3-解题脚本"><a href="#7-7-3-解题脚本" class="headerlink" title="7.7.3 解题脚本"></a>7.7.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> heapq</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dijkstra</span>(<span class="params">graph, start, end</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Dijkstra 算法，计算加权无向图中从起点到终点的最短路径</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 初始化距离字典，存储从起点到各节点的最短距离</span></span><br><span class="line">    distances = &#123;node: <span class="built_in">float</span>(<span class="string">&#x27;inf&#x27;</span>) <span class="keyword">for</span> node <span class="keyword">in</span> graph&#125;</span><br><span class="line">    distances[start] = <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 初始化前驱节点字典，用于回溯最短路径</span></span><br><span class="line">    predecessors = &#123;node: <span class="literal">None</span> <span class="keyword">for</span> node <span class="keyword">in</span> graph&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 初始化优先队列（最小堆）</span></span><br><span class="line">    priority_queue = [(<span class="number">0</span>, start)]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> priority_queue:</span><br><span class="line">        current_distance, current_node = heapq.heappop(priority_queue)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 如果到达终点，结束算法</span></span><br><span class="line">        <span class="keyword">if</span> current_node == end:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 如果当前距离大于已记录的最短距离，跳过</span></span><br><span class="line">        <span class="keyword">if</span> current_distance &gt; distances[current_node]:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 遍历当前节点的所有邻居</span></span><br><span class="line">        <span class="keyword">for</span> neighbor, weight, flag <span class="keyword">in</span> graph[current_node]:</span><br><span class="line">            distance = current_distance + weight</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 如果找到更短的路径，更新距离和前驱节点</span></span><br><span class="line">            <span class="keyword">if</span> distance &lt; distances[neighbor]:</span><br><span class="line">                distances[neighbor] = distance</span><br><span class="line">                predecessors[neighbor] = (current_node, flag)</span><br><span class="line">                heapq.heappush(priority_queue, (distance, neighbor))</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 回溯构建最短路径和标记序列</span></span><br><span class="line">    path = []</span><br><span class="line">    flags = []</span><br><span class="line">    current = end</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> current <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        path.append(current)</span><br><span class="line">        <span class="keyword">if</span> predecessors[current] <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            flags.append(predecessors[current][<span class="number">1</span>])</span><br><span class="line">        current = predecessors[current][<span class="number">0</span>] <span class="keyword">if</span> predecessors[current] <span class="keyword">else</span> <span class="literal">None</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 反转路径和标记序列，使其按从起点到终点的顺序排列</span></span><br><span class="line">    path.reverse()</span><br><span class="line">    flags.reverse()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> distances[end], path, flags</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    edges = [</span><br><span class="line">        [<span class="number">1</span>, <span class="number">2</span>, <span class="number">100</span>, <span class="string">&#x27;FLAG&#123;&#x27;</span>],</span><br><span class="line">        [<span class="number">2</span>, <span class="number">3</span>, <span class="number">87</span>, <span class="string">&quot;AFQWE&quot;</span>],</span><br><span class="line">        [<span class="number">2</span>, <span class="number">4</span>, <span class="number">57</span>, <span class="string">&quot;ETKLS&quot;</span>],</span><br><span class="line">        [<span class="number">2</span>, <span class="number">5</span>, <span class="number">50</span>, <span class="string">&quot;WEIVK&quot;</span>],</span><br><span class="line">        [<span class="number">2</span>, <span class="number">6</span>, <span class="number">51</span>, <span class="string">&quot;AWEIW&quot;</span>],</span><br><span class="line">        [<span class="number">3</span>, <span class="number">7</span>, <span class="number">94</span>, <span class="string">&quot;QIECJF&quot;</span>],</span><br><span class="line">        [<span class="number">3</span>, <span class="number">8</span>, <span class="number">78</span>, <span class="string">&quot;QSXKE&quot;</span>],</span><br><span class="line">        [<span class="number">3</span>, <span class="number">9</span>, <span class="number">85</span>, <span class="string">&quot;QWEIH&quot;</span>],</span><br><span class="line">        [<span class="number">4</span>, <span class="number">13</span>, <span class="number">54</span>, <span class="string">&quot;WQOJF&quot;</span>],</span><br><span class="line">        [<span class="number">4</span>, <span class="number">14</span>, <span class="number">47</span>, <span class="string">&quot;KDNVE&quot;</span>],</span><br><span class="line">        [<span class="number">4</span>, <span class="number">15</span>, <span class="number">98</span>, <span class="string">&quot;QISNV&quot;</span>],</span><br><span class="line">        [<span class="number">5</span>, <span class="number">10</span>, <span class="number">43</span>, <span class="string">&quot;AEWJV&quot;</span>],</span><br><span class="line">        [<span class="number">5</span>, <span class="number">11</span>, <span class="number">32</span>, <span class="string">&quot;QWKXF&quot;</span>],</span><br><span class="line">        [<span class="number">5</span>, <span class="number">12</span>, <span class="number">44</span>, <span class="string">&quot;ASJVL&quot;</span>],</span><br><span class="line">        [<span class="number">6</span>, <span class="number">16</span>, <span class="number">59</span>, <span class="string">&quot;ASJXJ&quot;</span>],</span><br><span class="line">        [<span class="number">6</span>, <span class="number">17</span>, <span class="number">92</span>, <span class="string">&quot;QJXNV&quot;</span>],</span><br><span class="line">        [<span class="number">6</span>, <span class="number">18</span>, <span class="number">39</span>, <span class="string">&quot;SCJJF&quot;</span>],</span><br><span class="line">        [<span class="number">6</span>, <span class="number">23</span>, <span class="number">99</span>, <span class="string">&quot;SJVHF&quot;</span>],</span><br><span class="line">        [<span class="number">7</span>, <span class="number">19</span>, <span class="number">99</span>, <span class="string">&quot;WJCNF&quot;</span>],</span><br><span class="line">        [<span class="number">8</span>, <span class="number">20</span>, <span class="number">96</span>, <span class="string">&quot;SKCNG&quot;</span>],</span><br><span class="line">        [<span class="number">9</span>, <span class="number">20</span>, <span class="number">86</span>, <span class="string">&quot;SJXHF&quot;</span>],</span><br><span class="line">        [<span class="number">10</span>, <span class="number">21</span>, <span class="number">60</span>, <span class="string">&quot;SJJCH&quot;</span>],</span><br><span class="line">        [<span class="number">11</span>, <span class="number">21</span>, <span class="number">57</span>, <span class="string">&quot;SJHGG&quot;</span>],</span><br><span class="line">        [<span class="number">12</span>, <span class="number">22</span>, <span class="number">47</span>, <span class="string">&quot;SJCHF&quot;</span>],</span><br><span class="line">        [<span class="number">14</span>, <span class="number">10</span>, <span class="number">55</span>, <span class="string">&quot;EJFHG&quot;</span>],</span><br><span class="line">        [<span class="number">16</span>, <span class="number">17</span>, <span class="number">59</span>, <span class="string">&quot;ASJVH&quot;</span>],</span><br><span class="line">        [<span class="number">18</span>, <span class="number">12</span>, <span class="number">53</span>, <span class="string">&quot;SJFHG&quot;</span>],</span><br><span class="line">        [<span class="number">18</span>, <span class="number">24</span>, <span class="number">93</span>, <span class="string">&quot;SHFVG&quot;</span>],</span><br><span class="line">        [<span class="number">21</span>, <span class="number">22</span>, <span class="number">33</span>, <span class="string">&quot;SJFHB&quot;</span>],</span><br><span class="line">        [<span class="number">19</span>, <span class="number">25</span>, <span class="number">88</span>, <span class="string">&quot;ASHHF&quot;</span>],</span><br><span class="line">        [<span class="number">20</span>, <span class="number">25</span>, <span class="number">96</span>, <span class="string">&quot;SJVHG&quot;</span>],</span><br><span class="line">        [<span class="number">22</span>, <span class="number">25</span>, <span class="number">23</span>, <span class="string">&quot;SJVHJ&quot;</span>],</span><br><span class="line">        [<span class="number">25</span>, <span class="number">26</span>, <span class="number">75</span>, <span class="string">&quot;SDEV&#125;&quot;</span>]</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 构建图的邻接表表示</span></span><br><span class="line">    graph = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> u, v, w, flag <span class="keyword">in</span> edges:</span><br><span class="line">        <span class="keyword">if</span> u <span class="keyword">not</span> <span class="keyword">in</span> graph:</span><br><span class="line">            graph[u] = []</span><br><span class="line">        <span class="keyword">if</span> v <span class="keyword">not</span> <span class="keyword">in</span> graph:</span><br><span class="line">            graph[v] = []</span><br><span class="line">        graph[u].append((v, w, flag))</span><br><span class="line">        graph[v].append((u, w, flag))  <span class="comment"># 无向图需要双向添加边</span></span><br><span class="line"></span><br><span class="line">    total_weight, path, flags = dijkstra(graph, <span class="number">1</span>, <span class="number">26</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(flags))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># FLAG&#123;WEIVKASJVLSJCHFSJVHJSDEV&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h1 id="8-信息隐藏与隐写术"><a href="#8-信息隐藏与隐写术" class="headerlink" title="8. 信息隐藏与隐写术"></a>8. 信息隐藏与隐写术</h1><h2 id="8-1-password"><a href="#8-1-password" class="headerlink" title="8.1 password"></a>8.1 password</h2><h3 id="8-1-1-题目"><a href="#8-1-1-题目" class="headerlink" title="8.1.1 题目"></a>8.1.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">姓名：张三 </span><br><span class="line">生日：<span class="number">19900315</span></span><br><span class="line"></span><br><span class="line">key格式为key&#123;xxxxxxxxxx&#125;</span><br></pre></td></tr></table></figure>

<h3 id="8-1-2-解题思路"><a href="#8-1-2-解题思路" class="headerlink" title="8.1.2 解题思路"></a>8.1.2 解题思路</h3><p>key{} 中有 10 个数，猜测可能是“姓名缩写+生日”</p>
<h3 id="8-1-3-解题脚本"><a href="#8-1-3-解题脚本" class="headerlink" title="8.1.3 解题脚本"></a>8.1.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;zs19900315&#125;</span><br></pre></td></tr></table></figure>

<br>

<h2 id="8-2-NPUCTF2020-这是什么觅🐎"><a href="#8-2-NPUCTF2020-这是什么觅🐎" class="headerlink" title="8.2 [NPUCTF2020]这是什么觅🐎"></a>8.2 [NPUCTF2020]这是什么觅🐎</h2><h3 id="8-2-1-题目"><a href="#8-2-1-题目" class="headerlink" title="8.2.1 题目"></a>8.2.1 题目</h3><center><img src=https://dstbp.com/data/imgs/posts/buuctf/NPUCTF2020这是什么觅马.jpg width="600"></center>

<h3 id="8-2-2-解题思路"><a href="#8-2-2-解题思路" class="headerlink" title="8.2.2 解题思路"></a>8.2.2 解题思路</h3><p>文件改为压缩包格式解压，<code>F1 W1 S22 S21 T12 S11 W1 S13</code> 字母部分对应星期的英文首字母，<code>T1</code> 对应星期二、<code>S1</code> 对应星期六、<code>S2</code> 对应星期日；最后一个数字表示该星期下方的第几个具体日期。最终提取出一组数字 <code>3, 1, 12, 5, 14, 4, 1, 18</code>，对应英文字母表序号还原出 flag。</p>
<h3 id="8-2-3-解题脚本"><a href="#8-2-3-解题脚本" class="headerlink" title="8.2.3 解题脚本"></a>8.2.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    numbers = [<span class="number">3</span>, <span class="number">1</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">14</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">18</span>]</span><br><span class="line">    letters = [<span class="built_in">chr</span>(n + <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) - <span class="number">1</span>) <span class="keyword">for</span> n <span class="keyword">in</span> numbers]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;flag&#123;&#123;<span class="subst">&#123;<span class="string">&#x27;&#x27;</span>.join(letters)&#125;</span>&#125;&#125;&quot;</span>)</span><br></pre></td></tr></table></figure>

<br>

<h2 id="8-3-ACTF新生赛2020-crypto-classic0"><a href="#8-3-ACTF新生赛2020-crypto-classic0" class="headerlink" title="8.3 [ACTF新生赛2020]crypto-classic0"></a>8.3 [ACTF新生赛2020]crypto-classic0</h2><h3 id="8-3-1-题目"><a href="#8-3-1-题目" class="headerlink" title="8.3.1 题目"></a>8.3.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># hint.txt</span></span><br><span class="line">哼，压缩包的密码？这是小Z童鞋的生日吧==</span><br><span class="line"></span><br><span class="line"><span class="comment"># cipher</span></span><br><span class="line">Ygvdmq[lYate[elghqvakl&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># howtoencrypt.zip</span></span><br><span class="line"><span class="number">50</span> 4b 03 04 <span class="number">14</span> <span class="number">00</span> 01 <span class="number">00</span> 08 <span class="number">00</span> 4b 8f 2c <span class="number">50</span> 6c f5 eb d9 <span class="number">97</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> ad <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">17</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">68</span> 6f <span class="number">77</span> <span class="number">74</span> 6f <span class="number">65</span> 6e <span class="number">63</span> <span class="number">72</span> <span class="number">79</span> <span class="number">70</span> <span class="number">74</span> 2f <span class="number">63</span> 6c <span class="number">61</span> <span class="number">73</span> <span class="number">73</span> <span class="number">69</span> <span class="number">63</span> <span class="number">30</span> 2e <span class="number">63</span> 3e ae 1a 0f <span class="number">42</span> 9f <span class="number">37</span> a1 bb <span class="number">98</span> <span class="number">91</span> 2b d4 <span class="number">50</span> 3b b4 1d 5f d9 0d <span class="number">12</span> b3 4c 9d 1f ac <span class="number">17</span> <span class="number">67</span> 0d ef 6b <span class="number">44</span> a9 dc df 1d e8 <span class="number">24</span> a4 <span class="number">11</span> 9b e0 ff dd <span class="number">78</span> b3 e9 05 2a <span class="number">18</span> <span class="number">22</span> 6f fc 8e 8c b9 cd b4 dd f5 <span class="number">37</span> c6 <span class="number">29</span> <span class="number">96</span> <span class="number">24</span> <span class="number">96</span> <span class="number">34</span> 4a ef <span class="number">35</span> ef 4f <span class="number">24</span> 5b <span class="number">72</span> 4c 0e <span class="number">97</span> <span class="number">51</span> d6 <span class="number">43</span> 3c <span class="number">97</span> f3 <span class="number">41</span> 7c <span class="number">67</span> be 1f <span class="number">53</span> <span class="number">70</span> ff 8b 0e e6 <span class="number">27</span> b4 f8 af <span class="number">85</span> 5a <span class="number">23</span> <span class="number">12</span> a3 <span class="number">93</span> <span class="number">45</span> a3 08 f9 <span class="number">55</span> 1f <span class="number">15</span> <span class="number">75</span> 7b <span class="number">27</span> 1d 1e fa a2 <span class="number">40</span> <span class="number">16</span> 3f 6b <span class="number">60</span> ff <span class="number">14</span> <span class="number">87</span> <span class="number">54</span> 1a eb 3a <span class="number">99</span> 2b <span class="number">00</span> a1 <span class="number">00</span> 2c e8 <span class="number">83</span> 09 <span class="number">68</span> <span class="number">66</span> <span class="number">77</span> 7c <span class="number">34</span> <span class="number">20</span> <span class="number">83</span> 08 ea <span class="number">78</span> <span class="number">61</span> <span class="number">50</span> 4b 03 04 <span class="number">14</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> 3d <span class="number">90</span> 2c <span class="number">50</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> 0d <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">68</span> 6f <span class="number">77</span> <span class="number">74</span> 6f <span class="number">65</span> 6e <span class="number">63</span> <span class="number">72</span> <span class="number">79</span> <span class="number">70</span> <span class="number">74</span> 2f <span class="number">50</span> 4b 01 02 3f <span class="number">00</span> <span class="number">14</span> <span class="number">00</span> 01 <span class="number">00</span> 08 <span class="number">00</span> 4b 8f 2c <span class="number">50</span> 6c f5 eb d9 <span class="number">97</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> ad <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">17</span> <span class="number">00</span> <span class="number">24</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">20</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">68</span> 6f <span class="number">77</span> <span class="number">74</span> 6f <span class="number">65</span> 6e <span class="number">63</span> <span class="number">72</span> <span class="number">79</span> <span class="number">70</span> <span class="number">74</span> 2f <span class="number">63</span> 6c <span class="number">61</span> <span class="number">73</span> <span class="number">73</span> <span class="number">69</span> <span class="number">63</span> <span class="number">30</span> 2e <span class="number">63</span> 0a <span class="number">00</span> <span class="number">20</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> 01 <span class="number">00</span> <span class="number">18</span> <span class="number">00</span> da <span class="number">42</span> <span class="number">47</span> d2 2e c9 d5 01 c3 2c <span class="number">95</span> <span class="number">53</span> 2f c9 d5 01 9c a4 <span class="number">55</span> af 2e c9 d5 01 <span class="number">50</span> 4b 01 02 3f <span class="number">00</span> <span class="number">14</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> 3d <span class="number">90</span> 2c <span class="number">50</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> 0d <span class="number">00</span> <span class="number">24</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">10</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> cc <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">68</span> 6f <span class="number">77</span> <span class="number">74</span> 6f <span class="number">65</span> 6e <span class="number">63</span> <span class="number">72</span> <span class="number">79</span> <span class="number">70</span> <span class="number">74</span> 2f 0a <span class="number">00</span> <span class="number">20</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> 01 <span class="number">00</span> <span class="number">18</span> <span class="number">00</span> <span class="number">29</span> e8 fc <span class="number">52</span> 2f c9 d5 01 <span class="number">63</span> 6e 2d <span class="number">61</span> 2f c9 d5 01 5f b5 <span class="number">56</span> af 2e c9 d5 01 <span class="number">50</span> 4b 05 06 <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> 02 <span class="number">00</span> 02 <span class="number">00</span> c8 <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> f7 <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br></pre></td></tr></table></figure>

<h3 id="8-3-2-解题思路"><a href="#8-3-2-解题思路" class="headerlink" title="8.3.2 解题思路"></a>8.3.2 解题思路</h3><p>压缩包爆破，Archive 爆破 8 位数字（YYYYMMDD）获得压缩包密码 <code>19990306</code>。获得 flag 加密算法文件：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include&lt;stdio.h&gt;</span></span><br><span class="line"></span><br><span class="line">char flag[<span class="number">25</span>] = ***</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">int</span> i;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">25</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        flag[i] -= <span class="number">3</span>;</span><br><span class="line">        flag[i] ^= <span class="number">0x7</span>;</span><br><span class="line">        printf(<span class="string">&quot;%c&quot;</span>,flag[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>简单逆向算法即可。</p>
<h3 id="8-3-3-解题脚本"><a href="#8-3-3-解题脚本" class="headerlink" title="8.3.3 解题脚本"></a>8.3.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">reverse</span>(<span class="params">ciphertext</span>):</span><br><span class="line">    res = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> ct <span class="keyword">in</span> ciphertext:</span><br><span class="line">        ascii_val = <span class="built_in">ord</span>(ct)</span><br><span class="line">        ascii_val ^= <span class="number">7</span></span><br><span class="line">        ascii_val += <span class="number">3</span></span><br><span class="line">        res += <span class="built_in">chr</span>(ascii_val)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    ciphertext = <span class="string">&#x27;Ygvdmq[lYate[elghqvakl&#125;&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(reverse(ciphertext))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># actf&#123;my_naive_encrytion&#125;</span></span><br></pre></td></tr></table></figure>

<br>

<h2 id="8-4-ACTF新生赛2020-crypto-rsa0"><a href="#8-4-ACTF新生赛2020-crypto-rsa0" class="headerlink" title="8.4 [ACTF新生赛2020]crypto-rsa0"></a>8.4 [ACTF新生赛2020]crypto-rsa0</h2><h3 id="8-4-1-题目"><a href="#8-4-1-题目" class="headerlink" title="8.4.1 题目"></a>8.4.1 题目</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">怎么办呢，出题人也太坏了，竟然把压缩包给伪加密了！</span><br><span class="line"></span><br><span class="line"><span class="comment"># challenge.zip</span></span><br><span class="line"><span class="number">50</span> 4B 03 04 <span class="number">14</span> <span class="number">00</span> 09 <span class="number">00</span> 08 <span class="number">00</span> <span class="number">72</span> <span class="number">93</span> <span class="number">77</span> 4F D0 <span class="number">36</span></span><br><span class="line">EB <span class="number">71</span> 3F 01 <span class="number">00</span> <span class="number">00</span> 6C 02 <span class="number">00</span> <span class="number">00</span> <span class="number">10</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">63</span> <span class="number">68</span></span><br><span class="line"><span class="number">61</span> 6C 6C <span class="number">65</span> 6E <span class="number">67</span> <span class="number">65</span> 2F 6F <span class="number">75</span> <span class="number">74</span> <span class="number">70</span> <span class="number">75</span> <span class="number">74</span> <span class="number">15</span> <span class="number">92</span></span><br><span class="line">4B 0E <span class="number">84</span> <span class="number">30</span> 0C <span class="number">43</span> F7 <span class="number">23</span> <span class="number">71</span> <span class="number">17</span> E7 E3 <span class="number">38</span> B9 FF C5</span><br><span class="line">C6 <span class="number">95</span> <span class="number">00</span> <span class="number">41</span> <span class="number">48</span> <span class="number">63</span> FB B5 <span class="number">87</span> <span class="number">58</span> EE <span class="number">62</span> A6 AB <span class="number">13</span> <span class="number">53</span></span><br><span class="line"><span class="number">52</span> <span class="number">36</span> <span class="number">52</span> 8A C9 D6 A8 2E <span class="number">15</span> B5 FE <span class="number">40</span> A8 B0 3B 1A</span><br><span class="line">E6 E4 B1 <span class="number">82</span> <span class="number">31</span> <span class="number">75</span> <span class="number">87</span> 9B AD <span class="number">16</span> <span class="number">32</span> 2F <span class="number">73</span> 3B F2 2E</span><br><span class="line"><span class="number">72</span> <span class="number">53</span> 4D <span class="number">46</span> AF 8B D3 EE C1 BA <span class="number">35</span> 4B C1 5A B7 5F</span><br><span class="line">DF B4 2C <span class="number">59</span> <span class="number">13</span> <span class="number">57</span> CB 3A 6D F3 CE <span class="number">73</span> 06 <span class="number">19</span> E8 <span class="number">88</span></span><br><span class="line">EF <span class="number">27</span> FA <span class="number">13</span> B4 <span class="number">89</span> <span class="number">95</span> FC <span class="number">48</span> 6A 8B CA D3 <span class="number">00</span> A5 <span class="number">67</span></span><br><span class="line"><span class="number">24</span> AA DA EF <span class="number">33</span> <span class="number">37</span> <span class="number">45</span> <span class="number">68</span> A6 B2 6D <span class="number">24</span> DE DC 0A DD</span><br><span class="line"><span class="number">55</span> <span class="number">46</span> <span class="number">33</span> D2 8D <span class="number">98</span> A5 B4 <span class="number">44</span> C3 <span class="number">69</span> 02 <span class="number">51</span> <span class="number">42</span> <span class="number">97</span> <span class="number">97</span></span><br><span class="line">1D <span class="number">37</span> 1D CC <span class="number">42</span> B7 BE C2 <span class="number">77</span> 5B A4 <span class="number">98</span> <span class="number">88</span> 3E EB 0D</span><br><span class="line"><span class="number">88</span> <span class="number">97</span> <span class="number">22</span> C5 <span class="number">50</span> 3B <span class="number">68</span> 7D 3F E2 6E CC EB <span class="number">92</span> <span class="number">37</span> 1E</span><br><span class="line"><span class="number">76</span> 1D 4C 3E 5F <span class="number">75</span> 2F <span class="number">18</span> 5D <span class="number">70</span> <span class="number">94</span> <span class="number">89</span> B6 F1 <span class="number">21</span> 2A</span><br><span class="line"><span class="number">75</span> 09 <span class="number">13</span> 7C 7A ED <span class="number">55</span> 2B C2 FD <span class="number">72</span> <span class="number">18</span> E3 <span class="number">34</span> 7E E7</span><br><span class="line">CF EA 5D 4E <span class="number">92</span> <span class="number">14</span> D7 C4 C7 <span class="number">75</span> D0 <span class="number">84</span> FC C3 4D 07</span><br><span class="line">6F <span class="number">90</span> D1 <span class="number">55</span> 0C C3 2D B0 <span class="number">22</span> 8D AD D4 B7 8E D8 9E</span><br><span class="line">B5 <span class="number">66</span> F0 D8 2F CA 03 F7 A0 0D 9B EF 1E <span class="number">94</span> F5 B3</span><br><span class="line">1C 4F 06 DC AB E7 <span class="number">65</span> CB <span class="number">82</span> 3B B1 <span class="number">61</span> 9C D6 B0 <span class="number">67</span></span><br><span class="line">1B <span class="number">27</span> 01 <span class="number">98</span> F3 B9 5C B6 9E A6 <span class="number">82</span> 3D 1F <span class="number">13</span> <span class="number">23</span> <span class="number">31</span></span><br><span class="line">F0 6D FB <span class="number">48</span> CF D3 3B <span class="number">33</span> B6 6B <span class="number">87</span> B1 <span class="number">76</span> A1 4C <span class="number">39</span></span><br><span class="line"><span class="number">49</span> 9F C3 B6 D6 FB EC CA <span class="number">63</span> <span class="number">62</span> 2D FC 01 <span class="number">50</span> 4B 03</span><br><span class="line">04 <span class="number">14</span> <span class="number">00</span> 09 <span class="number">00</span> 08 <span class="number">00</span> 1D B8 <span class="number">30</span> <span class="number">50</span> C8 5D <span class="number">92</span> <span class="number">54</span> B1</span><br><span class="line"><span class="number">00</span> <span class="number">00</span> <span class="number">00</span> F1 <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">11</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">63</span> <span class="number">68</span> <span class="number">61</span> 6C 6C</span><br><span class="line"><span class="number">65</span> 6E <span class="number">67</span> <span class="number">65</span> 2F <span class="number">72</span> <span class="number">73</span> <span class="number">61</span> <span class="number">30</span> 2E <span class="number">70</span> <span class="number">79</span> <span class="number">55</span> 8E 3D 0B</span><br><span class="line">C2 <span class="number">30</span> <span class="number">10</span> <span class="number">86</span> F7 <span class="number">40</span> FE <span class="number">43</span> C0 C1 B4 <span class="number">94</span> <span class="number">82</span> 4A <span class="number">75</span> CA</span><br><span class="line"><span class="number">20</span> <span class="number">82</span> 2E <span class="number">52</span> 5C 9C A5 <span class="number">35</span> D7 1A C8 <span class="number">57</span> D3 A8 F4 DF</span><br><span class="line">7B <span class="number">11</span> 3B C8 2D CF DD BD F7 <span class="number">70</span> 5D <span class="number">70</span> <span class="number">86</span> 1D C2 E4</span><br><span class="line">A3 <span class="number">93</span> CE <span class="number">40</span> <span class="number">79</span> 8D 4A <span class="number">97</span> F6 <span class="number">69</span> 5A 08 4C <span class="number">19</span> EF <span class="number">42</span></span><br><span class="line"><span class="number">64</span> <span class="number">39</span> <span class="number">25</span> 3F 0A 8D C5 <span class="number">10</span> <span class="number">25</span> <span class="number">94</span> 1C CF FB <span class="number">93</span> <span class="number">58</span> 3C</span><br><span class="line"><span class="number">94</span> <span class="number">94</span> <span class="number">60</span> 0B E6 <span class="number">35</span> <span class="number">34</span> <span class="number">23</span> B0 D1 E9 <span class="number">17</span> <span class="number">30</span> <span class="number">15</span> <span class="number">29</span> E9</span><br><span class="line"><span class="number">74</span> D3 0B <span class="number">65</span> <span class="number">63</span> <span class="number">99</span> F4 B7 <span class="number">76</span> 8A <span class="number">30</span> F2 <span class="number">74</span> <span class="number">52</span> <span class="number">24</span> <span class="number">74</span></span><br><span class="line"><span class="number">41</span> A2 5C B0 <span class="number">65</span> AB FA <span class="number">65</span> <span class="number">86</span> <span class="number">36</span> 2C 2F 7A <span class="number">88</span> <span class="number">97</span> A0</span><br><span class="line">0C F0 6A B5 C6 E1 F0 3F F8 <span class="number">66</span> 02 1A B9 CF <span class="number">66</span> 1A</span><br><span class="line"><span class="number">90</span> 6A E1 F3 <span class="number">81</span> <span class="number">12</span> <span class="number">10</span> DB AA DA EC <span class="number">10</span> EC 1D CD DE</span><br><span class="line">BD <span class="number">79</span> 7A A1 <span class="number">80</span> A2 9E E3 8C E3 0E 9B 0F <span class="number">50</span> 4B 03</span><br><span class="line">04 <span class="number">14</span> <span class="number">00</span> 09 <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">45</span> B8 <span class="number">30</span> <span class="number">50</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line"><span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> 0A <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">63</span> <span class="number">68</span> <span class="number">61</span> 6C 6C</span><br><span class="line"><span class="number">65</span> 6E <span class="number">67</span> <span class="number">65</span> 2F <span class="number">50</span> 4B 01 02 3F <span class="number">00</span> <span class="number">14</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> 08</span><br><span class="line"><span class="number">00</span> <span class="number">72</span> <span class="number">93</span> <span class="number">77</span> 4F D0 <span class="number">36</span> EB <span class="number">71</span> 3F 01 <span class="number">00</span> <span class="number">00</span> 6C 02 <span class="number">00</span></span><br><span class="line"><span class="number">00</span> <span class="number">10</span> <span class="number">00</span> <span class="number">24</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">20</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line"><span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">63</span> <span class="number">68</span> <span class="number">61</span> 6C 6C <span class="number">65</span> 6E <span class="number">67</span> <span class="number">65</span> 2F 6F <span class="number">75</span> <span class="number">74</span></span><br><span class="line"><span class="number">70</span> <span class="number">75</span> <span class="number">74</span> 0A <span class="number">00</span> <span class="number">20</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> 01 <span class="number">00</span> <span class="number">18</span> <span class="number">00</span> F7</span><br><span class="line">03 9A 9E E8 A1 D5 01 C9 09 <span class="number">90</span> EC 7D CC D5 01 <span class="number">66</span></span><br><span class="line">E3 8F EC 7D CC D5 01 <span class="number">50</span> 4B 01 02 3F <span class="number">00</span> <span class="number">14</span> <span class="number">00</span> 09</span><br><span class="line"><span class="number">00</span> 08 <span class="number">00</span> 1D B8 <span class="number">30</span> <span class="number">50</span> C8 5D <span class="number">92</span> <span class="number">54</span> B1 <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> F1</span><br><span class="line"><span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">11</span> <span class="number">00</span> <span class="number">24</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">20</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line"><span class="number">00</span> 6D 01 <span class="number">00</span> <span class="number">00</span> <span class="number">63</span> <span class="number">68</span> <span class="number">61</span> 6C 6C <span class="number">65</span> 6E <span class="number">67</span> <span class="number">65</span> 2F <span class="number">72</span></span><br><span class="line"><span class="number">73</span> <span class="number">61</span> <span class="number">30</span> 2E <span class="number">70</span> <span class="number">79</span> 0A <span class="number">00</span> <span class="number">20</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> 01 <span class="number">00</span></span><br><span class="line"><span class="number">18</span> <span class="number">00</span> <span class="number">10</span> 04 2F C1 7D CC D5 01 <span class="number">53</span> <span class="number">57</span> DD EC 7D CC</span><br><span class="line">D5 01 7C <span class="number">56</span> <span class="number">90</span> EC 7D CC D5 01 <span class="number">50</span> 4B 01 02 3F <span class="number">00</span></span><br><span class="line"><span class="number">14</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">45</span> B8 <span class="number">30</span> <span class="number">50</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line"><span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> 0A <span class="number">00</span> <span class="number">24</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br><span class="line"><span class="number">10</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> 4D 02 <span class="number">00</span> <span class="number">00</span> <span class="number">63</span> <span class="number">68</span> <span class="number">61</span> 6C 6C <span class="number">65</span> 6E <span class="number">67</span></span><br><span class="line"><span class="number">65</span> 2F 0A <span class="number">00</span> <span class="number">20</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> 01 <span class="number">00</span> <span class="number">18</span> <span class="number">00</span> 7C <span class="number">56</span></span><br><span class="line"><span class="number">90</span> EC 7D CC D5 01 9D 1F <span class="number">39</span> 01 7E CC D5 01 <span class="number">54</span> <span class="number">47</span></span><br><span class="line">8F EC 7D CC D5 01 <span class="number">50</span> 4B 05 06 <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> 03 <span class="number">00</span></span><br><span class="line">03 <span class="number">00</span> <span class="number">21</span> 01 <span class="number">00</span> <span class="number">00</span> <span class="number">75</span> 02 <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span></span><br></pre></td></tr></table></figure>

<h3 id="8-4-2-解题思路"><a href="#8-4-2-解题思路" class="headerlink" title="8.4.2 解题思路"></a>8.4.2 解题思路</h3><p>压缩包伪加密，压缩文件中的目录区标记 <code>50 4B 01 02</code>，定位到目录文件头。后面的字段中，<code>00 00</code> 表示未启用加密（该字段为全局方式标志位，奇数表示加密，偶数表示未加密）。可使用 010 Editor 将第二个 <code>50 4B 01 02</code> 后的 <code>09 00</code> 修改为 <code>00 00</code>，以解除加密标志。</p>
<p>解压得到加密脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Cryptodome.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">FLAG=<span class="comment">#hidden, please solve it</span></span><br><span class="line">flag=<span class="built_in">int</span>.from_bytes(FLAG,byteorder = <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p=getPrime(<span class="number">512</span>)</span><br><span class="line">q=getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"><span class="built_in">print</span>(q)</span><br><span class="line">N=p*q</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">enc = <span class="built_in">pow</span>(flag,e,N)</span><br><span class="line"><span class="built_in">print</span>(enc)</span><br><span class="line"></span><br><span class="line"><span class="number">9018588066434206377240277162476739271386240173088676526295315163990968347022922841299128274551482926490908399237153883494964743436193853978459947060210411</span></span><br><span class="line"><span class="number">7547005673877738257835729760037765213340036696350766324229143613179932145122130685778504062410137043635958208805698698169847293520149572605026492751740223</span></span><br><span class="line"><span class="number">50996206925961019415256003394743594106061473865032792073035954925875056079762626648452348856255575840166640519334862690063949316515750256545937498213476286637455803452890781264446030732369871044870359838568618176586206041055000297981733272816089806014400846392307742065559331874972274844992047849472203390350</span></span><br></pre></td></tr></table></figure>

<p>标准 RSA 解密</p>
<h3 id="8-4-3-解题脚本"><a href="#8-4-3-解题脚本" class="headerlink" title="8.4.3 解题脚本"></a>8.4.3 解题脚本</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> prod</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> totient</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_OAEP</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse, long_to_bytes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">standard_rsa_decryption</span>(<span class="params">e, c, primes=<span class="literal">None</span>, n=<span class="literal">None</span>, phi=<span class="literal">None</span>, ct_format=<span class="string">&#x27;int&#x27;</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    标准 RSA 解密</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> phi:</span><br><span class="line">        <span class="keyword">if</span> n:</span><br><span class="line">            phi = totient(n)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            phi = prod(p - <span class="number">1</span> <span class="keyword">for</span> p <span class="keyword">in</span> primes)</span><br><span class="line">            n = prod(p <span class="keyword">for</span> p <span class="keyword">in</span> primes)</span><br><span class="line"></span><br><span class="line">    d = inverse(e, phi)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ct_format == <span class="string">&#x27;base64&#x27;</span>:</span><br><span class="line">        p, q = primes[<span class="number">0</span>], primes[<span class="number">1</span>]</span><br><span class="line">        key_info = RSA.construct((n, e, d, p, q))</span><br><span class="line">        key = RSA.importKey(key_info.exportKey())</span><br><span class="line">        key = PKCS1_OAEP.new(key)</span><br><span class="line">        m = key.decrypt(b64decode(c)).decode()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line">    p = <span class="number">9018588066434206377240277162476739271386240173088676526295315163990968347022922841299128274551482926490908399237153883494964743436193853978459947060210411</span></span><br><span class="line">    q = <span class="number">7547005673877738257835729760037765213340036696350766324229143613179932145122130685778504062410137043635958208805698698169847293520149572605026492751740223</span></span><br><span class="line">    c = <span class="number">50996206925961019415256003394743594106061473865032792073035954925875056079762626648452348856255575840166640519334862690063949316515750256545937498213476286637455803452890781264446030732369871044870359838568618176586206041055000297981733272816089806014400846392307742065559331874972274844992047849472203390350</span></span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(standard_rsa_decryption(e, c, [p, q])))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># b&#x27;actf&#123;n0w_y0u_see_RSA&#125;&#x27;</span></span><br></pre></td></tr></table></figure>

</div><div class="article-licensing box"><div class="licensing-title"><p>[日常训练] Crypto Training - BUUCTF（一）</p><p><a href="http://dstbp.com/2024/02/01/buuctf1/">http://dstbp.com/2024/02/01/buuctf1/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>DSTBP</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2024-02-01</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2025-07-12</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="" rel="noopener" target="_blank" title="CC BY 4.0" href="https://creativecommons.org/licenses/by/4.0/deed.zh">CC BY 4.0</a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/">密码学</a></div><!--!--></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>支付宝</span><span class="qrcode"><img src="/images/alipay_qrcode.jpg" alt="支付宝"></span></a><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>微信</span><span class="qrcode"><img src="/images/wechat_qrcode.jpg" alt="微信"></span></a></div></div></div><div class="card"><nav class="post-navigation mt-4 level is-mobile card-content"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2025/05/14/lzw/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">[信息编码] LZW 压缩算法</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2024/01/01/hello-world/"><span class="level-item">欢迎来到「微澜尘寰的雾岛」</span><i class="level-item fas fa-chevron-right"></i></a></div></nav></div><div class="card" id="comments"><div class="card-content"><h3 class="title is-5">评论</h3><div class="content twikoo" id="twikoo"></div><script src="/js/imaegoo/twikoo/1.6.41/twikoo.min.js"></script><script>twikoo.init({
            envId: 'https://twikoo.dstbp.com',
            
            lang: "zh-CN",
            onCommentLoaded: function () {
              var commentContents = document.getElementsByClassName('tk-content');
              for (var i = 0; i < commentContents.length; i++) {
                var commentItem = commentContents[i];
                var imgEls = commentItem.getElementsByTagName('img');
                if (imgEls.length > 0) {
                  for (var j = 0; j < imgEls.length; j++) {
                    var imgEl = imgEls[j];
                    var aEl = document.createElement('a');
                    aEl.setAttribute('class', 'tk-lg-link');
                    aEl.setAttribute('href', imgEl.getAttribute('src'));
                    aEl.setAttribute('data-src', imgEl.getAttribute('src'));
                    aEl.appendChild(imgEl.cloneNode(false));
                    imgEl.parentNode.insertBefore(aEl, imgEl.nextSibling);
                    imgEl.remove();
                  }
                  if (typeof $.fn.lightGallery === 'function') {
                    $(commentItem).lightGallery({
                      selector: '.tk-lg-link'
                    });
                  }
                }
              }
            }
        });</script></div></div></div><style>.column.column-left,.column.column-right{display:none}</style><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/images/avatar.png" alt="DSTBP"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">DSTBP</p><p class="is-size-6 is-block">r0xanne</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Elliðaey island. Iceland.</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives/"><p class="title">4</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories/"><p class="title">4</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags/"><p class="title">1</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/dstbp" target="_blank" rel="me noopener" id="widget-follow">GitHub</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Home" href="https://dstbp.net"><i class="fas fa-home"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Stackexchange" href="https://crypto.stackexchange.com/users/112358/dstbp"><i class="fab fa-stack-exchange"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Mail" href="mailto:TaddeoWang123@gmail.com"><i class="fas fa-envelope"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="RSS" href="/atom.xml"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget"><div class="card-content"><div class="media" style="overflow: hidden; align-items: center"><div class="media-left"><figure class="image is-96x96"><img src="/images/weixin/qrcode.jpg" alt="微信二维码"></figure></div><div class="media-content"><div id="weixin-search-logo"></div><div class="control has-icons-left" id="weixin-search-text"><input class="input" readonly value="三两黑白" onfocus="this.select()"><span class="icon is-small is-left"><i class="fas fa-search"></i></span></div></div></div></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2025/07/"><span class="level-start"><span class="level-item">2025 年 7 月</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2025/05/"><span class="level-start"><span class="level-item">2025 年 5 月</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/02/"><span class="level-start"><span class="level-item">2024 年 2 月</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/01/"><span class="level-start"><span class="level-item">2024 年 1 月</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="level is-mobile" href="#序言"><span class="level-left"><span class="level-item">1</span><span class="level-item">序言</span></span></a></li><li><a class="level is-mobile" href="#1-编码与混淆"><span class="level-left"><span class="level-item">2</span><span class="level-item">1. 编码与混淆</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-1-一眼就解密"><span class="level-left"><span class="level-item">2.1</span><span class="level-item">1.1 一眼就解密</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-1-1-题目"><span class="level-left"><span class="level-item">2.1.1</span><span class="level-item">1.1.1 题目</span></span></a></li><li><a class="level is-mobile" href="#1-1-2-解题思路"><span class="level-left"><span class="level-item">2.1.2</span><span class="level-item">1.1.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#1-1-3-解题脚本"><span class="level-left"><span class="level-item">2.1.3</span><span class="level-item">1.1.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#1-2-Url编码"><span class="level-left"><span class="level-item">2.2</span><span class="level-item">1.2 Url编码</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-2-1-题目"><span class="level-left"><span class="level-item">2.2.1</span><span class="level-item">1.2.1 题目</span></span></a></li><li><a class="level is-mobile" href="#1-2-2-解题思路"><span class="level-left"><span class="level-item">2.2.2</span><span class="level-item">1.2.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#1-2-3-解题脚本"><span class="level-left"><span class="level-item">2.2.3</span><span class="level-item">1.2.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#1-3-Quoted-printable"><span class="level-left"><span class="level-item">2.3</span><span class="level-item">1.3 Quoted-printable</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-3-1-题目"><span class="level-left"><span class="level-item">2.3.1</span><span class="level-item">1.3.1 题目</span></span></a></li><li><a class="level is-mobile" href="#1-3-2-解题思路"><span class="level-left"><span class="level-item">2.3.2</span><span class="level-item">1.3.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#1-3-3-解题脚本"><span class="level-left"><span class="level-item">2.3.3</span><span class="level-item">1.3.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#1-4-信息化时代的步伐"><span class="level-left"><span class="level-item">2.4</span><span class="level-item">1.4 信息化时代的步伐</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-4-1-题目"><span class="level-left"><span class="level-item">2.4.1</span><span class="level-item">1.4.1 题目</span></span></a></li><li><a class="level is-mobile" href="#1-4-2-解题思路"><span class="level-left"><span class="level-item">2.4.2</span><span class="level-item">1.4.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#1-4-3-解题脚本"><span class="level-left"><span class="level-item">2.4.3</span><span class="level-item">1.4.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#1-5-Unencode"><span class="level-left"><span class="level-item">2.5</span><span class="level-item">1.5 Unencode</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-5-1-题目"><span class="level-left"><span class="level-item">2.5.1</span><span class="level-item">1.5.1 题目</span></span></a></li><li><a class="level is-mobile" href="#1-5-2-解题思路"><span class="level-left"><span class="level-item">2.5.2</span><span class="level-item">1.5.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#1-5-3-解题脚本"><span class="level-left"><span class="level-item">2.5.3</span><span class="level-item">1.5.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#1-6-异性相吸"><span class="level-left"><span class="level-item">2.6</span><span class="level-item">1.6 异性相吸</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-6-1-题目"><span class="level-left"><span class="level-item">2.6.1</span><span class="level-item">1.6.1 题目</span></span></a></li><li><a class="level is-mobile" href="#1-6-2-解题思路"><span class="level-left"><span class="level-item">2.6.2</span><span class="level-item">1.6.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#1-6-3-解题脚本"><span class="level-left"><span class="level-item">2.6.3</span><span class="level-item">1.6.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#1-7-密码学的心声"><span class="level-left"><span class="level-item">2.7</span><span class="level-item">1.7 密码学的心声</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-7-1-题目"><span class="level-left"><span class="level-item">2.7.1</span><span class="level-item">1.7.1 题目</span></span></a></li><li><a class="level is-mobile" href="#1-7-2-解题思路"><span class="level-left"><span class="level-item">2.7.2</span><span class="level-item">1.7.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#1-7-3-解题脚本"><span class="level-left"><span class="level-item">2.7.3</span><span class="level-item">1.7.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#1-8-BJDCTF2020-这是base"><span class="level-left"><span class="level-item">2.8</span><span class="level-item">1.8 [BJDCTF2020]这是base??</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-8-1-题目"><span class="level-left"><span class="level-item">2.8.1</span><span class="level-item">1.8.1 题目</span></span></a></li><li><a class="level is-mobile" href="#1-8-2-解题思路"><span class="level-left"><span class="level-item">2.8.2</span><span class="level-item">1.8.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#1-8-3-解题脚本"><span class="level-left"><span class="level-item">2.8.3</span><span class="level-item">1.8.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#1-9-这是什么"><span class="level-left"><span class="level-item">2.9</span><span class="level-item">1.9 这是什么</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-9-1-题目"><span class="level-left"><span class="level-item">2.9.1</span><span class="level-item">1.9.1 题目</span></span></a></li><li><a class="level is-mobile" href="#1-9-2-解题思路"><span class="level-left"><span class="level-item">2.9.2</span><span class="level-item">1.9.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#1-9-3-解题脚本"><span class="level-left"><span class="level-item">2.9.3</span><span class="level-item">1.9.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#1-10-BJDCTF2020-signin"><span class="level-left"><span class="level-item">2.10</span><span class="level-item">1.10 [BJDCTF2020]signin</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-10-1-题目"><span class="level-left"><span class="level-item">2.10.1</span><span class="level-item">1.10.1 题目</span></span></a></li><li><a class="level is-mobile" href="#1-10-2-解题思路"><span class="level-left"><span class="level-item">2.10.2</span><span class="level-item">1.10.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#1-10-3-解题脚本"><span class="level-left"><span class="level-item">2.10.3</span><span class="level-item">1.10.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#1-11-传感器"><span class="level-left"><span class="level-item">2.11</span><span class="level-item">1.11 传感器</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-11-1-题目"><span class="level-left"><span class="level-item">2.11.1</span><span class="level-item">1.11.1 题目</span></span></a></li><li><a class="level is-mobile" href="#1-11-2-解题思路"><span class="level-left"><span class="level-item">2.11.2</span><span class="level-item">1.11.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#1-11-3-解题脚本"><span class="level-left"><span class="level-item">2.11.3</span><span class="level-item">1.11.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#1-12-yxx"><span class="level-left"><span class="level-item">2.12</span><span class="level-item">1.12 yxx</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-12-1-题目"><span class="level-left"><span class="level-item">2.12.1</span><span class="level-item">1.12.1 题目</span></span></a></li><li><a class="level is-mobile" href="#1-12-2-解题思路"><span class="level-left"><span class="level-item">2.12.2</span><span class="level-item">1.12.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#1-12-3-解题脚本"><span class="level-left"><span class="level-item">2.12.3</span><span class="level-item">1.12.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#1-13-WUSTCTF2020-B-se"><span class="level-left"><span class="level-item">2.13</span><span class="level-item">1.13 [WUSTCTF2020]B@se</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-13-1-题目"><span class="level-left"><span class="level-item">2.13.1</span><span class="level-item">1.13.1 题目</span></span></a></li><li><a class="level is-mobile" href="#1-13-2-解题思路"><span class="level-left"><span class="level-item">2.13.2</span><span class="level-item">1.13.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#1-13-3-解题脚本"><span class="level-left"><span class="level-item">2.13.3</span><span class="level-item">1.13.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#1-14-AFCTF2018-BASE"><span class="level-left"><span class="level-item">2.14</span><span class="level-item">1.14 [AFCTF2018]BASE</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-14-1-题目"><span class="level-left"><span class="level-item">2.14.1</span><span class="level-item">1.14.1 题目</span></span></a></li><li><a class="level is-mobile" href="#1-14-2-解题思路"><span class="level-left"><span class="level-item">2.14.2</span><span class="level-item">1.14.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#1-14-3-解题脚本"><span class="level-left"><span class="level-item">2.14.3</span><span class="level-item">1.14.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#1-15-鸡藕椒盐味"><span class="level-left"><span class="level-item">2.15</span><span class="level-item">1.15 鸡藕椒盐味</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-15-1-题目"><span class="level-left"><span class="level-item">2.15.1</span><span class="level-item">1.15.1 题目</span></span></a></li><li><a class="level is-mobile" href="#1-15-2-解题思路"><span class="level-left"><span class="level-item">2.15.2</span><span class="level-item">1.15.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#1-15-3-解题脚本"><span class="level-left"><span class="level-item">2.15.3</span><span class="level-item">1.15.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#1-16-BJDCTF2020-编码与调制"><span class="level-left"><span class="level-item">2.16</span><span class="level-item">1.16 [BJDCTF2020]编码与调制</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-16-1-题目"><span class="level-left"><span class="level-item">2.16.1</span><span class="level-item">1.16.1 题目</span></span></a></li><li><a class="level is-mobile" href="#1-16-2-解题思路"><span class="level-left"><span class="level-item">2.16.2</span><span class="level-item">1.16.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#1-16-3-解题脚本"><span class="level-left"><span class="level-item">2.16.3</span><span class="level-item">1.16.3 解题脚本</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="#2-传统古典密码"><span class="level-left"><span class="level-item">3</span><span class="level-item">2. 传统古典密码</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-1-看我回旋踢"><span class="level-left"><span class="level-item">3.1</span><span class="level-item">2.1 看我回旋踢</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-1-1-题目"><span class="level-left"><span class="level-item">3.1.1</span><span class="level-item">2.1.1 题目</span></span></a></li><li><a class="level is-mobile" href="#2-1-2-解题思路"><span class="level-left"><span class="level-item">3.1.2</span><span class="level-item">2.1.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#2-1-3-解题脚本"><span class="level-left"><span class="level-item">3.1.3</span><span class="level-item">2.1.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#2-2-摩丝"><span class="level-left"><span class="level-item">3.2</span><span class="level-item">2.2 摩丝</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-2-1-题目"><span class="level-left"><span class="level-item">3.2.1</span><span class="level-item">2.2.1 题目</span></span></a></li><li><a class="level is-mobile" href="#2-2-2-解题思路"><span class="level-left"><span class="level-item">3.2.2</span><span class="level-item">2.2.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#2-2-3-解题脚本"><span class="level-left"><span class="level-item">3.2.3</span><span class="level-item">2.2.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#2-3-变异凯撒"><span class="level-left"><span class="level-item">3.3</span><span class="level-item">2.3 变异凯撒</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-3-1-题目"><span class="level-left"><span class="level-item">3.3.1</span><span class="level-item">2.3.1 题目</span></span></a></li><li><a class="level is-mobile" href="#2-3-2-解题思路"><span class="level-left"><span class="level-item">3.3.2</span><span class="level-item">2.3.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#2-3-3-解题脚本"><span class="level-left"><span class="level-item">3.3.3</span><span class="level-item">2.3.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#2-4-篱笆墙的影子"><span class="level-left"><span class="level-item">3.4</span><span class="level-item">2.4 篱笆墙的影子</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-4-1-题目"><span class="level-left"><span class="level-item">3.4.1</span><span class="level-item">2.4.1 题目</span></span></a></li><li><a class="level is-mobile" href="#2-4-2-解题思路"><span class="level-left"><span class="level-item">3.4.2</span><span class="level-item">2.4.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#2-4-3-解题脚本"><span class="level-left"><span class="level-item">3.4.3</span><span class="level-item">2.4.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#2-5-大帝的密码武器"><span class="level-left"><span class="level-item">3.5</span><span class="level-item">2.5 大帝的密码武器</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-5-1-题目"><span class="level-left"><span class="level-item">3.5.1</span><span class="level-item">2.5.1 题目</span></span></a></li><li><a class="level is-mobile" href="#2-5-2-解题思路"><span class="level-left"><span class="level-item">3.5.2</span><span class="level-item">2.5.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#2-5-3-解题脚本"><span class="level-left"><span class="level-item">3.5.3</span><span class="level-item">2.5.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#2-6-凯撒？替换？呵呵"><span class="level-left"><span class="level-item">3.6</span><span class="level-item">2.6 凯撒？替换？呵呵!</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-6-1-题目"><span class="level-left"><span class="level-item">3.6.1</span><span class="level-item">2.6.1 题目</span></span></a></li><li><a class="level is-mobile" href="#2-6-2-解题思路"><span class="level-left"><span class="level-item">3.6.2</span><span class="level-item">2.6.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#2-6-3-解题脚本"><span class="level-left"><span class="level-item">3.6.3</span><span class="level-item">2.6.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#2-7-萌萌哒的八戒"><span class="level-left"><span class="level-item">3.7</span><span class="level-item">2.7 萌萌哒的八戒</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-7-1-题目"><span class="level-left"><span class="level-item">3.7.1</span><span class="level-item">2.7.1 题目</span></span></a></li><li><a class="level is-mobile" href="#2-7-2-解题思路"><span class="level-left"><span class="level-item">3.7.2</span><span class="level-item">2.7.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#2-7-3-解题脚本"><span class="level-left"><span class="level-item">3.7.3</span><span class="level-item">2.7.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#2-8-传统知识-古典密码"><span class="level-left"><span class="level-item">3.8</span><span class="level-item">2.8 传统知识+古典密码</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-8-1-题目"><span class="level-left"><span class="level-item">3.8.1</span><span class="level-item">2.8.1 题目</span></span></a></li><li><a class="level is-mobile" href="#2-8-2-解题思路"><span class="level-left"><span class="level-item">3.8.2</span><span class="level-item">2.8.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#2-8-3-解题脚本"><span class="level-left"><span class="level-item">3.8.3</span><span class="level-item">2.8.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#2-9-世上无难事"><span class="level-left"><span class="level-item">3.9</span><span class="level-item">2.9 世上无难事</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-9-1-题目"><span class="level-left"><span class="level-item">3.9.1</span><span class="level-item">2.9.1 题目</span></span></a></li><li><a class="level is-mobile" href="#2-9-2-解题思路"><span class="level-left"><span class="level-item">3.9.2</span><span class="level-item">2.9.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#2-9-3-解题脚本"><span class="level-left"><span class="level-item">3.9.3</span><span class="level-item">2.9.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#2-10-old-fashion"><span class="level-left"><span class="level-item">3.10</span><span class="level-item">2.10 old-fashion</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-10-1-题目"><span class="level-left"><span class="level-item">3.10.1</span><span class="level-item">2.10.1 题目</span></span></a></li><li><a class="level is-mobile" href="#2-10-2-解题思路"><span class="level-left"><span class="level-item">3.10.2</span><span class="level-item">2.10.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#2-10-3-解题脚本"><span class="level-left"><span class="level-item">3.10.3</span><span class="level-item">2.10.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#2-11-AFCTF2018-Morse"><span class="level-left"><span class="level-item">3.11</span><span class="level-item">2.11 [AFCTF2018]Morse</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-11-1-题目"><span class="level-left"><span class="level-item">3.11.1</span><span class="level-item">2.11.1 题目</span></span></a></li><li><a class="level is-mobile" href="#2-11-2-解题思路"><span class="level-left"><span class="level-item">3.11.2</span><span class="level-item">2.11.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#2-11-3-解题脚本"><span class="level-left"><span class="level-item">3.11.3</span><span class="level-item">2.11.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#2-12-GXYCTF2019-CheckIn"><span class="level-left"><span class="level-item">3.12</span><span class="level-item">2.12 [GXYCTF2019]CheckIn</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-12-1-题目"><span class="level-left"><span class="level-item">3.12.1</span><span class="level-item">2.12.1 题目</span></span></a></li><li><a class="level is-mobile" href="#2-12-2-解题思路"><span class="level-left"><span class="level-item">3.12.2</span><span class="level-item">2.12.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#2-12-3-解题脚本"><span class="level-left"><span class="level-item">3.12.3</span><span class="level-item">2.12.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#2-13-Cipher"><span class="level-left"><span class="level-item">3.13</span><span class="level-item">2.13 Cipher</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-13-1-题目"><span class="level-left"><span class="level-item">3.13.1</span><span class="level-item">2.13.1 题目</span></span></a></li><li><a class="level is-mobile" href="#2-13-2-解题思路"><span class="level-left"><span class="level-item">3.13.2</span><span class="level-item">2.13.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#2-13-3-解题脚本"><span class="level-left"><span class="level-item">3.13.3</span><span class="level-item">2.13.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#2-14-robomunication"><span class="level-left"><span class="level-item">3.14</span><span class="level-item">2.14 robomunication</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-14-1-题目"><span class="level-left"><span class="level-item">3.14.1</span><span class="level-item">2.14.1 题目</span></span></a></li><li><a class="level is-mobile" href="#2-14-2-解题思路"><span class="level-left"><span class="level-item">3.14.2</span><span class="level-item">2.14.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#2-14-3-解题脚本"><span class="level-left"><span class="level-item">3.14.3</span><span class="level-item">2.14.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#2-15-MRCTF2020-古典密码知多少"><span class="level-left"><span class="level-item">3.15</span><span class="level-item">2.15 [MRCTF2020]古典密码知多少</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-15-1-题目"><span class="level-left"><span class="level-item">3.15.1</span><span class="level-item">2.15.1 题目</span></span></a></li><li><a class="level is-mobile" href="#2-15-2-解题思路"><span class="level-left"><span class="level-item">3.15.2</span><span class="level-item">2.15.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#2-15-3-解题脚本"><span class="level-left"><span class="level-item">3.15.3</span><span class="level-item">2.15.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#2-16-WUSTCTF2020-佛说：只能四天"><span class="level-left"><span class="level-item">3.16</span><span class="level-item">2.16 [WUSTCTF2020]佛说：只能四天</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-16-1-题目"><span class="level-left"><span class="level-item">3.16.1</span><span class="level-item">2.16.1 题目</span></span></a></li><li><a class="level is-mobile" href="#2-16-2-解题思路"><span class="level-left"><span class="level-item">3.16.2</span><span class="level-item">2.16.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#2-16-3-解题脚本"><span class="level-left"><span class="level-item">3.16.3</span><span class="level-item">2.16.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#2-17-rot"><span class="level-left"><span class="level-item">3.17</span><span class="level-item">2.17 rot</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-17-1-题目"><span class="level-left"><span class="level-item">3.17.1</span><span class="level-item">2.17.1 题目</span></span></a></li><li><a class="level is-mobile" href="#2-17-2-解题思路"><span class="level-left"><span class="level-item">3.17.2</span><span class="level-item">2.17.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#2-17-3-解题脚本"><span class="level-left"><span class="level-item">3.17.3</span><span class="level-item">2.17.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#2-18-MRCTF2020-天干地支-甲子"><span class="level-left"><span class="level-item">3.18</span><span class="level-item">2.18 [MRCTF2020]天干地支+甲子</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-18-1-题目"><span class="level-left"><span class="level-item">3.18.1</span><span class="level-item">2.18.1 题目</span></span></a></li><li><a class="level is-mobile" href="#2-18-2-解题思路"><span class="level-left"><span class="level-item">3.18.2</span><span class="level-item">2.18.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#2-18-3-解题脚本"><span class="level-left"><span class="level-item">3.18.3</span><span class="level-item">2.18.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#2-19-NCTF2019-Keyboard"><span class="level-left"><span class="level-item">3.19</span><span class="level-item">2.19 [NCTF2019]Keyboard</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-19-1-题目"><span class="level-left"><span class="level-item">3.19.1</span><span class="level-item">2.19.1 题目</span></span></a></li><li><a class="level is-mobile" href="#2-19-2-解题思路"><span class="level-left"><span class="level-item">3.19.2</span><span class="level-item">2.19.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#2-19-3-解题脚本"><span class="level-left"><span class="level-item">3.19.3</span><span class="level-item">2.19.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#2-20-MRCTF2020-vigenere"><span class="level-left"><span class="level-item">3.20</span><span class="level-item">2.20 [MRCTF2020]vigenere</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-20-1-题目"><span class="level-left"><span class="level-item">3.20.1</span><span class="level-item">2.20.1 题目</span></span></a></li><li><a class="level is-mobile" href="#2-20-2-解题思路"><span class="level-left"><span class="level-item">3.20.2</span><span class="level-item">2.20.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#2-20-3-解题脚本"><span class="level-left"><span class="level-item">3.20.3</span><span class="level-item">2.20.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#2-21-MRCTF2020-keyboard"><span class="level-left"><span class="level-item">3.21</span><span class="level-item">2.21 [MRCTF2020]keyboard</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-21-1-题目"><span class="level-left"><span class="level-item">3.21.1</span><span class="level-item">2.21.1 题目</span></span></a></li><li><a class="level is-mobile" href="#2-21-2-解题思路"><span class="level-left"><span class="level-item">3.21.2</span><span class="level-item">2.21.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#2-21-3-解题脚本"><span class="level-left"><span class="level-item">3.21.3</span><span class="level-item">2.21.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#2-22-一张谍报"><span class="level-left"><span class="level-item">3.22</span><span class="level-item">2.22 一张谍报</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-22-1-题目"><span class="level-left"><span class="level-item">3.22.1</span><span class="level-item">2.22.1 题目</span></span></a></li><li><a class="level is-mobile" href="#2-22-2-解题思路"><span class="level-left"><span class="level-item">3.22.2</span><span class="level-item">2.22.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#2-22-3-解题脚本"><span class="level-left"><span class="level-item">3.22.3</span><span class="level-item">2.22.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#2-23-AFCTF2018-Vigenere"><span class="level-left"><span class="level-item">3.23</span><span class="level-item">2.23 [AFCTF2018]Vigenère</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-23-1-题目"><span class="level-left"><span class="level-item">3.23.1</span><span class="level-item">2.23.1 题目</span></span></a></li><li><a class="level is-mobile" href="#2-23-2-解题思路"><span class="level-left"><span class="level-item">3.23.2</span><span class="level-item">2.23.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#2-23-3-解题脚本"><span class="level-left"><span class="level-item">3.23.3</span><span class="level-item">2.23.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#2-24-AFCTF2018-Single"><span class="level-left"><span class="level-item">3.24</span><span class="level-item">2.24 [AFCTF2018]Single</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-24-1-题目"><span class="level-left"><span class="level-item">3.24.1</span><span class="level-item">2.24.1 题目</span></span></a></li><li><a class="level is-mobile" href="#2-24-2-解题思路"><span class="level-left"><span class="level-item">3.24.2</span><span class="level-item">2.24.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#2-24-3-解题脚本"><span class="level-left"><span class="level-item">3.24.3</span><span class="level-item">2.24.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#2-25-UTCTF2020-basic-crypto"><span class="level-left"><span class="level-item">3.25</span><span class="level-item">2.25 [UTCTF2020]basic-crypto</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-25-1-题目"><span class="level-left"><span class="level-item">3.25.1</span><span class="level-item">2.25.1 题目</span></span></a></li><li><a class="level is-mobile" href="#2-25-2-解题思路"><span class="level-left"><span class="level-item">3.25.2</span><span class="level-item">2.25.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#2-25-3-解题脚本"><span class="level-left"><span class="level-item">3.25.3</span><span class="level-item">2.25.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#2-26-四面八方"><span class="level-left"><span class="level-item">3.26</span><span class="level-item">2.26 四面八方</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-26-1-题目"><span class="level-left"><span class="level-item">3.26.1</span><span class="level-item">2.26.1 题目</span></span></a></li><li><a class="level is-mobile" href="#2-26-2-解题思路"><span class="level-left"><span class="level-item">3.26.2</span><span class="level-item">2.26.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#2-26-3-解题脚本"><span class="level-left"><span class="level-item">3.26.3</span><span class="level-item">2.26.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#2-27-NPUCTF2020-Classical-Cipher"><span class="level-left"><span class="level-item">3.27</span><span class="level-item">2.27 [NPUCTF2020]Classical Cipher</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-27-1-题目"><span class="level-left"><span class="level-item">3.27.1</span><span class="level-item">2.27.1 题目</span></span></a></li><li><a class="level is-mobile" href="#2-27-2-解题思路"><span class="level-left"><span class="level-item">3.27.2</span><span class="level-item">2.27.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#2-27-3-解题脚本"><span class="level-left"><span class="level-item">3.27.3</span><span class="level-item">2.27.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#2-28-BJDCTF2020-Polybius"><span class="level-left"><span class="level-item">3.28</span><span class="level-item">2.28 [BJDCTF2020]Polybius</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-28-1-题目"><span class="level-left"><span class="level-item">3.28.1</span><span class="level-item">2.28.1 题目</span></span></a></li><li><a class="level is-mobile" href="#2-28-2-解题思路"><span class="level-left"><span class="level-item">3.28.2</span><span class="level-item">2.28.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#2-28-3-解题脚本"><span class="level-left"><span class="level-item">3.28.3</span><span class="level-item">2.28.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#2-29-ACTF新生赛2020-crypto-classic1"><span class="level-left"><span class="level-item">3.29</span><span class="level-item">2.29 [ACTF新生赛2020]crypto-classic1</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-29-1-题目"><span class="level-left"><span class="level-item">3.29.1</span><span class="level-item">2.29.1 题目</span></span></a></li><li><a class="level is-mobile" href="#2-29-2-解题思路"><span class="level-left"><span class="level-item">3.29.2</span><span class="level-item">2.29.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#2-29-3-解题脚本"><span class="level-left"><span class="level-item">3.29.3</span><span class="level-item">2.29.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#2-30-浪里淘沙"><span class="level-left"><span class="level-item">3.30</span><span class="level-item">2.30 浪里淘沙</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-30-1-题目"><span class="level-left"><span class="level-item">3.30.1</span><span class="level-item">2.30.1 题目</span></span></a></li><li><a class="level is-mobile" href="#2-30-2-解题思路"><span class="level-left"><span class="level-item">3.30.2</span><span class="level-item">2.30.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#2-30-3-解题脚本"><span class="level-left"><span class="level-item">3.30.3</span><span class="level-item">2.30.3 解题脚本</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="#3-现代对称密码"><span class="level-left"><span class="level-item">4</span><span class="level-item">3. 现代对称密码</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#3-1-Rabbit"><span class="level-left"><span class="level-item">4.1</span><span class="level-item">3.1 Rabbit</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#3-1-1-题目"><span class="level-left"><span class="level-item">4.1.1</span><span class="level-item">3.1.1 题目</span></span></a></li><li><a class="level is-mobile" href="#3-1-2-解题思路"><span class="level-left"><span class="level-item">4.1.2</span><span class="level-item">3.1.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#3-1-3-解题脚本"><span class="level-left"><span class="level-item">4.1.3</span><span class="level-item">3.1.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#3-2-ACTF新生赛2020-crypto-aes"><span class="level-left"><span class="level-item">4.2</span><span class="level-item">3.2 [ACTF新生赛2020]crypto-aes</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#3-2-1-题目"><span class="level-left"><span class="level-item">4.2.1</span><span class="level-item">3.2.1 题目</span></span></a></li><li><a class="level is-mobile" href="#3-2-2-解题思路"><span class="level-left"><span class="level-item">4.2.2</span><span class="level-item">3.2.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#3-2-3-解题脚本"><span class="level-left"><span class="level-item">4.2.3</span><span class="level-item">3.2.3 解题脚本</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="#4-现代非对称密码"><span class="level-left"><span class="level-item">5</span><span class="level-item">4. 现代非对称密码</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-1-RSA"><span class="level-left"><span class="level-item">5.1</span><span class="level-item">4.1 RSA</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-1-1-题目"><span class="level-left"><span class="level-item">5.1.1</span><span class="level-item">4.1.1 题目</span></span></a></li><li><a class="level is-mobile" href="#4-1-2-解题思路"><span class="level-left"><span class="level-item">5.1.2</span><span class="level-item">4.1.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#4-1-3-解题脚本"><span class="level-left"><span class="level-item">5.1.3</span><span class="level-item">4.1.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#4-2-rsarsa"><span class="level-left"><span class="level-item">5.2</span><span class="level-item">4.2 rsarsa</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-2-1-题目"><span class="level-left"><span class="level-item">5.2.1</span><span class="level-item">4.2.1 题目</span></span></a></li><li><a class="level is-mobile" href="#4-2-2-解题思路"><span class="level-left"><span class="level-item">5.2.2</span><span class="level-item">4.2.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#4-2-3-解题脚本"><span class="level-left"><span class="level-item">5.2.3</span><span class="level-item">4.2.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#4-3-RSA1"><span class="level-left"><span class="level-item">5.3</span><span class="level-item">4.3 RSA1</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-3-1-题目"><span class="level-left"><span class="level-item">5.3.1</span><span class="level-item">4.3.1 题目</span></span></a></li><li><a class="level is-mobile" href="#4-3-2-解题思路"><span class="level-left"><span class="level-item">5.3.2</span><span class="level-item">4.3.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#4-3-3-解题脚本"><span class="level-left"><span class="level-item">5.3.3</span><span class="level-item">4.3.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#4-4-RSA3"><span class="level-left"><span class="level-item">5.4</span><span class="level-item">4.4 RSA3</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-4-1-题目"><span class="level-left"><span class="level-item">5.4.1</span><span class="level-item">4.4.1 题目</span></span></a></li><li><a class="level is-mobile" href="#4-4-2-解题思路"><span class="level-left"><span class="level-item">5.4.2</span><span class="level-item">4.4.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#4-4-3-解题脚本"><span class="level-left"><span class="level-item">5.4.3</span><span class="level-item">4.4.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#4-5-RSA2"><span class="level-left"><span class="level-item">5.5</span><span class="level-item">4.5 RSA2</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-5-1-题目"><span class="level-left"><span class="level-item">5.5.1</span><span class="level-item">4.5.1 题目</span></span></a></li><li><a class="level is-mobile" href="#4-5-2-解题思路"><span class="level-left"><span class="level-item">5.5.2</span><span class="level-item">4.5.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#4-5-3-解题脚本"><span class="level-left"><span class="level-item">5.5.3</span><span class="level-item">4.5.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#4-6-RSA"><span class="level-left"><span class="level-item">5.6</span><span class="level-item">4.6 RSA</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-6-1-题目"><span class="level-left"><span class="level-item">5.6.1</span><span class="level-item">4.6.1 题目</span></span></a></li><li><a class="level is-mobile" href="#4-6-2-解题思路"><span class="level-left"><span class="level-item">5.6.2</span><span class="level-item">4.6.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#4-6-3-解题脚本"><span class="level-left"><span class="level-item">5.6.3</span><span class="level-item">4.6.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#4-7-RSAROLL"><span class="level-left"><span class="level-item">5.7</span><span class="level-item">4.7 RSAROLL</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-7-1-题目"><span class="level-left"><span class="level-item">5.7.1</span><span class="level-item">4.7.1 题目</span></span></a></li><li><a class="level is-mobile" href="#4-7-2-解题思路"><span class="level-left"><span class="level-item">5.7.2</span><span class="level-item">4.7.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#4-7-3-解题脚本"><span class="level-left"><span class="level-item">5.7.3</span><span class="level-item">4.7.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#4-8-Dangerous-RSA"><span class="level-left"><span class="level-item">5.8</span><span class="level-item">4.8 Dangerous RSA</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-8-1-题目"><span class="level-left"><span class="level-item">5.8.1</span><span class="level-item">4.8.1 题目</span></span></a></li><li><a class="level is-mobile" href="#4-8-2-解题思路"><span class="level-left"><span class="level-item">5.8.2</span><span class="level-item">4.8.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#4-8-3-解题脚本"><span class="level-left"><span class="level-item">5.8.3</span><span class="level-item">4.8.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#4-9-HDCTF2019-basic-rsa"><span class="level-left"><span class="level-item">5.9</span><span class="level-item">4.9 [HDCTF2019]basic rsa</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-9-1-题目"><span class="level-left"><span class="level-item">5.9.1</span><span class="level-item">4.9.1 题目</span></span></a></li><li><a class="level is-mobile" href="#4-9-2-解题思路"><span class="level-left"><span class="level-item">5.9.2</span><span class="level-item">4.9.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#4-9-3-解题脚本"><span class="level-left"><span class="level-item">5.9.3</span><span class="level-item">4.9.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#4-10-GUET-CTF2019-BabyRSA"><span class="level-left"><span class="level-item">5.10</span><span class="level-item">4.10 [GUET-CTF2019]BabyRSA</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-10-1-题目"><span class="level-left"><span class="level-item">5.10.1</span><span class="level-item">4.10.1 题目</span></span></a></li><li><a class="level is-mobile" href="#4-10-2-解题思路"><span class="level-left"><span class="level-item">5.10.2</span><span class="level-item">4.10.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#4-10-3-解题脚本"><span class="level-left"><span class="level-item">5.10.3</span><span class="level-item">4.10.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#4-11-rsa2"><span class="level-left"><span class="level-item">5.11</span><span class="level-item">4.11 rsa2</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-11-1-题目"><span class="level-left"><span class="level-item">5.11.1</span><span class="level-item">4.11.1 题目</span></span></a></li><li><a class="level is-mobile" href="#4-11-2-解题思路"><span class="level-left"><span class="level-item">5.11.2</span><span class="level-item">4.11.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#4-11-3-解题脚本"><span class="level-left"><span class="level-item">5.11.3</span><span class="level-item">4.11.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#4-12-RSA5"><span class="level-left"><span class="level-item">5.12</span><span class="level-item">4.12 RSA5</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-12-1-题目"><span class="level-left"><span class="level-item">5.12.1</span><span class="level-item">4.12.1 题目</span></span></a></li><li><a class="level is-mobile" href="#4-12-2-解题思路"><span class="level-left"><span class="level-item">5.12.2</span><span class="level-item">4.12.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#4-12-3-解题脚本"><span class="level-left"><span class="level-item">5.12.3</span><span class="level-item">4.12.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#4-13-NCTF2019-childRSA"><span class="level-left"><span class="level-item">5.13</span><span class="level-item">4.13 [NCTF2019]childRSA</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-13-1-题目"><span class="level-left"><span class="level-item">5.13.1</span><span class="level-item">4.13.1 题目</span></span></a></li><li><a class="level is-mobile" href="#4-13-2-解题思路"><span class="level-left"><span class="level-item">5.13.2</span><span class="level-item">4.13.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#4-13-3-解题脚本"><span class="level-left"><span class="level-item">5.13.3</span><span class="level-item">4.13.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#4-14-HDCTF2019-bbbbbbrsa"><span class="level-left"><span class="level-item">5.14</span><span class="level-item">4.14 [HDCTF2019]bbbbbbrsa</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-14-1-题目"><span class="level-left"><span class="level-item">5.14.1</span><span class="level-item">4.14.1 题目</span></span></a></li><li><a class="level is-mobile" href="#4-14-2-解题思路"><span class="level-left"><span class="level-item">5.14.2</span><span class="level-item">4.14.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#4-14-3-解题脚本"><span class="level-left"><span class="level-item">5.14.3</span><span class="level-item">4.14.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#4-15-BJDCTF2020-RSA4"><span class="level-left"><span class="level-item">5.15</span><span class="level-item">4.15 [BJDCTF2020]RSA4</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-15-1-题目"><span class="level-left"><span class="level-item">5.15.1</span><span class="level-item">4.15.1 题目</span></span></a></li><li><a class="level is-mobile" href="#4-15-2-解题思路"><span class="level-left"><span class="level-item">5.15.2</span><span class="level-item">4.15.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#4-15-3-解题脚本"><span class="level-left"><span class="level-item">5.15.3</span><span class="level-item">4.15.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#4-16-BJDCTF2020-rsa-output"><span class="level-left"><span class="level-item">5.16</span><span class="level-item">4.16 [BJDCTF2020]rsa_output</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-16-1-题目"><span class="level-left"><span class="level-item">5.16.1</span><span class="level-item">4.16.1 题目</span></span></a></li><li><a class="level is-mobile" href="#4-16-2-解题思路"><span class="level-left"><span class="level-item">5.16.2</span><span class="level-item">4.16.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#4-16-3-解题脚本"><span class="level-left"><span class="level-item">5.16.3</span><span class="level-item">4.16.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#4-17-BJDCTF2020-RSA"><span class="level-left"><span class="level-item">5.17</span><span class="level-item">4.17 [BJDCTF2020]RSA</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-17-1-题目"><span class="level-left"><span class="level-item">5.17.1</span><span class="level-item">4.17.1 题目</span></span></a></li><li><a class="level is-mobile" href="#4-17-2-解题思路"><span class="level-left"><span class="level-item">5.17.2</span><span class="level-item">4.17.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#4-17-3-解题脚本"><span class="level-left"><span class="level-item">5.17.3</span><span class="level-item">4.17.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#4-18-WUSTCTF2020-babyrsa"><span class="level-left"><span class="level-item">5.18</span><span class="level-item">4.18 [WUSTCTF2020]babyrsa</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-18-1-题目"><span class="level-left"><span class="level-item">5.18.1</span><span class="level-item">4.18.1 题目</span></span></a></li><li><a class="level is-mobile" href="#4-18-2-解题思路"><span class="level-left"><span class="level-item">5.18.2</span><span class="level-item">4.18.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#4-18-3-解题脚本"><span class="level-left"><span class="level-item">5.18.3</span><span class="level-item">4.18.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#4-19-ACTF新生赛2020-crypto-rsa3"><span class="level-left"><span class="level-item">5.19</span><span class="level-item">4.19 [ACTF新生赛2020]crypto-rsa3</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-19-1-题目"><span class="level-left"><span class="level-item">5.19.1</span><span class="level-item">4.19.1 题目</span></span></a></li><li><a class="level is-mobile" href="#4-19-2-解题思路"><span class="level-left"><span class="level-item">5.19.2</span><span class="level-item">4.19.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#4-19-3-解题脚本"><span class="level-left"><span class="level-item">5.19.3</span><span class="level-item">4.19.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#4-20-GWCTF-2019-BabyRSA"><span class="level-left"><span class="level-item">5.20</span><span class="level-item">4.20 [GWCTF 2019]BabyRSA</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-20-1-题目"><span class="level-left"><span class="level-item">5.20.1</span><span class="level-item">4.20.1 题目</span></span></a></li><li><a class="level is-mobile" href="#4-20-2-解题思路"><span class="level-left"><span class="level-item">5.20.2</span><span class="level-item">4.20.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#4-20-3-解题脚本"><span class="level-left"><span class="level-item">5.20.3</span><span class="level-item">4.20.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#4-21-SameMod"><span class="level-left"><span class="level-item">5.21</span><span class="level-item">4.21 SameMod</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-21-1-题目"><span class="level-left"><span class="level-item">5.21.1</span><span class="level-item">4.21.1 题目</span></span></a></li><li><a class="level is-mobile" href="#4-21-2-解题思路"><span class="level-left"><span class="level-item">5.21.2</span><span class="level-item">4.21.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#4-21-3-解题脚本"><span class="level-left"><span class="level-item">5.21.3</span><span class="level-item">4.21.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#4-22-AFCTF2018-你能看出这是什么加密么"><span class="level-left"><span class="level-item">5.22</span><span class="level-item">4.22 [AFCTF2018]你能看出这是什么加密么</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-22-1-题目"><span class="level-left"><span class="level-item">5.22.1</span><span class="level-item">4.22.1 题目</span></span></a></li><li><a class="level is-mobile" href="#4-22-2-解题思路"><span class="level-left"><span class="level-item">5.22.2</span><span class="level-item">4.22.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#4-22-3-解题脚本"><span class="level-left"><span class="level-item">5.22.3</span><span class="level-item">4.22.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#4-23-NCTF2019-babyRSA"><span class="level-left"><span class="level-item">5.23</span><span class="level-item">4.23 [NCTF2019]babyRSA</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-23-1-题目"><span class="level-left"><span class="level-item">5.23.1</span><span class="level-item">4.23.1 题目</span></span></a></li><li><a class="level is-mobile" href="#4-23-2-解题思路"><span class="level-left"><span class="level-item">5.23.2</span><span class="level-item">4.23.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#4-23-3-解题脚本"><span class="level-left"><span class="level-item">5.23.3</span><span class="level-item">4.23.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#4-24-AFCTF2018-可怜的RSA"><span class="level-left"><span class="level-item">5.24</span><span class="level-item">4.24 [AFCTF2018]可怜的RSA</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-24-1-题目"><span class="level-left"><span class="level-item">5.24.1</span><span class="level-item">4.24.1 题目</span></span></a></li><li><a class="level is-mobile" href="#4-24-2-解题思路"><span class="level-left"><span class="level-item">5.24.2</span><span class="level-item">4.24.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#4-24-3-解题脚本"><span class="level-left"><span class="level-item">5.24.3</span><span class="level-item">4.24.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#4-25-网鼎杯-2020-青龙组-you-raise-me-up"><span class="level-left"><span class="level-item">5.25</span><span class="level-item">4.25 [网鼎杯 2020 青龙组]you_raise_me_up</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-25-1-题目"><span class="level-left"><span class="level-item">5.25.1</span><span class="level-item">4.25.1 题目</span></span></a></li><li><a class="level is-mobile" href="#4-25-2-解题思路"><span class="level-left"><span class="level-item">5.25.2</span><span class="level-item">4.25.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#4-25-3-解题脚本"><span class="level-left"><span class="level-item">5.25.3</span><span class="level-item">4.25.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#4-26-RSA-what"><span class="level-left"><span class="level-item">5.26</span><span class="level-item">4.26 RSA &amp; what</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-26-1-题目"><span class="level-left"><span class="level-item">5.26.1</span><span class="level-item">4.26.1 题目</span></span></a></li><li><a class="level is-mobile" href="#4-26-2-解题思路"><span class="level-left"><span class="level-item">5.26.2</span><span class="level-item">4.26.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#4-26-3-解题脚本"><span class="level-left"><span class="level-item">5.26.3</span><span class="level-item">4.26.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#4-27-NPUCTF2020-EzRSA"><span class="level-left"><span class="level-item">5.27</span><span class="level-item">4.27 [NPUCTF2020]EzRSA</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-27-1-题目"><span class="level-left"><span class="level-item">5.27.1</span><span class="level-item">4.27.1 题目</span></span></a></li><li><a class="level is-mobile" href="#4-27-2-解题思路"><span class="level-left"><span class="level-item">5.27.2</span><span class="level-item">4.27.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#4-27-3-解题脚本"><span class="level-left"><span class="level-item">5.27.3</span><span class="level-item">4.27.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#4-28-MRCTF2020-babyRSA"><span class="level-left"><span class="level-item">5.28</span><span class="level-item">4.28 [MRCTF2020]babyRSA</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-28-1-题目"><span class="level-left"><span class="level-item">5.28.1</span><span class="level-item">4.28.1 题目</span></span></a></li><li><a class="level is-mobile" href="#4-28-2-解题思路"><span class="level-left"><span class="level-item">5.28.2</span><span class="level-item">4.28.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#4-28-3-解题脚本"><span class="level-left"><span class="level-item">5.28.3</span><span class="level-item">4.28.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#4-29-WUSTCTF2020-情书"><span class="level-left"><span class="level-item">5.29</span><span class="level-item">4.29 [WUSTCTF2020]情书</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-29-1-题目"><span class="level-left"><span class="level-item">5.29.1</span><span class="level-item">4.29.1 题目</span></span></a></li><li><a class="level is-mobile" href="#4-29-2-解题思路"><span class="level-left"><span class="level-item">5.29.2</span><span class="level-item">4.29.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#4-29-3-解题脚本"><span class="level-left"><span class="level-item">5.29.3</span><span class="level-item">4.29.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#4-30-WUSTCTF2020-dp-leaking-1s-very-d-angerous"><span class="level-left"><span class="level-item">5.30</span><span class="level-item">4.30 [WUSTCTF2020]dp_leaking_1s_very_d@angerous</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-30-1-题目"><span class="level-left"><span class="level-item">5.30.1</span><span class="level-item">4.30.1 题目</span></span></a></li><li><a class="level is-mobile" href="#4-30-2-解题思路"><span class="level-left"><span class="level-item">5.30.2</span><span class="level-item">4.30.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#4-30-3-解题脚本"><span class="level-left"><span class="level-item">5.30.3</span><span class="level-item">4.30.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#4-31-MRCTF2020-Easy-RSA"><span class="level-left"><span class="level-item">5.31</span><span class="level-item">4.31 [MRCTF2020]Easy_RSA</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-31-1-题目"><span class="level-left"><span class="level-item">5.31.1</span><span class="level-item">4.31.1 题目</span></span></a></li><li><a class="level is-mobile" href="#4-31-2-解题思路"><span class="level-left"><span class="level-item">5.31.2</span><span class="level-item">4.31.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#4-31-3-解题脚本"><span class="level-left"><span class="level-item">5.31.3</span><span class="level-item">4.31.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#4-32-HDCTF2019-together"><span class="level-left"><span class="level-item">5.32</span><span class="level-item">4.32 [HDCTF2019]together</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-32-1-题目"><span class="level-left"><span class="level-item">5.32.1</span><span class="level-item">4.32.1 题目</span></span></a></li><li><a class="level is-mobile" href="#4-32-2-解题思路"><span class="level-left"><span class="level-item">5.32.2</span><span class="level-item">4.32.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#4-32-3-解题脚本"><span class="level-left"><span class="level-item">5.32.3</span><span class="level-item">4.32.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#4-33-INSHack2017-rsa16m"><span class="level-left"><span class="level-item">5.33</span><span class="level-item">4.33 [INSHack2017]rsa16m</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-33-1-题目"><span class="level-left"><span class="level-item">5.33.1</span><span class="level-item">4.33.1 题目</span></span></a></li><li><a class="level is-mobile" href="#4-33-2-解题思路"><span class="level-left"><span class="level-item">5.33.2</span><span class="level-item">4.33.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#4-33-3-解题脚本"><span class="level-left"><span class="level-item">5.33.3</span><span class="level-item">4.33.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#4-34-坏蛋是雷宾"><span class="level-left"><span class="level-item">5.34</span><span class="level-item">4.34 坏蛋是雷宾</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-34-1-题目"><span class="level-left"><span class="level-item">5.34.1</span><span class="level-item">4.34.1 题目</span></span></a></li><li><a class="level is-mobile" href="#4-34-2-解题思路"><span class="level-left"><span class="level-item">5.34.2</span><span class="level-item">4.34.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#4-34-3-解题脚本"><span class="level-left"><span class="level-item">5.34.3</span><span class="level-item">4.34.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#4-35-INSHack2019-Yet-Another-RSA-Challenge-Part-1"><span class="level-left"><span class="level-item">5.35</span><span class="level-item">4.35 [INSHack2019]Yet Another RSA Challenge - Part 1</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-35-1-题目"><span class="level-left"><span class="level-item">5.35.1</span><span class="level-item">4.35.1 题目</span></span></a></li><li><a class="level is-mobile" href="#4-35-2-解题思路"><span class="level-left"><span class="level-item">5.35.2</span><span class="level-item">4.35.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#4-35-3-解题脚本"><span class="level-left"><span class="level-item">5.35.3</span><span class="level-item">4.35.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#4-36-RoarCTF2019-RSA"><span class="level-left"><span class="level-item">5.36</span><span class="level-item">4.36 [RoarCTF2019]RSA</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-36-1-题目"><span class="level-left"><span class="level-item">5.36.1</span><span class="level-item">4.36.1 题目</span></span></a></li><li><a class="level is-mobile" href="#4-36-2-解题思路"><span class="level-left"><span class="level-item">5.36.2</span><span class="level-item">4.36.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#4-36-3-解题脚本"><span class="level-left"><span class="level-item">5.36.3</span><span class="level-item">4.36.3 解题脚本</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="#5-哈希与消息认证"><span class="level-left"><span class="level-item">6</span><span class="level-item">5. 哈希与消息认证</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#5-1-MD5"><span class="level-left"><span class="level-item">6.1</span><span class="level-item">5.1 MD5</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#5-1-1-题目"><span class="level-left"><span class="level-item">6.1.1</span><span class="level-item">5.1.1 题目</span></span></a></li><li><a class="level is-mobile" href="#5-1-2-解题思路"><span class="level-left"><span class="level-item">6.1.2</span><span class="level-item">5.1.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#5-1-3-解题脚本"><span class="level-left"><span class="level-item">6.1.3</span><span class="level-item">5.1.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#5-2-丢失的MD5"><span class="level-left"><span class="level-item">6.2</span><span class="level-item">5.2 丢失的MD5</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#5-2-1-题目"><span class="level-left"><span class="level-item">6.2.1</span><span class="level-item">5.2.1 题目</span></span></a></li><li><a class="level is-mobile" href="#5-2-2-解题思路"><span class="level-left"><span class="level-item">6.2.2</span><span class="level-item">5.2.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#5-2-3-解题脚本"><span class="level-left"><span class="level-item">6.2.3</span><span class="level-item">5.2.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#5-3-Windows系统密码"><span class="level-left"><span class="level-item">6.3</span><span class="level-item">5.3 Windows系统密码</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#5-3-1-题目"><span class="level-left"><span class="level-item">6.3.1</span><span class="level-item">5.3.1 题目</span></span></a></li><li><a class="level is-mobile" href="#5-3-2-解题思路"><span class="level-left"><span class="level-item">6.3.2</span><span class="level-item">5.3.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#5-3-3-解题脚本"><span class="level-left"><span class="level-item">6.3.3</span><span class="level-item">5.3.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#5-4-权限获得第一步"><span class="level-left"><span class="level-item">6.4</span><span class="level-item">5.4 权限获得第一步</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#5-4-1-题目"><span class="level-left"><span class="level-item">6.4.1</span><span class="level-item">5.4.1 题目</span></span></a></li><li><a class="level is-mobile" href="#5-4-2-解题思路"><span class="level-left"><span class="level-item">6.4.2</span><span class="level-item">5.4.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#5-4-3-解题脚本"><span class="level-left"><span class="level-item">6.4.3</span><span class="level-item">5.4.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#5-5-还原大师"><span class="level-left"><span class="level-item">6.5</span><span class="level-item">5.5 还原大师</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#5-5-1-题目"><span class="level-left"><span class="level-item">6.5.1</span><span class="level-item">5.5.1 题目</span></span></a></li><li><a class="level is-mobile" href="#5-5-2-解题思路"><span class="level-left"><span class="level-item">6.5.2</span><span class="level-item">5.5.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#5-5-3-解题脚本"><span class="level-left"><span class="level-item">6.5.3</span><span class="level-item">5.5.3 解题脚本</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="#6-应用密码学"><span class="level-left"><span class="level-item">7</span><span class="level-item">6. 应用密码学</span></span></a></li><li><a class="level is-mobile" href="#7-自定义构造题"><span class="level-left"><span class="level-item">8</span><span class="level-item">7. 自定义构造题</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#7-1-Alice与Bob"><span class="level-left"><span class="level-item">8.1</span><span class="level-item">7.1 Alice与Bob</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#7-1-1-题目"><span class="level-left"><span class="level-item">8.1.1</span><span class="level-item">7.1.1 题目</span></span></a></li><li><a class="level is-mobile" href="#7-1-2-解题思路"><span class="level-left"><span class="level-item">8.1.2</span><span class="level-item">7.1.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#7-1-3-解题脚本"><span class="level-left"><span class="level-item">8.1.3</span><span class="level-item">7.1.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#7-2-达芬奇密码"><span class="level-left"><span class="level-item">8.2</span><span class="level-item">7.2 达芬奇密码</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#7-2-1-题目"><span class="level-left"><span class="level-item">8.2.1</span><span class="level-item">7.2.1 题目</span></span></a></li><li><a class="level is-mobile" href="#7-2-2-解题思路"><span class="level-left"><span class="level-item">8.2.2</span><span class="level-item">7.2.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#7-2-3-解题脚本"><span class="level-left"><span class="level-item">8.2.3</span><span class="level-item">7.2.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#7-3-BJDCTF2020-easyrsa"><span class="level-left"><span class="level-item">8.3</span><span class="level-item">7.3 [BJDCTF2020]easyrsa</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#7-3-1-题目"><span class="level-left"><span class="level-item">8.3.1</span><span class="level-item">7.3.1 题目</span></span></a></li><li><a class="level is-mobile" href="#7-3-2-解题思路"><span class="level-left"><span class="level-item">8.3.2</span><span class="level-item">7.3.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#7-3-3-解题脚本"><span class="level-left"><span class="level-item">8.3.3</span><span class="level-item">7.3.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#7-4-网鼎杯-2020-青龙组-boom"><span class="level-left"><span class="level-item">8.4</span><span class="level-item">7.4 [网鼎杯 2020 青龙组]boom</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#7-4-1-题目"><span class="level-left"><span class="level-item">8.4.1</span><span class="level-item">7.4.1 题目</span></span></a></li><li><a class="level is-mobile" href="#7-4-2-解题思路"><span class="level-left"><span class="level-item">8.4.2</span><span class="level-item">7.4.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#7-4-3-解题脚本"><span class="level-left"><span class="level-item">8.4.3</span><span class="level-item">7.4.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#7-5-RoarCTF2019-babyRSA"><span class="level-left"><span class="level-item">8.5</span><span class="level-item">7.5 [RoarCTF2019]babyRSA</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#7-5-1-题目"><span class="level-left"><span class="level-item">8.5.1</span><span class="level-item">7.5.1 题目</span></span></a></li><li><a class="level is-mobile" href="#7-5-2-解题思路"><span class="level-left"><span class="level-item">8.5.2</span><span class="level-item">7.5.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#7-5-3-解题脚本"><span class="level-left"><span class="level-item">8.5.3</span><span class="level-item">7.5.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#7-6-WUSTCTF2020-大数计算"><span class="level-left"><span class="level-item">8.6</span><span class="level-item">7.6 [WUSTCTF2020]大数计算</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#7-6-1-题目"><span class="level-left"><span class="level-item">8.6.1</span><span class="level-item">7.6.1 题目</span></span></a></li><li><a class="level is-mobile" href="#7-6-2-解题思路"><span class="level-left"><span class="level-item">8.6.2</span><span class="level-item">7.6.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#7-6-3-解题脚本"><span class="level-left"><span class="level-item">8.6.3</span><span class="level-item">7.6.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#7-7-救世捷径"><span class="level-left"><span class="level-item">8.7</span><span class="level-item">7.7 救世捷径</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#7-7-1-题目"><span class="level-left"><span class="level-item">8.7.1</span><span class="level-item">7.7.1 题目</span></span></a></li><li><a class="level is-mobile" href="#7-7-2-解题思路"><span class="level-left"><span class="level-item">8.7.2</span><span class="level-item">7.7.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#7-7-3-解题脚本"><span class="level-left"><span class="level-item">8.7.3</span><span class="level-item">7.7.3 解题脚本</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="#8-信息隐藏与隐写术"><span class="level-left"><span class="level-item">9</span><span class="level-item">8. 信息隐藏与隐写术</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#8-1-password"><span class="level-left"><span class="level-item">9.1</span><span class="level-item">8.1 password</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#8-1-1-题目"><span class="level-left"><span class="level-item">9.1.1</span><span class="level-item">8.1.1 题目</span></span></a></li><li><a class="level is-mobile" href="#8-1-2-解题思路"><span class="level-left"><span class="level-item">9.1.2</span><span class="level-item">8.1.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#8-1-3-解题脚本"><span class="level-left"><span class="level-item">9.1.3</span><span class="level-item">8.1.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#8-2-NPUCTF2020-这是什么觅🐎"><span class="level-left"><span class="level-item">9.2</span><span class="level-item">8.2 [NPUCTF2020]这是什么觅🐎</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#8-2-1-题目"><span class="level-left"><span class="level-item">9.2.1</span><span class="level-item">8.2.1 题目</span></span></a></li><li><a class="level is-mobile" href="#8-2-2-解题思路"><span class="level-left"><span class="level-item">9.2.2</span><span class="level-item">8.2.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#8-2-3-解题脚本"><span class="level-left"><span class="level-item">9.2.3</span><span class="level-item">8.2.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#8-3-ACTF新生赛2020-crypto-classic0"><span class="level-left"><span class="level-item">9.3</span><span class="level-item">8.3 [ACTF新生赛2020]crypto-classic0</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#8-3-1-题目"><span class="level-left"><span class="level-item">9.3.1</span><span class="level-item">8.3.1 题目</span></span></a></li><li><a class="level is-mobile" href="#8-3-2-解题思路"><span class="level-left"><span class="level-item">9.3.2</span><span class="level-item">8.3.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#8-3-3-解题脚本"><span class="level-left"><span class="level-item">9.3.3</span><span class="level-item">8.3.3 解题脚本</span></span></a></li></ul></li><li><a class="level is-mobile" href="#8-4-ACTF新生赛2020-crypto-rsa0"><span class="level-left"><span class="level-item">9.4</span><span class="level-item">8.4 [ACTF新生赛2020]crypto-rsa0</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#8-4-1-题目"><span class="level-left"><span class="level-item">9.4.1</span><span class="level-item">8.4.1 题目</span></span></a></li><li><a class="level is-mobile" href="#8-4-2-解题思路"><span class="level-left"><span class="level-item">9.4.2</span><span class="level-item">8.4.2 解题思路</span></span></a></li><li><a class="level is-mobile" href="#8-4-3-解题脚本"><span class="level-left"><span class="level-item">9.4.3</span><span class="level-item">8.4.3 解题脚本</span></span></a></li></ul></li></ul></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><figure class="media-left"><a class="image" href="/2025/07/14/graph_sub/"><img src="https://dstbp.com/data/imgs/posts/GSC/Thumbnail.png" alt="[古典密码] 图像替换密码"></a></figure><div class="media-content"><p class="date"><time dateTime="2025-07-14T04:30:00.000Z">2025-07-14</time></p><p class="title"><a href="/2025/07/14/graph_sub/">[古典密码] 图像替换密码</a></p><p class="categories"><a href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/">密码学</a> / <a href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81/">古典密码</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2025/05/14/lzw/"><img src="https://dstbp.com/data/imgs/posts/lzw/Thumbnail.png" alt="[信息编码] LZW 压缩算法"></a></figure><div class="media-content"><p class="date"><time dateTime="2025-05-14T07:10:43.000Z">2025-05-14</time></p><p class="title"><a href="/2025/05/14/lzw/">[信息编码] LZW 压缩算法</a></p><p class="categories"><a href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/">密码学</a> / <a href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/%E4%BF%A1%E6%81%AF%E7%BC%96%E7%A0%81/">信息编码</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2024/02/01/buuctf1/"><img src="https://dstbp.com/data/imgs/posts/buuctf/Thumbnail.png" alt="[日常训练] Crypto Training - BUUCTF（一）"></a></figure><div class="media-content"><p class="date"><time dateTime="2024-02-01T00:10:43.000Z">2024-02-01</time></p><p class="title"><a href="/2024/02/01/buuctf1/">[日常训练] Crypto Training - BUUCTF（一）</a></p><p class="categories"><a href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/">密码学</a> / <a href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/%E6%97%A5%E5%B8%B8%E8%AE%AD%E7%BB%83/">日常训练</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-12-31T16:00:00.000Z">2024-01-01</time></p><p class="title"><a href="/2024/01/01/hello-world/">欢迎来到「微澜尘寰的雾岛」</a></p></div></article></div></div><div class="card widget" id="twikoo-new"><div class="card-content"><div class="menu"><h3 class="menu-label">最新评论</h3><script>window.twikooEnvId = 'https://twikoo.dstbp.com';</script><div class="twikoo-new-container"></div></div></div></div></div><style>.column.column-left,.column.column-right{display:block}</style></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img class="logo-img" src="/images/logo.jpg" alt="DSTBP Blog" height="28"><img class="logo-img-dark" src="/images/logo-dark.jpg" alt="DSTBP Blog" height="28"></a><p class="is-size-7"><span>&copy; 2025 DSTBP</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/imaegoo/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">总访问量&nbsp;<span id="busuanzi_value_site_pv">-</span>&nbsp;次&nbsp;&nbsp;总访客数&nbsp;<span id="busuanzi_value_site_uv">-</span>&nbsp;人</span></p><p class="is-size-7">版权说明：本网站所有内容版权归属 DSTBP，仅限网友与自己学习交流，如有侵权，请<a href="/message" target="_blank" rel="noreferrer noopener">留言</a>，管理员立即处理<br/><a href="https://beian.miit.gov.cn" target="_blank" rel="noreferrer noopener">萌 ICP 备 20211214 号-8</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/deed.zh"><i class="fab fa-creative-commons-by"></i></a></p></div></div></div></div></footer><script src="/js/imaegoo/instant.page/5.1.1/instantpage.min.js" type="module"></script><script src="/js/imaegoo/jquery/3.3.1/dist/jquery.min.js"></script><script src="/js/imaegoo/moment/2.22.2/min/moment-with-locales.min.js"></script><script src="/js/imaegoo/twikoo/1.6.41/twikoo.min.js"></script><script src="/js/imaegoo/clipboard/2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'folded'
                }
            }
        };</script><script data-pjax src="/js/column.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/js/back_to_top.js" defer></script><!--!--><!--!--><script src="/js/imaegoo/lightgallery/1.10.0/dist/js/lightgallery.min.js" defer></script><script src="/js/imaegoo/justifiedGallery/3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/javascript" id="MathJax-script" async>MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      },
      chtml: {
        matchFontHeight: false
      }
    };</script><script src="/js/imaegoo/mathjax/3.2.2/es5/tex-mml-chtml.js"></script><script src="/js/imaegoo/cookieconsent/3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-right",
        content: {
          message: "此网站使用 Cookie，以启用评论系统和分析功能。",
          dismiss: "知道了",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "/cookies/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script data-pjax src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><div class="searchbox-pinyin"><label class="checkbox"><input id="search-by-pinyin" type="checkbox" checked="checked"><span> 拼音检索</span></label></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/imaegoo/pinyin.js" defer></script><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script><script type="text/javascript" src="/js/imaegoo/imaegoo.js"></script><script type="text/javascript" src="/js/imaegoo/universe.js"></script></body></html>