<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>[古典密码] 单表替换密码 - DSTBP Blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="DSTBP Blog"><meta name="msapplication-TileImage" content="/images/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="DSTBP Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="序言假设你正置身 16 世纪的大航海时代，商队凭借英法两国间的羊毛贸易往来日进斗金。信使的船帆在英吉利海峡上来回穿梭，帆布上的家族纹章曾是你最引以为傲的标志 —— 直到阴影悄然笼罩。最近三封关于羊毛贸易的明文信件都被竞争对手破译，导致两次货运路线被抢，损失惨重。你深知，再用明文传递信息，无异于将商业机密拱手让人。 这日，你坐在伦敦商会的橡木桌前，指尖划过一封刚写好的信：“下月初三，携佛兰德斯羊毛至"><meta property="og:type" content="article"><meta property="og:title" content="[古典密码] 单表替换密码"><meta property="og:url" content="http://dstbp.com/2025/07/30/msc/"><meta property="og:site_name" content="DSTBP Blog"><meta property="og:description" content="序言假设你正置身 16 世纪的大航海时代，商队凭借英法两国间的羊毛贸易往来日进斗金。信使的船帆在英吉利海峡上来回穿梭，帆布上的家族纹章曾是你最引以为傲的标志 —— 直到阴影悄然笼罩。最近三封关于羊毛贸易的明文信件都被竞争对手破译，导致两次货运路线被抢，损失惨重。你深知，再用明文传递信息，无异于将商业机密拱手让人。 这日，你坐在伦敦商会的橡木桌前，指尖划过一封刚写好的信：“下月初三，携佛兰德斯羊毛至"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://dstbp.com/data/imgs/posts/msc/Thumbnail.png"><meta property="article:published_time" content="2025-07-30T11:58:43.000Z"><meta property="article:modified_time" content="2025-08-09T11:10:32.460Z"><meta property="article:author" content="DSTBP"><meta property="article:tag" content="密码学"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://dstbp.com/data/imgs/posts/msc/Thumbnail.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://dstbp.com/2025/07/30/msc/"},"headline":"[古典密码] 单表替换密码","image":["https://dstbp.com/data/imgs/posts/msc/Thumbnail.png"],"datePublished":"2025-07-30T11:58:43.000Z","dateModified":"2025-08-09T11:10:32.460Z","author":{"@type":"Person","name":"DSTBP"},"publisher":{"@type":"Organization","name":"DSTBP Blog","logo":{"@type":"ImageObject","url":{"light":"/images/logo.jpg","dark":"/images/logo-dark.jpg"}}},"description":"序言假设你正置身 16 世纪的大航海时代，商队凭借英法两国间的羊毛贸易往来日进斗金。信使的船帆在英吉利海峡上来回穿梭，帆布上的家族纹章曾是你最引以为傲的标志 —— 直到阴影悄然笼罩。最近三封关于羊毛贸易的明文信件都被竞争对手破译，导致两次货运路线被抢，损失惨重。你深知，再用明文传递信息，无异于将商业机密拱手让人。 这日，你坐在伦敦商会的橡木桌前，指尖划过一封刚写好的信：“下月初三，携佛兰德斯羊毛至"}</script><link rel="canonical" href="http://dstbp.com/2025/07/30/msc/"><link rel="alternate" href="/atom.xml" title="DSTBP Blog" type="application/atom+xml"><link rel="icon" href="/images/favicon.svg"><link rel="stylesheet" href="/css/font/fontawesome/css/all.min.css"><link data-pjax rel="stylesheet" href="/js/imaegoo/highlight.js/11.7.0/styles/atom-one-light.css"><link data-pjax rel="stylesheet" href="/css/default.css"><!--!--><!--!--><script src="https://vercount.one/js" defer></script><link rel="stylesheet" href="/js/imaegoo/lightgallery/1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="/js/imaegoo/justifiedGallery/3.8.1/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=G-K9WLQN9BFY" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'G-K9WLQN9BFY');</script><!--!--><!--!--><link rel="stylesheet" href="/js/imaegoo/cookieconsent/3.1.1/build/cookieconsent.min.css"><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body class="is-3-column"><script type="text/javascript" src="/js/imaegoo/night.js"></script><canvas id="universe"></canvas><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img class="logo-img" src="/images/logo.jpg" alt="DSTBP Blog" height="28"><img class="logo-img-dark" src="/images/logo-dark.jpg" alt="DSTBP Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">首页</a><a class="navbar-item" href="/archives/">时间轴</a><a class="navbar-item" href="/categories/">分类</a><a class="navbar-item" href="/tags/">标签</a><a class="navbar-item" href="/messages/">留言板</a><a class="navbar-item" href="/friends/">友链</a><a class="navbar-item" href="/about/">关于</a></div><div class="navbar-end"><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i><span>  目录</span></a><a class="navbar-item night" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><i class="fas fa-thumbtack level-item" title="Pinned"></i><span class="level-item"><time dateTime="2025-07-30T11:58:43.000Z" title="2025/7/30 19:58:43">2025-07-30</time>发表</span><span class="level-item"><time dateTime="2025-08-09T11:10:32.460Z" title="2025/8/9 19:10:32">2025-08-09</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/">密码学</a><span> / </span><a class="link-muted" href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81/">古典密码</a></span><span class="level-item">2 小时读完 (大约14613个字)</span><span class="level-item leancloud_visitors" id="/2025/07/30/msc/" data-flag-title="[古典密码] 单表替换密码"><i class="far fa-eye"></i>&nbsp;&nbsp;<span id="twikoo_visitors"><i class="fa fa-spinner fa-spin"></i></span>次访问</span></div></div><h1 class="title is-3 is-size-4-mobile">[古典密码] 单表替换密码</h1><div class="content"><h1 id="序言"><a href="#序言" class="headerlink" title="序言"></a><strong>序言</strong></h1><p>假设你正置身 16 世纪的大航海时代，商队凭借英法两国间的羊毛贸易往来日进斗金。信使的船帆在英吉利海峡上来回穿梭，帆布上的家族纹章曾是你最引以为傲的标志 —— 直到阴影悄然笼罩。最近三封关于羊毛贸易的明文信件都被竞争对手破译，导致两次货运路线被抢，损失惨重。你深知，再用明文传递信息，无异于将商业机密拱手让人。</p>
<p>这日，你坐在伦敦商会的橡木桌前，指尖划过一封刚写好的信：“下月初三，携佛兰德斯羊毛至多佛港，与约克公爵代理人交接，暗号‘红玫瑰’。” 窗外细雨绵绵，你却额头冒汗 —— 这封信若再被截获，不仅血本无归，恐怕还要背上“私通贵族”的罪名。</p>
<span id="more"></span>

<p>“必须让他们看不懂。”你咬着笔杆，目光扫过桌上的杂物：账本、印章、还有一卷上周从威尼斯商人手里换来的羊皮纸。你随手把它扯过来，展开时，朱砂画的字符在烛光下格外清晰 —— 是一列 A 到 Z 的拉丁字母。</p>
<p>“一个字母表？能做什么？”你眉头微蹙，该如何设计加密方式，让窥探者无计可施？雨还在下，敲得窗棂咚咚作响，像在催促一个答案。羊皮纸上的朱砂字母在烛光里明明灭灭，仿佛在等你给它们重新编排命运……</p>
<p>其实很容易想到用字母表中的其他字母替换信件中的明文，为每个字母寻找“替身”，A 替换成 M、B 替换成 N。使明文变成毫无意义的字符串。<strong>单表替换密码</strong>（Monoalphabetic Substitution Cipher）正是这样一种经典的加密方式，其核心在于：每个字母始终被替换为另一个唯一的字母，整个过程基于一个固定的替换表。由于替换是一一对应的，知道替换表就能轻松还原原文。接下来让我们使用单表替换密码对机密信件进行加密。</p>
<br>

<h1 id="1-ROT-密码"><a href="#1-ROT-密码" class="headerlink" title="1. ROT 密码"></a><strong>1. ROT 密码</strong></h1><p>既然是替换，就得有个确定的规则，不能随意替换，否则除你之外谁也看不懂，加密也就失去了意义。在罗马共和时期，尤利乌斯・凯撒（Julius Caesar）为保障军事信件的安全，想出了一套加密规则，以此与前线作战的将军们传递信息，防止被敌军截获后破译。他规定，明文中的所有字母都需在字母表上向后偏移 3 位，以此生成密文：A 替换为 D，B 替换为 E，依此类推；到了字母表末尾则循环衔接，X 变为 A，Y 变为 B，Z 变为 C。经此处理，原本表意清晰的明文便转化为外人难以解读的密文。</p>
<p>随着历史的推进，基于不同偏移量的单表替换密码陆续出现 —— 比如偏移量为 5 的 ROT5、偏移量为 13 的 ROT13 等。这类依靠固定偏移进行替换的规则，操作简单且易于推行。以如今的眼光看，它们的破解难度极低；但在当时，受限于技术条件，这种最基础、最简单的替换密码，曾是许多人难以攻克的信息屏障。</p>
<p>后世人们对这类基于固定偏移的单表替换密码加以系统整理，最终归纳出了 ROT 密码体系。<strong>ROT 密码</strong>（Rotate Cipher）是一种最经典的单表替换加密算法，将明文中的每个字母在字母表中按固定的偏移量向前或向后移动来加密文本。偏移量默认为正，表示向后（右）移动；偏移量为负，表示向前（左）移动。</p>
<p>按种类大致分为：ROT5、Caesar Cipher、ROT13、ROT18、ROT47</p>
<h2 id="1-1-ROT5"><a href="#1-1-ROT5" class="headerlink" title="1.1 ROT5"></a><strong>1.1 ROT5</strong></h2><h3 id="1-1-1-加解密原理"><a href="#1-1-1-加解密原理" class="headerlink" title="1.1.1 加解密原理"></a><strong>1.1.1 加解密原理</strong></h3><p>ROT5（rotate by 5 places）是一种只针对数字的编码方式，采用对 0–9 的循环偏移。每个数字<strong>向后</strong>移动 5 位，例如 0 编码为 5，1 编码为 6，以此类推，超过 9 后从 0 重新开始，形成一个 10 进制的循环替换。其他字符均保持不变。该加密方式具有自反性，即加密两次即可还原原文。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">明文数字表：0123456789</span><br><span class="line">密文数字表：<span class="number">5678901234</span></span><br></pre></td></tr></table></figure>

<p><strong>代码实现（python）</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ROT5Cipher</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ROT5密码加解密&quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_shift_char</span>(<span class="params">char, shift</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;对单个字符进行移位处理，非数字字符保持不变&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> char.isdigit():</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">str</span>((<span class="built_in">int</span>(char) + shift) % <span class="number">10</span>)</span><br><span class="line">        <span class="keyword">return</span> char</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">cls, plaintext</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;加密：数字字符加5取模10，其他字符不变&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([cls._shift_char(c, <span class="number">5</span>) <span class="keyword">for</span> c <span class="keyword">in</span> plaintext])</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">cls, ciphertext</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;解密：数字字符减5取模10，其他字符不变&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([cls._shift_char(c, -<span class="number">5</span>) <span class="keyword">for</span> c <span class="keyword">in</span> ciphertext])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    original = <span class="string">&quot;Hello, I am DSTBP! 123 456&quot;</span></span><br><span class="line">    encrypted = ROT5Cipher.encrypt(original)</span><br><span class="line">    decrypted = ROT5Cipher.decrypt(encrypted)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;原始文本: <span class="subst">&#123;original&#125;</span>\n加密后: <span class="subst">&#123;encrypted&#125;</span>\n解密后: <span class="subst">&#123;decrypted&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    原始文本: Hello, I am DSTBP! 123 456</span></span><br><span class="line"><span class="string">    加密后: Hello, I am DSTBP! 678 901</span></span><br><span class="line"><span class="string">    解密后: Hello, I am DSTBP! 123 456</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="1-2-ROT13"><a href="#1-2-ROT13" class="headerlink" title="1.2 ROT13"></a><strong>1.2 ROT13</strong></h2><h3 id="1-2-1-加解密原理"><a href="#1-2-1-加解密原理" class="headerlink" title="1.2.1 加解密原理"></a><strong>1.2.1 加解密原理</strong></h3><p>ROT13 只对字母进行加密。其偏移量为 13，例如 A 编码为 N，B 编码为 O，依此类推，超过范围后从头开始。非字母字符保持不变，且该加密方式也具有自反性。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">明文字母表：ABCDEFGHIJKLMNOPQRSTUVWXYZ abcdefghijklmnopqrstuvwxyz</span><br><span class="line">密文字母表：NOPQRSTUVWXYZABCDEFGHIJKLM nopqrstuvwxyzabcdefghijklm</span><br></pre></td></tr></table></figure>

<p><strong>代码实现（python）</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ROT13Cipher</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ROT13密码加解密&quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_shift_char</span>(<span class="params">char: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;对单个字符进行ROT13移位，非字母字符保持不变&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> char.isalpha():</span><br><span class="line">            <span class="keyword">return</span> char</span><br><span class="line">            </span><br><span class="line">        <span class="comment"># 确定字母的基准ASCII值（大写65，小写97）</span></span><br><span class="line">        base = <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) <span class="keyword">if</span> char.isupper() <span class="keyword">else</span> <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">        <span class="comment"># 计算移位后的值（加13和减13效果相同，因为26%13=0）</span></span><br><span class="line">        shifted = (<span class="built_in">ord</span>(char) - base + <span class="number">13</span>) % <span class="number">26</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">chr</span>(shifted + base)</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">transform</span>(<span class="params">cls, text: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;加密和解密统一方法（ROT13加密解密相同）&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(cls._shift_char(c) <span class="keyword">for</span> c <span class="keyword">in</span> text)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 保持接口一致性</span></span><br><span class="line">    encrypt = transform</span><br><span class="line">    decrypt = transform</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    original = <span class="string">&quot;Hello, I am DSTBP! 123 456&quot;</span></span><br><span class="line">    encrypted = ROT13Cipher.encrypt(original)</span><br><span class="line">    decrypted = ROT13Cipher.decrypt(encrypted)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;原始文本: <span class="subst">&#123;original&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;加密后: <span class="subst">&#123;encrypted&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;解密后: <span class="subst">&#123;decrypted&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    原始文本: Hello, I am DSTBP! 123 456</span></span><br><span class="line"><span class="string">    加密后: Uryyb, V nz QFGOC! 123 456</span></span><br><span class="line"><span class="string">    解密后: Hello, I am DSTBP! 123 456</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="1-3-凯撒密码"><a href="#1-3-凯撒密码" class="headerlink" title="1.3 凯撒密码"></a><strong>1.3 凯撒密码</strong></h2><h3 id="1-3-1-加解密原理"><a href="#1-3-1-加解密原理" class="headerlink" title="1.3.1 加解密原理"></a><strong>1.3.1 加解密原理</strong></h3><p>Caesar Cipher（凯撒密码）也是一种对字母进行加密的单表替换方法。它将每个字母在 A–Z 或 a–z 范围内循环向后偏移 3 位，非字母字符保持原样。解密时，只需将字母向前偏移 3 位即可还原原文。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">明文字母表：ABCDEFGHIJKLMNOPQRSTUVWXYZ</span><br><span class="line">密文字母表：DEFGHIJKLMNOPQRSTUVWXYZABC</span><br></pre></td></tr></table></figure>

<p><strong>代码实现（python）</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">CaesarCipher</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    凯撒密码加解密类</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_shift_char</span>(<span class="params">char: <span class="built_in">str</span>, offest: <span class="built_in">int</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;对单个字符进行指定偏移量的移位，非字母字符保持不变&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> char.isalpha():</span><br><span class="line">            <span class="keyword">return</span> char</span><br><span class="line">            </span><br><span class="line">        <span class="comment"># 确定字母的基准ASCII值（大写65，小写97）</span></span><br><span class="line">        base = <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) <span class="keyword">if</span> char.isupper() <span class="keyword">else</span> <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">        shifted = (<span class="built_in">ord</span>(char) - base + offest) % <span class="number">26</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">chr</span>(shifted + base)</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">cls, text: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;对文本进行加密&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(cls._shift_char(c, <span class="number">3</span>) <span class="keyword">for</span> c <span class="keyword">in</span> text)</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">cls, text: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;对文本进行解密&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(cls._shift_char(c, -<span class="number">3</span>) <span class="keyword">for</span> c <span class="keyword">in</span> text)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    original = <span class="string">&quot;Hello, I am DSTBP! 123 456&quot;</span></span><br><span class="line">    encrypted = CaesarCipher.encrypt(original)</span><br><span class="line">    decrypted = CaesarCipher.decrypt(encrypted)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;原始文本: <span class="subst">&#123;original&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;加密后: <span class="subst">&#123;encrypted&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;解密后: <span class="subst">&#123;decrypted&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    原始文本: Hello, I am DSTBP! 123 456</span></span><br><span class="line"><span class="string">    加密后: Khoor, L dp GVWES! 123 456</span></span><br><span class="line"><span class="string">    解密后: Hello, I am DSTBP! 123 456</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="1-4-ROT18"><a href="#1-4-ROT18" class="headerlink" title="1.4 ROT18"></a><strong>1.4 ROT18</strong></h2><h3 id="1-4-1-加解密原理"><a href="#1-4-1-加解密原理" class="headerlink" title="1.4.1 加解密原理"></a><strong>1.4.1 加解密原理</strong></h3><p>ROT18 其实是非标准加密，原本并不存在这一命名，仅为便于称呼而将这种组合称为 ROT18。它结合了 ROT13 和 ROT5：对字母执行 ROT13，对数字执行 ROT5。</p>
<p><strong>代码实现（python）</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ROT18Cipher</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ROT18密码加解密&quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_shift_char</span>(<span class="params">char</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;对单个字符进行ROT18处理：字母用ROT13，数字用ROT5，其他字符不变&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> char.isalpha():</span><br><span class="line">            <span class="comment"># 字母应用ROT13变换</span></span><br><span class="line">            base = <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) <span class="keyword">if</span> char.isupper() <span class="keyword">else</span> <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">            shifted = (<span class="built_in">ord</span>(char) - base + <span class="number">13</span>) % <span class="number">26</span></span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">chr</span>(shifted + base)</span><br><span class="line">        <span class="keyword">elif</span> char.isdigit():</span><br><span class="line">            <span class="comment"># 数字应用ROT5变换</span></span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">str</span>((<span class="built_in">int</span>(char) + <span class="number">5</span>) % <span class="number">10</span>)</span><br><span class="line">        <span class="comment"># 非字母数字字符保持不变</span></span><br><span class="line">        <span class="keyword">return</span> char</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">cls, plaintext</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;加密：对字母执行 ROT13，对数字执行 ROT5，其他字符不变&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([cls._shift_char(c) <span class="keyword">for</span> c <span class="keyword">in</span> plaintext])</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">cls, ciphertext</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;解密：ROT18加密解密相同，执行相同操作即可还原&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([cls._shift_char(c) <span class="keyword">for</span> c <span class="keyword">in</span> ciphertext])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    original = <span class="string">&quot;Hello, I am DSTBP! 123 456&quot;</span></span><br><span class="line">    encrypted = ROT18Cipher.encrypt(original)</span><br><span class="line">    decrypted = ROT18Cipher.decrypt(encrypted)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;原始文本: <span class="subst">&#123;original&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;加密后: <span class="subst">&#123;encrypted&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;解密后: <span class="subst">&#123;decrypted&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    原始文本: Hello, I am DSTBP! 123 456</span></span><br><span class="line"><span class="string">    加密后: Uryyb, V nz QFGOC! 678 901</span></span><br><span class="line"><span class="string">    解密后: Hello, I am DSTBP! 123 456</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>



<h2 id="1-5-ROT47"><a href="#1-5-ROT47" class="headerlink" title="1.5 ROT47"></a><strong>1.5 ROT47</strong></h2><h3 id="1-5-1-加解密原理"><a href="#1-5-1-加解密原理" class="headerlink" title="1.5.1 加解密原理"></a><strong>1.5.1 加解密原理</strong></h3><p>引入 ASCII 码，对数字、字母、常用符号进行加密，字符范围限定在 33 到 126 之间，并使用固定步长 47 进行替换。加密时，以当前字符的 ASCII 值为起点，<strong>向后</strong>数第 47 个位置所对应的字符替换当前字符。例如，小写字母 z 编码后变为大写 K，数字 0 编码后变为符号 _。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">明文字母表：!<span class="string">&quot;#$%&amp;&#x27;()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_`abcdefghijklmnopqrstuvwxyz&#123;|&#125;~</span></span><br><span class="line"><span class="string">密文字母表：PQRSTUVWXYZ[\]^_`abcdefghijklmnopqrstuvwxyz&#123;|&#125;~!&quot;</span><span class="comment">#$%&amp;&#x27;()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNO</span></span><br></pre></td></tr></table></figure>

<p><strong>代码实现（python）</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ROT47Cipher</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;ROT47密码加解密&quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_shift_char</span>(<span class="params">char</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;对单个字符进行ROT47处理：可打印字符移位47，其他字符不变&quot;&quot;&quot;</span></span><br><span class="line">        ord_char = <span class="built_in">ord</span>(char)</span><br><span class="line">        <span class="keyword">if</span> <span class="number">33</span> &lt;= ord_char &lt;= <span class="number">126</span>:</span><br><span class="line">            <span class="comment"># 移位公式：(原位置 - 33 + 47) % 94 + 33（94为可打印字符总数）</span></span><br><span class="line">            shifted_ord = (ord_char - <span class="number">33</span> + <span class="number">47</span>) % <span class="number">94</span> + <span class="number">33</span></span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">chr</span>(shifted_ord)</span><br><span class="line">        <span class="comment"># 非可打印字符保持不变</span></span><br><span class="line">        <span class="keyword">return</span> char</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">cls, plaintext</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;加密：对可打印字符执行ROT47移位，其他字符不变&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([cls._shift_char(c) <span class="keyword">for</span> c <span class="keyword">in</span> plaintext])</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">cls, ciphertext</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;解密：ROT47加密解密相同，执行相同操作即可还原&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([cls._shift_char(c) <span class="keyword">for</span> c <span class="keyword">in</span> ciphertext])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用示例</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    original = <span class="string">&quot;Hello, I am DSTBP! 123 456&quot;</span></span><br><span class="line"></span><br><span class="line">    encrypted = ROT47Cipher.encrypt(original)</span><br><span class="line">    decrypted = ROT47Cipher.decrypt(encrypted)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;原始文本: <span class="subst">&#123;original&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;加密后: <span class="subst">&#123;encrypted&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;解密后: <span class="subst">&#123;decrypted&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    原始文本: Hello, I am DSTBP! 123 456</span></span><br><span class="line"><span class="string">    加密后: w6==@[ x 2&gt; s$%q!P `ab cde</span></span><br><span class="line"><span class="string">    解密后: Hello, I am DSTBP! 123 456</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>



<h2 id="1-6-广义-ROT-密码"><a href="#1-6-广义-ROT-密码" class="headerlink" title="1.6 广义 ROT 密码"></a><strong>1.6 广义 ROT 密码</strong></h2><h3 id="1-6-1-加解密原理"><a href="#1-6-1-加解密原理" class="headerlink" title="1.6.1 加解密原理"></a><strong>1.6.1 加解密原理</strong></h3><p>除了上面提到的常见偏移量算法之外，还有一些使用非常见偏移量的加密方式，例如 Avocat（偏移量为 10）、Cassis（偏移量为 -5）、Cassette（偏移量为 -6）。由此可以看出，偏移量本质上就是 ROT13 等加密算法的密钥，不同的偏移值会产生完全不同的密文。</p>
<p>下面给出自定义偏移量的广义 ROT 密码的代码实现：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">GeneralizedROTCipher</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;广义ROT密码加解密&quot;&quot;&quot;</span></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_shift_char</span>(<span class="params">char, alphabet, offset</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;对单个字符进行移位处理：码表内字符按偏移量移位，其他字符不变&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> char <span class="keyword">in</span> alphabet:</span><br><span class="line">            <span class="comment"># 计算移位后在码表中的位置</span></span><br><span class="line">            char_index = alphabet.index(char)</span><br><span class="line">            shifted_index = (char_index + offset) % <span class="built_in">len</span>(alphabet)</span><br><span class="line">            <span class="keyword">return</span> alphabet[shifted_index]</span><br><span class="line">        <span class="keyword">return</span> char  <span class="comment"># 不在码表中的字符保持不变</span></span><br><span class="line">    </span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_is_case_mixed</span>(<span class="params">alphabet</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;判断码表是否大小写混用&quot;&quot;&quot;</span></span><br><span class="line">        has_upper = <span class="built_in">any</span>(c.isupper() <span class="keyword">for</span> c <span class="keyword">in</span> alphabet)</span><br><span class="line">        has_lower = <span class="built_in">any</span>(c.islower() <span class="keyword">for</span> c <span class="keyword">in</span> alphabet)</span><br><span class="line">        <span class="keyword">return</span> has_upper <span class="keyword">and</span> has_lower</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_normalize_case</span>(<span class="params">text, alphabet</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;根据码表类型标准化文本大小写&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> GeneralizedROTCipher._is_case_mixed(alphabet):</span><br><span class="line">            <span class="keyword">return</span> text  <span class="comment"># 码表大小写混用，保持原样</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 判断码表类型</span></span><br><span class="line">        is_upper_alphabet = alphabet[<span class="number">0</span>].isupper() <span class="keyword">if</span> alphabet <span class="keyword">else</span> <span class="literal">False</span></span><br><span class="line">        </span><br><span class="line">        normalized = <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">for</span> char <span class="keyword">in</span> text:</span><br><span class="line">            <span class="keyword">if</span> char.isalpha():</span><br><span class="line">                <span class="keyword">if</span> is_upper_alphabet:</span><br><span class="line">                    normalized += char.upper()</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    normalized += char.lower()</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                normalized += char</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> normalized</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_restore_case</span>(<span class="params">processed_text, original_text</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;恢复原始文本的大小写&quot;&quot;&quot;</span></span><br><span class="line">        result = <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">for</span> i, char <span class="keyword">in</span> <span class="built_in">enumerate</span>(processed_text):</span><br><span class="line">            <span class="keyword">if</span> i &lt; <span class="built_in">len</span>(original_text) <span class="keyword">and</span> char.isalpha() <span class="keyword">and</span> original_text[i].isalpha():</span><br><span class="line">                <span class="comment"># 恢复原始大小写</span></span><br><span class="line">                <span class="keyword">if</span> original_text[i].isupper():</span><br><span class="line">                    result += char.upper()</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    result += char.lower()</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                result += char</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">cls, plaintext, offset, alphabet=<span class="string">&#x27;abcdefghijklmnopqrstuvwxyz&#x27;</span>, case_sensitive=<span class="literal">True</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;加密：对码表内字符按指定偏移量移位&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">set</span>(alphabet)) != <span class="built_in">len</span>(alphabet):</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;码表中存在重复字符&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> case_sensitive:</span><br><span class="line">            <span class="comment"># 大小写敏感模式，直接处理</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([cls._shift_char(c, alphabet, offset) <span class="keyword">for</span> c <span class="keyword">in</span> plaintext])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># 大小写不敏感模式</span></span><br><span class="line">            <span class="comment"># 1. 判断码表是否大小写混用</span></span><br><span class="line">            <span class="keyword">if</span> cls._is_case_mixed(alphabet):</span><br><span class="line">                <span class="comment"># 码表大小写混用，直接处理</span></span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([cls._shift_char(c, alphabet, offset) <span class="keyword">for</span> c <span class="keyword">in</span> plaintext])</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="comment"># 码表不混用，按码表类型标准化处理</span></span><br><span class="line">                normalized_text = cls._normalize_case(plaintext, alphabet)</span><br><span class="line">                processed_text = <span class="string">&#x27;&#x27;</span>.join([cls._shift_char(c, alphabet, offset) <span class="keyword">for</span> c <span class="keyword">in</span> normalized_text])</span><br><span class="line">                <span class="comment"># 恢复原始大小写</span></span><br><span class="line">                <span class="keyword">return</span> cls._restore_case(processed_text, plaintext)</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">cls, ciphertext, offset, alphabet=<span class="string">&#x27;abcdefghijklmnopqrstuvwxyz&#x27;</span>, case_sensitive=<span class="literal">True</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;解密：对码表内字符按负偏移量移位（逆向操作）&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">set</span>(alphabet)) != <span class="built_in">len</span>(alphabet):</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;码表中存在重复字符&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> case_sensitive:</span><br><span class="line">            <span class="comment"># 大小写敏感模式，直接处理</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([cls._shift_char(c, alphabet, -offset) <span class="keyword">for</span> c <span class="keyword">in</span> ciphertext])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># 大小写不敏感模式</span></span><br><span class="line">            <span class="comment"># 1. 判断码表是否大小写混用</span></span><br><span class="line">            <span class="keyword">if</span> cls._is_case_mixed(alphabet):</span><br><span class="line">                <span class="comment"># 码表大小写混用，直接处理</span></span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([cls._shift_char(c, alphabet, -offset) <span class="keyword">for</span> c <span class="keyword">in</span> ciphertext])</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="comment"># 码表不混用，按码表类型标准化处理</span></span><br><span class="line">                normalized_text = cls._normalize_case(ciphertext, alphabet)</span><br><span class="line">                processed_text = <span class="string">&#x27;&#x27;</span>.join([cls._shift_char(c, alphabet, -offset) <span class="keyword">for</span> c <span class="keyword">in</span> normalized_text])</span><br><span class="line">                <span class="comment"># 恢复原始大小写</span></span><br><span class="line">                <span class="keyword">return</span> cls._restore_case(processed_text, ciphertext)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    original = <span class="string">&quot;Hello, I am Dstbp! 123 456&quot;</span></span><br><span class="line"></span><br><span class="line">    encrypted = GeneralizedROTCipher.encrypt(original, <span class="number">5</span>, case_sensitive=<span class="literal">False</span>)</span><br><span class="line">    decrypted = GeneralizedROTCipher.decrypt(encrypted, <span class="number">5</span>, case_sensitive=<span class="literal">False</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;原始文本: <span class="subst">&#123;original&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;加密后: <span class="subst">&#123;encrypted&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;解密后: <span class="subst">&#123;decrypted&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    原始文本: Hello, I am Dstbp! 123 456</span></span><br><span class="line"><span class="string">    加密后: Mjqqt, N fr Ixygu! 123 456</span></span><br><span class="line"><span class="string">    解密后: Hello, I am Dstbp! 123 456</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="1-6-2-攻击手段"><a href="#1-6-2-攻击手段" class="headerlink" title="1.6.2 攻击手段"></a><strong>1.6.2 攻击手段</strong></h3><p><strong>唯密文攻击</strong></p>
<p>由于使用 ROT 加密的语言通常基于字母文字系统，偏移量的范围是有限的。例如在使用 26 个字母的英文中，最大有效偏移量为 25，偏移量超过 26 会循环回到 1–25 的范围。因此，如果<strong>偏移量未知</strong>，可以通过穷举所有可能值轻松破解，加密强度较低。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">brute_force_rot</span>(<span class="params">ciphertext: <span class="built_in">str</span>, alphabet: <span class="built_in">str</span></span>) -&gt; <span class="built_in">dict</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    爆破已知码表下的未知偏移量</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> alphabet:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;码表不能为空&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">set</span>(alphabet)) != <span class="built_in">len</span>(alphabet):</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;码表中存在重复字符&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    max_offset = <span class="built_in">len</span>(alphabet)</span><br><span class="line">    results = &#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 爆破所有可能的偏移量（0到max_offset-1）</span></span><br><span class="line">    <span class="keyword">for</span> offset <span class="keyword">in</span> <span class="built_in">range</span>(max_offset):</span><br><span class="line">        plaintext = []</span><br><span class="line">        <span class="keyword">for</span> char <span class="keyword">in</span> ciphertext:</span><br><span class="line">            <span class="keyword">if</span> char <span class="keyword">in</span> alphabet:</span><br><span class="line">                char_idx = alphabet.index(char)</span><br><span class="line">                decrypted_idx = (char_idx - offset) % max_offset</span><br><span class="line">                plaintext.append(alphabet[decrypted_idx])</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="comment"># 非码表字符直接保留</span></span><br><span class="line">                plaintext.append(char)</span><br><span class="line">        results[offset] = <span class="string">&#x27;&#x27;</span>.join(plaintext)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> results</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    known_alphabet = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&quot;</span></span><br><span class="line">    ciphertext = <span class="string">&quot;CZggj, D Vh yNOwK! 123 456&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 爆破所有可能的偏移量</span></span><br><span class="line">    decrypted_results = brute_force_rot(ciphertext, known_alphabet)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> offset, text <span class="keyword">in</span> decrypted_results.items():</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;偏移量 <span class="subst">&#123;offset:2d&#125;</span>: <span class="subst">&#123;text&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 偏移量 47: Hello, I am DSTBP! 123 456</span></span><br></pre></td></tr></table></figure>

<h3 id="1-6-3-方法改进"><a href="#1-6-3-方法改进" class="headerlink" title="1.6.3 方法改进"></a><strong>1.6.3 方法改进</strong></h3><p>ROT 密码的偏移量选择有限，极易被穷举破解，若用它来加密我们的贸易信件，安全性自然无从谈起。那么，有没有办法改进传统的 ROT 加密，提升其抗破解能力呢？</p>
<p>ROT 加密的核心在于两个要素：偏移量和码表。要增强其安全性，可以尝试从这两方面进行改进。</p>
<p><strong>自变偏移 ROT 密码</strong>（Self-changing Offset ROT Cipher）</p>
<p>从偏移量来看，常规 ROT 加密采用的是固定偏移，即每个字母都按照相同的数值偏移，加密模式过于单一。为了提升复杂度，可以引入<strong>动态偏移机制</strong>：从一个初始偏移量开始，每加密一个字符，偏移量递增 1，从而实现偏移量逐字符变化的加密效果。</p>
<p><strong>代码实现（python）</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">SelfChangingOffsetROT</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    支持自定义码表的自变偏移 ROT 密码</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_shift_char</span>(<span class="params">char: <span class="built_in">str</span>, offset: <span class="built_in">int</span>, alphabet: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;根据自定义码表和偏移量处理单个字符&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> char <span class="keyword">not</span> <span class="keyword">in</span> alphabet:</span><br><span class="line">            <span class="keyword">return</span> char  <span class="comment"># 不在码表中的字符直接保留</span></span><br><span class="line">            </span><br><span class="line">        <span class="comment"># 计算移位后在码表中的位置</span></span><br><span class="line">        char_index = alphabet.index(char)</span><br><span class="line">        shifted_index = (char_index + offset) % <span class="built_in">len</span>(alphabet)</span><br><span class="line">        <span class="keyword">return</span> alphabet[shifted_index]</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">cls, plaintext: <span class="built_in">str</span>, initial_offset: <span class="built_in">int</span>, alphabet: <span class="built_in">str</span>=<span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;加密：使用自定义码表，偏移量从初始值开始逐字符递增&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">set</span>(alphabet)) != <span class="built_in">len</span>(alphabet):</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;码表中存在重复字符&quot;</span>)</span><br><span class="line">        ciphertext = []</span><br><span class="line">        current_offset = initial_offset</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> char <span class="keyword">in</span> plaintext:</span><br><span class="line">            <span class="comment"># 对当前字符进行移位</span></span><br><span class="line">            cipher_char = cls._shift_char(char, current_offset, alphabet)</span><br><span class="line">            ciphertext.append(cipher_char)</span><br><span class="line">            <span class="comment"># 仅对码表中的字符递增偏移量</span></span><br><span class="line">            <span class="keyword">if</span> char <span class="keyword">in</span> alphabet:</span><br><span class="line">                current_offset += <span class="number">1</span></span><br><span class="line">                </span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(ciphertext)</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">cls, ciphertext: <span class="built_in">str</span>, initial_offset: <span class="built_in">int</span>, alphabet: <span class="built_in">str</span>=<span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;解密：使用自定义码表，偏移量规则与加密一致&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">set</span>(alphabet)) != <span class="built_in">len</span>(alphabet):</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;码表中存在重复字符&quot;</span>)</span><br><span class="line">        plaintext = []</span><br><span class="line">        current_offset = initial_offset</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> char <span class="keyword">in</span> ciphertext:</span><br><span class="line">            <span class="comment"># 解密使用负偏移量</span></span><br><span class="line">            plain_char = cls._shift_char(char, -current_offset, alphabet)</span><br><span class="line">            plaintext.append(plain_char)</span><br><span class="line">            <span class="comment"># 仅对码表中的字符递增偏移量</span></span><br><span class="line">            <span class="keyword">if</span> char <span class="keyword">in</span> alphabet:</span><br><span class="line">                current_offset += <span class="number">1</span></span><br><span class="line">                </span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(plaintext)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    original = <span class="string">&quot;Hello, I am DSTBP! 123 456&quot;</span></span><br><span class="line">    initial_offset = <span class="number">14</span></span><br><span class="line">    custom_alphabet = <span class="string">&quot;0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_`abcdefghijklmnopqrstuvwxyz&#123;|&#125;~&quot;</span></span><br><span class="line">    </span><br><span class="line">    encrypted = SelfChangingOffsetROT.encrypt(original, initial_offset, custom_alphabet)</span><br><span class="line">    decrypted = SelfChangingOffsetROT.decrypt(encrypted, initial_offset, custom_alphabet)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;原始文本: <span class="subst">&#123;original&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;加密后: <span class="subst">&#123;encrypted&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;解密后: <span class="subst">&#123;decrypted&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    原始文本: Hello, I am DSTBP! 123 456</span></span><br><span class="line"><span class="string">    加密后: Vt|&#125;2, \ u3 Zjl[j! LNP RTV</span></span><br><span class="line"><span class="string">    解密后: Hello, I am DSTBP! 123 456</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<br>

<p><strong>基于密钥的 ROT 密码</strong>（Keyed ROT Cipher，也称 Keyed Casear Cipher）</p>
<p>再看码表，标准 ROT 密码始终基于固定顺序的字母表 —— 无论偏移量如何，字母之间的相对位置保持不变（如 A 后总是 B，B 后总是 C）。为打破这一规律，可以基于密钥构造一个<strong>自定义字母表</strong>。方法是：先提取密钥中的字母，按出现顺序去重排列，再将未出现的字母按字母顺序补全。例如，若密钥为 “cryptotion”，生成的字母表为 <code>CRYPTOINABDEFGHJKLMQSUVWXZ</code>。加密时用该字母表替代标准字母表，结合偏移实现替换操作，其余逻辑与凯撒加密一致。</p>
<p><strong>代码实现（python）</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">KeyedCaesarCipher</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    带密钥的凯撒密码加解密类</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_build_alphabet</span>(<span class="params">key: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        根据密钥构建加密字母表</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># 提取密钥中唯一字母（大写）</span></span><br><span class="line">        key_chars = [c.upper() <span class="keyword">for</span> c <span class="keyword">in</span> key <span class="keyword">if</span> c.isalpha()]</span><br><span class="line">        unique_key = []</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> key_chars:</span><br><span class="line">            <span class="keyword">if</span> c <span class="keyword">not</span> <span class="keyword">in</span> unique_key:</span><br><span class="line">                unique_key.append(c)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 补充剩余字母（排除已在密钥中出现的）</span></span><br><span class="line">        all_letters = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span></span><br><span class="line">        remaining = [c <span class="keyword">for</span> c <span class="keyword">in</span> all_letters <span class="keyword">if</span> c <span class="keyword">not</span> <span class="keyword">in</span> unique_key]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(unique_key + remaining)</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">cls, plaintext: <span class="built_in">str</span>, key: <span class="built_in">str</span>, offset: <span class="built_in">int</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        加密：使用密钥字母表和偏移量</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        ciphertext = []</span><br><span class="line">        base_alphabet = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span></span><br><span class="line">        key_alphabet = cls._build_alphabet(key)</span><br><span class="line">        offset = offset % <span class="number">26</span>  <span class="comment"># 确保偏移量在0-25之间</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> char <span class="keyword">in</span> plaintext:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> char.isalpha():</span><br><span class="line">                <span class="comment"># 非字母字符直接保留</span></span><br><span class="line">                ciphertext.append(char)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">                </span><br><span class="line">            <span class="comment"># 找到在基础字母表中的位置</span></span><br><span class="line">            idx = base_alphabet.index(char.upper())</span><br><span class="line">            <span class="comment"># 计算加密后在密钥字母表中的位置</span></span><br><span class="line">            encrypted_idx = (idx + offset) % <span class="number">26</span></span><br><span class="line">            encrypted_char = key_alphabet[encrypted_idx]</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 恢复原始大小写</span></span><br><span class="line">            ciphertext.append(encrypted_char <span class="keyword">if</span> char.isupper() <span class="keyword">else</span> encrypted_char.lower())</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(ciphertext)</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">cls, ciphertext: <span class="built_in">str</span>, key: <span class="built_in">str</span>, offset: <span class="built_in">int</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        解密：使用密钥字母表和偏移量</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        plaintext = []</span><br><span class="line">        base_alphabet = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span></span><br><span class="line">        key_alphabet = cls._build_alphabet(key)</span><br><span class="line">        offset = offset % <span class="number">26</span>  <span class="comment"># 确保偏移量在0-25之间</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> char <span class="keyword">in</span> ciphertext:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> char.isalpha():</span><br><span class="line">                <span class="comment"># 非字母字符直接保留</span></span><br><span class="line">                plaintext.append(char)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">                </span><br><span class="line">            is_upper = char.isupper()</span><br><span class="line">            char_upper = char.upper()</span><br><span class="line">            <span class="comment"># 找到在密钥字母表中的位置</span></span><br><span class="line">            idx = key_alphabet.index(char_upper)</span><br><span class="line">            <span class="comment"># 计算解密后在基础字母表中的位置</span></span><br><span class="line">            decrypted_idx = (idx - offset) % <span class="number">26</span></span><br><span class="line">            decrypted_char = base_alphabet[decrypted_idx]</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 恢复原始大小写</span></span><br><span class="line">            plaintext.append(decrypted_char <span class="keyword">if</span> is_upper <span class="keyword">else</span> decrypted_char.lower())</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(plaintext)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    key = <span class="string">&quot;cryptotion&quot;</span></span><br><span class="line">    offset = <span class="number">2</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 加密示例</span></span><br><span class="line">    original = <span class="string">&quot;Hello, I am DSTBP! 123 456&quot;</span></span><br><span class="line">    encrypted = KeyedCaesarCipher.encrypt(original, key, offset)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;原始文本: <span class="subst">&#123;original&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;加密后: <span class="subst">&#123;encrypted&#125;</span>&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 解密示例</span></span><br><span class="line">    decrypted = KeyedCaesarCipher.decrypt(encrypted, key, offset)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;解密后: <span class="subst">&#123;decrypted&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    原始文本: Hello, I am DSTBP! 123 456</span></span><br><span class="line"><span class="string">    加密后: Biggk, D yh OSUPL! 123 456</span></span><br><span class="line"><span class="string">    解密后: Hello, I am DSTBP! 123 456</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<br>

<h1 id="2-Atbash-Cipher"><a href="#2-Atbash-Cipher" class="headerlink" title="2. Atbash Cipher"></a><strong>2. Atbash Cipher</strong></h1><p>自变偏移的 ROT 加密在一定程度上提高了爆破难度（初始偏移 × 增加步长，共 26 × 26 种组合），但总量仍有限，依然容易被暴力破解。而基于密钥的凯撒密码虽然通过打乱码表顺序提升了安全性，但由于密钥通常较短，能覆盖的字母种类有限，其余未出现的字母仍按标准顺序补全，整体码表的变化空间依然受限。</p>
<p>那么，有没有更彻底的方式来打破字母表的固定顺序，重新编排码表呢？比如将整个字母表完全反转。如果你产生了这种想法，那么恭喜你，你就和公元 1 世纪的萨多吉等教派信徒对上脑电波了。</p>
<h2 id="2-1-加解密原理"><a href="#2-1-加解密原理" class="headerlink" title="2.1 加解密原理"></a><strong>2.1 加解密原理</strong></h2><p><strong>Atbash Cipher</strong>（埃特巴什码）也是一种单表替换密码，这种密码曾被公元 1 世纪的艾赛尼、萨多吉教派的经文中，用以隐藏姓名。由熊斐特博士（Dr. Robert Eisenman）发现，他使用这种加密方法来解读艾赛尼、萨多吉教派的经文。其加密规则是将字母表反转：第一个字母对应最后一个，第二个对应倒数第二个。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">明文字母表：ABCDEFGHIJKLMNOPQRSTUVWXYZ</span><br><span class="line">密文字母表：ZYXWVUTSRQPONMLKJIHGFEDCBA</span><br></pre></td></tr></table></figure>

<p><strong>代码实现（python）</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">AtbashCipher</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Atbash Cipher 埃特巴什码&quot;&quot;&quot;</span></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_shift_char</span>(<span class="params">char</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;对单个字符进行移位处理&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> char.isalpha():</span><br><span class="line">            <span class="keyword">return</span> char</span><br><span class="line">        </span><br><span class="line">        base = <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) <span class="keyword">if</span> char.isupper() <span class="keyword">else</span> <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">        shifted_index = -<span class="built_in">ord</span>(char) + base + <span class="number">25</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">chr</span>(base + shifted_index)</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">cls, plaintext</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;加密&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([cls._shift_char(c) <span class="keyword">for</span> c <span class="keyword">in</span> plaintext])</span><br><span class="line">    </span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">cls, ciphertext</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;解密&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([cls._shift_char(c) <span class="keyword">for</span> c <span class="keyword">in</span> ciphertext])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    original = <span class="string">&#x27;Hello, I am DSTBP! 123 456&#x27;</span></span><br><span class="line"></span><br><span class="line">    encrypted = AtbashCipher.encrypt(original)</span><br><span class="line">    decrypted = AtbashCipher.decrypt(encrypted)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;原始文本: <span class="subst">&#123;original&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;加密后: <span class="subst">&#123;encrypted&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;解密后: <span class="subst">&#123;decrypted&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    原始文本: Hello, I am DSTBP! 123 456</span></span><br><span class="line"><span class="string">    加密后: Svool, R zn WHGYK! 123 456</span></span><br><span class="line"><span class="string">    解密后: Hello, I am DSTBP! 123 456</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>



<h2 id="2-2-扩展埃特巴什码"><a href="#2-2-扩展埃特巴什码" class="headerlink" title="2.2 扩展埃特巴什码"></a><strong>2.2 扩展埃特巴什码</strong></h2><p>标准的 Atbash Cipher 只是对 26 个字母表进行一次简单反转，对于有经验的分析者来说相当容易破解。但这种思路可以拓展：在反转的基础上，将字母表划分为若干段，并对这些段之间的顺序进行重新排列。例如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">明文字母表：                      ABCDEFGHIJKLMNOPQRSTUVWXYZ</span><br><span class="line">标准 Atbash Cipher 密文字母表：   ZYXWVUTSRQPONMLKJIHGFEDCBA</span><br><span class="line">划分三段：       			   ZYXWVUT SRQPONMLK JIHGFEDCBA</span><br><span class="line">交换顺序是 <span class="number">312</span>：                 JIHGFEDCBA ZYXWVUT SRQPONMLK</span><br><span class="line">最终变种密文字母表：              JIHGFEDCBAZYXWVUTSRQPONMLK</span><br></pre></td></tr></table></figure>

<p>段的长度和交换顺序可作为加密密钥，使加密过程更加灵活可控，从而显著提高加密的复杂度与破解难度。  </p>
<p><strong>代码实现（python）</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ExtendAtbashCipher</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Extend Atbash Cipher 扩展埃特巴什码</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, key: <span class="built_in">str</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;构建明文密文对应码表&quot;&quot;&quot;</span></span><br><span class="line">        <span class="variable language_">self</span>.key = <span class="variable language_">self</span>._build_alphabet(key)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_build_alphabet</span>(<span class="params">self, key: <span class="built_in">str</span></span>):</span><br><span class="line">        key_list = key.split(<span class="string">&quot; &quot;</span>)</span><br><span class="line">        index_list = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">int</span>, key_list[:-<span class="number">1</span>]))</span><br><span class="line">        order_list = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">int</span>, key_list[-<span class="number">1</span>]))</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 合法性校验</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">sum</span>(index_list) != <span class="number">26</span> <span class="keyword">and</span> <span class="built_in">len</span>(key_list[:-<span class="number">1</span>]) != <span class="built_in">len</span>(key_list[-<span class="number">1</span>]):</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;密钥有误&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 切片</span></span><br><span class="line">        ua = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span></span><br><span class="line">        segments = []</span><br><span class="line">        start = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> length <span class="keyword">in</span> index_list:</span><br><span class="line">            end = start + length</span><br><span class="line">            segments.append(ua[::-<span class="number">1</span>][start:end])</span><br><span class="line">            start = end</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 调整顺序</span></span><br><span class="line">        res = <span class="string">&#x27;&#x27;</span>.join(segments[i-<span class="number">1</span>] <span class="keyword">for</span> i <span class="keyword">in</span> order_list)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">dict</span>(<span class="built_in">zip</span>(ua, res))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_shift_char</span>(<span class="params">self, char: <span class="built_in">str</span>, key: <span class="built_in">dict</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;对单个字符进行操作&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> char.isalpha():</span><br><span class="line">            <span class="keyword">return</span> char</span><br><span class="line">        <span class="keyword">if</span> char.isupper():</span><br><span class="line">            <span class="keyword">return</span> key[char]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> key[char.upper()].lower()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self, plaintext: <span class="built_in">str</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;加密&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([<span class="variable language_">self</span>._shift_char(c, <span class="variable language_">self</span>.key) <span class="keyword">for</span> c <span class="keyword">in</span> plaintext])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">self, ciphertext: <span class="built_in">str</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;解密&quot;&quot;&quot;</span></span><br><span class="line">        key = <span class="built_in">dict</span>(<span class="built_in">zip</span>(<span class="variable language_">self</span>.key.values(), <span class="variable language_">self</span>.key.keys()))</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([<span class="variable language_">self</span>._shift_char(c, key) <span class="keyword">for</span> c <span class="keyword">in</span> ciphertext])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    original = <span class="string">&#x27;Hello, I am DSTBP! 123 456&#x27;</span></span><br><span class="line">    key = <span class="string">&quot;7 9 10 312&quot;</span></span><br><span class="line"></span><br><span class="line">    eac = ExtendAtbashCipher(key)</span><br><span class="line"></span><br><span class="line">    encrypted = eac.encrypt(original)</span><br><span class="line">    decrypted = eac.decrypt(encrypted)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;原始文本: <span class="subst">&#123;original&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;加密后: <span class="subst">&#123;encrypted&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;解密后: <span class="subst">&#123;decrypted&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    原始文本: Hello, I am DSTBP! 123 456</span></span><br><span class="line"><span class="string">    加密后: Cfyyv, B jx GRQIU! 123 456</span></span><br><span class="line"><span class="string">    解密后: Hello, I am DSTBP! 123 456</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<br>

<h1 id="3-简单替换密码"><a href="#3-简单替换密码" class="headerlink" title="3. 简单替换密码"></a><strong>3. 简单替换密码</strong></h1><h2 id="3-1-加解密原理"><a href="#3-1-加解密原理" class="headerlink" title="3.1 加解密原理"></a><strong>3.1 加解密原理</strong></h2><p>可以看出，扩展后的 Atbash 密码相比标准版本，其破解难度大大提升。攻击者不仅需要知道如何分段，还必须掌握各段的交换顺序。最复杂的情况是：每个字母被视为一个独立段，再根据密钥进行任意排列。敌手若不知排列顺序，穷举需尝试 $ 26! $ 种情况，也就是密钥空间为 $ 26! $，在有限时间内几乎无法爆破。</p>
<p>密码学中，这种通过对标准字母表进行任意排列（permutation）来构造密文映射的单表替换方式，被称为<strong>简单替换密码（Simple Substitution Cipher）</strong>。其中“简单”指的是结构简单：每个明文字母始终对应唯一的密文字母，加密过程依赖一个固定的替换表。区分于多表替换密码或更复杂的机械加密系统（详情请阅读 [古典密码] 多表替换密码）。</p>
<p><strong>代码实现（python）</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">SimpleSubCipher</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    简单替换密码</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, key: <span class="built_in">str</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;构建明文密文对应码表&quot;&quot;&quot;</span></span><br><span class="line">        <span class="variable language_">self</span>.key = <span class="variable language_">self</span>._build_alphabet(key)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_build_alphabet</span>(<span class="params">self, key: <span class="built_in">str</span></span>):</span><br><span class="line">        upper_alpha = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">dict</span>(<span class="built_in">zip</span>(upper_alpha, key.upper()))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_shift_char</span>(<span class="params">self, char: <span class="built_in">str</span>, key: <span class="built_in">dict</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;对单个字符进行操作&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> char.isalpha():</span><br><span class="line">            <span class="keyword">return</span> char</span><br><span class="line">        <span class="keyword">if</span> char.isupper():</span><br><span class="line">            <span class="keyword">return</span> key[char]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> key[char.upper()].lower()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self, plaintext: <span class="built_in">str</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;加密&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([<span class="variable language_">self</span>._shift_char(c, <span class="variable language_">self</span>.key) <span class="keyword">for</span> c <span class="keyword">in</span> plaintext])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">self, ciphertext: <span class="built_in">str</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;解密&quot;&quot;&quot;</span></span><br><span class="line">        key = <span class="built_in">dict</span>(<span class="built_in">zip</span>(<span class="variable language_">self</span>.key.values(), <span class="variable language_">self</span>.key.keys()))</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([<span class="variable language_">self</span>._shift_char(c, key) <span class="keyword">for</span> c <span class="keyword">in</span> ciphertext])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    original = <span class="string">&#x27;Hello, I am DSTBP! 123 456&#x27;</span></span><br><span class="line">    key = <span class="string">&quot;phqgiumeaylnofdxjkrcvstzwb&quot;</span></span><br><span class="line"></span><br><span class="line">    eac = SimpleSubCipher(key)</span><br><span class="line"></span><br><span class="line">    encrypted = eac.encrypt(original)</span><br><span class="line">    decrypted = eac.decrypt(encrypted)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;原始文本: <span class="subst">&#123;original&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;加密后: <span class="subst">&#123;encrypted&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;解密后: <span class="subst">&#123;decrypted&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    原始文本: Hello, I am DSTBP! 123 456</span></span><br><span class="line"><span class="string">    加密后: Einnd, A po GRCHX! 123 456</span></span><br><span class="line"><span class="string">    解密后: Hello, I am DSTBP! 123 456</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<br>

<h1 id="4-仿射密码"><a href="#4-仿射密码" class="headerlink" title="4. 仿射密码"></a><strong>4. 仿射密码</strong></h1><p>前面介绍的 ROT 密码体系、Atbash 密码，虽各有其特点，但逐一记忆未免繁杂。这些加密方式的本质，都是通过简单的字母映射实现替换。那么，是否存在一种“大一统”的算法能够将它们整合，从数学角度用一个算式来概括这些密码呢？我们不妨自己先来推导一番。</p>
<p>首先是 ROT 密码体系，它的核心原理很直观：对字母表进行循环偏移。所谓“偏移”，即对字母的索引值进行加减偏移量的操作；而“循环”特性，则可通过取模运算来实现。这样，ROT 密码就可以概括为：</p>
<p>$$<br>E(x)&#x3D;(x+b) \mod m<br>$$<br>$ b $ 为 3，表示凯撒密码，$ b $ 为 13，表示 ROT13，以此类推。</p>
<p>再分析 Atbash 密码，其将字母表进行反转，这个关系可写为：</p>
<p>$$<br>E(x)&#x3D;(-x+25) \mod {26}<br>$$<br>由此可见，无论是 ROT 系列的“偏移”（加法），还是 Atbash 的“反转”（乘法），都可纳入同一框架。若用 $ a $ 表示线性变换的系数（<strong>控制缩放或反转</strong>），$ b $ <strong>控制偏移量</strong>，$ m $ 表示模数（对 26 个字母而言 $ m&#x3D;26 $），则所有这类单表替换密码都可统一表述为：</p>
<p>$$<br>E(x)&#x3D;(ax+b) \mod m<br>$$<br>这便是仿射密码。</p>
<h2 id="4-1-加解密原理"><a href="#4-1-加解密原理" class="headerlink" title="4.1 加解密原理"></a><strong>4.1 加解密原理</strong></h2><p><strong>仿射密码</strong>（Affine Cipher）为单表加密的一种，字母系统中所有字母都基于一简单数学方程加密：<br>$$<br>E(x)&#x3D;(ax+b) \mod m<br>$$<br>根据加密函数可以推导出解密方程：</p>
<p>$$<br>D(x)&#x3D;a^{-1}(x-b) \mod m<br>$$<br>从解密函数可见，仿射密码若要实际应用（即确保能够解密），需满足一个前提：参数 $ a $ 在模 $m$ 的情况下有逆元。即 $ a、m $ 互质（$ \gcd(a,,m)&#x3D;1 $）。</p>
<p>这里必须要求参数 $ a $ 存在模 26 的逆元，原因在于它控制的是字母表的缩放比例。</p>
<p>仿射密码基于仿射变换。可以将字母表视为一个数轴，字母 A 作为原点，每个明文字母的索引就像是从原点出发的一个向量。参数 $ a $ 就是对这个向量进行缩放的倍数，即将字母与原点之间的距离放大或缩小 $ a $ 倍。</p>
<center><img src="https://dstbp.com/data/imgs/posts/msc/Affine_a.png" width="800"></center>

<center style="margin-top: 10px; margin-bottom: 18px;"><span style="font-family:楷体;font-size:14px;">图 4.1 参数 a 表示线性缩放</span></center>

<p>当缩放后的结果超出字母表范围时，通过取模运算将其折回范围内。但只有当 $ a $ 与模数 26 互质时，才能保证所有明文索引在缩放后仍能一一对应到密文字母，也就是说变换是可逆的。如果 $ a $ 与 26 不互质，就会出现不同明文字母被映射到相同密文位置的情况，导致信息丢失，无法解密还原。</p>
<center><img src="https://dstbp.com/data/imgs/posts/msc/Affine_non_coprime.png" width="800"></center>

<center style="margin-top: 10px; margin-bottom: 18px;"><span style="font-family:楷体;font-size:14px;">图 4.2 不互质会存在两点加密后落在同一点的情况</span></center>

<p><strong>代码实现（python）</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AffineCipher</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    仿射密码</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_process_char</span>(<span class="params">char, b, m, a=<span class="literal">None</span>, a_inv=<span class="literal">None</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;对单个字符进行处理&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> a <span class="keyword">and</span> <span class="keyword">not</span> a_inv:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;缺少 a 参数&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> char.isalpha():</span><br><span class="line">            <span class="keyword">return</span> char</span><br><span class="line">        </span><br><span class="line">        base = <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) <span class="keyword">if</span> char.isupper() <span class="keyword">else</span> <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">        index = <span class="built_in">ord</span>(char) - base</span><br><span class="line">        <span class="keyword">if</span> a_inv:</span><br><span class="line">            char = (index - b) * a_inv % m</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            char = (a*index + b) % m</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">chr</span>(base + char)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">cls, plaintext, a, b, m</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(cls._process_char(pt, b, m, a) <span class="keyword">for</span> pt <span class="keyword">in</span> plaintext)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">cls, ciphertext, a, b, m</span>):</span><br><span class="line">        a_inv = inverse(a, m)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(cls._process_char(ct, b, m, a_inv=a_inv) <span class="keyword">for</span> ct <span class="keyword">in</span> ciphertext)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    original = <span class="string">&quot;Hello, I am DSTBP! 123 456&quot;</span></span><br><span class="line">    a, b = <span class="number">11</span>, <span class="number">5</span></span><br><span class="line">    encrypted = AffineCipher.encrypt(original, a, b, <span class="number">26</span>)</span><br><span class="line">    decrypted = AffineCipher.decrypt(encrypted, a, b, <span class="number">26</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;原始文本: <span class="subst">&#123;original&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;加密后: <span class="subst">&#123;encrypted&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;解密后: <span class="subst">&#123;decrypted&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    原始文本: Hello, I am DSTBP! 123 456</span></span><br><span class="line"><span class="string">    加密后: Exwwd, P fh MVGQO! 123 456</span></span><br><span class="line"><span class="string">    解密后: Hello, I am DSTBP! 123 456</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>



<h2 id="4-2-攻击手段"><a href="#4-2-攻击手段" class="headerlink" title="4.2 攻击手段"></a><strong>4.2 攻击手段</strong></h2><h3 id="4-2-1-已知明文攻击"><a href="#4-2-1-已知明文攻击" class="headerlink" title="4.2.1 已知明文攻击"></a><strong>4.2.1 已知明文攻击</strong></h3><p>对于这类密码，如果已知部分明文，只需掌握至少两组明文与密文的对应关系，就有可能推算出关键参数，从而对加密进行有效攻击：</p>
<p>已知明文 $ x_1 $ 对应密文 $ y_1 $；明文 $ x_2 $ 对应密文 $ y_2 $，则有：</p>
<p>$$<br>\begin{gathered}<br>y_1 &#x3D; (ax_1+b) \mod m \<br>y_2 &#x3D; (ax_2+b) \mod m<br>\end{gathered}<br>$$<br>两式相减得：</p>
<p>$$<br>\begin{gathered}<br>y_1 - y_2 &#x3D; a(x_1-x_2) \mod m \<br>a &#x3D; (y_1 - y_2) \cdot (x_1-x_2)^{-1}  \mod m \<br>b &#x3D; y_1-ax_1 \mod m<br>\end{gathered}<br>$$<br><strong>代码实现（python）</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">known_plaintext_attack</span>(<span class="params">x1, x2, y1, y2, m=<span class="number">26</span></span>):</span><br><span class="line">    x_inv = inverse(<span class="built_in">ord</span>(x1) - <span class="built_in">ord</span>(x2), m)</span><br><span class="line">    a = ((<span class="built_in">ord</span>(y1) - <span class="built_in">ord</span>(y2))*(x_inv)) % m</span><br><span class="line">    b = (<span class="built_in">ord</span>(y1)-a*<span class="built_in">ord</span>(x1)) % m</span><br><span class="line">    <span class="keyword">return</span> a, b</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    x1, x2 = <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;r&#x27;</span></span><br><span class="line">    y1, y2 = <span class="string">&#x27;z&#x27;</span>, <span class="string">&#x27;i&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;仿射密码参数: <span class="subst">&#123;known_plaintext_attack(x1, x2, y1, y2)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 仿射密码参数: (25, 11)</span></span><br></pre></td></tr></table></figure>

<h3 id="4-2-2-唯密文攻击"><a href="#4-2-2-唯密文攻击" class="headerlink" title="4.2.2 唯密文攻击"></a><strong>4.2.2 唯密文攻击</strong></h3><p>现在来探讨只在已知密文的情况下，爆破攻击的可行性。加密参数中，$ a $ 必须与模数 $ m&#x3D;26 $ 互质，因此 $ a $ 的合法取值为 ${1,\ 3,\ 5,\ 7,\ 9,\ 11,\ 15,\ 17,\ 19,\ 21,\ 23,\ 25}$，共 12 种；而 $ b $ 的取值范围为 0 到 25，共 26 种。除去无加密效果的情况（即 $a&#x3D;1,\ b&#x3D;0$ ），有效密钥组合总数为：$12 \times 26 -1 &#x3D; 311$。</p>
<p>因此，密钥空间非常有限，可在短时间内通过穷举尝试全部组合，完成爆破。</p>
<p><strong>代码实现（python）</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AffineCipher</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    仿射密码</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_process_char</span>(<span class="params">char, b, m, a=<span class="literal">None</span>, a_inv=<span class="literal">None</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;对单个字符进行处理&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> a <span class="keyword">and</span> <span class="keyword">not</span> a_inv:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;缺少 a 参数&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> char.isalpha():</span><br><span class="line">            <span class="keyword">return</span> char</span><br><span class="line">        </span><br><span class="line">        base = <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) <span class="keyword">if</span> char.isupper() <span class="keyword">else</span> <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">        index = <span class="built_in">ord</span>(char) - base</span><br><span class="line">        <span class="keyword">if</span> a_inv:</span><br><span class="line">            char = (index - b) * a_inv % m</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            char = (a*index + b) % m</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">chr</span>(base + char)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">cls, ciphertext, a, b, m</span>):</span><br><span class="line">        a_inv = inverse(a, m)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(cls._process_char(ct, b, m, a_inv=a_inv) <span class="keyword">for</span> ct <span class="keyword">in</span> ciphertext)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ciphertext_only_attack</span>(<span class="params">ciphertext, m=<span class="number">26</span></span>):</span><br><span class="line">    res = &#123;&#125;</span><br><span class="line">    a_list = [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">21</span>, <span class="number">23</span>, <span class="number">25</span>]</span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> a_list:</span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, m):</span><br><span class="line">            res[<span class="string">f&#x27;a=<span class="subst">&#123;a&#125;</span>, b=<span class="subst">&#123;b&#125;</span>&#x27;</span>] = (AffineCipher.decrypt(ciphertext, a, b, m))</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    ciphertext = <span class="string">&#x27;Detts, U ok NIZFJ! 123 456&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;爆破结果: <span class="subst">&#123;ciphertext_only_attack(ciphertext)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    爆破结果: &#123;</span></span><br><span class="line"><span class="string">        &#x27;a=1, b=0&#x27;: &#x27;Detts, U ok NIZFJ! 123 456&#x27;, </span></span><br><span class="line"><span class="string">        &#x27;a=1, b=1&#x27;: &#x27;Cdssr, T nj MHYEI! 123 456&#x27;, </span></span><br><span class="line"><span class="string">        &#x27;a=1, b=2&#x27;: &#x27;Bcrrq, S mi LGXDH! 123 456&#x27;, </span></span><br><span class="line"><span class="string">        &#x27;a=1, b=3&#x27;: &#x27;Abqqp, R lh KFWCG! 123 456&#x27;, </span></span><br><span class="line"><span class="string">        ...</span></span><br><span class="line"><span class="string">        &#x27;a=17, b=14&#x27;: &#x27;Hello, I am DSTBP! 123 456&#x27;,</span></span><br><span class="line"><span class="string">        ...</span></span><br><span class="line"><span class="string">        &#x27;a=25, b=24&#x27;: &#x27;Vuffg, E ko LQZTP! 123 456&#x27;, </span></span><br><span class="line"><span class="string">        &#x27;a=25, b=25&#x27;: &#x27;Wvggh, F lp MRAUQ! 123 456&#x27;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p><strong>补充</strong>：从这里也可以看出，仿射密码并不能覆盖所有可能的替换情况（共 $ 26! $ 种），因此它并不适合作为简单替换加密的方式。这也很好理解：简单替换是基于对字母表的任意排列，具有高度随机性，而仿射密码依赖的是可计算的数学公式，替换模式固定，无法实现完全随机的映射。</p>
<br>

<h1 id="5-唯密文攻击-——-统计分析法"><a href="#5-唯密文攻击-——-统计分析法" class="headerlink" title="5. 唯密文攻击 —— 统计分析法"></a><strong>5. 唯密文攻击 —— 统计分析法</strong></h1><p>看到这里，你或许会觉得大功告成 —— 只要用简单替换密码（Simple Substitution Cipher）加密信件，便能高枕无忧。但事实真的如此吗？</p>
<p>若密文篇幅较短，在密钥未知的情况下，确实难以破解；可一旦密文足够长，情况就会截然不同。要知道，替换密码依赖固定码表，加密过程中每个字母始终对应唯一字母（比如 A 永远替换为 Z）。这意味着，字母出现的频次在加密前后保持不变：明文中 A 出现 20 次，密文中 Z 便必然出现 20 次。这一特性，就给了攻击者可乘之机。</p>
<h2 id="5-1-破译原理"><a href="#5-1-破译原理" class="headerlink" title="5.1 破译原理"></a><strong>5.1 破译原理</strong></h2><p><strong>频率分析</strong>（Frequency Analysis）是密码学中常用的分析手段，指通过研究字母或字母组合在文本中出现的频率规律，来辅助破解加密内容。任何语言在书写时，字符出现的频率都具有稳定的分布特征。</p>
<p>例如在英语中，字母 E 最常出现，而 Z 较为少见；常见的字母组合包括 TH、NG、ST、QU，而 QJ、NZ 等组合则极少。在现代汉语中，常用字如“的”“不”“是”出现频率很高，而“翊”“谧”“觑”等字则极为罕见。频率分析正是利用这些分布规律来推测密文中字符的真实含义。</p>
<center><img src="https://dstbp.com/data/imgs/posts/msc/letter_freq.png" width="800"></center>

<center style="margin-top: 10px; margin-bottom: 18px;"><span style="font-family:楷体;font-size:14px;">图 5.1 英语语料中的字母频率</span></center>

<p>我们只需将密文中频率最高的字母替换成 e、第二高的替换成 t，依次类推，便有极大概率恢复出明文。</p>
<h2 id="5-2-研究背景"><a href="#5-2-研究背景" class="headerlink" title="5.2 研究背景"></a><strong>5.2 研究背景</strong></h2><p>自频率分析提出以来，众多研究者不断对其方法进行改进和优化，提出了多种策略以提升其效率。如今，频率分析在破解单表替换密码中的速度和准确性已大幅提高。下面，将简要回顾频率分析的发展历程及其代表成果。</p>
<h3 id="5-2-1-传统频率分析"><a href="#5-2-1-传统频率分析" class="headerlink" title="5.2.1 传统频率分析"></a><strong>5.2.1 传统频率分析</strong></h3><p>最基本的频率分析方法是：先统计密文中各字母的出现频率，再将其与目标语言中常见字母的标准频率分布进行一一对应映射，从而推测出明文内容。</p>
<p>然而在实际应用中，频率分析存在显著局限。尽管像 “E”、“T”、“A”、“O” 等字母在英文中通常出现频率较高，但具体分布会因文本类型、主题或写作风格的不同而有所变化。此外，在篇幅较短的文本中，一些字母可能完全不出现，使得频率分布不稳定，降低了分析的准确性和可预测性。</p>
<p>比如《杀死一只知更鸟》第二章前两段的字母频率分布，便能明显看出与标准频率分布并不吻合。</p>
<center><img src="https://dstbp.com/data/imgs/posts/msc/freq_inconsistent.png" width="800"></center>

<center style="margin-top: 10px; margin-bottom: 18px;"><span style="font-family:楷体;font-size:14px;">图 5.2 已知统计数据与样本数据之间的字母频率比较</span></center>

<p>针对这一问题，吴俊斌、吴干华<sup> [1-2] </sup>等学者发现，尽管某些样本的字母频率与标准分布不完全一致，但整体趋势通常相似，且在频率曲线上常出现明显的分界点。例如，字母 e 与 t 之间，或 r 与 d 之间，频率差距显著。基于这一观察，可以将频率分布划分为若干组，并在每组内进行全排列穷举匹配，尝试不同的字母映射组合。每生成一个候选映射表，对密文进行解密，并使用如 nltk 等语料库判断解密结果中合法单词占比，若该占比超过设定阈值，即可认为密文已成功破解。</p>
<table>
<thead>
<tr>
<th align="left"><strong>频率分组</strong></th>
<th align="left"><strong>字母</strong></th>
<th><strong>频率范围</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="left">极高频率字母组</td>
<td align="left">E</td>
<td>≥ 10%</td>
</tr>
<tr>
<td align="left">次高频率字母组</td>
<td align="left">T、A、O、I、N、S、H、R</td>
<td>6% ~ 9%</td>
</tr>
<tr>
<td align="left">中等频率字母组</td>
<td align="left">D、L</td>
<td>4% ~ 5%</td>
</tr>
<tr>
<td align="left">低频率字母组</td>
<td align="left">C、U、M、W、F、G、Y、P、B</td>
<td>1.5% ~ 3%</td>
</tr>
<tr>
<td align="left">极低频率字母组</td>
<td align="left">V、K、J、X、Q、Z</td>
<td>&lt; 1%</td>
</tr>
</tbody></table>
<center style="margin-top: 10px; margin-bottom: 18px;"><span style="font-family:楷体;font-size:14px;">表 5.1 标准频率分组</span></center>

<p>通过这种分组策略，原本需要尝试的 $ 26! $ 种情况显著减少，降低到了 $ 8!\times2!\times9!\times6! $。降低了破解的计算复杂度。</p>
<p><strong>代码实现（python）</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> nltk.corpus <span class="keyword">import</span> words</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> permutations, product</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment"># 首次使用需要下载词库</span></span><br><span class="line"><span class="comment"># nltk.download(&#x27;words&#x27;)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">FrequencyAnalysis</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, clue: <span class="built_in">dict</span> = <span class="literal">None</span></span>):</span><br><span class="line">        <span class="comment"># 标准英文字母频率分布</span></span><br><span class="line">        <span class="variable language_">self</span>.letter_freq = &#123;</span><br><span class="line">            <span class="string">&#x27;e&#x27;</span>: <span class="number">12.702</span>, <span class="string">&#x27;t&#x27;</span>: <span class="number">9.056</span>, <span class="string">&#x27;a&#x27;</span>: <span class="number">8.167</span>, <span class="string">&#x27;o&#x27;</span>: <span class="number">7.507</span>, <span class="string">&#x27;i&#x27;</span>: <span class="number">6.966</span>, <span class="string">&#x27;n&#x27;</span>: <span class="number">6.749</span>, </span><br><span class="line">            <span class="string">&#x27;s&#x27;</span>: <span class="number">6.327</span>, <span class="string">&#x27;h&#x27;</span>: <span class="number">6.094</span>, <span class="string">&#x27;r&#x27;</span>: <span class="number">5.987</span>, <span class="string">&#x27;d&#x27;</span>: <span class="number">4.253</span>, <span class="string">&#x27;l&#x27;</span>: <span class="number">4.025</span>, <span class="string">&#x27;c&#x27;</span>: <span class="number">2.782</span>, </span><br><span class="line">            <span class="string">&#x27;u&#x27;</span>: <span class="number">2.758</span>, <span class="string">&#x27;m&#x27;</span>: <span class="number">2.406</span>, <span class="string">&#x27;w&#x27;</span>: <span class="number">2.360</span>, <span class="string">&#x27;f&#x27;</span>: <span class="number">2.228</span>, <span class="string">&#x27;g&#x27;</span>: <span class="number">2.015</span>, <span class="string">&#x27;y&#x27;</span>: <span class="number">1.974</span>, </span><br><span class="line">            <span class="string">&#x27;p&#x27;</span>: <span class="number">1.929</span>, <span class="string">&#x27;b&#x27;</span>: <span class="number">1.492</span>, <span class="string">&#x27;v&#x27;</span>: <span class="number">0.978</span>, <span class="string">&#x27;k&#x27;</span>: <span class="number">0.772</span>, <span class="string">&#x27;j&#x27;</span>: <span class="number">0.153</span>, <span class="string">&#x27;x&#x27;</span>: <span class="number">0.150</span>, </span><br><span class="line">            <span class="string">&#x27;q&#x27;</span>: <span class="number">0.095</span>, <span class="string">&#x27;z&#x27;</span>: <span class="number">0.074</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 基于频率分界点的分组策略</span></span><br><span class="line">        <span class="variable language_">self</span>.freq_groups = [</span><br><span class="line">            [<span class="string">&#x27;e&#x27;</span>],                    <span class="comment"># 1! = 1</span></span><br><span class="line">            [<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;r&#x27;</span>],  <span class="comment"># 8! = 40320</span></span><br><span class="line">            [<span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;l&#x27;</span>],              <span class="comment"># 2! = 2</span></span><br><span class="line">            [<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, <span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;b&#x27;</span>],  <span class="comment"># 9! = 362880</span></span><br><span class="line">            [<span class="string">&#x27;v&#x27;</span>, <span class="string">&#x27;k&#x27;</span>, <span class="string">&#x27;j&#x27;</span>, <span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;q&#x27;</span>, <span class="string">&#x27;z&#x27;</span>]  <span class="comment"># 6! = 720</span></span><br><span class="line">        ]</span><br><span class="line">        </span><br><span class="line">        <span class="variable language_">self</span>.clue = clue <span class="keyword">or</span> &#123;&#125;</span><br><span class="line">        <span class="variable language_">self</span>.english_words = <span class="built_in">set</span>(words.words())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_ciphertext_frequency</span>(<span class="params">self, ciphertext: <span class="built_in">str</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;统计密文字符频率&quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># 只统计字母字符</span></span><br><span class="line">        letters = [c.lower() <span class="keyword">for</span> c <span class="keyword">in</span> ciphertext <span class="keyword">if</span> c.isalpha()]</span><br><span class="line">        <span class="keyword">return</span> Counter(letters)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">calculate_word_ratio</span>(<span class="params">self, text: <span class="built_in">str</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;计算文本中合法英文单词的占比&quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># 清理文本</span></span><br><span class="line">        translator = <span class="built_in">str</span>.maketrans(<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, string.punctuation)</span><br><span class="line">        cleaned_text = text.translate(translator)</span><br><span class="line">        words_list = cleaned_text.lower().split()</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> words_list:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0.0</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 统计合法单词</span></span><br><span class="line">        valid_count = <span class="built_in">sum</span>(<span class="number">1</span> <span class="keyword">for</span> word <span class="keyword">in</span> words_list <span class="keyword">if</span> word <span class="keyword">in</span> <span class="variable language_">self</span>.english_words)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">round</span>(valid_count / <span class="built_in">len</span>(words_list), <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt_text</span>(<span class="params">self, ciphertext: <span class="built_in">str</span>, mapping: <span class="built_in">dict</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;根据映射表解密文本&quot;&quot;&quot;</span></span><br><span class="line">        result = []</span><br><span class="line">        <span class="keyword">for</span> char <span class="keyword">in</span> ciphertext:</span><br><span class="line">            <span class="keyword">if</span> char.isalpha():</span><br><span class="line">                <span class="comment"># 查找映射</span></span><br><span class="line">                <span class="keyword">for</span> plain_char, cipher_char <span class="keyword">in</span> mapping.items():</span><br><span class="line">                    <span class="keyword">if</span> char.lower() == cipher_char:</span><br><span class="line">                        result.append(plain_char.upper() <span class="keyword">if</span> char.isupper() <span class="keyword">else</span> plain_char)</span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    result.append(char)  <span class="comment"># 未找到映射，保持原字符</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                result.append(char)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(result)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">create_mapping</span>(<span class="params">self, plain_groups: <span class="built_in">list</span>, cipher_groups: <span class="built_in">list</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;创建字母映射表&quot;&quot;&quot;</span></span><br><span class="line">        mapping = &#123;&#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 应用已知线索</span></span><br><span class="line">        <span class="keyword">for</span> plain_char, cipher_char <span class="keyword">in</span> <span class="variable language_">self</span>.clue.items():</span><br><span class="line">            mapping[plain_char] = cipher_char</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 根据分组创建映射</span></span><br><span class="line">        <span class="keyword">for</span> plain_group, cipher_group <span class="keyword">in</span> <span class="built_in">zip</span>(plain_groups, cipher_groups):</span><br><span class="line">            <span class="keyword">for</span> plain_char, cipher_char <span class="keyword">in</span> <span class="built_in">zip</span>(plain_group, cipher_group):</span><br><span class="line">                <span class="keyword">if</span> plain_char <span class="keyword">not</span> <span class="keyword">in</span> <span class="variable language_">self</span>.clue:  <span class="comment"># 跳过已知映射</span></span><br><span class="line">                    mapping[plain_char] = cipher_char</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> mapping</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">frequency_analysis</span>(<span class="params">self, ciphertext: <span class="built_in">str</span>, min_ratio: <span class="built_in">float</span> = <span class="number">0.6</span>, show_progress: <span class="built_in">bool</span> = <span class="literal">True</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;频率分析主函数&quot;&quot;&quot;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;开始频率分析...&quot;</span>)</span><br><span class="line">        start_time = time.time()</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 获取密文字符频率</span></span><br><span class="line">        cipher_freq = <span class="variable language_">self</span>.get_ciphertext_frequency(ciphertext)</span><br><span class="line">        sorted_cipher_chars = [char <span class="keyword">for</span> char, _ <span class="keyword">in</span> cipher_freq.most_common()]</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 按频率分组密文字符</span></span><br><span class="line">        cipher_groups = []</span><br><span class="line">        start = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> group_size <span class="keyword">in</span> [<span class="number">1</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">9</span>, <span class="number">6</span>]:</span><br><span class="line">            end = start + group_size</span><br><span class="line">            <span class="keyword">if</span> start &lt; <span class="built_in">len</span>(sorted_cipher_chars):</span><br><span class="line">                group = sorted_cipher_chars[start:end]</span><br><span class="line">                cipher_groups.append(group)</span><br><span class="line">                start = end</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;密文字符分组: <span class="subst">&#123;cipher_groups&#125;</span>&quot;</span>)</span><br><span class="line">        total_combinations = <span class="variable language_">self</span>._calculate_complexity(cipher_groups)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;计算复杂度: <span class="subst">&#123;total_combinations:,&#125;</span> 种组合&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 生成所有可能的映射组合</span></span><br><span class="line">        best_result = <span class="literal">None</span></span><br><span class="line">        best_ratio = <span class="number">0</span></span><br><span class="line">        tested_count = <span class="number">0</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 创建进度条</span></span><br><span class="line">        <span class="keyword">if</span> show_progress:</span><br><span class="line">            pbar = tqdm(total=total_combinations, desc=<span class="string">&quot;破解进度&quot;</span>, unit=<span class="string">&quot;组合&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> plain_perm <span class="keyword">in</span> <span class="variable language_">self</span>._generate_group_permutations(cipher_groups):</span><br><span class="line">            mapping = <span class="variable language_">self</span>.create_mapping(plain_perm, cipher_groups)</span><br><span class="line">            decrypted = <span class="variable language_">self</span>.decrypt_text(ciphertext, mapping)</span><br><span class="line">            ratio = <span class="variable language_">self</span>.calculate_word_ratio(decrypted)</span><br><span class="line">            tested_count += <span class="number">1</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> show_progress:</span><br><span class="line">                pbar.update(<span class="number">1</span>)</span><br><span class="line">                pbar.set_postfix(&#123;</span><br><span class="line">                    <span class="string">&#x27;当前比率&#x27;</span>: <span class="string">f&quot;<span class="subst">&#123;ratio:<span class="number">.3</span>f&#125;</span>&quot;</span>,</span><br><span class="line">                    <span class="string">&#x27;最佳比率&#x27;</span>: <span class="string">f&quot;<span class="subst">&#123;best_ratio:<span class="number">.3</span>f&#125;</span>&quot;</span>,</span><br><span class="line">                    <span class="string">&#x27;已测试&#x27;</span>: <span class="string">f&quot;<span class="subst">&#123;tested_count:,&#125;</span>&quot;</span></span><br><span class="line">                &#125;)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> ratio &gt; best_ratio:</span><br><span class="line">                best_ratio = ratio</span><br><span class="line">                best_result = &#123;</span><br><span class="line">                    <span class="string">&#x27;text&#x27;</span>: decrypted,</span><br><span class="line">                    <span class="string">&#x27;mapping&#x27;</span>: mapping,</span><br><span class="line">                    <span class="string">&#x27;ratio&#x27;</span>: ratio</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> ratio &gt;= min_ratio:</span><br><span class="line">                    <span class="keyword">if</span> show_progress:</span><br><span class="line">                        pbar.close()</span><br><span class="line">                    elapsed_time = time.time() - start_time</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;\n找到高质量结果 (比率: <span class="subst">&#123;ratio:<span class="number">.3</span>f&#125;</span>)&quot;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;耗时: <span class="subst">&#123;elapsed_time:<span class="number">.2</span>f&#125;</span>秒&quot;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;映射: <span class="subst">&#123;mapping&#125;</span>&quot;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;明文: <span class="subst">&#123;decrypted[:<span class="number">200</span>]&#125;</span>...&quot;</span>)</span><br><span class="line">                    <span class="keyword">return</span> best_result</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> show_progress:</span><br><span class="line">            pbar.close()</span><br><span class="line">        </span><br><span class="line">        elapsed_time = time.time() - start_time</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\n总耗时: <span class="subst">&#123;elapsed_time:<span class="number">.2</span>f&#125;</span>秒&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;测试了 <span class="subst">&#123;tested_count:,&#125;</span> 种组合&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> best_result:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;\n最佳结果 (比率: <span class="subst">&#123;best_ratio:<span class="number">.3</span>f&#125;</span>):&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;映射: <span class="subst">&#123;best_result[<span class="string">&#x27;mapping&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;明文: <span class="subst">&#123;best_result[<span class="string">&#x27;text&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;未找到满意的解密结果&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> best_result</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_generate_group_permutations</span>(<span class="params">self, cipher_groups</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;生成所有可能的明文分组排列&quot;&quot;&quot;</span></span><br><span class="line">        group_permutations = []</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> i, cipher_group <span class="keyword">in</span> <span class="built_in">enumerate</span>(cipher_groups):</span><br><span class="line">            plain_group = <span class="variable language_">self</span>.freq_groups[i]</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(plain_group) == <span class="built_in">len</span>(cipher_group):</span><br><span class="line">                perms = <span class="built_in">list</span>(permutations(plain_group))</span><br><span class="line">                group_permutations.append(perms)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="comment"># 如果长度不匹配，使用原始顺序</span></span><br><span class="line">                group_permutations.append([plain_group])</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 生成所有组合</span></span><br><span class="line">        <span class="keyword">for</span> combo <span class="keyword">in</span> product(*group_permutations):</span><br><span class="line">            <span class="keyword">yield</span> <span class="built_in">list</span>(combo)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_calculate_complexity</span>(<span class="params">self, cipher_groups</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;计算计算复杂度&quot;&quot;&quot;</span></span><br><span class="line">        total_combinations = <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> i, group <span class="keyword">in</span> <span class="built_in">enumerate</span>(cipher_groups):</span><br><span class="line">            <span class="keyword">if</span> i &lt; <span class="built_in">len</span>(<span class="variable language_">self</span>.freq_groups):</span><br><span class="line">                plain_group = <span class="variable language_">self</span>.freq_groups[i]</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">len</span>(group) == <span class="built_in">len</span>(plain_group):</span><br><span class="line">                    total_combinations *= <span class="built_in">len</span>(<span class="built_in">list</span>(permutations(plain_group)))</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> total_combinations</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    ciphertext = <span class="string">&#x27;&#x27;&#x27;Gann niuc vr ipknw af Rixciohik, cd kicvkf cd Oikagapf1. Ti rpt eao duu df cei uasi d&#x27;qndqlhvr pfg A tpr oarikphni2 tacedvc eao vfcan ac dqqvkkig cd oi cepc A tdvng hi rcpkcafm cdrqeddn af p tiil. A fisik nddlig udktpkg odki cd pfwceafm af ow naui. Edvkr du tafcikcaoiepg udvfg oi af cei ckiiedvri, nddlafm dsik pc cei rqeddnwpkg, rxwafm df ovncacvgir duqeangkif cekdvme p ctd-xdtik cinirqdxi Yio epg masif oi, nipkfafm ceiak mpoir,udnndtafm Yio&#x27;r kig ypqlic cekdvme tkammnafm3 qakqnir du hnafg opf&#x27;r hvuu, riqkicnw repkafmceiak oarudkcvfir pfg oafdk4 saqcdkair. A ndfmig cd ydaf ceio.</span></span><br><span class="line"><span class="string">Yio qdfgirqifgig5 cd cpli oi cd rqeddn cei uakrc gpw, p ydh vrvpnnw gdfi hw dfi&#x27;rxpkifcr, hvc Pccaqvr epg rpag Yio tdvng hi ginamecig cd redt oi teiki ow kddo tpr. Aceafl rdoi odfiw qepfmig epfgr af cear ckpfrpqcadf, udk pr ti ckdccig6 pkdvfg ceiqdkfik xprc cei Kpgniw Xnpqi A eipkg pf vfupoanapk7 yafmni8 af Yio&#x27;r xdqlicr. Teif tirndtig cd p tpnl pc cei igmi du cei rqeddnwpkg, Yio tpr qpkiuvn cd izxnpaf cepc gvkafmrqeddn edvkr A tpr fdc cd hdceik eao, A tpr fdc cd pxxkdpqe eao tace kijvircr cd ifpqc9 pqepxcik du Cpkbpf pfg cei Pfc Oif, cd iohpkkprr eao tace kiuikifqir cd ear xkaspci naui,dk cpm pndfm hieafg eao pc kiqirr10 pfg fddf. A tpr cd rcaql tace cei uakrc mkpgi pfg eitdvng rcaql tace cei uauce. Af redkc, A tpr cd nipsi eao pndfi.&#x27;&#x27;&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 创建频率分析器实例</span></span><br><span class="line">    fa = FrequencyAnalysis()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 执行频率分析</span></span><br><span class="line">    result = fa.frequency_analysis(ciphertext, min_ratio=<span class="number">0.5</span>, show_progress=<span class="literal">True</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> result:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\n最终结果:&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;单词匹配率: <span class="subst">&#123;result[<span class="string">&#x27;ratio&#x27;</span>]:<span class="number">.3</span>f&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;解密文本: <span class="subst">&#123;result[<span class="string">&#x27;text&#x27;</span>]&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;未找到满意的解密结果&quot;</span>) </span><br></pre></td></tr></table></figure>

<h3 id="5-2-2-候选密钥-词典匹配频率分析"><a href="#5-2-2-候选密钥-词典匹配频率分析" class="headerlink" title="5.2.2 候选密钥+词典匹配频率分析"></a><strong>5.2.2 候选密钥+词典匹配频率分析</strong></h3><p>尽管传统频率分析已大幅减少尝试次数，但计算量仍然庞大。为进一步提高效率，可以结合单词频率分析来辅助破解。比如说：先识别密文中出现频率最高的符号，假设它对应字母 e，并进行初步替换；接着查找密文中出现的单字母单词，尝试替换为常见的 a 或 I；然后分析包含 e 的高频单词结构，如 “the”、”that”、”who”、”is” 等，逐步推测其他字母的替换关系。</p>
<p>通过不断匹配已知高频英文单词，并据此反推出潜在的替换规则，再将更新后的假设应用于密文，循环修正、验证，直到成功还原原文。</p>
<p>Kang 等人<sup>[3]</sup> 与 2024 年提出一种基于候选密钥+词典匹配的频率分析方法，具体操作如下：</p>
<p>首先，通过对密文进行字母频率分析，并与标准频率分布进行对应，构造一个<strong>初始密钥</strong>。接下来，为了让这个初始密钥更精确，系统执行下面优化算法：</p>
<ol>
<li><p>在初始密钥基础上，随机交换映射表中两个字母，计算一个评价函数评估新密钥的解密效果<sup>[4]</sup>。<br>$$<br>f(t)&#x3D;\sum_{i,\ j}|D_{ij}(t)-E_{ij}|<br>$$<br>其中 $ D(t) $ 和 $ E $ 是 $ 26 \times 26 $ 的矩阵，分别表示给定文本 $ t $ 的双字母频率和英语字母常见双字母频率<sup>[5]</sup>。</p>
<center><img src="https://dstbp.com/data/imgs/posts/msc/bigram_frequency_table.png" width="800"></center>

<center style="margin-top: 10px; margin-bottom: 18px;"><span style="font-family:楷体;font-size:14px;">图 5.3 双字母频率分布表</span></center>

<p>遍历矩阵索引并比较这些频率，如果 $ f(t) $ 减少，表示新组合的效果更好，更接近标准频率，解密结果更像英文。就用新密钥替换旧密钥，重复 3000 次，得到优化后的密钥。（大约 3000 次后，$ f(t) $ 趋于收敛）</p>
</li>
<li><p>考虑随机性带来的结果差异，算法会生成多个<strong>候选密钥</strong>，以覆盖更大可能空间。（作者发现生成 10 个密钥就能覆盖较好的解密可能性）</p>
</li>
<li><p>将密文中非字母字符（如引号、标点）转成空格，并按空格切分成<strong>密文单词片段（tokens）</strong>。分别用每个候选密钥对其解密。</p>
</li>
<li><p>接入词典 API。对每个解密结果，查找相似的英文单词，并用一个打分函数来评估每个单词的可信度。打分函数考虑三个因素：</p>
<ul>
<li>相似单词在其他候选结果中出现的次数（出现越多越可信）</li>
<li>词的流行程度（由词典 API 给出，流行度越高越可信）</li>
<li>单词长度（越长、越具体越可信）</li>
</ul>
<p> 三个因素综合成一个打分值 $ S $，用来衡量该解密结果更像哪个真实词。</p>
</li>
</ol>
<p>$$<br>S&#x3D;count \times (1+\log_{10}(reputation)) \times length<br>$$</p>
<ol start="5">
<li>将每个 token 与其最接近的真实单词组成的元组列表按打分值 $ S $ 排序。对得分高的 token，优先尝试用其对应的真实单词反推替换密钥，并据此逐步修正整体映射关系。具体操作如下：<ul>
<li>如果当前 token 长度 &lt; 4，先不处理，防止出错。</li>
<li>如果替换不冲突，更新密钥。</li>
<li>如果冲突，保留空位，后续再尝试其它 token 处理。</li>
</ul>
</li>
<li>最终，系统输出与真实英文最接近的解密结果所对应的密钥。若密文未涵盖全部 26 个字母，或推导出的密钥存在缺失，系统将对剩余未出现的字母进行全排列补全。由于缺失字母数量有限，这部分爆破尝试次数在可接受范围内。</li>
</ol>
<center><img src="https://dstbp.com/data/imgs/posts/msc/Kang_plan.png" width="800"></center>

<center style="margin-top: 10px; margin-bottom: 18px;"><span style="font-family:楷体;font-size:14px;">图 5.4 基于候选密钥+词典匹配的频率分析流程图</span></center>

<p>该方法的优势在于：它适用于短密文，即使缺乏足够的统计特征也能发挥作用；不依赖大量训练数据或上下文信息；同时通过利用自然语言特征，如常见单词和拼写规则，有效提升了解密的准确性，并能在有限时间内解出密文。</p>
<p><strong>代码实现（python）</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> wordfreq</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"><span class="keyword">from</span> autocorrect <span class="keyword">import</span> Speller</span><br><span class="line"><span class="keyword">from</span> nltk.corpus <span class="keyword">import</span> words</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> permutations</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> punctuation</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Dict</span>, <span class="type">List</span>, <span class="type">Tuple</span>, <span class="type">Optional</span></span><br><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"></span><br><span class="line"><span class="comment"># 首次使用需要下载词库</span></span><br><span class="line"><span class="comment"># nltk.download(&#x27;words&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">FrequencyAnalysis</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;频率分析类 - 用于破解替换密码&quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 标准英文字母频率分布</span></span><br><span class="line">    LETTER_FREQ = &#123;</span><br><span class="line">        <span class="string">&#x27;e&#x27;</span>: <span class="number">12.702</span>, <span class="string">&#x27;t&#x27;</span>: <span class="number">9.056</span>, <span class="string">&#x27;a&#x27;</span>: <span class="number">8.167</span>, <span class="string">&#x27;o&#x27;</span>: <span class="number">7.507</span>, <span class="string">&#x27;i&#x27;</span>: <span class="number">6.966</span>, <span class="string">&#x27;n&#x27;</span>: <span class="number">6.749</span>, </span><br><span class="line">        <span class="string">&#x27;s&#x27;</span>: <span class="number">6.327</span>, <span class="string">&#x27;h&#x27;</span>: <span class="number">6.094</span>, <span class="string">&#x27;r&#x27;</span>: <span class="number">5.987</span>, <span class="string">&#x27;d&#x27;</span>: <span class="number">4.253</span>, <span class="string">&#x27;l&#x27;</span>: <span class="number">4.025</span>, <span class="string">&#x27;c&#x27;</span>: <span class="number">2.782</span>, </span><br><span class="line">        <span class="string">&#x27;u&#x27;</span>: <span class="number">2.758</span>, <span class="string">&#x27;m&#x27;</span>: <span class="number">2.406</span>, <span class="string">&#x27;w&#x27;</span>: <span class="number">2.360</span>, <span class="string">&#x27;f&#x27;</span>: <span class="number">2.228</span>, <span class="string">&#x27;g&#x27;</span>: <span class="number">2.015</span>, <span class="string">&#x27;y&#x27;</span>: <span class="number">1.974</span>, </span><br><span class="line">        <span class="string">&#x27;p&#x27;</span>: <span class="number">1.929</span>, <span class="string">&#x27;b&#x27;</span>: <span class="number">1.492</span>, <span class="string">&#x27;v&#x27;</span>: <span class="number">0.978</span>, <span class="string">&#x27;k&#x27;</span>: <span class="number">0.772</span>, <span class="string">&#x27;j&#x27;</span>: <span class="number">0.153</span>, <span class="string">&#x27;x&#x27;</span>: <span class="number">0.150</span>, </span><br><span class="line">        <span class="string">&#x27;q&#x27;</span>: <span class="number">0.095</span>, <span class="string">&#x27;z&#x27;</span>: <span class="number">0.074</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, clue: <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="built_in">str</span>] = <span class="literal">None</span>, bigram_file: <span class="built_in">str</span> = <span class="literal">None</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        初始化频率分析器</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="variable language_">self</span>.clue = clue <span class="keyword">or</span> &#123;&#125;</span><br><span class="line">        <span class="variable language_">self</span>.english_words = <span class="built_in">set</span>(words.words())</span><br><span class="line">        <span class="variable language_">self</span>.speller = Speller(lang=<span class="string">&#x27;en&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 字母映射表</span></span><br><span class="line">        <span class="variable language_">self</span>.letter_to_index = &#123;letter: i <span class="keyword">for</span> i, letter <span class="keyword">in</span> <span class="built_in">enumerate</span>(<span class="string">&#x27;abcdefghijklmnopqrstuvwxyz&#x27;</span>)&#125;</span><br><span class="line">        <span class="variable language_">self</span>.index_to_letter = &#123;i: letter <span class="keyword">for</span> i, letter <span class="keyword">in</span> <span class="built_in">enumerate</span>(<span class="string">&#x27;abcdefghijklmnopqrstuvwxyz&#x27;</span>)&#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 加载双字母频率矩阵</span></span><br><span class="line">        <span class="variable language_">self</span>.expected_bigram_matrix = <span class="variable language_">self</span>._load_bigram_matrix(bigram_file)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_load_bigram_matrix</span>(<span class="params">self, file_path: <span class="type">Optional</span>[<span class="built_in">str</span>] = <span class="literal">None</span></span>) -&gt; np.ndarray:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;加载双字母频率矩阵&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> file_path <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            file_path = Path(__file__).parent / <span class="string">&#x27;bigram_frequency_matrix.json&#x27;</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                data = json.load(f)</span><br><span class="line">                <span class="keyword">return</span> np.array(data[<span class="string">&#x27;matrix&#x27;</span>])</span><br><span class="line">        <span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;警告: 未找到双字母频率矩阵文件 <span class="subst">&#123;file_path&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> np.ones((<span class="number">26</span>, <span class="number">26</span>)) * <span class="number">0.01</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">analyze_frequency</span>(<span class="params">self, text: <span class="built_in">str</span></span>) -&gt; <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="built_in">float</span>]:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;分析文本中字母频率&quot;&quot;&quot;</span></span><br><span class="line">        letters = [c.lower() <span class="keyword">for</span> c <span class="keyword">in</span> text <span class="keyword">if</span> c.isalpha()]</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> letters:</span><br><span class="line">            <span class="keyword">return</span> &#123;&#125;</span><br><span class="line">        </span><br><span class="line">        counter = Counter(letters)</span><br><span class="line">        total = <span class="built_in">len</span>(letters)</span><br><span class="line">        <span class="keyword">return</span> &#123;char: (count / total) * <span class="number">100</span> <span class="keyword">for</span> char, count <span class="keyword">in</span> counter.items()&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_bigram_matrix</span>(<span class="params">self, text: <span class="built_in">str</span></span>) -&gt; np.ndarray:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;计算文本的双字母频率矩阵&quot;&quot;&quot;</span></span><br><span class="line">        matrix = np.zeros((<span class="number">26</span>, <span class="number">26</span>))</span><br><span class="line">        letters = [c.lower() <span class="keyword">for</span> c <span class="keyword">in</span> text <span class="keyword">if</span> c.isalpha()]</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 统计双字母频率</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(letters) - <span class="number">1</span>):</span><br><span class="line">            first, second = letters[i], letters[i + <span class="number">1</span>]</span><br><span class="line">            <span class="keyword">if</span> first <span class="keyword">in</span> <span class="variable language_">self</span>.letter_to_index <span class="keyword">and</span> second <span class="keyword">in</span> <span class="variable language_">self</span>.letter_to_index:</span><br><span class="line">                row = <span class="variable language_">self</span>.letter_to_index[first]</span><br><span class="line">                col = <span class="variable language_">self</span>.letter_to_index[second]</span><br><span class="line">                matrix[row][col] += <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 归一化</span></span><br><span class="line">        total = np.<span class="built_in">sum</span>(matrix)</span><br><span class="line">        <span class="keyword">return</span> (matrix / total * <span class="number">100</span>) <span class="keyword">if</span> total &gt; <span class="number">0</span> <span class="keyword">else</span> matrix</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt_text</span>(<span class="params">self, ciphertext: <span class="built_in">str</span>, mapping: <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="built_in">str</span>]</span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;根据映射表解密文本&quot;&quot;&quot;</span></span><br><span class="line">        result = []</span><br><span class="line">        <span class="keyword">for</span> char <span class="keyword">in</span> ciphertext:</span><br><span class="line">            <span class="keyword">if</span> char.isalpha():</span><br><span class="line">                <span class="comment"># 查找映射</span></span><br><span class="line">                <span class="keyword">for</span> plain_char, cipher_char <span class="keyword">in</span> mapping.items():</span><br><span class="line">                    <span class="keyword">if</span> char.lower() == cipher_char:</span><br><span class="line">                        result.append(plain_char.upper() <span class="keyword">if</span> char.isupper() <span class="keyword">else</span> plain_char)</span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    result.append(char)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                result.append(char)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(result)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">create_initial_mapping</span>(<span class="params">self, cipher_freq: <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="built_in">float</span>]</span>) -&gt; <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="built_in">str</span>]:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;基于频率分析创建初始映射&quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># 按频率排序</span></span><br><span class="line">        sorted_cipher = <span class="built_in">sorted</span>(cipher_freq.items(), key=<span class="keyword">lambda</span> x: x[<span class="number">1</span>], reverse=<span class="literal">True</span>)</span><br><span class="line">        sorted_standard = <span class="built_in">sorted</span>(<span class="variable language_">self</span>.LETTER_FREQ.items(), key=<span class="keyword">lambda</span> x: x[<span class="number">1</span>], reverse=<span class="literal">True</span>)</span><br><span class="line">        </span><br><span class="line">        mapping = &#123;&#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 应用已知线索</span></span><br><span class="line">        <span class="keyword">for</span> plain_char, cipher_char <span class="keyword">in</span> <span class="variable language_">self</span>.clue.items():</span><br><span class="line">            mapping[plain_char] = cipher_char</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 根据频率对应创建映射</span></span><br><span class="line">        cipher_chars = [char <span class="keyword">for</span> char, _ <span class="keyword">in</span> sorted_cipher]</span><br><span class="line">        standard_chars = [char <span class="keyword">for</span> char, _ <span class="keyword">in</span> sorted_standard]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> cipher_char, standard_char <span class="keyword">in</span> <span class="built_in">zip</span>(cipher_chars, standard_chars):</span><br><span class="line">            <span class="keyword">if</span> standard_char <span class="keyword">not</span> <span class="keyword">in</span> <span class="variable language_">self</span>.clue:</span><br><span class="line">                mapping[standard_char] = cipher_char</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> mapping</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">evaluate_mapping</span>(<span class="params">self, ciphertext: <span class="built_in">str</span>, mapping: <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="built_in">str</span>]</span>) -&gt; <span class="built_in">float</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;评价映射质量&quot;&quot;&quot;</span></span><br><span class="line">        decrypted_text = <span class="variable language_">self</span>.decrypt_text(ciphertext, mapping)</span><br><span class="line">        actual_matrix = <span class="variable language_">self</span>.get_bigram_matrix(decrypted_text)</span><br><span class="line">        difference = np.<span class="built_in">abs</span>(actual_matrix - <span class="variable language_">self</span>.expected_bigram_matrix)</span><br><span class="line">        <span class="keyword">return</span> np.<span class="built_in">sum</span>(difference)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">swap_random_chars</span>(<span class="params">self, mapping: <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="built_in">str</span>]</span>) -&gt; <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="built_in">str</span>]:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;随机交换映射表中的两个字母&quot;&quot;&quot;</span></span><br><span class="line">        new_mapping = mapping.copy()</span><br><span class="line">        available_chars = [char <span class="keyword">for</span> char <span class="keyword">in</span> mapping.keys() <span class="keyword">if</span> char <span class="keyword">not</span> <span class="keyword">in</span> <span class="variable language_">self</span>.clue]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(available_chars) &lt; <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">return</span> mapping</span><br><span class="line">        </span><br><span class="line">        char1, char2 = random.sample(available_chars, <span class="number">2</span>)</span><br><span class="line">        cipher1, cipher2 = new_mapping[char1], new_mapping[char2]</span><br><span class="line">        new_mapping[char1], new_mapping[char2] = cipher2, cipher1</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> new_mapping</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">optimize_mapping</span>(<span class="params">self, ciphertext: <span class="built_in">str</span>, initial_mapping: <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="built_in">str</span>], </span></span><br><span class="line"><span class="params">                        iterations: <span class="built_in">int</span> = <span class="number">3000</span></span>) -&gt; <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="built_in">str</span>]:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;使用模拟退火算法优化映射&quot;&quot;&quot;</span></span><br><span class="line">        current_mapping = initial_mapping.copy()</span><br><span class="line">        current_score = <span class="variable language_">self</span>.evaluate_mapping(ciphertext, current_mapping)</span><br><span class="line">        best_mapping = current_mapping.copy()</span><br><span class="line">        best_score = current_score</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(iterations):</span><br><span class="line">            new_mapping = <span class="variable language_">self</span>.swap_random_chars(current_mapping)</span><br><span class="line">            new_score = <span class="variable language_">self</span>.evaluate_mapping(ciphertext, new_mapping)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 接受更好的解</span></span><br><span class="line">            <span class="keyword">if</span> new_score &lt; current_score:</span><br><span class="line">                current_mapping = new_mapping</span><br><span class="line">                current_score = new_score</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> new_score &lt; best_score:</span><br><span class="line">                    best_mapping = new_mapping.copy()</span><br><span class="line">                    best_score = new_score</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> best_mapping</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">generate_candidates</span>(<span class="params">self, ciphertext: <span class="built_in">str</span>, initial_mapping: <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="built_in">str</span>], </span></span><br><span class="line"><span class="params">                          num_candidates: <span class="built_in">int</span> = <span class="number">10</span>, iterations: <span class="built_in">int</span> = <span class="number">3000</span></span>) -&gt; <span class="type">List</span>[<span class="type">Dict</span>[<span class="built_in">str</span>, <span class="built_in">str</span>]]:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;生成多个候选映射&quot;&quot;&quot;</span></span><br><span class="line">        candidates = []</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num_candidates):</span><br><span class="line">            random.seed(i + <span class="number">42</span>)  <span class="comment"># 确保多样性</span></span><br><span class="line">            candidate = <span class="variable language_">self</span>.optimize_mapping(ciphertext, initial_mapping, iterations)</span><br><span class="line">            candidates.append(candidate)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> candidates</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">tokenize_text</span>(<span class="params">self, text: <span class="built_in">str</span></span>) -&gt; <span class="type">List</span>[<span class="built_in">str</span>]:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;将文本分割成单词片段&quot;&quot;&quot;</span></span><br><span class="line">        processed = re.sub(<span class="string">r&#x27;[^a-zA-Z]&#x27;</span>, <span class="string">&#x27; &#x27;</span>, text)</span><br><span class="line">        processed = re.sub(<span class="string">r&#x27;\s+&#x27;</span>, <span class="string">&#x27; &#x27;</span>, processed).strip()</span><br><span class="line">        <span class="keyword">return</span> processed.split()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">find_similar_word</span>(<span class="params">self, token: <span class="built_in">str</span></span>) -&gt; <span class="type">Tuple</span>[<span class="built_in">str</span>, <span class="built_in">float</span>]:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;查找相似单词并返回频率&quot;&quot;&quot;</span></span><br><span class="line">        similar_word = <span class="variable language_">self</span>.speller(token)</span><br><span class="line">        reputation = wordfreq.word_frequency(similar_word, <span class="string">&#x27;en&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> similar_word, reputation</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">score_token_candidates</span>(<span class="params">self, token: <span class="built_in">str</span>, candidates: <span class="type">List</span>[<span class="type">Dict</span>[<span class="built_in">str</span>, <span class="built_in">str</span>]]</span>) -&gt; <span class="type">Dict</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;对token的所有候选解密结果进行评分&quot;&quot;&quot;</span></span><br><span class="line">        token_results = []</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> candidate <span class="keyword">in</span> candidates:</span><br><span class="line">            decrypted = <span class="variable language_">self</span>.decrypt_text(token, candidate)</span><br><span class="line">            similar_word, reputation = <span class="variable language_">self</span>.find_similar_word(decrypted)</span><br><span class="line">            </span><br><span class="line">            token_results.append(&#123;</span><br><span class="line">                <span class="string">&#x27;token&#x27;</span>: token,</span><br><span class="line">                <span class="string">&#x27;similar_word&#x27;</span>: similar_word,</span><br><span class="line">                <span class="string">&#x27;reputation&#x27;</span>: reputation</span><br><span class="line">            &#125;)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 统计单词出现次数</span></span><br><span class="line">        word_counts = Counter(result[<span class="string">&#x27;similar_word&#x27;</span>] <span class="keyword">for</span> result <span class="keyword">in</span> token_results)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 计算综合评分</span></span><br><span class="line">        best_result = <span class="built_in">max</span>(token_results, key=<span class="keyword">lambda</span> x: </span><br><span class="line">            word_counts[x[<span class="string">&#x27;similar_word&#x27;</span>]] * (<span class="number">1</span> + x[<span class="string">&#x27;reputation&#x27;</span>]) * <span class="built_in">len</span>(x[<span class="string">&#x27;similar_word&#x27;</span>]))</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> best_result</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">create_token_mapping</span>(<span class="params">self, token: <span class="built_in">str</span>, word: <span class="built_in">str</span></span>) -&gt; <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="built_in">str</span>]:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;根据token和对应单词创建字母映射&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(token) != <span class="built_in">len</span>(word):</span><br><span class="line">            <span class="keyword">return</span> &#123;&#125;</span><br><span class="line">        </span><br><span class="line">        mapping = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> cipher_char, plain_char <span class="keyword">in</span> <span class="built_in">zip</span>(token.lower(), word.lower()):</span><br><span class="line">            <span class="keyword">if</span> cipher_char.isalpha() <span class="keyword">and</span> plain_char.isalpha():</span><br><span class="line">                mapping[plain_char] = cipher_char</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> mapping</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">check_mapping_conflicts</span>(<span class="params">self, new_mapping: <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="built_in">str</span>], </span></span><br><span class="line"><span class="params">                              current_mapping: <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="built_in">str</span>]</span>) -&gt; <span class="type">List</span>[<span class="built_in">str</span>]:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;检查映射冲突&quot;&quot;&quot;</span></span><br><span class="line">        conflicts = []</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> plain_char, cipher_char <span class="keyword">in</span> new_mapping.items():</span><br><span class="line">            <span class="comment"># 检查键冲突</span></span><br><span class="line">            <span class="keyword">if</span> plain_char <span class="keyword">in</span> current_mapping <span class="keyword">and</span> current_mapping[plain_char] != cipher_char:</span><br><span class="line">                conflicts.append(<span class="string">f&quot;键冲突: &#x27;<span class="subst">&#123;plain_char&#125;</span>&#x27; 已映射到 &#x27;<span class="subst">&#123;current_mapping[plain_char]&#125;</span>&#x27;&quot;</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="comment"># 检查值冲突</span></span><br><span class="line">            <span class="keyword">for</span> existing_plain, existing_cipher <span class="keyword">in</span> current_mapping.items():</span><br><span class="line">                <span class="keyword">if</span> existing_cipher == cipher_char <span class="keyword">and</span> existing_plain != plain_char:</span><br><span class="line">                    conflicts.append(<span class="string">f&quot;值冲突: &#x27;<span class="subst">&#123;cipher_char&#125;</span>&#x27; 已被 &#x27;<span class="subst">&#123;existing_plain&#125;</span>&#x27; 映射&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> conflicts</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">merge_mappings</span>(<span class="params">self, current_mapping: <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="built_in">str</span>], </span></span><br><span class="line"><span class="params">                      new_mapping: <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="built_in">str</span>]</span>) -&gt; <span class="type">Tuple</span>[<span class="type">Dict</span>[<span class="built_in">str</span>, <span class="built_in">str</span>], <span class="built_in">bool</span>]:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;安全地合并映射&quot;&quot;&quot;</span></span><br><span class="line">        conflicts = <span class="variable language_">self</span>.check_mapping_conflicts(new_mapping, current_mapping)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> conflicts:</span><br><span class="line">            <span class="keyword">return</span> current_mapping, <span class="literal">False</span></span><br><span class="line">        </span><br><span class="line">        merged = current_mapping.copy()</span><br><span class="line">        merged.update(new_mapping)</span><br><span class="line">        <span class="keyword">return</span> merged, <span class="literal">True</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">refine_mapping_with_tokens</span>(<span class="params">self, tokens: <span class="type">List</span>[<span class="built_in">str</span>], </span></span><br><span class="line"><span class="params">                                  candidates: <span class="type">List</span>[<span class="type">Dict</span>[<span class="built_in">str</span>, <span class="built_in">str</span>]]</span>) -&gt; <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="built_in">str</span>]:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;基于高分token优化映射&quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># 处理所有token</span></span><br><span class="line">        token_results = []</span><br><span class="line">        <span class="keyword">for</span> token <span class="keyword">in</span> tokens:</span><br><span class="line">            result = <span class="variable language_">self</span>.score_token_candidates(token, candidates)</span><br><span class="line">            token_results.append(result)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 按评分排序</span></span><br><span class="line">        token_results.sort(key=<span class="keyword">lambda</span> x: </span><br><span class="line">            wordfreq.word_frequency(x[<span class="string">&#x27;similar_word&#x27;</span>], <span class="string">&#x27;en&#x27;</span>) * <span class="built_in">len</span>(x[<span class="string">&#x27;similar_word&#x27;</span>]), reverse=<span class="literal">True</span>)</span><br><span class="line">        </span><br><span class="line">        current_mapping = &#123;&#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 处理长token（&gt;=4字符）</span></span><br><span class="line">        <span class="keyword">for</span> result <span class="keyword">in</span> token_results:</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(result[<span class="string">&#x27;token&#x27;</span>]) &gt;= <span class="number">4</span>:</span><br><span class="line">                new_mapping = <span class="variable language_">self</span>.create_token_mapping(result[<span class="string">&#x27;token&#x27;</span>], result[<span class="string">&#x27;similar_word&#x27;</span>])</span><br><span class="line">                current_mapping, success = <span class="variable language_">self</span>.merge_mappings(current_mapping, new_mapping)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 处理短token</span></span><br><span class="line">        <span class="keyword">for</span> result <span class="keyword">in</span> token_results:</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(result[<span class="string">&#x27;token&#x27;</span>]) &lt; <span class="number">4</span>:</span><br><span class="line">                new_mapping = <span class="variable language_">self</span>.create_token_mapping(result[<span class="string">&#x27;token&#x27;</span>], result[<span class="string">&#x27;similar_word&#x27;</span>])</span><br><span class="line">                current_mapping, success = <span class="variable language_">self</span>.merge_mappings(current_mapping, new_mapping)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> current_mapping</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">calculate_word_ratio</span>(<span class="params">self, text: <span class="built_in">str</span></span>) -&gt; <span class="built_in">float</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;计算文本中合法英文单词的占比&quot;&quot;&quot;</span></span><br><span class="line">        translator = <span class="built_in">str</span>.maketrans(<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>, punctuation)</span><br><span class="line">        cleaned_text = text.translate(translator)</span><br><span class="line">        words_list = cleaned_text.lower().split()</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> words_list:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0.0</span></span><br><span class="line">        </span><br><span class="line">        valid_count = <span class="built_in">sum</span>(<span class="number">1</span> <span class="keyword">for</span> word <span class="keyword">in</span> words_list <span class="keyword">if</span> word <span class="keyword">in</span> <span class="variable language_">self</span>.english_words)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">round</span>(valid_count / <span class="built_in">len</span>(words_list), <span class="number">3</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">complete_mapping</span>(<span class="params">self, partial_mapping: <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="built_in">str</span>]</span>) -&gt; <span class="type">List</span>[<span class="type">Dict</span>[<span class="built_in">str</span>, <span class="built_in">str</span>]]:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;补全缺失的字母映射&quot;&quot;&quot;</span></span><br><span class="line">        all_letters = <span class="built_in">set</span>(<span class="string">&#x27;abcdefghijklmnopqrstuvwxyz&#x27;</span>)</span><br><span class="line">        used_keys = <span class="built_in">set</span>(partial_mapping.keys())</span><br><span class="line">        used_values = <span class="built_in">set</span>(partial_mapping.values())</span><br><span class="line">        </span><br><span class="line">        missing_keys = all_letters - used_keys</span><br><span class="line">        available_values = all_letters - used_values</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(missing_keys) != <span class="built_in">len</span>(available_values):</span><br><span class="line">            <span class="keyword">return</span> []</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 生成所有可能的排列</span></span><br><span class="line">        mappings = []</span><br><span class="line">        <span class="keyword">for</span> perm <span class="keyword">in</span> permutations(<span class="built_in">sorted</span>(available_values)):</span><br><span class="line">            full_mapping = partial_mapping.copy()</span><br><span class="line">            <span class="keyword">for</span> key, value <span class="keyword">in</span> <span class="built_in">zip</span>(<span class="built_in">sorted</span>(missing_keys), perm):</span><br><span class="line">                full_mapping[key] = value</span><br><span class="line">            mappings.append(full_mapping)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> mappings</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">brute_force_completion</span>(<span class="params">self, ciphertext: <span class="built_in">str</span>, partial_mapping: <span class="type">Dict</span>[<span class="built_in">str</span>, <span class="built_in">str</span>]</span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;暴力破解补全映射&quot;&quot;&quot;</span></span><br><span class="line">        mappings = <span class="variable language_">self</span>.complete_mapping(partial_mapping)</span><br><span class="line">        </span><br><span class="line">        best_text = <span class="string">&quot;&quot;</span></span><br><span class="line">        best_ratio = <span class="number">0.0</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> mapping <span class="keyword">in</span> mappings:</span><br><span class="line">            decrypted = <span class="variable language_">self</span>.decrypt_text(ciphertext, mapping)</span><br><span class="line">            ratio = <span class="variable language_">self</span>.calculate_word_ratio(decrypted)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> ratio &gt; best_ratio:</span><br><span class="line">                best_ratio = ratio</span><br><span class="line">                best_text = decrypted</span><br><span class="line">                best_mapping = mapping</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> best_text, best_mapping</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">analyze</span>(<span class="params">self, ciphertext: <span class="built_in">str</span>, use_brute_force: <span class="built_in">bool</span> = <span class="literal">False</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;主分析函数&quot;&quot;&quot;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[+] 开始频率分析...&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 初始频率分析</span></span><br><span class="line">        cipher_freq = <span class="variable language_">self</span>.analyze_frequency(ciphertext)</span><br><span class="line">        initial_mapping = <span class="variable language_">self</span>.create_initial_mapping(cipher_freq)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 生成候选映射</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[+] 生成候选映射...&quot;</span>)</span><br><span class="line">        candidates = <span class="variable language_">self</span>.generate_candidates(ciphertext, initial_mapping)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 处理token</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[+] 处理单词片段...&quot;</span>)</span><br><span class="line">        tokens = <span class="variable language_">self</span>.tokenize_text(ciphertext)</span><br><span class="line">        refined_mapping = <span class="variable language_">self</span>.refine_mapping_with_tokens(tokens, candidates)</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[+] 优化后的映射: <span class="subst">&#123;refined_mapping&#125;</span>&quot;</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 最终解密</span></span><br><span class="line">        <span class="keyword">if</span> use_brute_force <span class="keyword">and</span> <span class="built_in">len</span>(refined_mapping) &lt; <span class="number">26</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[+] 使用暴力破解补全映射...&quot;</span>)</span><br><span class="line">            result, refined_mapping = <span class="variable language_">self</span>.brute_force_completion(ciphertext, refined_mapping)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result = <span class="variable language_">self</span>.decrypt_text(ciphertext, refined_mapping)</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[+] 解密结果: <span class="subst">&#123;result&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[+] 解密密钥: <span class="subst">&#123;refined_mapping&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    ciphertext = <span class="string">&#x27;&#x27;&#x27;Teif A tpr ctifcw-risif wipkr dng, A tpr p oafafm-hkdlik’r qnikl af Rpf Ukpfqarqd, pfg pf izxikc af pnn cei gicpanr du rcdql ckpuuaq. A tpr pndfi af cei tdkng, pfg epg fdceafm cd gixifg vxdf hvc ow tacr pfg p qnipf kixvcpcadf; hvc ceiri tiki riccafm ow uiic af cei kdpg cd isifcvpn udkcvfi, pfg A tpr qdfcifc tace cei xkdrxiqc.&#x27;&#x27;&#x27;</span></span><br><span class="line">    </span><br><span class="line">    analyzer = FrequencyAnalysis()</span><br><span class="line">    result = analyzer.analyze(ciphertext, use_brute_force=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    [+] 开始频率分析...</span></span><br><span class="line"><span class="string">    [+] 生成候选映射...</span></span><br><span class="line"><span class="string">    [+] 处理单词片段...</span></span><br><span class="line"><span class="string">    [+] 优化后的映射: &#123;&#x27;t&#x27;: &#x27;c&#x27;, &#x27;h&#x27;: &#x27;e&#x27;, &#x27;e&#x27;: &#x27;i&#x27;, &#x27;r&#x27;: &#x27;r&#x27;, &#x27;w&#x27;: &#x27;t&#x27;, &#x27;n&#x27;: &#x27;f&#x27;, &#x27;g&#x27;: &#x27;m&#x27;, &#x27;i&#x27;: &#x27;a&#x27;, &#x27;o&#x27;: &#x27;d&#x27;, &#x27;m&#x27;: &#x27;u&#x27;, &#x27;a&#x27;: &#x27;p&#x27;, &#x27;l&#x27;: &#x27;n&#x27;, &#x27;y&#x27;: &#x27;w&#x27;, &#x27;v&#x27;: &#x27;s&#x27;, &#x27;u&#x27;: &#x27;v&#x27;, &#x27;b&#x27;: &#x27;h&#x27;, &#x27;d&#x27;: &#x27;g&#x27;&#125;</span></span><br><span class="line"><span class="string">    [+] 使用暴力破解补全映射...</span></span><br><span class="line"><span class="string">    [+] 解密结果: When I war twenty-reven yeasr old, I war a qining-bsokes’r clesk in Ran Msancirco, and an ezpest in all the detailr om rtock tsammic. I war alone in the wosld, and had nothing to depend upon but qy witr and a clean seputation; but there wese retting qy meet in the soad to eventual mostune, and I war content with the psorpect.</span></span><br><span class="line"><span class="string">    [+] 解密密钥: &#123;&#x27;t&#x27;: &#x27;c&#x27;, &#x27;h&#x27;: &#x27;e&#x27;, &#x27;e&#x27;: &#x27;i&#x27;, &#x27;r&#x27;: &#x27;r&#x27;, &#x27;w&#x27;: &#x27;t&#x27;, &#x27;n&#x27;: &#x27;f&#x27;, &#x27;g&#x27;: &#x27;m&#x27;, &#x27;i&#x27;: &#x27;a&#x27;, &#x27;o&#x27;: &#x27;d&#x27;, &#x27;m&#x27;: &#x27;u&#x27;, &#x27;a&#x27;: &#x27;p&#x27;, &#x27;l&#x27;: &#x27;n&#x27;, &#x27;y&#x27;: &#x27;w&#x27;, &#x27;v&#x27;: &#x27;s&#x27;, &#x27;u&#x27;: &#x27;v&#x27;, &#x27;b&#x27;: &#x27;h&#x27;, &#x27;d&#x27;: &#x27;g&#x27;, &#x27;c&#x27;: &#x27;q&#x27;, &#x27;f&#x27;: &#x27;b&#x27;, &#x27;j&#x27;: &#x27;j&#x27;, &#x27;k&#x27;: &#x27;l&#x27;, &#x27;p&#x27;: &#x27;x&#x27;, &#x27;q&#x27;: &#x27;o&#x27;, &#x27;s&#x27;: &#x27;k&#x27;, &#x27;x&#x27;: &#x27;y&#x27;, &#x27;z&#x27;: &#x27;z&#x27;&#125;</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&quot;letters&quot;</span>:<span class="string">&quot;abcdefghijklmnopqrstuvwxyz&quot;</span>,<span class="string">&quot;matrix&quot;</span>:[[<span class="number">0.00283</span>,<span class="number">0.229786</span>,<span class="number">0.447772</span>,<span class="number">0.367956</span>,<span class="number">0.012397</span>,<span class="number">0.074207</span>,<span class="number">0.204725</span>,<span class="number">0.013643</span>,<span class="number">0.316448</span>,<span class="number">0.011753</span>,<span class="number">0.104699</span>,<span class="number">1.08745</span>,<span class="number">0.284866</span>,<span class="number">1.985151</span>,<span class="number">0.004626</span>,<span class="number">0.202846</span>,<span class="number">0.002244</span>,<span class="number">1.074898</span>,<span class="number">0.871095</span>,<span class="number">1.486732</span>,<span class="number">0.119033</span>,<span class="number">0.204933</span>,<span class="number">0.059916</span>,<span class="number">0.018839</span>,<span class="number">0.217361</span>,<span class="number">0.011869</span>],[<span class="number">0.146204</span>,<span class="number">0.010933</span>,<span class="number">0.00189</span>,<span class="number">0.002474</span>,<span class="number">0.576284</span>,<span class="number">0.000146</span>,<span class="number">0.000255</span>,<span class="number">0.001057</span>,<span class="number">0.106597</span>,<span class="number">0.023225</span>,<span class="number">9.4e-05</span>,<span class="number">0.2334</span>,<span class="number">0.003129</span>,<span class="number">0.002095</span>,<span class="number">0.195411</span>,<span class="number">0.000547</span>,<span class="number">1.2e-05</span>,<span class="number">0.11156</span>,<span class="number">0.045832</span>,<span class="number">0.017104</span>,<span class="number">0.184944</span>,<span class="number">0.003844</span>,<span class="number">0.000295</span>,<span class="number">2.8e-05</span>,<span class="number">0.176468</span>,<span class="number">3.6e-05</span>],[<span class="number">0.538164</span>,<span class="number">0.00063</span>,<span class="number">0.083138</span>,<span class="number">0.002231</span>,<span class="number">0.651417</span>,<span class="number">0.001408</span>,<span class="number">0.000886</span>,<span class="number">0.597766</span>,<span class="number">0.281485</span>,<span class="number">0.000105</span>,<span class="number">0.117626</span>,<span class="number">0.149011</span>,<span class="number">0.002665</span>,<span class="number">0.00086</span>,<span class="number">0.79386</span>,<span class="number">0.001315</span>,<span class="number">0.005475</span>,<span class="number">0.149456</span>,<span class="number">0.022823</span>,<span class="number">0.460972</span>,<span class="number">0.162614</span>,<span class="number">0.000208</span>,<span class="number">0.000139</span>,<span class="number">3.1e-05</span>,<span class="number">0.041719</span>,<span class="number">0.000731</span>],[<span class="number">0.151067</span>,<span class="number">0.002773</span>,<span class="number">0.002519</span>,<span class="number">0.042751</span>,<span class="number">0.764818</span>,<span class="number">0.002779</span>,<span class="number">0.031003</span>,<span class="number">0.005438</span>,<span class="number">0.492966</span>,<span class="number">0.004782</span>,<span class="number">0.000337</span>,<span class="number">0.03234</span>,<span class="number">0.018177</span>,<span class="number">0.007569</span>,<span class="number">0.188235</span>,<span class="number">0.001733</span>,<span class="number">0.000707</span>,<span class="number">0.08545</span>,<span class="number">0.126261</span>,<span class="number">0.002896</span>,<span class="number">0.148461</span>,<span class="number">0.019053</span>,<span class="number">0.008162</span>,<span class="number">4.6e-05</span>,<span class="number">0.050423</span>,<span class="number">7.8e-05</span>],[<span class="number">0.688165</span>,<span class="number">0.027074</span>,<span class="number">0.477283</span>,<span class="number">1.168123</span>,<span class="number">0.377605</span>,<span class="number">0.162732</span>,<span class="number">0.119536</span>,<span class="number">0.026324</span>,<span class="number">0.183352</span>,<span class="number">0.004546</span>,<span class="number">0.016472</span>,<span class="number">0.530302</span>,<span class="number">0.373664</span>,<span class="number">1.454248</span>,<span class="number">0.0725</span>,<span class="number">0.171574</span>,<span class="number">0.057252</span>,<span class="number">2.048265</span>,<span class="number">1.339394</span>,<span class="number">0.412608</span>,<span class="number">0.031153</span>,<span class="number">0.254784</span>,<span class="number">0.116806</span>,<span class="number">0.214045</span>,<span class="number">0.143746</span>,<span class="number">0.004523</span>],[<span class="number">0.164</span>,<span class="number">0.000274</span>,<span class="number">0.000576</span>,<span class="number">0.000495</span>,<span class="number">0.236573</span>,<span class="number">0.146317</span>,<span class="number">0.000512</span>,<span class="number">0.000183</span>,<span class="number">0.284586</span>,<span class="number">7.3e-05</span>,<span class="number">0.000117</span>,<span class="number">0.064905</span>,<span class="number">0.000686</span>,<span class="number">0.000419</span>,<span class="number">0.487754</span>,<span class="number">0.000222</span>,<span class="number">5e-06</span>,<span class="number">0.213189</span>,<span class="number">0.00551</span>,<span class="number">0.081664</span>,<span class="number">0.095975</span>,<span class="number">2.9e-05</span>,<span class="number">0.000229</span>,<span class="number">2.9e-05</span>,<span class="number">0.009098</span>,<span class="number">9e-06</span>],[<span class="number">0.148077</span>,<span class="number">0.000495</span>,<span class="number">0.000229</span>,<span class="number">0.00316</span>,<span class="number">0.38519</span>,<span class="number">0.001204</span>,<span class="number">0.024755</span>,<span class="number">0.227503</span>,<span class="number">0.151637</span>,<span class="number">3.9e-05</span>,<span class="number">0.00026</span>,<span class="number">0.060637</span>,<span class="number">0.009858</span>,<span class="number">0.065639</span>,<span class="number">0.132128</span>,<span class="number">0.000412</span>,<span class="number">1.2e-05</span>,<span class="number">0.196778</span>,<span class="number">0.051193</span>,<span class="number">0.015403</span>,<span class="number">0.08577</span>,<span class="number">4.2e-05</span>,<span class="number">0.000648</span>,<span class="number">2e-05</span>,<span class="number">0.02594</span>,<span class="number">0.000122</span>],[<span class="number">0.925764</span>,<span class="number">0.00439</span>,<span class="number">0.001228</span>,<span class="number">0.002857</span>,<span class="number">3.074741</span>,<span class="number">0.002243</span>,<span class="number">0.000276</span>,<span class="number">0.000522</span>,<span class="number">0.763242</span>,<span class="number">4.5e-05</span>,<span class="number">0.000234</span>,<span class="number">0.012592</span>,<span class="number">0.012743</span>,<span class="number">0.025758</span>,<span class="number">0.484902</span>,<span class="number">0.000592</span>,<span class="number">0.000423</span>,<span class="number">0.084393</span>,<span class="number">0.014684</span>,<span class="number">0.130186</span>,<span class="number">0.073693</span>,<span class="number">0.000223</span>,<span class="number">0.004774</span>,<span class="number">9e-06</span>,<span class="number">0.050089</span>,<span class="number">0.000381</span>],[<span class="number">0.286282</span>,<span class="number">0.098603</span>,<span class="number">0.698707</span>,<span class="number">0.295504</span>,<span class="number">0.384646</span>,<span class="number">0.203257</span>,<span class="number">0.254961</span>,<span class="number">0.002091</span>,<span class="number">0.022782</span>,<span class="number">0.001111</span>,<span class="number">0.042913</span>,<span class="number">0.431535</span>,<span class="number">0.31776</span>,<span class="number">2.432745</span>,<span class="number">0.834932</span>,<span class="number">0.089211</span>,<span class="number">0.011304</span>,<span class="number">0.315172</span>,<span class="number">1.12843</span>,<span class="number">1.123274</span>,<span class="number">0.017409</span>,<span class="number">0.287848</span>,<span class="number">0.000625</span>,<span class="number">0.022032</span>,<span class="number">0.000222</span>,<span class="number">0.06434</span>],[<span class="number">0.025861</span>,<span class="number">7.5e-05</span>,<span class="number">0.000122</span>,<span class="number">9.3e-05</span>,<span class="number">0.051887</span>,<span class="number">8.6e-05</span>,<span class="number">3.7e-05</span>,<span class="number">0.000126</span>,<span class="number">0.002763</span>,<span class="number">0.000106</span>,<span class="number">6.2e-05</span>,<span class="number">0.000113</span>,<span class="number">0.00013</span>,<span class="number">0.000147</span>,<span class="number">0.05379</span>,<span class="number">0.000217</span>,<span class="number">0.0</span>,<span class="number">0.000243</span>,<span class="number">0.000118</span>,<span class="number">0.000103</span>,<span class="number">0.058702</span>,<span class="number">6.1e-05</span>,<span class="number">4.1e-05</span>,<span class="number">6e-06</span>,<span class="number">4e-05</span>,<span class="number">8e-06</span>],[<span class="number">0.016956</span>,<span class="number">0.000901</span>,<span class="number">0.000224</span>,<span class="number">0.00067</span>,<span class="number">0.213768</span>,<span class="number">0.001587</span>,<span class="number">0.002563</span>,<span class="number">0.003185</span>,<span class="number">0.097878</span>,<span class="number">0.000123</span>,<span class="number">0.000453</span>,<span class="number">0.01057</span>,<span class="number">0.001789</span>,<span class="number">0.051439</span>,<span class="number">0.006076</span>,<span class="number">0.000727</span>,<span class="number">7e-06</span>,<span class="number">0.002722</span>,<span class="number">0.047509</span>,<span class="number">0.001033</span>,<span class="number">0.003026</span>,<span class="number">0.000157</span>,<span class="number">0.002178</span>,<span class="number">2e-05</span>,<span class="number">0.00595</span>,<span class="number">5e-06</span>],[<span class="number">0.527529</span>,<span class="number">0.00669</span>,<span class="number">0.011822</span>,<span class="number">0.252606</span>,<span class="number">0.829254</span>,<span class="number">0.053477</span>,<span class="number">0.006088</span>,<span class="number">0.001619</span>,<span class="number">0.624352</span>,<span class="number">0.000112</span>,<span class="number">0.019715</span>,<span class="number">0.576571</span>,<span class="number">0.023021</span>,<span class="number">0.00587</span>,<span class="number">0.386884</span>,<span class="number">0.01903</span>,<span class="number">0.000127</span>,<span class="number">0.010051</span>,<span class="number">0.141513</span>,<span class="number">0.123637</span>,<span class="number">0.135189</span>,<span class="number">0.034906</span>,<span class="number">0.012639</span>,<span class="number">0.000305</span>,<span class="number">0.425014</span>,<span class="number">0.000417</span>],[<span class="number">0.565269</span>,<span class="number">0.090256</span>,<span class="number">0.004312</span>,<span class="number">0.000671</span>,<span class="number">0.793006</span>,<span class="number">0.003818</span>,<span class="number">0.001225</span>,<span class="number">0.000533</span>,<span class="number">0.317691</span>,<span class="number">0.000104</span>,<span class="number">0.00014</span>,<span class="number">0.004607</span>,<span class="number">0.096069</span>,<span class="number">0.00879</span>,<span class="number">0.336878</span>,<span class="number">0.239175</span>,<span class="number">2.5e-05</span>,<span class="number">0.003106</span>,<span class="number">0.092833</span>,<span class="number">0.001367</span>,<span class="number">0.114619</span>,<span class="number">0.00029</span>,<span class="number">0.000584</span>,<span class="number">3.5e-05</span>,<span class="number">0.062186</span>,<span class="number">3.4e-05</span>],[<span class="number">0.347235</span>,<span class="number">0.004336</span>,<span class="number">0.415746</span>,<span class="number">1.352281</span>,<span class="number">0.691722</span>,<span class="number">0.067181</span>,<span class="number">0.953015</span>,<span class="number">0.010884</span>,<span class="number">0.339212</span>,<span class="number">0.011086</span>,<span class="number">0.051605</span>,<span class="number">0.063784</span>,<span class="number">0.027749</span>,<span class="number">0.072765</span>,<span class="number">0.464575</span>,<span class="number">0.006036</span>,<span class="number">0.00595</span>,<span class="number">0.009152</span>,<span class="number">0.508937</span>,<span class="number">1.041251</span>,<span class="number">0.078644</span>,<span class="number">0.052007</span>,<span class="number">0.005797</span>,<span class="number">0.002621</span>,<span class="number">0.097917</span>,<span class="number">0.004369</span>],[<span class="number">0.057486</span>,<span class="number">0.096671</span>,<span class="number">0.166405</span>,<span class="number">0.195449</span>,<span class="number">0.038631</span>,<span class="number">1.174975</span>,<span class="number">0.094024</span>,<span class="number">0.021354</span>,<span class="number">0.087751</span>,<span class="number">0.006976</span>,<span class="number">0.064312</span>,<span class="number">0.365493</span>,<span class="number">0.546257</span>,<span class="number">1.758046</span>,<span class="number">0.210259</span>,<span class="number">0.223911</span>,<span class="number">0.001037</span>,<span class="number">1.276539</span>,<span class="number">0.289967</span>,<span class="number">0.442103</span>,<span class="number">0.870002</span>,<span class="number">0.178087</span>,<span class="number">0.330478</span>,<span class="number">0.018575</span>,<span class="number">0.036181</span>,<span class="number">0.003472</span>],[<span class="number">0.323572</span>,<span class="number">0.001309</span>,<span class="number">0.001176</span>,<span class="number">0.001199</span>,<span class="number">0.477989</span>,<span class="number">0.001455</span>,<span class="number">0.000474</span>,<span class="number">0.09439</span>,<span class="number">0.123094</span>,<span class="number">0.0001</span>,<span class="number">0.000819</span>,<span class="number">0.262987</span>,<span class="number">0.015956</span>,<span class="number">0.001189</span>,<span class="number">0.361373</span>,<span class="number">0.136546</span>,<span class="number">3.8e-05</span>,<span class="number">0.474471</span>,<span class="number">0.054571</span>,<span class="number">0.105782</span>,<span class="number">0.10454</span>,<span class="number">0.000221</span>,<span class="number">0.001207</span>,<span class="number">5.2e-05</span>,<span class="number">0.011764</span>,<span class="number">0.000226</span>],[<span class="number">0.000152</span>,<span class="number">3.8e-05</span>,<span class="number">4e-05</span>,<span class="number">1.8e-05</span>,<span class="number">2e-05</span>,<span class="number">3.4e-05</span>,<span class="number">0.0</span>,<span class="number">9e-06</span>,<span class="number">0.000318</span>,<span class="number">8e-06</span>,<span class="number">0.0</span>,<span class="number">0.000238</span>,<span class="number">3.5e-05</span>,<span class="number">6.6e-05</span>,<span class="number">4.7e-05</span>,<span class="number">1e-05</span>,<span class="number">6.1e-05</span>,<span class="number">6.2e-05</span>,<span class="number">0.000158</span>,<span class="number">4.9e-05</span>,<span class="number">0.147541</span>,<span class="number">2.3e-05</span>,<span class="number">6e-06</span>,<span class="number">6e-06</span>,<span class="number">0.0</span>,<span class="number">0.0</span>],[<span class="number">0.685633</span>,<span class="number">0.026712</span>,<span class="number">0.121387</span>,<span class="number">0.189316</span>,<span class="number">1.854323</span>,<span class="number">0.03226</span>,<span class="number">0.099773</span>,<span class="number">0.015112</span>,<span class="number">0.727619</span>,<span class="number">0.000553</span>,<span class="number">0.097034</span>,<span class="number">0.086265</span>,<span class="number">0.175133</span>,<span class="number">0.160361</span>,<span class="number">0.726724</span>,<span class="number">0.04162</span>,<span class="number">0.000998</span>,<span class="number">0.120743</span>,<span class="number">0.396527</span>,<span class="number">0.361676</span>,<span class="number">0.128329</span>,<span class="number">0.069283</span>,<span class="number">0.012757</span>,<span class="number">0.00117</span>,<span class="number">0.24774</span>,<span class="number">0.000638</span>],[<span class="number">0.218017</span>,<span class="number">0.007916</span>,<span class="number">0.154749</span>,<span class="number">0.005259</span>,<span class="number">0.932115</span>,<span class="number">0.017164</span>,<span class="number">0.002468</span>,<span class="number">0.31524</span>,<span class="number">0.550057</span>,<span class="number">0.00027</span>,<span class="number">0.039465</span>,<span class="number">0.055881</span>,<span class="number">0.065199</span>,<span class="number">0.009175</span>,<span class="number">0.397732</span>,<span class="number">0.191254</span>,<span class="number">0.007444</span>,<span class="number">0.00599</span>,<span class="number">0.405075</span>,<span class="number">1.053476</span>,<span class="number">0.311177</span>,<span class="number">0.001241</span>,<span class="number">0.023528</span>,<span class="number">1.8e-05</span>,<span class="number">0.056845</span>,<span class="number">0.00025</span>],[<span class="number">0.529886</span>,<span class="number">0.002544</span>,<span class="number">0.026136</span>,<span class="number">0.001296</span>,<span class="number">1.20487</span>,<span class="number">0.005661</span>,<span class="number">0.001969</span>,<span class="number">3.556203</span>,<span class="number">1.342579</span>,<span class="number">0.000112</span>,<span class="number">0.000464</span>,<span class="number">0.098449</span>,<span class="number">0.026479</span>,<span class="number">0.010011</span>,<span class="number">1.041267</span>,<span class="number">0.004294</span>,<span class="number">8.9e-05</span>,<span class="number">0.42582</span>,<span class="number">0.337488</span>,<span class="number">0.170683</span>,<span class="number">0.254907</span>,<span class="number">0.001163</span>,<span class="number">0.082372</span>,<span class="number">0.000118</span>,<span class="number">0.227277</span>,<span class="number">0.003849</span>],[<span class="number">0.136333</span>,<span class="number">0.08858</span>,<span class="number">0.187652</span>,<span class="number">0.091401</span>,<span class="number">0.14748</span>,<span class="number">0.018532</span>,<span class="number">0.127908</span>,<span class="number">0.001067</span>,<span class="number">0.101153</span>,<span class="number">0.000516</span>,<span class="number">0.004604</span>,<span class="number">0.345829</span>,<span class="number">0.138383</span>,<span class="number">0.394413</span>,<span class="number">0.010657</span>,<span class="number">0.136012</span>,<span class="number">0.000257</span>,<span class="number">0.542748</span>,<span class="number">0.454257</span>,<span class="number">0.405151</span>,<span class="number">0.00078</span>,<span class="number">0.002917</span>,<span class="number">0.000277</span>,<span class="number">0.003935</span>,<span class="number">0.004567</span>,<span class="number">0.001911</span>],[<span class="number">0.13998</span>,<span class="number">8.9e-05</span>,<span class="number">0.000233</span>,<span class="number">0.000299</span>,<span class="number">0.825281</span>,<span class="number">5.5e-05</span>,<span class="number">0.000105</span>,<span class="number">9.5e-05</span>,<span class="number">0.269544</span>,<span class="number">2.6e-05</span>,<span class="number">1.2e-05</span>,<span class="number">0.000412</span>,<span class="number">0.000113</span>,<span class="number">0.000153</span>,<span class="number">0.071107</span>,<span class="number">0.000195</span>,<span class="number">8e-06</span>,<span class="number">0.000876</span>,<span class="number">0.000577</span>,<span class="number">0.000219</span>,<span class="number">0.002212</span>,<span class="number">9.3e-05</span>,<span class="number">2.6e-05</span>,<span class="number">1.6e-05</span>,<span class="number">0.004897</span>,<span class="number">1.8e-05</span>],[<span class="number">0.385337</span>,<span class="number">0.001061</span>,<span class="number">0.000674</span>,<span class="number">0.003538</span>,<span class="number">0.360899</span>,<span class="number">0.001608</span>,<span class="number">9.8e-05</span>,<span class="number">0.378793</span>,<span class="number">0.374421</span>,<span class="number">3.2e-05</span>,<span class="number">0.001067</span>,<span class="number">0.015221</span>,<span class="number">0.00109</span>,<span class="number">0.078988</span>,<span class="number">0.221754</span>,<span class="number">0.000744</span>,<span class="number">0.0</span>,<span class="number">0.030761</span>,<span class="number">0.035084</span>,<span class="number">0.006541</span>,<span class="number">0.000695</span>,<span class="number">1.4e-05</span>,<span class="number">0.000262</span>,<span class="number">5e-06</span>,<span class="number">0.002425</span>,<span class="number">0.0</span>],[<span class="number">0.029601</span>,<span class="number">7.7e-05</span>,<span class="number">0.02646</span>,<span class="number">6e-06</span>,<span class="number">0.021795</span>,<span class="number">0.001857</span>,<span class="number">1.9e-05</span>,<span class="number">0.004171</span>,<span class="number">0.039418</span>,<span class="number">1.8e-05</span>,<span class="number">1e-05</span>,<span class="number">0.000593</span>,<span class="number">0.000233</span>,<span class="number">5.7e-05</span>,<span class="number">0.002699</span>,<span class="number">0.066864</span>,<span class="number">0.000292</span>,<span class="number">3.2e-05</span>,<span class="number">6.4e-05</span>,<span class="number">0.046661</span>,<span class="number">0.004771</span>,<span class="number">0.001953</span>,<span class="number">0.000223</span>,<span class="number">0.002804</span>,<span class="number">0.002576</span>,<span class="number">5e-06</span>],[<span class="number">0.015766</span>,<span class="number">0.004299</span>,<span class="number">0.013501</span>,<span class="number">0.006818</span>,<span class="number">0.092669</span>,<span class="number">0.000754</span>,<span class="number">0.002593</span>,<span class="number">0.000521</span>,<span class="number">0.02882</span>,<span class="number">2e-05</span>,<span class="number">0.00033</span>,<span class="number">0.014756</span>,<span class="number">0.023675</span>,<span class="number">0.013214</span>,<span class="number">0.149902</span>,<span class="number">0.024914</span>,<span class="number">1.4e-05</span>,<span class="number">0.007792</span>,<span class="number">0.096832</span>,<span class="number">0.016684</span>,<span class="number">0.001328</span>,<span class="number">0.000181</span>,<span class="number">0.003372</span>,<span class="number">0.000149</span>,<span class="number">7.1e-05</span>,<span class="number">0.001812</span>],[<span class="number">0.024904</span>,<span class="number">0.000208</span>,<span class="number">7.5e-05</span>,<span class="number">5e-05</span>,<span class="number">0.049733</span>,<span class="number">2.2e-05</span>,<span class="number">0.000168</span>,<span class="number">0.000666</span>,<span class="number">0.012117</span>,<span class="number">1.1e-05</span>,<span class="number">3.2e-05</span>,<span class="number">0.001257</span>,<span class="number">0.000167</span>,<span class="number">0.000153</span>,<span class="number">0.007181</span>,<span class="number">4.8e-05</span>,<span class="number">3.2e-05</span>,<span class="number">0.000189</span>,<span class="number">0.000298</span>,<span class="number">0.000235</span>,<span class="number">0.002152</span>,<span class="number">0.000164</span>,<span class="number">0.000223</span>,<span class="number">4e-06</span>,<span class="number">0.002357</span>,<span class="number">0.00266</span>]]&#125;</span><br></pre></td></tr></table></figure>

<br>

<h1 id="结语"><a href="#结语" class="headerlink" title="结语"></a><strong>结语</strong></h1><p>雨还在下，敲得窗棂愈发急促。当你将用单表替换密码加密的信件封入火漆信封时，指腹仍能感受到羊皮纸的粗糙纹理 —— 那些被重新编排的字母虽暂时守住了秘密，却像悬在头顶的利剑。</p>
<p>你深知，这些看似巧妙的替换并非无懈可击。凯撒的偏移量不过二十余种可能，即便是最复杂的简单替换，也难敌字母频率的无情破译。当对手用统计规律撬开替换表的缝隙时，再精密的单表映射也会沦为透明。就像此刻窗缝里钻进来的风，总能找到最细微的缺口。</p>
<p>商队的船帆即将再次升起，英吉利海峡的雾气中藏着更多窥探的眼睛。或许，该让字母的替换不再墨守成规？让每个字符在不同位置拥有不同的替身，如同信使在不同港口更换不同的纹章。</p>
<p>雨势渐歇时，你在羊皮纸的空白处写下一行字：“若一张表不足为恃，便以百张表应之。”远处的航标灯在雾中明灭，仿佛在预示着一种更复杂的加密之道……</p>
<br>

<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a><strong>参考</strong></h1><p><strong>参考资料：</strong></p>
<p><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/ROT13">https://zh.wikipedia.org/wiki/ROT13</a></p>
<p><a target="_blank" rel="noopener" href="https://www.boxentriq.com/code-breaking/keyed-caesar-cipher">Keyed Caesar Cipher Tool</a></p>
<p><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E9%98%BF%E7%89%B9%E5%B7%B4%E5%B8%8C%E5%AF%86%E7%A2%BC">阿特巴希密码 维基百科</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cachesleuth.com/multidecoder/">CacheSleuth</a></p>
<p><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%AD%97%E6%AF%8D%E9%A2%91%E7%8E%87">字母频率 维基百科</a></p>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/opus/426863944716672745">【科普】从单表代换到字频分析</a></p>
<p><a target="_blank" rel="noopener" href="https://gist.github.com/lydell/c439049abac2c9226e53">English bigram and letter pair frequencies from the Google Corpus Data in JSON format</a></p>
<br>

<p><strong>参考文献：</strong></p>
<p>[1] 吴干华.基于频率分析的代替密码破译方法及其程序实现[J].福建电脑,2006,(09):125+127.</p>
<p>[2] 吴俊斌,吴晟,吴兴蛟. 基于字母频率的单表替换密码破译算法[J]. 计算机与数字工程,2016,(4): 583-585，634.</p>
<p>[3] Kang, DayeongCAa,Lee,et al. A Robust Decryption Technique Using Letter Frequency Analysis for Short Monoalphabetic Substitution Ciphers[J]. Journal of Computing Science and Engineering, 2024,Vol.18(3): 144-151.</p>
<p>[4] Thomas Jakobsen,. A fast method for cryptanalysis of substitution ciphers[J]. Cryptologia, 1995,Vol.19(3): 265-274.</p>
<p>[5] Jones, Michael N.. Queen’s University, Kingston,et al. Case-sensitive letter and bigram frequency counts from large-scale English corpora[J]. Behavior Research Methods, Instruments, &amp; Computers,2004,Vol.36(3): 388-396.</p>
</div><div class="article-licensing box"><div class="licensing-title"><p>[古典密码] 单表替换密码</p><p><a href="http://dstbp.com/2025/07/30/msc/">http://dstbp.com/2025/07/30/msc/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>DSTBP</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2025-07-30</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2025-08-09</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="" rel="noopener" target="_blank" title="CC BY 4.0" href="https://creativecommons.org/licenses/by/4.0/deed.zh">CC BY 4.0</a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/">密码学</a></div><!--!--></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>支付宝</span><span class="qrcode"><img src="/images/alipay_qrcode.jpg" alt="支付宝"></span></a><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>微信</span><span class="qrcode"><img src="/images/wechat_qrcode.jpg" alt="微信"></span></a></div></div></div><div class="card"><nav class="post-navigation mt-4 level is-mobile card-content"><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2025/07/14/steg-sub/"><span class="level-item">[古典密码] 隐写式单表替换密码</span><i class="level-item fas fa-chevron-right"></i></a></div></nav></div><div class="card" id="comments"><div class="card-content"><h3 class="title is-5">评论</h3><div class="content twikoo" id="twikoo"></div><script src="/js/imaegoo/twikoo/1.6.41/twikoo.min.js"></script><script>twikoo.init({
            envId: 'https://twikoo.dstbp.com',
            
            lang: "zh-CN",
            onCommentLoaded: function () {
              var commentContents = document.getElementsByClassName('tk-content');
              for (var i = 0; i < commentContents.length; i++) {
                var commentItem = commentContents[i];
                var imgEls = commentItem.getElementsByTagName('img');
                if (imgEls.length > 0) {
                  for (var j = 0; j < imgEls.length; j++) {
                    var imgEl = imgEls[j];
                    var aEl = document.createElement('a');
                    aEl.setAttribute('class', 'tk-lg-link');
                    aEl.setAttribute('href', imgEl.getAttribute('src'));
                    aEl.setAttribute('data-src', imgEl.getAttribute('src'));
                    aEl.appendChild(imgEl.cloneNode(false));
                    imgEl.parentNode.insertBefore(aEl, imgEl.nextSibling);
                    imgEl.remove();
                  }
                  if (typeof $.fn.lightGallery === 'function') {
                    $(commentItem).lightGallery({
                      selector: '.tk-lg-link'
                    });
                  }
                }
              }
            }
        });</script></div></div></div><style>.column.column-left,.column.column-right{display:none}</style><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/images/avatar.png" alt="DSTBP"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">DSTBP</p><p class="is-size-6 is-block">r0xanne</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Elliðaey island. Iceland.</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives/"><p class="title">5</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories/"><p class="title">4</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags/"><p class="title">1</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/dstbp" target="_blank" rel="me noopener" id="widget-follow">GitHub</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Home" href="https://dstbp.net"><i class="fas fa-home"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Stackexchange" href="https://crypto.stackexchange.com/users/112358/dstbp"><i class="fab fa-stack-exchange"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="Mail" href="mailto:TaddeoWang123@gmail.com"><i class="fas fa-envelope"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="me noopener" title="RSS" href="/atom.xml"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget"><div class="card-content"><div class="media" style="overflow: hidden; align-items: center"><div class="media-left"><figure class="image is-96x96"><img src="/images/weixin/qrcode.jpg" alt="微信二维码"></figure></div><div class="media-content"><div id="weixin-search-logo"></div><div class="control has-icons-left" id="weixin-search-text"><input class="input" readonly value="三两黑白" onfocus="this.select()"><span class="icon is-small is-left"><i class="fas fa-search"></i></span></div></div></div></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2025/07/"><span class="level-start"><span class="level-item">2025 年 7 月</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2025/05/"><span class="level-start"><span class="level-item">2025 年 5 月</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/02/"><span class="level-start"><span class="level-item">2024 年 2 月</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/01/"><span class="level-start"><span class="level-item">2024 年 1 月</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="level is-mobile" href="#序言"><span class="level-left"><span class="level-item">1</span><span class="level-item">序言</span></span></a></li><li><a class="level is-mobile" href="#1-ROT-密码"><span class="level-left"><span class="level-item">2</span><span class="level-item">1. ROT 密码</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-1-ROT5"><span class="level-left"><span class="level-item">2.1</span><span class="level-item">1.1 ROT5</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-1-1-加解密原理"><span class="level-left"><span class="level-item">2.1.1</span><span class="level-item">1.1.1 加解密原理</span></span></a></li></ul></li><li><a class="level is-mobile" href="#1-2-ROT13"><span class="level-left"><span class="level-item">2.2</span><span class="level-item">1.2 ROT13</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-2-1-加解密原理"><span class="level-left"><span class="level-item">2.2.1</span><span class="level-item">1.2.1 加解密原理</span></span></a></li></ul></li><li><a class="level is-mobile" href="#1-3-凯撒密码"><span class="level-left"><span class="level-item">2.3</span><span class="level-item">1.3 凯撒密码</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-3-1-加解密原理"><span class="level-left"><span class="level-item">2.3.1</span><span class="level-item">1.3.1 加解密原理</span></span></a></li></ul></li><li><a class="level is-mobile" href="#1-4-ROT18"><span class="level-left"><span class="level-item">2.4</span><span class="level-item">1.4 ROT18</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-4-1-加解密原理"><span class="level-left"><span class="level-item">2.4.1</span><span class="level-item">1.4.1 加解密原理</span></span></a></li></ul></li><li><a class="level is-mobile" href="#1-5-ROT47"><span class="level-left"><span class="level-item">2.5</span><span class="level-item">1.5 ROT47</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-5-1-加解密原理"><span class="level-left"><span class="level-item">2.5.1</span><span class="level-item">1.5.1 加解密原理</span></span></a></li></ul></li><li><a class="level is-mobile" href="#1-6-广义-ROT-密码"><span class="level-left"><span class="level-item">2.6</span><span class="level-item">1.6 广义 ROT 密码</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-6-1-加解密原理"><span class="level-left"><span class="level-item">2.6.1</span><span class="level-item">1.6.1 加解密原理</span></span></a></li><li><a class="level is-mobile" href="#1-6-2-攻击手段"><span class="level-left"><span class="level-item">2.6.2</span><span class="level-item">1.6.2 攻击手段</span></span></a></li><li><a class="level is-mobile" href="#1-6-3-方法改进"><span class="level-left"><span class="level-item">2.6.3</span><span class="level-item">1.6.3 方法改进</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="#2-Atbash-Cipher"><span class="level-left"><span class="level-item">3</span><span class="level-item">2. Atbash Cipher</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#2-1-加解密原理"><span class="level-left"><span class="level-item">3.1</span><span class="level-item">2.1 加解密原理</span></span></a></li><li><a class="level is-mobile" href="#2-2-扩展埃特巴什码"><span class="level-left"><span class="level-item">3.2</span><span class="level-item">2.2 扩展埃特巴什码</span></span></a></li></ul></li><li><a class="level is-mobile" href="#3-简单替换密码"><span class="level-left"><span class="level-item">4</span><span class="level-item">3. 简单替换密码</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#3-1-加解密原理"><span class="level-left"><span class="level-item">4.1</span><span class="level-item">3.1 加解密原理</span></span></a></li></ul></li><li><a class="level is-mobile" href="#4-仿射密码"><span class="level-left"><span class="level-item">5</span><span class="level-item">4. 仿射密码</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-1-加解密原理"><span class="level-left"><span class="level-item">5.1</span><span class="level-item">4.1 加解密原理</span></span></a></li><li><a class="level is-mobile" href="#4-2-攻击手段"><span class="level-left"><span class="level-item">5.2</span><span class="level-item">4.2 攻击手段</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#4-2-1-已知明文攻击"><span class="level-left"><span class="level-item">5.2.1</span><span class="level-item">4.2.1 已知明文攻击</span></span></a></li><li><a class="level is-mobile" href="#4-2-2-唯密文攻击"><span class="level-left"><span class="level-item">5.2.2</span><span class="level-item">4.2.2 唯密文攻击</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="#5-唯密文攻击-——-统计分析法"><span class="level-left"><span class="level-item">6</span><span class="level-item">5. 唯密文攻击 —— 统计分析法</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#5-1-破译原理"><span class="level-left"><span class="level-item">6.1</span><span class="level-item">5.1 破译原理</span></span></a></li><li><a class="level is-mobile" href="#5-2-研究背景"><span class="level-left"><span class="level-item">6.2</span><span class="level-item">5.2 研究背景</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#5-2-1-传统频率分析"><span class="level-left"><span class="level-item">6.2.1</span><span class="level-item">5.2.1 传统频率分析</span></span></a></li><li><a class="level is-mobile" href="#5-2-2-候选密钥-词典匹配频率分析"><span class="level-left"><span class="level-item">6.2.2</span><span class="level-item">5.2.2 候选密钥+词典匹配频率分析</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="#结语"><span class="level-left"><span class="level-item">7</span><span class="level-item">结语</span></span></a></li><li><a class="level is-mobile" href="#参考"><span class="level-left"><span class="level-item">8</span><span class="level-item">参考</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><figure class="media-left"><a class="image" href="/2025/07/30/msc/"><img src="https://dstbp.com/data/imgs/posts/msc/Thumbnail.png" alt="[古典密码] 单表替换密码"></a></figure><div class="media-content"><p class="date"><time dateTime="2025-07-30T11:58:43.000Z">2025-07-30</time></p><p class="title"><a href="/2025/07/30/msc/">[古典密码] 单表替换密码</a></p><p class="categories"><a href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/">密码学</a> / <a href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81/">古典密码</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2025/07/14/steg-sub/"><img src="https://dstbp.com/data/imgs/posts/smsc/Thumbnail.png" alt="[古典密码] 隐写式单表替换密码"></a></figure><div class="media-content"><p class="date"><time dateTime="2025-07-14T04:30:00.000Z">2025-07-14</time></p><p class="title"><a href="/2025/07/14/steg-sub/">[古典密码] 隐写式单表替换密码</a></p><p class="categories"><a href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/">密码学</a> / <a href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81/">古典密码</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2025/05/14/lzw/"><img src="https://dstbp.com/data/imgs/posts/lzw/Thumbnail.png" alt="[信息编码] LZW 压缩算法"></a></figure><div class="media-content"><p class="date"><time dateTime="2025-05-14T07:10:43.000Z">2025-05-14</time></p><p class="title"><a href="/2025/05/14/lzw/">[信息编码] LZW 压缩算法</a></p><p class="categories"><a href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/">密码学</a> / <a href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/%E4%BF%A1%E6%81%AF%E7%BC%96%E7%A0%81/">信息编码</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2024/02/01/buuctf1/"><img src="https://dstbp.com/data/imgs/posts/buuctf/Thumbnail.png" alt="[日常训练] Crypto Training - BUUCTF（一）"></a></figure><div class="media-content"><p class="date"><time dateTime="2024-02-01T00:10:43.000Z">2024-02-01</time></p><p class="title"><a href="/2024/02/01/buuctf1/">[日常训练] Crypto Training - BUUCTF（一）</a></p><p class="categories"><a href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/">密码学</a> / <a href="/categories/%E5%AF%86%E7%A0%81%E5%AD%A6/%E6%97%A5%E5%B8%B8%E8%AE%AD%E7%BB%83/">日常训练</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2023-12-31T16:00:00.000Z">2024-01-01</time></p><p class="title"><a href="/2024/01/01/hello-world/">欢迎来到「微澜尘寰的雾岛」</a></p></div></article></div></div><div class="card widget" id="twikoo-new"><div class="card-content"><div class="menu"><h3 class="menu-label">最新评论</h3><script>window.twikooEnvId = 'https://twikoo.dstbp.com';</script><div class="twikoo-new-container"></div></div></div></div></div><style>.column.column-left,.column.column-right{display:block}</style></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img class="logo-img" src="/images/logo.jpg" alt="DSTBP Blog" height="28"><img class="logo-img-dark" src="/images/logo-dark.jpg" alt="DSTBP Blog" height="28"></a><p class="is-size-7"><span>&copy; 2025 DSTBP</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/imaegoo/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">总访问量&nbsp;<span id="busuanzi_value_site_pv">-</span>&nbsp;次&nbsp;&nbsp;总访客数&nbsp;<span id="busuanzi_value_site_uv">-</span>&nbsp;人</span></p><p class="is-size-7">版权说明：本网站所有内容版权归属 DSTBP，仅限网友与自己学习交流，如有侵权，请<a href="/message" target="_blank" rel="noreferrer noopener">留言</a>，管理员立即处理<br/><a href="https://beian.miit.gov.cn" target="_blank" rel="noreferrer noopener">萌 ICP 备 20211214 号-8</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/deed.zh"><i class="fab fa-creative-commons-by"></i></a></p></div></div></div></div></footer><script src="/js/imaegoo/instant.page/5.1.1/instantpage.min.js" type="module"></script><script src="/js/imaegoo/jquery/3.3.1/dist/jquery.min.js"></script><script src="/js/imaegoo/moment/2.22.2/min/moment-with-locales.min.js"></script><script src="/js/imaegoo/twikoo/1.6.41/twikoo.min.js"></script><script src="/js/imaegoo/clipboard/2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'folded'
                }
            }
        };</script><script data-pjax src="/js/column.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/js/back_to_top.js" defer></script><!--!--><!--!--><script src="/js/imaegoo/lightgallery/1.10.0/dist/js/lightgallery.min.js" defer></script><script src="/js/imaegoo/justifiedGallery/3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/javascript" id="MathJax-script" async>MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      },
      chtml: {
        matchFontHeight: false
      }
    };</script><script src="/js/imaegoo/mathjax/3.2.2/es5/tex-mml-chtml.js"></script><script src="/js/imaegoo/cookieconsent/3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-right",
        content: {
          message: "此网站使用 Cookie，以启用评论系统和分析功能。",
          dismiss: "知道了",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "/cookies/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script data-pjax src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><div class="searchbox-pinyin"><label class="checkbox"><input id="search-by-pinyin" type="checkbox" checked="checked"><span> 拼音检索</span></label></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/imaegoo/pinyin.js" defer></script><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script><script type="text/javascript" src="/js/imaegoo/imaegoo.js"></script><script type="text/javascript" src="/js/imaegoo/universe.js"></script></body></html>